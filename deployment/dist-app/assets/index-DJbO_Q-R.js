var DN=Object.defineProperty;var Bg=t=>{throw TypeError(t)};var PN=(t,e,r)=>e in t?DN(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var S=(t,e,r)=>PN(t,typeof e!="symbol"?e+"":e,r),xh=(t,e,r)=>e.has(t)||Bg("Cannot "+r);var w=(t,e,r)=>(xh(t,e,"read from private field"),r?r.call(t):e.get(t)),U=(t,e,r)=>e.has(t)?Bg("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),j=(t,e,r,n)=>(xh(t,e,"write to private field"),n?n.call(t,r):e.set(t,r),r),ne=(t,e,r)=>(xh(t,e,"access private method"),r);var el=(t,e,r,n)=>({set _(a){j(t,e,a,r)},get _(){return w(t,e,n)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var by={exports:{}},Ru={},vy={exports:{}},be={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dc=Symbol.for("react.element"),IN=Symbol.for("react.portal"),TN=Symbol.for("react.fragment"),_N=Symbol.for("react.strict_mode"),BN=Symbol.for("react.profiler"),RN=Symbol.for("react.provider"),ON=Symbol.for("react.context"),MN=Symbol.for("react.forward_ref"),LN=Symbol.for("react.suspense"),FN=Symbol.for("react.memo"),UN=Symbol.for("react.lazy"),Rg=Symbol.iterator;function zN(t){return t===null||typeof t!="object"?null:(t=Rg&&t[Rg]||t["@@iterator"],typeof t=="function"?t:null)}var Ny={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ky=Object.assign,jy={};function Wo(t,e,r){this.props=t,this.context=e,this.refs=jy,this.updater=r||Ny}Wo.prototype.isReactComponent={};Wo.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Wo.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Ay(){}Ay.prototype=Wo.prototype;function em(t,e,r){this.props=t,this.context=e,this.refs=jy,this.updater=r||Ny}var tm=em.prototype=new Ay;tm.constructor=em;ky(tm,Wo.prototype);tm.isPureReactComponent=!0;var Og=Array.isArray,Ey=Object.prototype.hasOwnProperty,rm={current:null},Sy={key:!0,ref:!0,__self:!0,__source:!0};function Cy(t,e,r){var n,a={},i=null,o=null;if(e!=null)for(n in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)Ey.call(e,n)&&!Sy.hasOwnProperty(n)&&(a[n]=e[n]);var l=arguments.length-2;if(l===1)a.children=r;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];a.children=c}if(t&&t.defaultProps)for(n in l=t.defaultProps,l)a[n]===void 0&&(a[n]=l[n]);return{$$typeof:Dc,type:t,key:i,ref:o,props:a,_owner:rm.current}}function HN(t,e){return{$$typeof:Dc,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function nm(t){return typeof t=="object"&&t!==null&&t.$$typeof===Dc}function VN(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var Mg=/\/+/g;function yh(t,e){return typeof t=="object"&&t!==null&&t.key!=null?VN(""+t.key):e.toString(36)}function yd(t,e,r,n,a){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Dc:case IN:o=!0}}if(o)return o=t,a=a(o),t=n===""?"."+yh(o,0):n,Og(a)?(r="",t!=null&&(r=t.replace(Mg,"$&/")+"/"),yd(a,e,r,"",function(d){return d})):a!=null&&(nm(a)&&(a=HN(a,r+(!a.key||o&&o.key===a.key?"":(""+a.key).replace(Mg,"$&/")+"/")+t)),e.push(a)),1;if(o=0,n=n===""?".":n+":",Og(t))for(var l=0;l<t.length;l++){i=t[l];var c=n+yh(i,l);o+=yd(i,e,r,c,a)}else if(c=zN(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=n+yh(i,l++),o+=yd(i,e,r,c,a);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Gc(t,e,r){if(t==null)return t;var n=[],a=0;return yd(t,n,"","",function(i){return e.call(r,i,a++)}),n}function GN(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Lt={current:null},wd={transition:null},$N={ReactCurrentDispatcher:Lt,ReactCurrentBatchConfig:wd,ReactCurrentOwner:rm};function Dy(){throw Error("act(...) is not supported in production builds of React.")}be.Children={map:Gc,forEach:function(t,e,r){Gc(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return Gc(t,function(){e++}),e},toArray:function(t){return Gc(t,function(e){return e})||[]},only:function(t){if(!nm(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};be.Component=Wo;be.Fragment=TN;be.Profiler=BN;be.PureComponent=em;be.StrictMode=_N;be.Suspense=LN;be.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$N;be.act=Dy;be.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=ky({},t.props),a=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=rm.current),e.key!==void 0&&(a=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)Ey.call(e,c)&&!Sy.hasOwnProperty(c)&&(n[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];n.children=l}return{$$typeof:Dc,type:t.type,key:a,ref:i,props:n,_owner:o}};be.createContext=function(t){return t={$$typeof:ON,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:RN,_context:t},t.Consumer=t};be.createElement=Cy;be.createFactory=function(t){var e=Cy.bind(null,t);return e.type=t,e};be.createRef=function(){return{current:null}};be.forwardRef=function(t){return{$$typeof:MN,render:t}};be.isValidElement=nm;be.lazy=function(t){return{$$typeof:UN,_payload:{_status:-1,_result:t},_init:GN}};be.memo=function(t,e){return{$$typeof:FN,type:t,compare:e===void 0?null:e}};be.startTransition=function(t){var e=wd.transition;wd.transition={};try{t()}finally{wd.transition=e}};be.unstable_act=Dy;be.useCallback=function(t,e){return Lt.current.useCallback(t,e)};be.useContext=function(t){return Lt.current.useContext(t)};be.useDebugValue=function(){};be.useDeferredValue=function(t){return Lt.current.useDeferredValue(t)};be.useEffect=function(t,e){return Lt.current.useEffect(t,e)};be.useId=function(){return Lt.current.useId()};be.useImperativeHandle=function(t,e,r){return Lt.current.useImperativeHandle(t,e,r)};be.useInsertionEffect=function(t,e){return Lt.current.useInsertionEffect(t,e)};be.useLayoutEffect=function(t,e){return Lt.current.useLayoutEffect(t,e)};be.useMemo=function(t,e){return Lt.current.useMemo(t,e)};be.useReducer=function(t,e,r){return Lt.current.useReducer(t,e,r)};be.useRef=function(t){return Lt.current.useRef(t)};be.useState=function(t){return Lt.current.useState(t)};be.useSyncExternalStore=function(t,e,r){return Lt.current.useSyncExternalStore(t,e,r)};be.useTransition=function(){return Lt.current.useTransition()};be.version="18.3.1";vy.exports=be;var _=vy.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var QN=_,WN=Symbol.for("react.element"),KN=Symbol.for("react.fragment"),JN=Object.prototype.hasOwnProperty,YN=QN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,qN={key:!0,ref:!0,__self:!0,__source:!0};function Py(t,e,r){var n,a={},i=null,o=null;r!==void 0&&(i=""+r),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)JN.call(e,n)&&!qN.hasOwnProperty(n)&&(a[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)a[n]===void 0&&(a[n]=e[n]);return{$$typeof:WN,type:t,key:i,ref:o,props:a,_owner:YN.current}}Ru.Fragment=KN;Ru.jsx=Py;Ru.jsxs=Py;by.exports=Ru;var s=by.exports,Iy={exports:{}},dr={},Ty={exports:{}},_y={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(B,R){var G=B.length;B.push(R);e:for(;0<G;){var F=G-1>>>1,H=B[F];if(0<a(H,R))B[F]=R,B[G]=H,G=F;else break e}}function r(B){return B.length===0?null:B[0]}function n(B){if(B.length===0)return null;var R=B[0],G=B.pop();if(G!==R){B[0]=G;e:for(var F=0,H=B.length,$=H>>>1;F<$;){var I=2*(F+1)-1,W=B[I],q=I+1,ae=B[q];if(0>a(W,G))q<H&&0>a(ae,W)?(B[F]=ae,B[q]=G,F=q):(B[F]=W,B[I]=G,F=I);else if(q<H&&0>a(ae,G))B[F]=ae,B[q]=G,F=q;else break e}}return R}function a(B,R){var G=B.sortIndex-R.sortIndex;return G!==0?G:B.id-R.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],d=[],h=1,u=null,f=3,g=!1,b=!1,y=!1,k=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function p(B){for(var R=r(d);R!==null;){if(R.callback===null)n(d);else if(R.startTime<=B)n(d),R.sortIndex=R.expirationTime,e(c,R);else break;R=r(d)}}function v(B){if(y=!1,p(B),!b)if(r(c)!==null)b=!0,Y(N);else{var R=r(d);R!==null&&T(v,R.startTime-B)}}function N(B,R){b=!1,y&&(y=!1,m(E),E=-1),g=!0;var G=f;try{for(p(R),u=r(c);u!==null&&(!(u.expirationTime>R)||B&&!O());){var F=u.callback;if(typeof F=="function"){u.callback=null,f=u.priorityLevel;var H=F(u.expirationTime<=R);R=t.unstable_now(),typeof H=="function"?u.callback=H:u===r(c)&&n(c),p(R)}else n(c);u=r(c)}if(u!==null)var $=!0;else{var I=r(d);I!==null&&T(v,I.startTime-R),$=!1}return $}finally{u=null,f=G,g=!1}}var A=!1,D=null,E=-1,L=5,C=-1;function O(){return!(t.unstable_now()-C<L)}function V(){if(D!==null){var B=t.unstable_now();C=B;var R=!0;try{R=D(!0,B)}finally{R?M():(A=!1,D=null)}}else A=!1}var M;if(typeof x=="function")M=function(){x(V)};else if(typeof MessageChannel<"u"){var ie=new MessageChannel,z=ie.port2;ie.port1.onmessage=V,M=function(){z.postMessage(null)}}else M=function(){k(V,0)};function Y(B){D=B,A||(A=!0,M())}function T(B,R){E=k(function(){B(t.unstable_now())},R)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(B){B.callback=null},t.unstable_continueExecution=function(){b||g||(b=!0,Y(N))},t.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<B?Math.floor(1e3/B):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(B){switch(f){case 1:case 2:case 3:var R=3;break;default:R=f}var G=f;f=R;try{return B()}finally{f=G}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(B,R){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var G=f;f=B;try{return R()}finally{f=G}},t.unstable_scheduleCallback=function(B,R,G){var F=t.unstable_now();switch(typeof G=="object"&&G!==null?(G=G.delay,G=typeof G=="number"&&0<G?F+G:F):G=F,B){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=G+H,B={id:h++,callback:R,priorityLevel:B,startTime:G,expirationTime:H,sortIndex:-1},G>F?(B.sortIndex=G,e(d,B),r(c)===null&&B===r(d)&&(y?(m(E),E=-1):y=!0,T(v,G-F))):(B.sortIndex=H,e(c,B),b||g||(b=!0,Y(N))),B},t.unstable_shouldYield=O,t.unstable_wrapCallback=function(B){var R=f;return function(){var G=f;f=R;try{return B.apply(this,arguments)}finally{f=G}}}})(_y);Ty.exports=_y;var ZN=Ty.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var XN=_,cr=ZN;function Z(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var By=new Set,Ll={};function ti(t,e){Ao(t,e),Ao(t+"Capture",e)}function Ao(t,e){for(Ll[t]=e,t=0;t<e.length;t++)By.add(e[t])}var Kn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),wf=Object.prototype.hasOwnProperty,e2=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Lg={},Fg={};function t2(t){return wf.call(Fg,t)?!0:wf.call(Lg,t)?!1:e2.test(t)?Fg[t]=!0:(Lg[t]=!0,!1)}function r2(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function n2(t,e,r,n){if(e===null||typeof e>"u"||r2(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ft(t,e,r,n,a,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var xt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){xt[t]=new Ft(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];xt[e]=new Ft(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){xt[t]=new Ft(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){xt[t]=new Ft(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){xt[t]=new Ft(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){xt[t]=new Ft(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){xt[t]=new Ft(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){xt[t]=new Ft(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){xt[t]=new Ft(t,5,!1,t.toLowerCase(),null,!1,!1)});var sm=/[\-:]([a-z])/g;function am(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(sm,am);xt[e]=new Ft(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(sm,am);xt[e]=new Ft(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(sm,am);xt[e]=new Ft(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){xt[t]=new Ft(t,1,!1,t.toLowerCase(),null,!1,!1)});xt.xlinkHref=new Ft("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){xt[t]=new Ft(t,1,!1,t.toLowerCase(),null,!0,!0)});function im(t,e,r,n){var a=xt.hasOwnProperty(e)?xt[e]:null;(a!==null?a.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(n2(e,r,a,n)&&(r=null),n||a===null?t2(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):a.mustUseProperty?t[a.propertyName]=r===null?a.type===3?!1:"":r:(e=a.attributeName,n=a.attributeNamespace,r===null?t.removeAttribute(e):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var rs=XN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,$c=Symbol.for("react.element"),ui=Symbol.for("react.portal"),hi=Symbol.for("react.fragment"),om=Symbol.for("react.strict_mode"),bf=Symbol.for("react.profiler"),Ry=Symbol.for("react.provider"),Oy=Symbol.for("react.context"),lm=Symbol.for("react.forward_ref"),vf=Symbol.for("react.suspense"),Nf=Symbol.for("react.suspense_list"),cm=Symbol.for("react.memo"),gs=Symbol.for("react.lazy"),My=Symbol.for("react.offscreen"),Ug=Symbol.iterator;function tl(t){return t===null||typeof t!="object"?null:(t=Ug&&t[Ug]||t["@@iterator"],typeof t=="function"?t:null)}var Ke=Object.assign,wh;function ul(t){if(wh===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);wh=e&&e[1]||""}return`
`+wh+t}var bh=!1;function vh(t,e){if(!t||bh)return"";bh=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var n=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){n=d}t.call(e.prototype)}else{try{throw Error()}catch(d){n=d}t()}}catch(d){if(d&&n&&typeof d.stack=="string"){for(var a=d.stack.split(`
`),i=n.stack.split(`
`),o=a.length-1,l=i.length-1;1<=o&&0<=l&&a[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(a[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||a[o]!==i[l]){var c=`
`+a[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{bh=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?ul(t):""}function s2(t){switch(t.tag){case 5:return ul(t.type);case 16:return ul("Lazy");case 13:return ul("Suspense");case 19:return ul("SuspenseList");case 0:case 2:case 15:return t=vh(t.type,!1),t;case 11:return t=vh(t.type.render,!1),t;case 1:return t=vh(t.type,!0),t;default:return""}}function kf(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case hi:return"Fragment";case ui:return"Portal";case bf:return"Profiler";case om:return"StrictMode";case vf:return"Suspense";case Nf:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Oy:return(t.displayName||"Context")+".Consumer";case Ry:return(t._context.displayName||"Context")+".Provider";case lm:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case cm:return e=t.displayName||null,e!==null?e:kf(t.type)||"Memo";case gs:e=t._payload,t=t._init;try{return kf(t(e))}catch{}}return null}function a2(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return kf(e);case 8:return e===om?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ys(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Ly(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function i2(t){var e=Ly(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,i=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return a.call(this)},set:function(o){n=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Qc(t){t._valueTracker||(t._valueTracker=i2(t))}function Fy(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=Ly(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function zd(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function jf(t,e){var r=e.checked;return Ke({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function zg(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Ys(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Uy(t,e){e=e.checked,e!=null&&im(t,"checked",e,!1)}function Af(t,e){Uy(t,e);var r=Ys(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Ef(t,e.type,r):e.hasOwnProperty("defaultValue")&&Ef(t,e.type,Ys(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Hg(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function Ef(t,e,r){(e!=="number"||zd(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var hl=Array.isArray;function Ci(t,e,r,n){if(t=t.options,e){e={};for(var a=0;a<r.length;a++)e["$"+r[a]]=!0;for(r=0;r<t.length;r++)a=e.hasOwnProperty("$"+t[r].value),t[r].selected!==a&&(t[r].selected=a),a&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Ys(r),e=null,a=0;a<t.length;a++){if(t[a].value===r){t[a].selected=!0,n&&(t[a].defaultSelected=!0);return}e!==null||t[a].disabled||(e=t[a])}e!==null&&(e.selected=!0)}}function Sf(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Z(91));return Ke({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Vg(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(Z(92));if(hl(r)){if(1<r.length)throw Error(Z(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Ys(r)}}function zy(t,e){var r=Ys(e.value),n=Ys(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function Gg(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Hy(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Cf(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Hy(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Wc,Vy=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,a){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,a)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Wc=Wc||document.createElement("div"),Wc.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Wc.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Fl(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var vl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},o2=["Webkit","ms","Moz","O"];Object.keys(vl).forEach(function(t){o2.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),vl[e]=vl[t]})});function Gy(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||vl.hasOwnProperty(t)&&vl[t]?(""+e).trim():e+"px"}function $y(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=Gy(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,a):t[r]=a}}var l2=Ke({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Df(t,e){if(e){if(l2[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Z(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Z(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Z(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Z(62))}}function Pf(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var If=null;function dm(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Tf=null,Di=null,Pi=null;function $g(t){if(t=Tc(t)){if(typeof Tf!="function")throw Error(Z(280));var e=t.stateNode;e&&(e=Uu(e),Tf(t.stateNode,t.type,e))}}function Qy(t){Di?Pi?Pi.push(t):Pi=[t]:Di=t}function Wy(){if(Di){var t=Di,e=Pi;if(Pi=Di=null,$g(t),e)for(t=0;t<e.length;t++)$g(e[t])}}function Ky(t,e){return t(e)}function Jy(){}var Nh=!1;function Yy(t,e,r){if(Nh)return t(e,r);Nh=!0;try{return Ky(t,e,r)}finally{Nh=!1,(Di!==null||Pi!==null)&&(Jy(),Wy())}}function Ul(t,e){var r=t.stateNode;if(r===null)return null;var n=Uu(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(Z(231,e,typeof r));return r}var _f=!1;if(Kn)try{var rl={};Object.defineProperty(rl,"passive",{get:function(){_f=!0}}),window.addEventListener("test",rl,rl),window.removeEventListener("test",rl,rl)}catch{_f=!1}function c2(t,e,r,n,a,i,o,l,c){var d=Array.prototype.slice.call(arguments,3);try{e.apply(r,d)}catch(h){this.onError(h)}}var Nl=!1,Hd=null,Vd=!1,Bf=null,d2={onError:function(t){Nl=!0,Hd=t}};function u2(t,e,r,n,a,i,o,l,c){Nl=!1,Hd=null,c2.apply(d2,arguments)}function h2(t,e,r,n,a,i,o,l,c){if(u2.apply(this,arguments),Nl){if(Nl){var d=Hd;Nl=!1,Hd=null}else throw Error(Z(198));Vd||(Vd=!0,Bf=d)}}function ri(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function qy(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Qg(t){if(ri(t)!==t)throw Error(Z(188))}function f2(t){var e=t.alternate;if(!e){if(e=ri(t),e===null)throw Error(Z(188));return e!==t?null:t}for(var r=t,n=e;;){var a=r.return;if(a===null)break;var i=a.alternate;if(i===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===r)return Qg(a),t;if(i===n)return Qg(a),e;i=i.sibling}throw Error(Z(188))}if(r.return!==n.return)r=a,n=i;else{for(var o=!1,l=a.child;l;){if(l===r){o=!0,r=a,n=i;break}if(l===n){o=!0,n=a,r=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===r){o=!0,r=i,n=a;break}if(l===n){o=!0,n=i,r=a;break}l=l.sibling}if(!o)throw Error(Z(189))}}if(r.alternate!==n)throw Error(Z(190))}if(r.tag!==3)throw Error(Z(188));return r.stateNode.current===r?t:e}function Zy(t){return t=f2(t),t!==null?Xy(t):null}function Xy(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Xy(t);if(e!==null)return e;t=t.sibling}return null}var ew=cr.unstable_scheduleCallback,Wg=cr.unstable_cancelCallback,m2=cr.unstable_shouldYield,g2=cr.unstable_requestPaint,Ze=cr.unstable_now,p2=cr.unstable_getCurrentPriorityLevel,um=cr.unstable_ImmediatePriority,tw=cr.unstable_UserBlockingPriority,Gd=cr.unstable_NormalPriority,x2=cr.unstable_LowPriority,rw=cr.unstable_IdlePriority,Ou=null,yn=null;function y2(t){if(yn&&typeof yn.onCommitFiberRoot=="function")try{yn.onCommitFiberRoot(Ou,t,void 0,(t.current.flags&128)===128)}catch{}}var $r=Math.clz32?Math.clz32:v2,w2=Math.log,b2=Math.LN2;function v2(t){return t>>>=0,t===0?32:31-(w2(t)/b2|0)|0}var Kc=64,Jc=4194304;function fl(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function $d(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,a=t.suspendedLanes,i=t.pingedLanes,o=r&268435455;if(o!==0){var l=o&~a;l!==0?n=fl(l):(i&=o,i!==0&&(n=fl(i)))}else o=r&~a,o!==0?n=fl(o):i!==0&&(n=fl(i));if(n===0)return 0;if(e!==0&&e!==n&&!(e&a)&&(a=n&-n,i=e&-e,a>=i||a===16&&(i&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-$r(e),a=1<<r,n|=t[r],e&=~a;return n}function N2(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function k2(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,a=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-$r(i),l=1<<o,c=a[o];c===-1?(!(l&r)||l&n)&&(a[o]=N2(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function Rf(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function nw(){var t=Kc;return Kc<<=1,!(Kc&4194240)&&(Kc=64),t}function kh(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function Pc(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-$r(e),t[e]=r}function j2(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var a=31-$r(r),i=1<<a;e[a]=0,n[a]=-1,t[a]=-1,r&=~i}}function hm(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-$r(r),a=1<<n;a&e|t[n]&e&&(t[n]|=e),r&=~a}}var Te=0;function sw(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var aw,fm,iw,ow,lw,Of=!1,Yc=[],Us=null,zs=null,Hs=null,zl=new Map,Hl=new Map,xs=[],A2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Kg(t,e){switch(t){case"focusin":case"focusout":Us=null;break;case"dragenter":case"dragleave":zs=null;break;case"mouseover":case"mouseout":Hs=null;break;case"pointerover":case"pointerout":zl.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Hl.delete(e.pointerId)}}function nl(t,e,r,n,a,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[a]},e!==null&&(e=Tc(e),e!==null&&fm(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,a!==null&&e.indexOf(a)===-1&&e.push(a),t)}function E2(t,e,r,n,a){switch(e){case"focusin":return Us=nl(Us,t,e,r,n,a),!0;case"dragenter":return zs=nl(zs,t,e,r,n,a),!0;case"mouseover":return Hs=nl(Hs,t,e,r,n,a),!0;case"pointerover":var i=a.pointerId;return zl.set(i,nl(zl.get(i)||null,t,e,r,n,a)),!0;case"gotpointercapture":return i=a.pointerId,Hl.set(i,nl(Hl.get(i)||null,t,e,r,n,a)),!0}return!1}function cw(t){var e=ga(t.target);if(e!==null){var r=ri(e);if(r!==null){if(e=r.tag,e===13){if(e=qy(r),e!==null){t.blockedOn=e,lw(t.priority,function(){iw(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function bd(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=Mf(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);If=n,r.target.dispatchEvent(n),If=null}else return e=Tc(r),e!==null&&fm(e),t.blockedOn=r,!1;e.shift()}return!0}function Jg(t,e,r){bd(t)&&r.delete(e)}function S2(){Of=!1,Us!==null&&bd(Us)&&(Us=null),zs!==null&&bd(zs)&&(zs=null),Hs!==null&&bd(Hs)&&(Hs=null),zl.forEach(Jg),Hl.forEach(Jg)}function sl(t,e){t.blockedOn===e&&(t.blockedOn=null,Of||(Of=!0,cr.unstable_scheduleCallback(cr.unstable_NormalPriority,S2)))}function Vl(t){function e(a){return sl(a,t)}if(0<Yc.length){sl(Yc[0],t);for(var r=1;r<Yc.length;r++){var n=Yc[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Us!==null&&sl(Us,t),zs!==null&&sl(zs,t),Hs!==null&&sl(Hs,t),zl.forEach(e),Hl.forEach(e),r=0;r<xs.length;r++)n=xs[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<xs.length&&(r=xs[0],r.blockedOn===null);)cw(r),r.blockedOn===null&&xs.shift()}var Ii=rs.ReactCurrentBatchConfig,Qd=!0;function C2(t,e,r,n){var a=Te,i=Ii.transition;Ii.transition=null;try{Te=1,mm(t,e,r,n)}finally{Te=a,Ii.transition=i}}function D2(t,e,r,n){var a=Te,i=Ii.transition;Ii.transition=null;try{Te=4,mm(t,e,r,n)}finally{Te=a,Ii.transition=i}}function mm(t,e,r,n){if(Qd){var a=Mf(t,e,r,n);if(a===null)_h(t,e,n,Wd,r),Kg(t,n);else if(E2(a,t,e,r,n))n.stopPropagation();else if(Kg(t,n),e&4&&-1<A2.indexOf(t)){for(;a!==null;){var i=Tc(a);if(i!==null&&aw(i),i=Mf(t,e,r,n),i===null&&_h(t,e,n,Wd,r),i===a)break;a=i}a!==null&&n.stopPropagation()}else _h(t,e,n,null,r)}}var Wd=null;function Mf(t,e,r,n){if(Wd=null,t=dm(n),t=ga(t),t!==null)if(e=ri(t),e===null)t=null;else if(r=e.tag,r===13){if(t=qy(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Wd=t,null}function dw(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(p2()){case um:return 1;case tw:return 4;case Gd:case x2:return 16;case rw:return 536870912;default:return 16}default:return 16}}var Ms=null,gm=null,vd=null;function uw(){if(vd)return vd;var t,e=gm,r=e.length,n,a="value"in Ms?Ms.value:Ms.textContent,i=a.length;for(t=0;t<r&&e[t]===a[t];t++);var o=r-t;for(n=1;n<=o&&e[r-n]===a[i-n];n++);return vd=a.slice(t,1<n?1-n:void 0)}function Nd(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function qc(){return!0}function Yg(){return!1}function ur(t){function e(r,n,a,i,o){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(r=t[l],this[l]=r?r(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?qc:Yg,this.isPropagationStopped=Yg,this}return Ke(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=qc)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=qc)},persist:function(){},isPersistent:qc}),e}var Ko={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},pm=ur(Ko),Ic=Ke({},Ko,{view:0,detail:0}),P2=ur(Ic),jh,Ah,al,Mu=Ke({},Ic,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xm,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==al&&(al&&t.type==="mousemove"?(jh=t.screenX-al.screenX,Ah=t.screenY-al.screenY):Ah=jh=0,al=t),jh)},movementY:function(t){return"movementY"in t?t.movementY:Ah}}),qg=ur(Mu),I2=Ke({},Mu,{dataTransfer:0}),T2=ur(I2),_2=Ke({},Ic,{relatedTarget:0}),Eh=ur(_2),B2=Ke({},Ko,{animationName:0,elapsedTime:0,pseudoElement:0}),R2=ur(B2),O2=Ke({},Ko,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),M2=ur(O2),L2=Ke({},Ko,{data:0}),Zg=ur(L2),F2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},U2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},z2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function H2(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=z2[t])?!!e[t]:!1}function xm(){return H2}var V2=Ke({},Ic,{key:function(t){if(t.key){var e=F2[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Nd(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?U2[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xm,charCode:function(t){return t.type==="keypress"?Nd(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Nd(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),G2=ur(V2),$2=Ke({},Mu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Xg=ur($2),Q2=Ke({},Ic,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xm}),W2=ur(Q2),K2=Ke({},Ko,{propertyName:0,elapsedTime:0,pseudoElement:0}),J2=ur(K2),Y2=Ke({},Mu,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),q2=ur(Y2),Z2=[9,13,27,32],ym=Kn&&"CompositionEvent"in window,kl=null;Kn&&"documentMode"in document&&(kl=document.documentMode);var X2=Kn&&"TextEvent"in window&&!kl,hw=Kn&&(!ym||kl&&8<kl&&11>=kl),ep=" ",tp=!1;function fw(t,e){switch(t){case"keyup":return Z2.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function mw(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var fi=!1;function ek(t,e){switch(t){case"compositionend":return mw(e);case"keypress":return e.which!==32?null:(tp=!0,ep);case"textInput":return t=e.data,t===ep&&tp?null:t;default:return null}}function tk(t,e){if(fi)return t==="compositionend"||!ym&&fw(t,e)?(t=uw(),vd=gm=Ms=null,fi=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return hw&&e.locale!=="ko"?null:e.data;default:return null}}var rk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function rp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!rk[t.type]:e==="textarea"}function gw(t,e,r,n){Qy(n),e=Kd(e,"onChange"),0<e.length&&(r=new pm("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var jl=null,Gl=null;function nk(t){Ew(t,0)}function Lu(t){var e=pi(t);if(Fy(e))return t}function sk(t,e){if(t==="change")return e}var pw=!1;if(Kn){var Sh;if(Kn){var Ch="oninput"in document;if(!Ch){var np=document.createElement("div");np.setAttribute("oninput","return;"),Ch=typeof np.oninput=="function"}Sh=Ch}else Sh=!1;pw=Sh&&(!document.documentMode||9<document.documentMode)}function sp(){jl&&(jl.detachEvent("onpropertychange",xw),Gl=jl=null)}function xw(t){if(t.propertyName==="value"&&Lu(Gl)){var e=[];gw(e,Gl,t,dm(t)),Yy(nk,e)}}function ak(t,e,r){t==="focusin"?(sp(),jl=e,Gl=r,jl.attachEvent("onpropertychange",xw)):t==="focusout"&&sp()}function ik(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Lu(Gl)}function ok(t,e){if(t==="click")return Lu(e)}function lk(t,e){if(t==="input"||t==="change")return Lu(e)}function ck(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Kr=typeof Object.is=="function"?Object.is:ck;function $l(t,e){if(Kr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!wf.call(e,a)||!Kr(t[a],e[a]))return!1}return!0}function ap(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function ip(t,e){var r=ap(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=ap(r)}}function yw(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?yw(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function ww(){for(var t=window,e=zd();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=zd(t.document)}return e}function wm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function dk(t){var e=ww(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&yw(r.ownerDocument.documentElement,r)){if(n!==null&&wm(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var a=r.textContent.length,i=Math.min(n.start,a);n=n.end===void 0?i:Math.min(n.end,a),!t.extend&&i>n&&(a=n,n=i,i=a),a=ip(r,i);var o=ip(r,n);a&&o&&(t.rangeCount!==1||t.anchorNode!==a.node||t.anchorOffset!==a.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(a.node,a.offset),t.removeAllRanges(),i>n?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var uk=Kn&&"documentMode"in document&&11>=document.documentMode,mi=null,Lf=null,Al=null,Ff=!1;function op(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Ff||mi==null||mi!==zd(n)||(n=mi,"selectionStart"in n&&wm(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Al&&$l(Al,n)||(Al=n,n=Kd(Lf,"onSelect"),0<n.length&&(e=new pm("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=mi)))}function Zc(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var gi={animationend:Zc("Animation","AnimationEnd"),animationiteration:Zc("Animation","AnimationIteration"),animationstart:Zc("Animation","AnimationStart"),transitionend:Zc("Transition","TransitionEnd")},Dh={},bw={};Kn&&(bw=document.createElement("div").style,"AnimationEvent"in window||(delete gi.animationend.animation,delete gi.animationiteration.animation,delete gi.animationstart.animation),"TransitionEvent"in window||delete gi.transitionend.transition);function Fu(t){if(Dh[t])return Dh[t];if(!gi[t])return t;var e=gi[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in bw)return Dh[t]=e[r];return t}var vw=Fu("animationend"),Nw=Fu("animationiteration"),kw=Fu("animationstart"),jw=Fu("transitionend"),Aw=new Map,lp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ea(t,e){Aw.set(t,e),ti(e,[t])}for(var Ph=0;Ph<lp.length;Ph++){var Ih=lp[Ph],hk=Ih.toLowerCase(),fk=Ih[0].toUpperCase()+Ih.slice(1);ea(hk,"on"+fk)}ea(vw,"onAnimationEnd");ea(Nw,"onAnimationIteration");ea(kw,"onAnimationStart");ea("dblclick","onDoubleClick");ea("focusin","onFocus");ea("focusout","onBlur");ea(jw,"onTransitionEnd");Ao("onMouseEnter",["mouseout","mouseover"]);Ao("onMouseLeave",["mouseout","mouseover"]);Ao("onPointerEnter",["pointerout","pointerover"]);Ao("onPointerLeave",["pointerout","pointerover"]);ti("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ti("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ti("onBeforeInput",["compositionend","keypress","textInput","paste"]);ti("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ti("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ti("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ml="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mk=new Set("cancel close invalid load scroll toggle".split(" ").concat(ml));function cp(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,h2(n,e,void 0,t),t.currentTarget=null}function Ew(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],a=n.event;n=n.listeners;e:{var i=void 0;if(e)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==i&&a.isPropagationStopped())break e;cp(a,l,d),i=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,d=l.currentTarget,l=l.listener,c!==i&&a.isPropagationStopped())break e;cp(a,l,d),i=c}}}if(Vd)throw t=Bf,Vd=!1,Bf=null,t}function Fe(t,e){var r=e[Gf];r===void 0&&(r=e[Gf]=new Set);var n=t+"__bubble";r.has(n)||(Sw(e,t,2,!1),r.add(n))}function Th(t,e,r){var n=0;e&&(n|=4),Sw(r,t,n,e)}var Xc="_reactListening"+Math.random().toString(36).slice(2);function Ql(t){if(!t[Xc]){t[Xc]=!0,By.forEach(function(r){r!=="selectionchange"&&(mk.has(r)||Th(r,!1,t),Th(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Xc]||(e[Xc]=!0,Th("selectionchange",!1,e))}}function Sw(t,e,r,n){switch(dw(e)){case 1:var a=C2;break;case 4:a=D2;break;default:a=mm}r=a.bind(null,e,r,t),a=void 0,!_f||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(a=!0),n?a!==void 0?t.addEventListener(e,r,{capture:!0,passive:a}):t.addEventListener(e,r,!0):a!==void 0?t.addEventListener(e,r,{passive:a}):t.addEventListener(e,r,!1)}function _h(t,e,r,n,a){var i=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===a||l.nodeType===8&&l.parentNode===a)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===a||c.nodeType===8&&c.parentNode===a))return;o=o.return}for(;l!==null;){if(o=ga(l),o===null)return;if(c=o.tag,c===5||c===6){n=i=o;continue e}l=l.parentNode}}n=n.return}Yy(function(){var d=i,h=dm(r),u=[];e:{var f=Aw.get(t);if(f!==void 0){var g=pm,b=t;switch(t){case"keypress":if(Nd(r)===0)break e;case"keydown":case"keyup":g=G2;break;case"focusin":b="focus",g=Eh;break;case"focusout":b="blur",g=Eh;break;case"beforeblur":case"afterblur":g=Eh;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=qg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=T2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=W2;break;case vw:case Nw:case kw:g=R2;break;case jw:g=J2;break;case"scroll":g=P2;break;case"wheel":g=q2;break;case"copy":case"cut":case"paste":g=M2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=Xg}var y=(e&4)!==0,k=!y&&t==="scroll",m=y?f!==null?f+"Capture":null:f;y=[];for(var x=d,p;x!==null;){p=x;var v=p.stateNode;if(p.tag===5&&v!==null&&(p=v,m!==null&&(v=Ul(x,m),v!=null&&y.push(Wl(x,v,p)))),k)break;x=x.return}0<y.length&&(f=new g(f,b,null,r,h),u.push({event:f,listeners:y}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",g=t==="mouseout"||t==="pointerout",f&&r!==If&&(b=r.relatedTarget||r.fromElement)&&(ga(b)||b[Jn]))break e;if((g||f)&&(f=h.window===h?h:(f=h.ownerDocument)?f.defaultView||f.parentWindow:window,g?(b=r.relatedTarget||r.toElement,g=d,b=b?ga(b):null,b!==null&&(k=ri(b),b!==k||b.tag!==5&&b.tag!==6)&&(b=null)):(g=null,b=d),g!==b)){if(y=qg,v="onMouseLeave",m="onMouseEnter",x="mouse",(t==="pointerout"||t==="pointerover")&&(y=Xg,v="onPointerLeave",m="onPointerEnter",x="pointer"),k=g==null?f:pi(g),p=b==null?f:pi(b),f=new y(v,x+"leave",g,r,h),f.target=k,f.relatedTarget=p,v=null,ga(h)===d&&(y=new y(m,x+"enter",b,r,h),y.target=p,y.relatedTarget=k,v=y),k=v,g&&b)t:{for(y=g,m=b,x=0,p=y;p;p=ai(p))x++;for(p=0,v=m;v;v=ai(v))p++;for(;0<x-p;)y=ai(y),x--;for(;0<p-x;)m=ai(m),p--;for(;x--;){if(y===m||m!==null&&y===m.alternate)break t;y=ai(y),m=ai(m)}y=null}else y=null;g!==null&&dp(u,f,g,y,!1),b!==null&&k!==null&&dp(u,k,b,y,!0)}}e:{if(f=d?pi(d):window,g=f.nodeName&&f.nodeName.toLowerCase(),g==="select"||g==="input"&&f.type==="file")var N=sk;else if(rp(f))if(pw)N=lk;else{N=ik;var A=ak}else(g=f.nodeName)&&g.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(N=ok);if(N&&(N=N(t,d))){gw(u,N,r,h);break e}A&&A(t,f,d),t==="focusout"&&(A=f._wrapperState)&&A.controlled&&f.type==="number"&&Ef(f,"number",f.value)}switch(A=d?pi(d):window,t){case"focusin":(rp(A)||A.contentEditable==="true")&&(mi=A,Lf=d,Al=null);break;case"focusout":Al=Lf=mi=null;break;case"mousedown":Ff=!0;break;case"contextmenu":case"mouseup":case"dragend":Ff=!1,op(u,r,h);break;case"selectionchange":if(uk)break;case"keydown":case"keyup":op(u,r,h)}var D;if(ym)e:{switch(t){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else fi?fw(t,r)&&(E="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(E="onCompositionStart");E&&(hw&&r.locale!=="ko"&&(fi||E!=="onCompositionStart"?E==="onCompositionEnd"&&fi&&(D=uw()):(Ms=h,gm="value"in Ms?Ms.value:Ms.textContent,fi=!0)),A=Kd(d,E),0<A.length&&(E=new Zg(E,t,null,r,h),u.push({event:E,listeners:A}),D?E.data=D:(D=mw(r),D!==null&&(E.data=D)))),(D=X2?ek(t,r):tk(t,r))&&(d=Kd(d,"onBeforeInput"),0<d.length&&(h=new Zg("onBeforeInput","beforeinput",null,r,h),u.push({event:h,listeners:d}),h.data=D))}Ew(u,e)})}function Wl(t,e,r){return{instance:t,listener:e,currentTarget:r}}function Kd(t,e){for(var r=e+"Capture",n=[];t!==null;){var a=t,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=Ul(t,r),i!=null&&n.unshift(Wl(t,i,a)),i=Ul(t,e),i!=null&&n.push(Wl(t,i,a))),t=t.return}return n}function ai(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function dp(t,e,r,n,a){for(var i=e._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,d=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&d!==null&&(l=d,a?(c=Ul(r,i),c!=null&&o.unshift(Wl(r,c,l))):a||(c=Ul(r,i),c!=null&&o.push(Wl(r,c,l)))),r=r.return}o.length!==0&&t.push({event:e,listeners:o})}var gk=/\r\n?/g,pk=/\u0000|\uFFFD/g;function up(t){return(typeof t=="string"?t:""+t).replace(gk,`
`).replace(pk,"")}function ed(t,e,r){if(e=up(e),up(t)!==e&&r)throw Error(Z(425))}function Jd(){}var Uf=null,zf=null;function Hf(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Vf=typeof setTimeout=="function"?setTimeout:void 0,xk=typeof clearTimeout=="function"?clearTimeout:void 0,hp=typeof Promise=="function"?Promise:void 0,yk=typeof queueMicrotask=="function"?queueMicrotask:typeof hp<"u"?function(t){return hp.resolve(null).then(t).catch(wk)}:Vf;function wk(t){setTimeout(function(){throw t})}function Bh(t,e){var r=e,n=0;do{var a=r.nextSibling;if(t.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){t.removeChild(a),Vl(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);Vl(e)}function Vs(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function fp(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var Jo=Math.random().toString(36).slice(2),mn="__reactFiber$"+Jo,Kl="__reactProps$"+Jo,Jn="__reactContainer$"+Jo,Gf="__reactEvents$"+Jo,bk="__reactListeners$"+Jo,vk="__reactHandles$"+Jo;function ga(t){var e=t[mn];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Jn]||r[mn]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=fp(t);t!==null;){if(r=t[mn])return r;t=fp(t)}return e}t=r,r=t.parentNode}return null}function Tc(t){return t=t[mn]||t[Jn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function pi(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Z(33))}function Uu(t){return t[Kl]||null}var $f=[],xi=-1;function ta(t){return{current:t}}function Ue(t){0>xi||(t.current=$f[xi],$f[xi]=null,xi--)}function Oe(t,e){xi++,$f[xi]=t.current,t.current=e}var qs={},Et=ta(qs),Kt=ta(!1),$a=qs;function Eo(t,e){var r=t.type.contextTypes;if(!r)return qs;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in r)a[i]=e[i];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=a),a}function Jt(t){return t=t.childContextTypes,t!=null}function Yd(){Ue(Kt),Ue(Et)}function mp(t,e,r){if(Et.current!==qs)throw Error(Z(168));Oe(Et,e),Oe(Kt,r)}function Cw(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in e))throw Error(Z(108,a2(t)||"Unknown",a));return Ke({},r,n)}function qd(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||qs,$a=Et.current,Oe(Et,t),Oe(Kt,Kt.current),!0}function gp(t,e,r){var n=t.stateNode;if(!n)throw Error(Z(169));r?(t=Cw(t,e,$a),n.__reactInternalMemoizedMergedChildContext=t,Ue(Kt),Ue(Et),Oe(Et,t)):Ue(Kt),Oe(Kt,r)}var En=null,zu=!1,Rh=!1;function Dw(t){En===null?En=[t]:En.push(t)}function Nk(t){zu=!0,Dw(t)}function ra(){if(!Rh&&En!==null){Rh=!0;var t=0,e=Te;try{var r=En;for(Te=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}En=null,zu=!1}catch(a){throw En!==null&&(En=En.slice(t+1)),ew(um,ra),a}finally{Te=e,Rh=!1}}return null}var yi=[],wi=0,Zd=null,Xd=0,kr=[],jr=0,Qa=null,Un=1,zn="";function la(t,e){yi[wi++]=Xd,yi[wi++]=Zd,Zd=t,Xd=e}function Pw(t,e,r){kr[jr++]=Un,kr[jr++]=zn,kr[jr++]=Qa,Qa=t;var n=Un;t=zn;var a=32-$r(n)-1;n&=~(1<<a),r+=1;var i=32-$r(e)+a;if(30<i){var o=a-a%5;i=(n&(1<<o)-1).toString(32),n>>=o,a-=o,Un=1<<32-$r(e)+a|r<<a|n,zn=i+t}else Un=1<<i|r<<a|n,zn=t}function bm(t){t.return!==null&&(la(t,1),Pw(t,1,0))}function vm(t){for(;t===Zd;)Zd=yi[--wi],yi[wi]=null,Xd=yi[--wi],yi[wi]=null;for(;t===Qa;)Qa=kr[--jr],kr[jr]=null,zn=kr[--jr],kr[jr]=null,Un=kr[--jr],kr[jr]=null}var lr=null,or=null,ze=!1,Ur=null;function Iw(t,e){var r=Ar(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function pp(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,lr=t,or=Vs(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,lr=t,or=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Qa!==null?{id:Un,overflow:zn}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Ar(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,lr=t,or=null,!0):!1;default:return!1}}function Qf(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Wf(t){if(ze){var e=or;if(e){var r=e;if(!pp(t,e)){if(Qf(t))throw Error(Z(418));e=Vs(r.nextSibling);var n=lr;e&&pp(t,e)?Iw(n,r):(t.flags=t.flags&-4097|2,ze=!1,lr=t)}}else{if(Qf(t))throw Error(Z(418));t.flags=t.flags&-4097|2,ze=!1,lr=t}}}function xp(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;lr=t}function td(t){if(t!==lr)return!1;if(!ze)return xp(t),ze=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Hf(t.type,t.memoizedProps)),e&&(e=or)){if(Qf(t))throw Tw(),Error(Z(418));for(;e;)Iw(t,e),e=Vs(e.nextSibling)}if(xp(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Z(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){or=Vs(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}or=null}}else or=lr?Vs(t.stateNode.nextSibling):null;return!0}function Tw(){for(var t=or;t;)t=Vs(t.nextSibling)}function So(){or=lr=null,ze=!1}function Nm(t){Ur===null?Ur=[t]:Ur.push(t)}var kk=rs.ReactCurrentBatchConfig;function il(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Z(309));var n=r.stateNode}if(!n)throw Error(Z(147,t));var a=n,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=a.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(Z(284));if(!r._owner)throw Error(Z(290,t))}return t}function rd(t,e){throw t=Object.prototype.toString.call(e),Error(Z(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function yp(t){var e=t._init;return e(t._payload)}function _w(t){function e(m,x){if(t){var p=m.deletions;p===null?(m.deletions=[x],m.flags|=16):p.push(x)}}function r(m,x){if(!t)return null;for(;x!==null;)e(m,x),x=x.sibling;return null}function n(m,x){for(m=new Map;x!==null;)x.key!==null?m.set(x.key,x):m.set(x.index,x),x=x.sibling;return m}function a(m,x){return m=Ws(m,x),m.index=0,m.sibling=null,m}function i(m,x,p){return m.index=p,t?(p=m.alternate,p!==null?(p=p.index,p<x?(m.flags|=2,x):p):(m.flags|=2,x)):(m.flags|=1048576,x)}function o(m){return t&&m.alternate===null&&(m.flags|=2),m}function l(m,x,p,v){return x===null||x.tag!==6?(x=Hh(p,m.mode,v),x.return=m,x):(x=a(x,p),x.return=m,x)}function c(m,x,p,v){var N=p.type;return N===hi?h(m,x,p.props.children,v,p.key):x!==null&&(x.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===gs&&yp(N)===x.type)?(v=a(x,p.props),v.ref=il(m,x,p),v.return=m,v):(v=Dd(p.type,p.key,p.props,null,m.mode,v),v.ref=il(m,x,p),v.return=m,v)}function d(m,x,p,v){return x===null||x.tag!==4||x.stateNode.containerInfo!==p.containerInfo||x.stateNode.implementation!==p.implementation?(x=Vh(p,m.mode,v),x.return=m,x):(x=a(x,p.children||[]),x.return=m,x)}function h(m,x,p,v,N){return x===null||x.tag!==7?(x=za(p,m.mode,v,N),x.return=m,x):(x=a(x,p),x.return=m,x)}function u(m,x,p){if(typeof x=="string"&&x!==""||typeof x=="number")return x=Hh(""+x,m.mode,p),x.return=m,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case $c:return p=Dd(x.type,x.key,x.props,null,m.mode,p),p.ref=il(m,null,x),p.return=m,p;case ui:return x=Vh(x,m.mode,p),x.return=m,x;case gs:var v=x._init;return u(m,v(x._payload),p)}if(hl(x)||tl(x))return x=za(x,m.mode,p,null),x.return=m,x;rd(m,x)}return null}function f(m,x,p,v){var N=x!==null?x.key:null;if(typeof p=="string"&&p!==""||typeof p=="number")return N!==null?null:l(m,x,""+p,v);if(typeof p=="object"&&p!==null){switch(p.$$typeof){case $c:return p.key===N?c(m,x,p,v):null;case ui:return p.key===N?d(m,x,p,v):null;case gs:return N=p._init,f(m,x,N(p._payload),v)}if(hl(p)||tl(p))return N!==null?null:h(m,x,p,v,null);rd(m,p)}return null}function g(m,x,p,v,N){if(typeof v=="string"&&v!==""||typeof v=="number")return m=m.get(p)||null,l(x,m,""+v,N);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case $c:return m=m.get(v.key===null?p:v.key)||null,c(x,m,v,N);case ui:return m=m.get(v.key===null?p:v.key)||null,d(x,m,v,N);case gs:var A=v._init;return g(m,x,p,A(v._payload),N)}if(hl(v)||tl(v))return m=m.get(p)||null,h(x,m,v,N,null);rd(x,v)}return null}function b(m,x,p,v){for(var N=null,A=null,D=x,E=x=0,L=null;D!==null&&E<p.length;E++){D.index>E?(L=D,D=null):L=D.sibling;var C=f(m,D,p[E],v);if(C===null){D===null&&(D=L);break}t&&D&&C.alternate===null&&e(m,D),x=i(C,x,E),A===null?N=C:A.sibling=C,A=C,D=L}if(E===p.length)return r(m,D),ze&&la(m,E),N;if(D===null){for(;E<p.length;E++)D=u(m,p[E],v),D!==null&&(x=i(D,x,E),A===null?N=D:A.sibling=D,A=D);return ze&&la(m,E),N}for(D=n(m,D);E<p.length;E++)L=g(D,m,E,p[E],v),L!==null&&(t&&L.alternate!==null&&D.delete(L.key===null?E:L.key),x=i(L,x,E),A===null?N=L:A.sibling=L,A=L);return t&&D.forEach(function(O){return e(m,O)}),ze&&la(m,E),N}function y(m,x,p,v){var N=tl(p);if(typeof N!="function")throw Error(Z(150));if(p=N.call(p),p==null)throw Error(Z(151));for(var A=N=null,D=x,E=x=0,L=null,C=p.next();D!==null&&!C.done;E++,C=p.next()){D.index>E?(L=D,D=null):L=D.sibling;var O=f(m,D,C.value,v);if(O===null){D===null&&(D=L);break}t&&D&&O.alternate===null&&e(m,D),x=i(O,x,E),A===null?N=O:A.sibling=O,A=O,D=L}if(C.done)return r(m,D),ze&&la(m,E),N;if(D===null){for(;!C.done;E++,C=p.next())C=u(m,C.value,v),C!==null&&(x=i(C,x,E),A===null?N=C:A.sibling=C,A=C);return ze&&la(m,E),N}for(D=n(m,D);!C.done;E++,C=p.next())C=g(D,m,E,C.value,v),C!==null&&(t&&C.alternate!==null&&D.delete(C.key===null?E:C.key),x=i(C,x,E),A===null?N=C:A.sibling=C,A=C);return t&&D.forEach(function(V){return e(m,V)}),ze&&la(m,E),N}function k(m,x,p,v){if(typeof p=="object"&&p!==null&&p.type===hi&&p.key===null&&(p=p.props.children),typeof p=="object"&&p!==null){switch(p.$$typeof){case $c:e:{for(var N=p.key,A=x;A!==null;){if(A.key===N){if(N=p.type,N===hi){if(A.tag===7){r(m,A.sibling),x=a(A,p.props.children),x.return=m,m=x;break e}}else if(A.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===gs&&yp(N)===A.type){r(m,A.sibling),x=a(A,p.props),x.ref=il(m,A,p),x.return=m,m=x;break e}r(m,A);break}else e(m,A);A=A.sibling}p.type===hi?(x=za(p.props.children,m.mode,v,p.key),x.return=m,m=x):(v=Dd(p.type,p.key,p.props,null,m.mode,v),v.ref=il(m,x,p),v.return=m,m=v)}return o(m);case ui:e:{for(A=p.key;x!==null;){if(x.key===A)if(x.tag===4&&x.stateNode.containerInfo===p.containerInfo&&x.stateNode.implementation===p.implementation){r(m,x.sibling),x=a(x,p.children||[]),x.return=m,m=x;break e}else{r(m,x);break}else e(m,x);x=x.sibling}x=Vh(p,m.mode,v),x.return=m,m=x}return o(m);case gs:return A=p._init,k(m,x,A(p._payload),v)}if(hl(p))return b(m,x,p,v);if(tl(p))return y(m,x,p,v);rd(m,p)}return typeof p=="string"&&p!==""||typeof p=="number"?(p=""+p,x!==null&&x.tag===6?(r(m,x.sibling),x=a(x,p),x.return=m,m=x):(r(m,x),x=Hh(p,m.mode,v),x.return=m,m=x),o(m)):r(m,x)}return k}var Co=_w(!0),Bw=_w(!1),eu=ta(null),tu=null,bi=null,km=null;function jm(){km=bi=tu=null}function Am(t){var e=eu.current;Ue(eu),t._currentValue=e}function Kf(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function Ti(t,e){tu=t,km=bi=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Qt=!0),t.firstContext=null)}function Cr(t){var e=t._currentValue;if(km!==t)if(t={context:t,memoizedValue:e,next:null},bi===null){if(tu===null)throw Error(Z(308));bi=t,tu.dependencies={lanes:0,firstContext:t}}else bi=bi.next=t;return e}var pa=null;function Em(t){pa===null?pa=[t]:pa.push(t)}function Rw(t,e,r,n){var a=e.interleaved;return a===null?(r.next=r,Em(e)):(r.next=a.next,a.next=r),e.interleaved=r,Yn(t,n)}function Yn(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var ps=!1;function Sm(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ow(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Gn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Gs(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,Ae&2){var a=n.pending;return a===null?e.next=e:(e.next=a.next,a.next=e),n.pending=e,Yn(t,r)}return a=n.interleaved,a===null?(e.next=e,Em(n)):(e.next=a.next,a.next=e),n.interleaved=e,Yn(t,r)}function kd(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,hm(t,r)}}function wp(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?a=i=o:i=i.next=o,r=r.next}while(r!==null);i===null?a=i=e:i=i.next=e}else a=i=e;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function ru(t,e,r,n){var a=t.updateQueue;ps=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,l=a.shared.pending;if(l!==null){a.shared.pending=null;var c=l,d=c.next;c.next=null,o===null?i=d:o.next=d,o=c;var h=t.alternate;h!==null&&(h=h.updateQueue,l=h.lastBaseUpdate,l!==o&&(l===null?h.firstBaseUpdate=d:l.next=d,h.lastBaseUpdate=c))}if(i!==null){var u=a.baseState;o=0,h=d=c=null,l=i;do{var f=l.lane,g=l.eventTime;if((n&f)===f){h!==null&&(h=h.next={eventTime:g,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var b=t,y=l;switch(f=e,g=r,y.tag){case 1:if(b=y.payload,typeof b=="function"){u=b.call(g,u,f);break e}u=b;break e;case 3:b.flags=b.flags&-65537|128;case 0:if(b=y.payload,f=typeof b=="function"?b.call(g,u,f):b,f==null)break e;u=Ke({},u,f);break e;case 2:ps=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,f=a.effects,f===null?a.effects=[l]:f.push(l))}else g={eventTime:g,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},h===null?(d=h=g,c=u):h=h.next=g,o|=f;if(l=l.next,l===null){if(l=a.shared.pending,l===null)break;f=l,l=f.next,f.next=null,a.lastBaseUpdate=f,a.shared.pending=null}}while(!0);if(h===null&&(c=u),a.baseState=c,a.firstBaseUpdate=d,a.lastBaseUpdate=h,e=a.shared.interleaved,e!==null){a=e;do o|=a.lane,a=a.next;while(a!==e)}else i===null&&(a.shared.lanes=0);Ka|=o,t.lanes=o,t.memoizedState=u}}function bp(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(Z(191,a));a.call(n)}}}var _c={},wn=ta(_c),Jl=ta(_c),Yl=ta(_c);function xa(t){if(t===_c)throw Error(Z(174));return t}function Cm(t,e){switch(Oe(Yl,e),Oe(Jl,t),Oe(wn,_c),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Cf(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Cf(e,t)}Ue(wn),Oe(wn,e)}function Do(){Ue(wn),Ue(Jl),Ue(Yl)}function Mw(t){xa(Yl.current);var e=xa(wn.current),r=Cf(e,t.type);e!==r&&(Oe(Jl,t),Oe(wn,r))}function Dm(t){Jl.current===t&&(Ue(wn),Ue(Jl))}var $e=ta(0);function nu(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Oh=[];function Pm(){for(var t=0;t<Oh.length;t++)Oh[t]._workInProgressVersionPrimary=null;Oh.length=0}var jd=rs.ReactCurrentDispatcher,Mh=rs.ReactCurrentBatchConfig,Wa=0,We=null,nt=null,it=null,su=!1,El=!1,ql=0,jk=0;function wt(){throw Error(Z(321))}function Im(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Kr(t[r],e[r]))return!1;return!0}function Tm(t,e,r,n,a,i){if(Wa=i,We=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,jd.current=t===null||t.memoizedState===null?Ck:Dk,t=r(n,a),El){i=0;do{if(El=!1,ql=0,25<=i)throw Error(Z(301));i+=1,it=nt=null,e.updateQueue=null,jd.current=Pk,t=r(n,a)}while(El)}if(jd.current=au,e=nt!==null&&nt.next!==null,Wa=0,it=nt=We=null,su=!1,e)throw Error(Z(300));return t}function _m(){var t=ql!==0;return ql=0,t}function rn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return it===null?We.memoizedState=it=t:it=it.next=t,it}function Dr(){if(nt===null){var t=We.alternate;t=t!==null?t.memoizedState:null}else t=nt.next;var e=it===null?We.memoizedState:it.next;if(e!==null)it=e,nt=t;else{if(t===null)throw Error(Z(310));nt=t,t={memoizedState:nt.memoizedState,baseState:nt.baseState,baseQueue:nt.baseQueue,queue:nt.queue,next:null},it===null?We.memoizedState=it=t:it=it.next=t}return it}function Zl(t,e){return typeof e=="function"?e(t):e}function Lh(t){var e=Dr(),r=e.queue;if(r===null)throw Error(Z(311));r.lastRenderedReducer=t;var n=nt,a=n.baseQueue,i=r.pending;if(i!==null){if(a!==null){var o=a.next;a.next=i.next,i.next=o}n.baseQueue=a=i,r.pending=null}if(a!==null){i=a.next,n=n.baseState;var l=o=null,c=null,d=i;do{var h=d.lane;if((Wa&h)===h)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:t(n,d.action);else{var u={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=u,o=n):c=c.next=u,We.lanes|=h,Ka|=h}d=d.next}while(d!==null&&d!==i);c===null?o=n:c.next=l,Kr(n,e.memoizedState)||(Qt=!0),e.memoizedState=n,e.baseState=o,e.baseQueue=c,r.lastRenderedState=n}if(t=r.interleaved,t!==null){a=t;do i=a.lane,We.lanes|=i,Ka|=i,a=a.next;while(a!==t)}else a===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function Fh(t){var e=Dr(),r=e.queue;if(r===null)throw Error(Z(311));r.lastRenderedReducer=t;var n=r.dispatch,a=r.pending,i=e.memoizedState;if(a!==null){r.pending=null;var o=a=a.next;do i=t(i,o.action),o=o.next;while(o!==a);Kr(i,e.memoizedState)||(Qt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),r.lastRenderedState=i}return[i,n]}function Lw(){}function Fw(t,e){var r=We,n=Dr(),a=e(),i=!Kr(n.memoizedState,a);if(i&&(n.memoizedState=a,Qt=!0),n=n.queue,Bm(Hw.bind(null,r,n,t),[t]),n.getSnapshot!==e||i||it!==null&&it.memoizedState.tag&1){if(r.flags|=2048,Xl(9,zw.bind(null,r,n,a,e),void 0,null),dt===null)throw Error(Z(349));Wa&30||Uw(r,e,a)}return a}function Uw(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=We.updateQueue,e===null?(e={lastEffect:null,stores:null},We.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function zw(t,e,r,n){e.value=r,e.getSnapshot=n,Vw(e)&&Gw(t)}function Hw(t,e,r){return r(function(){Vw(e)&&Gw(t)})}function Vw(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Kr(t,r)}catch{return!0}}function Gw(t){var e=Yn(t,1);e!==null&&Qr(e,t,1,-1)}function vp(t){var e=rn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Zl,lastRenderedState:t},e.queue=t,t=t.dispatch=Sk.bind(null,We,t),[e.memoizedState,t]}function Xl(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=We.updateQueue,e===null?(e={lastEffect:null,stores:null},We.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function $w(){return Dr().memoizedState}function Ad(t,e,r,n){var a=rn();We.flags|=t,a.memoizedState=Xl(1|e,r,void 0,n===void 0?null:n)}function Hu(t,e,r,n){var a=Dr();n=n===void 0?null:n;var i=void 0;if(nt!==null){var o=nt.memoizedState;if(i=o.destroy,n!==null&&Im(n,o.deps)){a.memoizedState=Xl(e,r,i,n);return}}We.flags|=t,a.memoizedState=Xl(1|e,r,i,n)}function Np(t,e){return Ad(8390656,8,t,e)}function Bm(t,e){return Hu(2048,8,t,e)}function Qw(t,e){return Hu(4,2,t,e)}function Ww(t,e){return Hu(4,4,t,e)}function Kw(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Jw(t,e,r){return r=r!=null?r.concat([t]):null,Hu(4,4,Kw.bind(null,e,t),r)}function Rm(){}function Yw(t,e){var r=Dr();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Im(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function qw(t,e){var r=Dr();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Im(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function Zw(t,e,r){return Wa&21?(Kr(r,e)||(r=nw(),We.lanes|=r,Ka|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Qt=!0),t.memoizedState=r)}function Ak(t,e){var r=Te;Te=r!==0&&4>r?r:4,t(!0);var n=Mh.transition;Mh.transition={};try{t(!1),e()}finally{Te=r,Mh.transition=n}}function Xw(){return Dr().memoizedState}function Ek(t,e,r){var n=Qs(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},eb(t))tb(e,r);else if(r=Rw(t,e,r,n),r!==null){var a=Ot();Qr(r,t,n,a),rb(r,e,n)}}function Sk(t,e,r){var n=Qs(t),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(eb(t))tb(e,a);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,r);if(a.hasEagerState=!0,a.eagerState=l,Kr(l,o)){var c=e.interleaved;c===null?(a.next=a,Em(e)):(a.next=c.next,c.next=a),e.interleaved=a;return}}catch{}finally{}r=Rw(t,e,a,n),r!==null&&(a=Ot(),Qr(r,t,n,a),rb(r,e,n))}}function eb(t){var e=t.alternate;return t===We||e!==null&&e===We}function tb(t,e){El=su=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function rb(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,hm(t,r)}}var au={readContext:Cr,useCallback:wt,useContext:wt,useEffect:wt,useImperativeHandle:wt,useInsertionEffect:wt,useLayoutEffect:wt,useMemo:wt,useReducer:wt,useRef:wt,useState:wt,useDebugValue:wt,useDeferredValue:wt,useTransition:wt,useMutableSource:wt,useSyncExternalStore:wt,useId:wt,unstable_isNewReconciler:!1},Ck={readContext:Cr,useCallback:function(t,e){return rn().memoizedState=[t,e===void 0?null:e],t},useContext:Cr,useEffect:Np,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,Ad(4194308,4,Kw.bind(null,e,t),r)},useLayoutEffect:function(t,e){return Ad(4194308,4,t,e)},useInsertionEffect:function(t,e){return Ad(4,2,t,e)},useMemo:function(t,e){var r=rn();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=rn();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=Ek.bind(null,We,t),[n.memoizedState,t]},useRef:function(t){var e=rn();return t={current:t},e.memoizedState=t},useState:vp,useDebugValue:Rm,useDeferredValue:function(t){return rn().memoizedState=t},useTransition:function(){var t=vp(!1),e=t[0];return t=Ak.bind(null,t[1]),rn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=We,a=rn();if(ze){if(r===void 0)throw Error(Z(407));r=r()}else{if(r=e(),dt===null)throw Error(Z(349));Wa&30||Uw(n,e,r)}a.memoizedState=r;var i={value:r,getSnapshot:e};return a.queue=i,Np(Hw.bind(null,n,i,t),[t]),n.flags|=2048,Xl(9,zw.bind(null,n,i,r,e),void 0,null),r},useId:function(){var t=rn(),e=dt.identifierPrefix;if(ze){var r=zn,n=Un;r=(n&~(1<<32-$r(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=ql++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=jk++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Dk={readContext:Cr,useCallback:Yw,useContext:Cr,useEffect:Bm,useImperativeHandle:Jw,useInsertionEffect:Qw,useLayoutEffect:Ww,useMemo:qw,useReducer:Lh,useRef:$w,useState:function(){return Lh(Zl)},useDebugValue:Rm,useDeferredValue:function(t){var e=Dr();return Zw(e,nt.memoizedState,t)},useTransition:function(){var t=Lh(Zl)[0],e=Dr().memoizedState;return[t,e]},useMutableSource:Lw,useSyncExternalStore:Fw,useId:Xw,unstable_isNewReconciler:!1},Pk={readContext:Cr,useCallback:Yw,useContext:Cr,useEffect:Bm,useImperativeHandle:Jw,useInsertionEffect:Qw,useLayoutEffect:Ww,useMemo:qw,useReducer:Fh,useRef:$w,useState:function(){return Fh(Zl)},useDebugValue:Rm,useDeferredValue:function(t){var e=Dr();return nt===null?e.memoizedState=t:Zw(e,nt.memoizedState,t)},useTransition:function(){var t=Fh(Zl)[0],e=Dr().memoizedState;return[t,e]},useMutableSource:Lw,useSyncExternalStore:Fw,useId:Xw,unstable_isNewReconciler:!1};function Tr(t,e){if(t&&t.defaultProps){e=Ke({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function Jf(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:Ke({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Vu={isMounted:function(t){return(t=t._reactInternals)?ri(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Ot(),a=Qs(t),i=Gn(n,a);i.payload=e,r!=null&&(i.callback=r),e=Gs(t,i,a),e!==null&&(Qr(e,t,a,n),kd(e,t,a))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Ot(),a=Qs(t),i=Gn(n,a);i.tag=1,i.payload=e,r!=null&&(i.callback=r),e=Gs(t,i,a),e!==null&&(Qr(e,t,a,n),kd(e,t,a))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Ot(),n=Qs(t),a=Gn(r,n);a.tag=2,e!=null&&(a.callback=e),e=Gs(t,a,n),e!==null&&(Qr(e,t,n,r),kd(e,t,n))}};function kp(t,e,r,n,a,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,i,o):e.prototype&&e.prototype.isPureReactComponent?!$l(r,n)||!$l(a,i):!0}function nb(t,e,r){var n=!1,a=qs,i=e.contextType;return typeof i=="object"&&i!==null?i=Cr(i):(a=Jt(e)?$a:Et.current,n=e.contextTypes,i=(n=n!=null)?Eo(t,a):qs),e=new e(r,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Vu,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=a,t.__reactInternalMemoizedMaskedChildContext=i),e}function jp(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&Vu.enqueueReplaceState(e,e.state,null)}function Yf(t,e,r,n){var a=t.stateNode;a.props=r,a.state=t.memoizedState,a.refs={},Sm(t);var i=e.contextType;typeof i=="object"&&i!==null?a.context=Cr(i):(i=Jt(e)?$a:Et.current,a.context=Eo(t,i)),a.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Jf(t,e,i,r),a.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(e=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),e!==a.state&&Vu.enqueueReplaceState(a,a.state,null),ru(t,r,a,n),a.state=t.memoizedState),typeof a.componentDidMount=="function"&&(t.flags|=4194308)}function Po(t,e){try{var r="",n=e;do r+=s2(n),n=n.return;while(n);var a=r}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:a,digest:null}}function Uh(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function qf(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var Ik=typeof WeakMap=="function"?WeakMap:Map;function sb(t,e,r){r=Gn(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){ou||(ou=!0,o0=n),qf(t,e)},r}function ab(t,e,r){r=Gn(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var a=e.value;r.payload=function(){return n(a)},r.callback=function(){qf(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){qf(t,e),typeof n!="function"&&($s===null?$s=new Set([this]):$s.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),r}function Ap(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new Ik;var a=new Set;n.set(e,a)}else a=n.get(e),a===void 0&&(a=new Set,n.set(e,a));a.has(r)||(a.add(r),t=$k.bind(null,t,e,r),e.then(t,t))}function Ep(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Sp(t,e,r,n,a){return t.mode&1?(t.flags|=65536,t.lanes=a,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Gn(-1,1),e.tag=2,Gs(r,e,1))),r.lanes|=1),t)}var Tk=rs.ReactCurrentOwner,Qt=!1;function Ct(t,e,r,n){e.child=t===null?Bw(e,null,r,n):Co(e,t.child,r,n)}function Cp(t,e,r,n,a){r=r.render;var i=e.ref;return Ti(e,a),n=Tm(t,e,r,n,i,a),r=_m(),t!==null&&!Qt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,qn(t,e,a)):(ze&&r&&bm(e),e.flags|=1,Ct(t,e,n,a),e.child)}function Dp(t,e,r,n,a){if(t===null){var i=r.type;return typeof i=="function"&&!Vm(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=i,ib(t,e,i,n,a)):(t=Dd(r.type,null,n,e,e.mode,a),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&a)){var o=i.memoizedProps;if(r=r.compare,r=r!==null?r:$l,r(o,n)&&t.ref===e.ref)return qn(t,e,a)}return e.flags|=1,t=Ws(i,n),t.ref=e.ref,t.return=e,e.child=t}function ib(t,e,r,n,a){if(t!==null){var i=t.memoizedProps;if($l(i,n)&&t.ref===e.ref)if(Qt=!1,e.pendingProps=n=i,(t.lanes&a)!==0)t.flags&131072&&(Qt=!0);else return e.lanes=t.lanes,qn(t,e,a)}return Zf(t,e,r,n,a)}function ob(t,e,r){var n=e.pendingProps,a=n.children,i=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Oe(Ni,ir),ir|=r;else{if(!(r&1073741824))return t=i!==null?i.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Oe(Ni,ir),ir|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,Oe(Ni,ir),ir|=n}else i!==null?(n=i.baseLanes|r,e.memoizedState=null):n=r,Oe(Ni,ir),ir|=n;return Ct(t,e,a,r),e.child}function lb(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function Zf(t,e,r,n,a){var i=Jt(r)?$a:Et.current;return i=Eo(e,i),Ti(e,a),r=Tm(t,e,r,n,i,a),n=_m(),t!==null&&!Qt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,qn(t,e,a)):(ze&&n&&bm(e),e.flags|=1,Ct(t,e,r,a),e.child)}function Pp(t,e,r,n,a){if(Jt(r)){var i=!0;qd(e)}else i=!1;if(Ti(e,a),e.stateNode===null)Ed(t,e),nb(e,r,n),Yf(e,r,n,a),n=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,d=r.contextType;typeof d=="object"&&d!==null?d=Cr(d):(d=Jt(r)?$a:Et.current,d=Eo(e,d));var h=r.getDerivedStateFromProps,u=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";u||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==d)&&jp(e,o,n,d),ps=!1;var f=e.memoizedState;o.state=f,ru(e,n,o,a),c=e.memoizedState,l!==n||f!==c||Kt.current||ps?(typeof h=="function"&&(Jf(e,r,h,n),c=e.memoizedState),(l=ps||kp(e,r,l,n,f,c,d))?(u||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=c),o.props=n,o.state=c,o.context=d,n=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{o=e.stateNode,Ow(t,e),l=e.memoizedProps,d=e.type===e.elementType?l:Tr(e.type,l),o.props=d,u=e.pendingProps,f=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=Cr(c):(c=Jt(r)?$a:Et.current,c=Eo(e,c));var g=r.getDerivedStateFromProps;(h=typeof g=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==u||f!==c)&&jp(e,o,n,c),ps=!1,f=e.memoizedState,o.state=f,ru(e,n,o,a);var b=e.memoizedState;l!==u||f!==b||Kt.current||ps?(typeof g=="function"&&(Jf(e,r,g,n),b=e.memoizedState),(d=ps||kp(e,r,d,n,f,b,c)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,b,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,b,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=b),o.props=n,o.state=b,o.context=c,n=d):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),n=!1)}return Xf(t,e,r,n,i,a)}function Xf(t,e,r,n,a,i){lb(t,e);var o=(e.flags&128)!==0;if(!n&&!o)return a&&gp(e,r,!1),qn(t,e,i);n=e.stateNode,Tk.current=e;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&o?(e.child=Co(e,t.child,null,i),e.child=Co(e,null,l,i)):Ct(t,e,l,i),e.memoizedState=n.state,a&&gp(e,r,!0),e.child}function cb(t){var e=t.stateNode;e.pendingContext?mp(t,e.pendingContext,e.pendingContext!==e.context):e.context&&mp(t,e.context,!1),Cm(t,e.containerInfo)}function Ip(t,e,r,n,a){return So(),Nm(a),e.flags|=256,Ct(t,e,r,n),e.child}var e0={dehydrated:null,treeContext:null,retryLane:0};function t0(t){return{baseLanes:t,cachePool:null,transitions:null}}function db(t,e,r){var n=e.pendingProps,a=$e.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(a&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(a|=1),Oe($e,a&1),t===null)return Wf(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=n.children,t=n.fallback,i?(n=e.mode,i=e.child,o={mode:"hidden",children:o},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Qu(o,n,0,null),t=za(t,n,r,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=t0(r),e.memoizedState=e0,t):Om(e,o));if(a=t.memoizedState,a!==null&&(l=a.dehydrated,l!==null))return _k(t,e,o,n,l,a,r);if(i){i=n.fallback,o=e.mode,a=t.child,l=a.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&e.child!==a?(n=e.child,n.childLanes=0,n.pendingProps=c,e.deletions=null):(n=Ws(a,c),n.subtreeFlags=a.subtreeFlags&14680064),l!==null?i=Ws(l,i):(i=za(i,o,r,null),i.flags|=2),i.return=e,n.return=e,n.sibling=i,e.child=n,n=i,i=e.child,o=t.child.memoizedState,o=o===null?t0(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~r,e.memoizedState=e0,n}return i=t.child,t=i.sibling,n=Ws(i,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function Om(t,e){return e=Qu({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function nd(t,e,r,n){return n!==null&&Nm(n),Co(e,t.child,null,r),t=Om(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function _k(t,e,r,n,a,i,o){if(r)return e.flags&256?(e.flags&=-257,n=Uh(Error(Z(422))),nd(t,e,o,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=n.fallback,a=e.mode,n=Qu({mode:"visible",children:n.children},a,0,null),i=za(i,a,o,null),i.flags|=2,n.return=e,i.return=e,n.sibling=i,e.child=n,e.mode&1&&Co(e,t.child,null,o),e.child.memoizedState=t0(o),e.memoizedState=e0,i);if(!(e.mode&1))return nd(t,e,o,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var l=n.dgst;return n=l,i=Error(Z(419)),n=Uh(i,n,void 0),nd(t,e,o,n)}if(l=(o&t.childLanes)!==0,Qt||l){if(n=dt,n!==null){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|o)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,Yn(t,a),Qr(n,t,a,-1))}return Hm(),n=Uh(Error(Z(421))),nd(t,e,o,n)}return a.data==="$?"?(e.flags|=128,e.child=t.child,e=Qk.bind(null,t),a._reactRetry=e,null):(t=i.treeContext,or=Vs(a.nextSibling),lr=e,ze=!0,Ur=null,t!==null&&(kr[jr++]=Un,kr[jr++]=zn,kr[jr++]=Qa,Un=t.id,zn=t.overflow,Qa=e),e=Om(e,n.children),e.flags|=4096,e)}function Tp(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),Kf(t.return,e,r)}function zh(t,e,r,n,a){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=a)}function ub(t,e,r){var n=e.pendingProps,a=n.revealOrder,i=n.tail;if(Ct(t,e,n.children,r),n=$e.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Tp(t,r,e);else if(t.tag===19)Tp(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(Oe($e,n),!(e.mode&1))e.memoizedState=null;else switch(a){case"forwards":for(r=e.child,a=null;r!==null;)t=r.alternate,t!==null&&nu(t)===null&&(a=r),r=r.sibling;r=a,r===null?(a=e.child,e.child=null):(a=r.sibling,r.sibling=null),zh(e,!1,a,r,i);break;case"backwards":for(r=null,a=e.child,e.child=null;a!==null;){if(t=a.alternate,t!==null&&nu(t)===null){e.child=a;break}t=a.sibling,a.sibling=r,r=a,a=t}zh(e,!0,r,null,i);break;case"together":zh(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Ed(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function qn(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Ka|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Z(153));if(e.child!==null){for(t=e.child,r=Ws(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Ws(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function Bk(t,e,r){switch(e.tag){case 3:cb(e),So();break;case 5:Mw(e);break;case 1:Jt(e.type)&&qd(e);break;case 4:Cm(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,a=e.memoizedProps.value;Oe(eu,n._currentValue),n._currentValue=a;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(Oe($e,$e.current&1),e.flags|=128,null):r&e.child.childLanes?db(t,e,r):(Oe($e,$e.current&1),t=qn(t,e,r),t!==null?t.sibling:null);Oe($e,$e.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return ub(t,e,r);e.flags|=128}if(a=e.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Oe($e,$e.current),n)break;return null;case 22:case 23:return e.lanes=0,ob(t,e,r)}return qn(t,e,r)}var hb,r0,fb,mb;hb=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};r0=function(){};fb=function(t,e,r,n){var a=t.memoizedProps;if(a!==n){t=e.stateNode,xa(wn.current);var i=null;switch(r){case"input":a=jf(t,a),n=jf(t,n),i=[];break;case"select":a=Ke({},a,{value:void 0}),n=Ke({},n,{value:void 0}),i=[];break;case"textarea":a=Sf(t,a),n=Sf(t,n),i=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=Jd)}Df(r,n);var o;r=null;for(d in a)if(!n.hasOwnProperty(d)&&a.hasOwnProperty(d)&&a[d]!=null)if(d==="style"){var l=a[d];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Ll.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in n){var c=n[d];if(l=a!=null?a[d]:void 0,n.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(i||(i=[]),i.push(d,r)),r=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Ll.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Fe("scroll",t),i||l===c||(i=[])):(i=i||[]).push(d,c))}r&&(i=i||[]).push("style",r);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};mb=function(t,e,r,n){r!==n&&(e.flags|=4)};function ol(t,e){if(!ze)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function bt(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var a=t.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=t,a=a.sibling;else for(a=t.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=t,a=a.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function Rk(t,e,r){var n=e.pendingProps;switch(vm(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return bt(e),null;case 1:return Jt(e.type)&&Yd(),bt(e),null;case 3:return n=e.stateNode,Do(),Ue(Kt),Ue(Et),Pm(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(td(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Ur!==null&&(d0(Ur),Ur=null))),r0(t,e),bt(e),null;case 5:Dm(e);var a=xa(Yl.current);if(r=e.type,t!==null&&e.stateNode!=null)fb(t,e,r,n,a),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(Z(166));return bt(e),null}if(t=xa(wn.current),td(e)){n=e.stateNode,r=e.type;var i=e.memoizedProps;switch(n[mn]=e,n[Kl]=i,t=(e.mode&1)!==0,r){case"dialog":Fe("cancel",n),Fe("close",n);break;case"iframe":case"object":case"embed":Fe("load",n);break;case"video":case"audio":for(a=0;a<ml.length;a++)Fe(ml[a],n);break;case"source":Fe("error",n);break;case"img":case"image":case"link":Fe("error",n),Fe("load",n);break;case"details":Fe("toggle",n);break;case"input":zg(n,i),Fe("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},Fe("invalid",n);break;case"textarea":Vg(n,i),Fe("invalid",n)}Df(r,i),a=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?n.textContent!==l&&(i.suppressHydrationWarning!==!0&&ed(n.textContent,l,t),a=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&ed(n.textContent,l,t),a=["children",""+l]):Ll.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Fe("scroll",n)}switch(r){case"input":Qc(n),Hg(n,i,!0);break;case"textarea":Qc(n),Gg(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=Jd)}n=a,e.updateQueue=n,n!==null&&(e.flags|=4)}else{o=a.nodeType===9?a:a.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Hy(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=o.createElement(r,{is:n.is}):(t=o.createElement(r),r==="select"&&(o=t,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):t=o.createElementNS(t,r),t[mn]=e,t[Kl]=n,hb(t,e,!1,!1),e.stateNode=t;e:{switch(o=Pf(r,n),r){case"dialog":Fe("cancel",t),Fe("close",t),a=n;break;case"iframe":case"object":case"embed":Fe("load",t),a=n;break;case"video":case"audio":for(a=0;a<ml.length;a++)Fe(ml[a],t);a=n;break;case"source":Fe("error",t),a=n;break;case"img":case"image":case"link":Fe("error",t),Fe("load",t),a=n;break;case"details":Fe("toggle",t),a=n;break;case"input":zg(t,n),a=jf(t,n),Fe("invalid",t);break;case"option":a=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},a=Ke({},n,{value:void 0}),Fe("invalid",t);break;case"textarea":Vg(t,n),a=Sf(t,n),Fe("invalid",t);break;default:a=n}Df(r,a),l=a;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?$y(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Vy(t,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Fl(t,c):typeof c=="number"&&Fl(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Ll.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Fe("scroll",t):c!=null&&im(t,i,c,o))}switch(r){case"input":Qc(t),Hg(t,n,!1);break;case"textarea":Qc(t),Gg(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Ys(n.value));break;case"select":t.multiple=!!n.multiple,i=n.value,i!=null?Ci(t,!!n.multiple,i,!1):n.defaultValue!=null&&Ci(t,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(t.onclick=Jd)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return bt(e),null;case 6:if(t&&e.stateNode!=null)mb(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(Z(166));if(r=xa(Yl.current),xa(wn.current),td(e)){if(n=e.stateNode,r=e.memoizedProps,n[mn]=e,(i=n.nodeValue!==r)&&(t=lr,t!==null))switch(t.tag){case 3:ed(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&ed(n.nodeValue,r,(t.mode&1)!==0)}i&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[mn]=e,e.stateNode=n}return bt(e),null;case 13:if(Ue($e),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ze&&or!==null&&e.mode&1&&!(e.flags&128))Tw(),So(),e.flags|=98560,i=!1;else if(i=td(e),n!==null&&n.dehydrated!==null){if(t===null){if(!i)throw Error(Z(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Z(317));i[mn]=e}else So(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;bt(e),i=!1}else Ur!==null&&(d0(Ur),Ur=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||$e.current&1?st===0&&(st=3):Hm())),e.updateQueue!==null&&(e.flags|=4),bt(e),null);case 4:return Do(),r0(t,e),t===null&&Ql(e.stateNode.containerInfo),bt(e),null;case 10:return Am(e.type._context),bt(e),null;case 17:return Jt(e.type)&&Yd(),bt(e),null;case 19:if(Ue($e),i=e.memoizedState,i===null)return bt(e),null;if(n=(e.flags&128)!==0,o=i.rendering,o===null)if(n)ol(i,!1);else{if(st!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=nu(t),o!==null){for(e.flags|=128,ol(i,!1),n=o.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)i=r,t=n,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return Oe($e,$e.current&1|2),e.child}t=t.sibling}i.tail!==null&&Ze()>Io&&(e.flags|=128,n=!0,ol(i,!1),e.lanes=4194304)}else{if(!n)if(t=nu(o),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),ol(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!ze)return bt(e),null}else 2*Ze()-i.renderingStartTime>Io&&r!==1073741824&&(e.flags|=128,n=!0,ol(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(r=i.last,r!==null?r.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Ze(),e.sibling=null,r=$e.current,Oe($e,n?r&1|2:r&1),e):(bt(e),null);case 22:case 23:return zm(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?ir&1073741824&&(bt(e),e.subtreeFlags&6&&(e.flags|=8192)):bt(e),null;case 24:return null;case 25:return null}throw Error(Z(156,e.tag))}function Ok(t,e){switch(vm(e),e.tag){case 1:return Jt(e.type)&&Yd(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Do(),Ue(Kt),Ue(Et),Pm(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Dm(e),null;case 13:if(Ue($e),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Z(340));So()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ue($e),null;case 4:return Do(),null;case 10:return Am(e.type._context),null;case 22:case 23:return zm(),null;case 24:return null;default:return null}}var sd=!1,jt=!1,Mk=typeof WeakSet=="function"?WeakSet:Set,ce=null;function vi(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Ye(t,e,n)}else r.current=null}function n0(t,e,r){try{r()}catch(n){Ye(t,e,n)}}var _p=!1;function Lk(t,e){if(Uf=Qd,t=ww(),wm(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,d=0,h=0,u=t,f=null;t:for(;;){for(var g;u!==r||a!==0&&u.nodeType!==3||(l=o+a),u!==i||n!==0&&u.nodeType!==3||(c=o+n),u.nodeType===3&&(o+=u.nodeValue.length),(g=u.firstChild)!==null;)f=u,u=g;for(;;){if(u===t)break t;if(f===r&&++d===a&&(l=o),f===i&&++h===n&&(c=o),(g=u.nextSibling)!==null)break;u=f,f=u.parentNode}u=g}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(zf={focusedElem:t,selectionRange:r},Qd=!1,ce=e;ce!==null;)if(e=ce,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ce=t;else for(;ce!==null;){e=ce;try{var b=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(b!==null){var y=b.memoizedProps,k=b.memoizedState,m=e.stateNode,x=m.getSnapshotBeforeUpdate(e.elementType===e.type?y:Tr(e.type,y),k);m.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var p=e.stateNode.containerInfo;p.nodeType===1?p.textContent="":p.nodeType===9&&p.documentElement&&p.removeChild(p.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Z(163))}}catch(v){Ye(e,e.return,v)}if(t=e.sibling,t!==null){t.return=e.return,ce=t;break}ce=e.return}return b=_p,_p=!1,b}function Sl(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&t)===t){var i=a.destroy;a.destroy=void 0,i!==void 0&&n0(e,r,i)}a=a.next}while(a!==n)}}function Gu(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function s0(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function gb(t){var e=t.alternate;e!==null&&(t.alternate=null,gb(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[mn],delete e[Kl],delete e[Gf],delete e[bk],delete e[vk])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function pb(t){return t.tag===5||t.tag===3||t.tag===4}function Bp(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||pb(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function a0(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Jd));else if(n!==4&&(t=t.child,t!==null))for(a0(t,e,r),t=t.sibling;t!==null;)a0(t,e,r),t=t.sibling}function i0(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(i0(t,e,r),t=t.sibling;t!==null;)i0(t,e,r),t=t.sibling}var ht=null,Fr=!1;function as(t,e,r){for(r=r.child;r!==null;)xb(t,e,r),r=r.sibling}function xb(t,e,r){if(yn&&typeof yn.onCommitFiberUnmount=="function")try{yn.onCommitFiberUnmount(Ou,r)}catch{}switch(r.tag){case 5:jt||vi(r,e);case 6:var n=ht,a=Fr;ht=null,as(t,e,r),ht=n,Fr=a,ht!==null&&(Fr?(t=ht,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):ht.removeChild(r.stateNode));break;case 18:ht!==null&&(Fr?(t=ht,r=r.stateNode,t.nodeType===8?Bh(t.parentNode,r):t.nodeType===1&&Bh(t,r),Vl(t)):Bh(ht,r.stateNode));break;case 4:n=ht,a=Fr,ht=r.stateNode.containerInfo,Fr=!0,as(t,e,r),ht=n,Fr=a;break;case 0:case 11:case 14:case 15:if(!jt&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var i=a,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&n0(r,e,o),a=a.next}while(a!==n)}as(t,e,r);break;case 1:if(!jt&&(vi(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){Ye(r,e,l)}as(t,e,r);break;case 21:as(t,e,r);break;case 22:r.mode&1?(jt=(n=jt)||r.memoizedState!==null,as(t,e,r),jt=n):as(t,e,r);break;default:as(t,e,r)}}function Rp(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new Mk),e.forEach(function(n){var a=Wk.bind(null,t,n);r.has(n)||(r.add(n),n.then(a,a))})}}function Ir(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:ht=l.stateNode,Fr=!1;break e;case 3:ht=l.stateNode.containerInfo,Fr=!0;break e;case 4:ht=l.stateNode.containerInfo,Fr=!0;break e}l=l.return}if(ht===null)throw Error(Z(160));xb(i,o,a),ht=null,Fr=!1;var c=a.alternate;c!==null&&(c.return=null),a.return=null}catch(d){Ye(a,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)yb(e,t),e=e.sibling}function yb(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ir(e,t),Zr(t),n&4){try{Sl(3,t,t.return),Gu(3,t)}catch(y){Ye(t,t.return,y)}try{Sl(5,t,t.return)}catch(y){Ye(t,t.return,y)}}break;case 1:Ir(e,t),Zr(t),n&512&&r!==null&&vi(r,r.return);break;case 5:if(Ir(e,t),Zr(t),n&512&&r!==null&&vi(r,r.return),t.flags&32){var a=t.stateNode;try{Fl(a,"")}catch(y){Ye(t,t.return,y)}}if(n&4&&(a=t.stateNode,a!=null)){var i=t.memoizedProps,o=r!==null?r.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&Uy(a,i),Pf(l,o);var d=Pf(l,i);for(o=0;o<c.length;o+=2){var h=c[o],u=c[o+1];h==="style"?$y(a,u):h==="dangerouslySetInnerHTML"?Vy(a,u):h==="children"?Fl(a,u):im(a,h,u,d)}switch(l){case"input":Af(a,i);break;case"textarea":zy(a,i);break;case"select":var f=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var g=i.value;g!=null?Ci(a,!!i.multiple,g,!1):f!==!!i.multiple&&(i.defaultValue!=null?Ci(a,!!i.multiple,i.defaultValue,!0):Ci(a,!!i.multiple,i.multiple?[]:"",!1))}a[Kl]=i}catch(y){Ye(t,t.return,y)}}break;case 6:if(Ir(e,t),Zr(t),n&4){if(t.stateNode===null)throw Error(Z(162));a=t.stateNode,i=t.memoizedProps;try{a.nodeValue=i}catch(y){Ye(t,t.return,y)}}break;case 3:if(Ir(e,t),Zr(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Vl(e.containerInfo)}catch(y){Ye(t,t.return,y)}break;case 4:Ir(e,t),Zr(t);break;case 13:Ir(e,t),Zr(t),a=t.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(Fm=Ze())),n&4&&Rp(t);break;case 22:if(h=r!==null&&r.memoizedState!==null,t.mode&1?(jt=(d=jt)||h,Ir(e,t),jt=d):Ir(e,t),Zr(t),n&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for(ce=t,h=t.child;h!==null;){for(u=ce=h;ce!==null;){switch(f=ce,g=f.child,f.tag){case 0:case 11:case 14:case 15:Sl(4,f,f.return);break;case 1:vi(f,f.return);var b=f.stateNode;if(typeof b.componentWillUnmount=="function"){n=f,r=f.return;try{e=n,b.props=e.memoizedProps,b.state=e.memoizedState,b.componentWillUnmount()}catch(y){Ye(n,r,y)}}break;case 5:vi(f,f.return);break;case 22:if(f.memoizedState!==null){Mp(u);continue}}g!==null?(g.return=f,ce=g):Mp(u)}h=h.sibling}e:for(h=null,u=t;;){if(u.tag===5){if(h===null){h=u;try{a=u.stateNode,d?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=u.stateNode,c=u.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=Gy("display",o))}catch(y){Ye(t,t.return,y)}}}else if(u.tag===6){if(h===null)try{u.stateNode.nodeValue=d?"":u.memoizedProps}catch(y){Ye(t,t.return,y)}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===t)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===t)break e;for(;u.sibling===null;){if(u.return===null||u.return===t)break e;h===u&&(h=null),u=u.return}h===u&&(h=null),u.sibling.return=u.return,u=u.sibling}}break;case 19:Ir(e,t),Zr(t),n&4&&Rp(t);break;case 21:break;default:Ir(e,t),Zr(t)}}function Zr(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(pb(r)){var n=r;break e}r=r.return}throw Error(Z(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(Fl(a,""),n.flags&=-33);var i=Bp(t);i0(t,i,a);break;case 3:case 4:var o=n.stateNode.containerInfo,l=Bp(t);a0(t,l,o);break;default:throw Error(Z(161))}}catch(c){Ye(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Fk(t,e,r){ce=t,wb(t)}function wb(t,e,r){for(var n=(t.mode&1)!==0;ce!==null;){var a=ce,i=a.child;if(a.tag===22&&n){var o=a.memoizedState!==null||sd;if(!o){var l=a.alternate,c=l!==null&&l.memoizedState!==null||jt;l=sd;var d=jt;if(sd=o,(jt=c)&&!d)for(ce=a;ce!==null;)o=ce,c=o.child,o.tag===22&&o.memoizedState!==null?Lp(a):c!==null?(c.return=o,ce=c):Lp(a);for(;i!==null;)ce=i,wb(i),i=i.sibling;ce=a,sd=l,jt=d}Op(t)}else a.subtreeFlags&8772&&i!==null?(i.return=a,ce=i):Op(t)}}function Op(t){for(;ce!==null;){var e=ce;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:jt||Gu(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!jt)if(r===null)n.componentDidMount();else{var a=e.elementType===e.type?r.memoizedProps:Tr(e.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&bp(e,i,n);break;case 3:var o=e.updateQueue;if(o!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}bp(e,o,r)}break;case 5:var l=e.stateNode;if(r===null&&e.flags&4){r=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var u=h.dehydrated;u!==null&&Vl(u)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Z(163))}jt||e.flags&512&&s0(e)}catch(f){Ye(e,e.return,f)}}if(e===t){ce=null;break}if(r=e.sibling,r!==null){r.return=e.return,ce=r;break}ce=e.return}}function Mp(t){for(;ce!==null;){var e=ce;if(e===t){ce=null;break}var r=e.sibling;if(r!==null){r.return=e.return,ce=r;break}ce=e.return}}function Lp(t){for(;ce!==null;){var e=ce;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{Gu(4,e)}catch(c){Ye(e,r,c)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var a=e.return;try{n.componentDidMount()}catch(c){Ye(e,a,c)}}var i=e.return;try{s0(e)}catch(c){Ye(e,i,c)}break;case 5:var o=e.return;try{s0(e)}catch(c){Ye(e,o,c)}}}catch(c){Ye(e,e.return,c)}if(e===t){ce=null;break}var l=e.sibling;if(l!==null){l.return=e.return,ce=l;break}ce=e.return}}var Uk=Math.ceil,iu=rs.ReactCurrentDispatcher,Mm=rs.ReactCurrentOwner,Er=rs.ReactCurrentBatchConfig,Ae=0,dt=null,et=null,gt=0,ir=0,Ni=ta(0),st=0,ec=null,Ka=0,$u=0,Lm=0,Cl=null,Gt=null,Fm=0,Io=1/0,kn=null,ou=!1,o0=null,$s=null,ad=!1,Ls=null,lu=0,Dl=0,l0=null,Sd=-1,Cd=0;function Ot(){return Ae&6?Ze():Sd!==-1?Sd:Sd=Ze()}function Qs(t){return t.mode&1?Ae&2&&gt!==0?gt&-gt:kk.transition!==null?(Cd===0&&(Cd=nw()),Cd):(t=Te,t!==0||(t=window.event,t=t===void 0?16:dw(t.type)),t):1}function Qr(t,e,r,n){if(50<Dl)throw Dl=0,l0=null,Error(Z(185));Pc(t,r,n),(!(Ae&2)||t!==dt)&&(t===dt&&(!(Ae&2)&&($u|=r),st===4&&ys(t,gt)),Yt(t,n),r===1&&Ae===0&&!(e.mode&1)&&(Io=Ze()+500,zu&&ra()))}function Yt(t,e){var r=t.callbackNode;k2(t,e);var n=$d(t,t===dt?gt:0);if(n===0)r!==null&&Wg(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&Wg(r),e===1)t.tag===0?Nk(Fp.bind(null,t)):Dw(Fp.bind(null,t)),yk(function(){!(Ae&6)&&ra()}),r=null;else{switch(sw(n)){case 1:r=um;break;case 4:r=tw;break;case 16:r=Gd;break;case 536870912:r=rw;break;default:r=Gd}r=Sb(r,bb.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function bb(t,e){if(Sd=-1,Cd=0,Ae&6)throw Error(Z(327));var r=t.callbackNode;if(_i()&&t.callbackNode!==r)return null;var n=$d(t,t===dt?gt:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=cu(t,n);else{e=n;var a=Ae;Ae|=2;var i=Nb();(dt!==t||gt!==e)&&(kn=null,Io=Ze()+500,Ua(t,e));do try{Vk();break}catch(l){vb(t,l)}while(!0);jm(),iu.current=i,Ae=a,et!==null?e=0:(dt=null,gt=0,e=st)}if(e!==0){if(e===2&&(a=Rf(t),a!==0&&(n=a,e=c0(t,a))),e===1)throw r=ec,Ua(t,0),ys(t,n),Yt(t,Ze()),r;if(e===6)ys(t,n);else{if(a=t.current.alternate,!(n&30)&&!zk(a)&&(e=cu(t,n),e===2&&(i=Rf(t),i!==0&&(n=i,e=c0(t,i))),e===1))throw r=ec,Ua(t,0),ys(t,n),Yt(t,Ze()),r;switch(t.finishedWork=a,t.finishedLanes=n,e){case 0:case 1:throw Error(Z(345));case 2:ca(t,Gt,kn);break;case 3:if(ys(t,n),(n&130023424)===n&&(e=Fm+500-Ze(),10<e)){if($d(t,0)!==0)break;if(a=t.suspendedLanes,(a&n)!==n){Ot(),t.pingedLanes|=t.suspendedLanes&a;break}t.timeoutHandle=Vf(ca.bind(null,t,Gt,kn),e);break}ca(t,Gt,kn);break;case 4:if(ys(t,n),(n&4194240)===n)break;for(e=t.eventTimes,a=-1;0<n;){var o=31-$r(n);i=1<<o,o=e[o],o>a&&(a=o),n&=~i}if(n=a,n=Ze()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Uk(n/1960))-n,10<n){t.timeoutHandle=Vf(ca.bind(null,t,Gt,kn),n);break}ca(t,Gt,kn);break;case 5:ca(t,Gt,kn);break;default:throw Error(Z(329))}}}return Yt(t,Ze()),t.callbackNode===r?bb.bind(null,t):null}function c0(t,e){var r=Cl;return t.current.memoizedState.isDehydrated&&(Ua(t,e).flags|=256),t=cu(t,e),t!==2&&(e=Gt,Gt=r,e!==null&&d0(e)),t}function d0(t){Gt===null?Gt=t:Gt.push.apply(Gt,t)}function zk(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],i=a.getSnapshot;a=a.value;try{if(!Kr(i(),a))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ys(t,e){for(e&=~Lm,e&=~$u,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-$r(e),n=1<<r;t[r]=-1,e&=~n}}function Fp(t){if(Ae&6)throw Error(Z(327));_i();var e=$d(t,0);if(!(e&1))return Yt(t,Ze()),null;var r=cu(t,e);if(t.tag!==0&&r===2){var n=Rf(t);n!==0&&(e=n,r=c0(t,n))}if(r===1)throw r=ec,Ua(t,0),ys(t,e),Yt(t,Ze()),r;if(r===6)throw Error(Z(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ca(t,Gt,kn),Yt(t,Ze()),null}function Um(t,e){var r=Ae;Ae|=1;try{return t(e)}finally{Ae=r,Ae===0&&(Io=Ze()+500,zu&&ra())}}function Ja(t){Ls!==null&&Ls.tag===0&&!(Ae&6)&&_i();var e=Ae;Ae|=1;var r=Er.transition,n=Te;try{if(Er.transition=null,Te=1,t)return t()}finally{Te=n,Er.transition=r,Ae=e,!(Ae&6)&&ra()}}function zm(){ir=Ni.current,Ue(Ni)}function Ua(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,xk(r)),et!==null)for(r=et.return;r!==null;){var n=r;switch(vm(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Yd();break;case 3:Do(),Ue(Kt),Ue(Et),Pm();break;case 5:Dm(n);break;case 4:Do();break;case 13:Ue($e);break;case 19:Ue($e);break;case 10:Am(n.type._context);break;case 22:case 23:zm()}r=r.return}if(dt=t,et=t=Ws(t.current,null),gt=ir=e,st=0,ec=null,Lm=$u=Ka=0,Gt=Cl=null,pa!==null){for(e=0;e<pa.length;e++)if(r=pa[e],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,i=r.pending;if(i!==null){var o=i.next;i.next=a,n.next=o}r.pending=n}pa=null}return t}function vb(t,e){do{var r=et;try{if(jm(),jd.current=au,su){for(var n=We.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}su=!1}if(Wa=0,it=nt=We=null,El=!1,ql=0,Mm.current=null,r===null||r.return===null){st=1,ec=e,et=null;break}e:{var i=t,o=r.return,l=r,c=e;if(e=gt,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,h=l,u=h.tag;if(!(h.mode&1)&&(u===0||u===11||u===15)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var g=Ep(o);if(g!==null){g.flags&=-257,Sp(g,o,l,i,e),g.mode&1&&Ap(i,d,e),e=g,c=d;var b=e.updateQueue;if(b===null){var y=new Set;y.add(c),e.updateQueue=y}else b.add(c);break e}else{if(!(e&1)){Ap(i,d,e),Hm();break e}c=Error(Z(426))}}else if(ze&&l.mode&1){var k=Ep(o);if(k!==null){!(k.flags&65536)&&(k.flags|=256),Sp(k,o,l,i,e),Nm(Po(c,l));break e}}i=c=Po(c,l),st!==4&&(st=2),Cl===null?Cl=[i]:Cl.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var m=sb(i,c,e);wp(i,m);break e;case 1:l=c;var x=i.type,p=i.stateNode;if(!(i.flags&128)&&(typeof x.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&($s===null||!$s.has(p)))){i.flags|=65536,e&=-e,i.lanes|=e;var v=ab(i,l,e);wp(i,v);break e}}i=i.return}while(i!==null)}jb(r)}catch(N){e=N,et===r&&r!==null&&(et=r=r.return);continue}break}while(!0)}function Nb(){var t=iu.current;return iu.current=au,t===null?au:t}function Hm(){(st===0||st===3||st===2)&&(st=4),dt===null||!(Ka&268435455)&&!($u&268435455)||ys(dt,gt)}function cu(t,e){var r=Ae;Ae|=2;var n=Nb();(dt!==t||gt!==e)&&(kn=null,Ua(t,e));do try{Hk();break}catch(a){vb(t,a)}while(!0);if(jm(),Ae=r,iu.current=n,et!==null)throw Error(Z(261));return dt=null,gt=0,st}function Hk(){for(;et!==null;)kb(et)}function Vk(){for(;et!==null&&!m2();)kb(et)}function kb(t){var e=Eb(t.alternate,t,ir);t.memoizedProps=t.pendingProps,e===null?jb(t):et=e,Mm.current=null}function jb(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=Ok(r,e),r!==null){r.flags&=32767,et=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{st=6,et=null;return}}else if(r=Rk(r,e,ir),r!==null){et=r;return}if(e=e.sibling,e!==null){et=e;return}et=e=t}while(e!==null);st===0&&(st=5)}function ca(t,e,r){var n=Te,a=Er.transition;try{Er.transition=null,Te=1,Gk(t,e,r,n)}finally{Er.transition=a,Te=n}return null}function Gk(t,e,r,n){do _i();while(Ls!==null);if(Ae&6)throw Error(Z(327));r=t.finishedWork;var a=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(Z(177));t.callbackNode=null,t.callbackPriority=0;var i=r.lanes|r.childLanes;if(j2(t,i),t===dt&&(et=dt=null,gt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||ad||(ad=!0,Sb(Gd,function(){return _i(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=Er.transition,Er.transition=null;var o=Te;Te=1;var l=Ae;Ae|=4,Mm.current=null,Lk(t,r),yb(r,t),dk(zf),Qd=!!Uf,zf=Uf=null,t.current=r,Fk(r),g2(),Ae=l,Te=o,Er.transition=i}else t.current=r;if(ad&&(ad=!1,Ls=t,lu=a),i=t.pendingLanes,i===0&&($s=null),y2(r.stateNode),Yt(t,Ze()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)a=e[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(ou)throw ou=!1,t=o0,o0=null,t;return lu&1&&t.tag!==0&&_i(),i=t.pendingLanes,i&1?t===l0?Dl++:(Dl=0,l0=t):Dl=0,ra(),null}function _i(){if(Ls!==null){var t=sw(lu),e=Er.transition,r=Te;try{if(Er.transition=null,Te=16>t?16:t,Ls===null)var n=!1;else{if(t=Ls,Ls=null,lu=0,Ae&6)throw Error(Z(331));var a=Ae;for(Ae|=4,ce=t.current;ce!==null;){var i=ce,o=i.child;if(ce.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(ce=d;ce!==null;){var h=ce;switch(h.tag){case 0:case 11:case 15:Sl(8,h,i)}var u=h.child;if(u!==null)u.return=h,ce=u;else for(;ce!==null;){h=ce;var f=h.sibling,g=h.return;if(gb(h),h===d){ce=null;break}if(f!==null){f.return=g,ce=f;break}ce=g}}}var b=i.alternate;if(b!==null){var y=b.child;if(y!==null){b.child=null;do{var k=y.sibling;y.sibling=null,y=k}while(y!==null)}}ce=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,ce=o;else e:for(;ce!==null;){if(i=ce,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Sl(9,i,i.return)}var m=i.sibling;if(m!==null){m.return=i.return,ce=m;break e}ce=i.return}}var x=t.current;for(ce=x;ce!==null;){o=ce;var p=o.child;if(o.subtreeFlags&2064&&p!==null)p.return=o,ce=p;else e:for(o=x;ce!==null;){if(l=ce,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Gu(9,l)}}catch(N){Ye(l,l.return,N)}if(l===o){ce=null;break e}var v=l.sibling;if(v!==null){v.return=l.return,ce=v;break e}ce=l.return}}if(Ae=a,ra(),yn&&typeof yn.onPostCommitFiberRoot=="function")try{yn.onPostCommitFiberRoot(Ou,t)}catch{}n=!0}return n}finally{Te=r,Er.transition=e}}return!1}function Up(t,e,r){e=Po(r,e),e=sb(t,e,1),t=Gs(t,e,1),e=Ot(),t!==null&&(Pc(t,1,e),Yt(t,e))}function Ye(t,e,r){if(t.tag===3)Up(t,t,r);else for(;e!==null;){if(e.tag===3){Up(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&($s===null||!$s.has(n))){t=Po(r,t),t=ab(e,t,1),e=Gs(e,t,1),t=Ot(),e!==null&&(Pc(e,1,t),Yt(e,t));break}}e=e.return}}function $k(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Ot(),t.pingedLanes|=t.suspendedLanes&r,dt===t&&(gt&r)===r&&(st===4||st===3&&(gt&130023424)===gt&&500>Ze()-Fm?Ua(t,0):Lm|=r),Yt(t,e)}function Ab(t,e){e===0&&(t.mode&1?(e=Jc,Jc<<=1,!(Jc&130023424)&&(Jc=4194304)):e=1);var r=Ot();t=Yn(t,e),t!==null&&(Pc(t,e,r),Yt(t,r))}function Qk(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),Ab(t,r)}function Wk(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,a=t.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(Z(314))}n!==null&&n.delete(e),Ab(t,r)}var Eb;Eb=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Kt.current)Qt=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Qt=!1,Bk(t,e,r);Qt=!!(t.flags&131072)}else Qt=!1,ze&&e.flags&1048576&&Pw(e,Xd,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;Ed(t,e),t=e.pendingProps;var a=Eo(e,Et.current);Ti(e,r),a=Tm(null,e,n,t,a,r);var i=_m();return e.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Jt(n)?(i=!0,qd(e)):i=!1,e.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,Sm(e),a.updater=Vu,e.stateNode=a,a._reactInternals=e,Yf(e,n,t,r),e=Xf(null,e,n,!0,i,r)):(e.tag=0,ze&&i&&bm(e),Ct(null,e,a,r),e=e.child),e;case 16:n=e.elementType;e:{switch(Ed(t,e),t=e.pendingProps,a=n._init,n=a(n._payload),e.type=n,a=e.tag=Jk(n),t=Tr(n,t),a){case 0:e=Zf(null,e,n,t,r);break e;case 1:e=Pp(null,e,n,t,r);break e;case 11:e=Cp(null,e,n,t,r);break e;case 14:e=Dp(null,e,n,Tr(n.type,t),r);break e}throw Error(Z(306,n,""))}return e;case 0:return n=e.type,a=e.pendingProps,a=e.elementType===n?a:Tr(n,a),Zf(t,e,n,a,r);case 1:return n=e.type,a=e.pendingProps,a=e.elementType===n?a:Tr(n,a),Pp(t,e,n,a,r);case 3:e:{if(cb(e),t===null)throw Error(Z(387));n=e.pendingProps,i=e.memoizedState,a=i.element,Ow(t,e),ru(e,n,null,r);var o=e.memoizedState;if(n=o.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){a=Po(Error(Z(423)),e),e=Ip(t,e,n,r,a);break e}else if(n!==a){a=Po(Error(Z(424)),e),e=Ip(t,e,n,r,a);break e}else for(or=Vs(e.stateNode.containerInfo.firstChild),lr=e,ze=!0,Ur=null,r=Bw(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(So(),n===a){e=qn(t,e,r);break e}Ct(t,e,n,r)}e=e.child}return e;case 5:return Mw(e),t===null&&Wf(e),n=e.type,a=e.pendingProps,i=t!==null?t.memoizedProps:null,o=a.children,Hf(n,a)?o=null:i!==null&&Hf(n,i)&&(e.flags|=32),lb(t,e),Ct(t,e,o,r),e.child;case 6:return t===null&&Wf(e),null;case 13:return db(t,e,r);case 4:return Cm(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=Co(e,null,n,r):Ct(t,e,n,r),e.child;case 11:return n=e.type,a=e.pendingProps,a=e.elementType===n?a:Tr(n,a),Cp(t,e,n,a,r);case 7:return Ct(t,e,e.pendingProps,r),e.child;case 8:return Ct(t,e,e.pendingProps.children,r),e.child;case 12:return Ct(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,a=e.pendingProps,i=e.memoizedProps,o=a.value,Oe(eu,n._currentValue),n._currentValue=o,i!==null)if(Kr(i.value,o)){if(i.children===a.children&&!Kt.current){e=qn(t,e,r);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(i.tag===1){c=Gn(-1,r&-r),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?c.next=c:(c.next=h.next,h.next=c),d.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),Kf(i.return,r,e),l.lanes|=r;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(Z(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),Kf(o,r,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Ct(t,e,a.children,r),e=e.child}return e;case 9:return a=e.type,n=e.pendingProps.children,Ti(e,r),a=Cr(a),n=n(a),e.flags|=1,Ct(t,e,n,r),e.child;case 14:return n=e.type,a=Tr(n,e.pendingProps),a=Tr(n.type,a),Dp(t,e,n,a,r);case 15:return ib(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,a=e.pendingProps,a=e.elementType===n?a:Tr(n,a),Ed(t,e),e.tag=1,Jt(n)?(t=!0,qd(e)):t=!1,Ti(e,r),nb(e,n,a),Yf(e,n,a,r),Xf(null,e,n,!0,t,r);case 19:return ub(t,e,r);case 22:return ob(t,e,r)}throw Error(Z(156,e.tag))};function Sb(t,e){return ew(t,e)}function Kk(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ar(t,e,r,n){return new Kk(t,e,r,n)}function Vm(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Jk(t){if(typeof t=="function")return Vm(t)?1:0;if(t!=null){if(t=t.$$typeof,t===lm)return 11;if(t===cm)return 14}return 2}function Ws(t,e){var r=t.alternate;return r===null?(r=Ar(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Dd(t,e,r,n,a,i){var o=2;if(n=t,typeof t=="function")Vm(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case hi:return za(r.children,a,i,e);case om:o=8,a|=8;break;case bf:return t=Ar(12,r,e,a|2),t.elementType=bf,t.lanes=i,t;case vf:return t=Ar(13,r,e,a),t.elementType=vf,t.lanes=i,t;case Nf:return t=Ar(19,r,e,a),t.elementType=Nf,t.lanes=i,t;case My:return Qu(r,a,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Ry:o=10;break e;case Oy:o=9;break e;case lm:o=11;break e;case cm:o=14;break e;case gs:o=16,n=null;break e}throw Error(Z(130,t==null?t:typeof t,""))}return e=Ar(o,r,e,a),e.elementType=t,e.type=n,e.lanes=i,e}function za(t,e,r,n){return t=Ar(7,t,n,e),t.lanes=r,t}function Qu(t,e,r,n){return t=Ar(22,t,n,e),t.elementType=My,t.lanes=r,t.stateNode={isHidden:!1},t}function Hh(t,e,r){return t=Ar(6,t,null,e),t.lanes=r,t}function Vh(t,e,r){return e=Ar(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Yk(t,e,r,n,a){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=kh(0),this.expirationTimes=kh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=kh(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Gm(t,e,r,n,a,i,o,l,c){return t=new Yk(t,e,r,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Ar(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Sm(i),t}function qk(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ui,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function Cb(t){if(!t)return qs;t=t._reactInternals;e:{if(ri(t)!==t||t.tag!==1)throw Error(Z(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Jt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Z(171))}if(t.tag===1){var r=t.type;if(Jt(r))return Cw(t,r,e)}return e}function Db(t,e,r,n,a,i,o,l,c){return t=Gm(r,n,!0,t,a,i,o,l,c),t.context=Cb(null),r=t.current,n=Ot(),a=Qs(r),i=Gn(n,a),i.callback=e??null,Gs(r,i,a),t.current.lanes=a,Pc(t,a,n),Yt(t,n),t}function Wu(t,e,r,n){var a=e.current,i=Ot(),o=Qs(a);return r=Cb(r),e.context===null?e.context=r:e.pendingContext=r,e=Gn(i,o),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Gs(a,e,o),t!==null&&(Qr(t,a,o,i),kd(t,a,o)),o}function du(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function zp(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function $m(t,e){zp(t,e),(t=t.alternate)&&zp(t,e)}function Zk(){return null}var Pb=typeof reportError=="function"?reportError:function(t){console.error(t)};function Qm(t){this._internalRoot=t}Ku.prototype.render=Qm.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Z(409));Wu(t,e,null,null)};Ku.prototype.unmount=Qm.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ja(function(){Wu(null,t,null,null)}),e[Jn]=null}};function Ku(t){this._internalRoot=t}Ku.prototype.unstable_scheduleHydration=function(t){if(t){var e=ow();t={blockedOn:null,target:t,priority:e};for(var r=0;r<xs.length&&e!==0&&e<xs[r].priority;r++);xs.splice(r,0,t),r===0&&cw(t)}};function Wm(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Ju(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Hp(){}function Xk(t,e,r,n,a){if(a){if(typeof n=="function"){var i=n;n=function(){var d=du(o);i.call(d)}}var o=Db(e,n,t,0,null,!1,!1,"",Hp);return t._reactRootContainer=o,t[Jn]=o.current,Ql(t.nodeType===8?t.parentNode:t),Ja(),o}for(;a=t.lastChild;)t.removeChild(a);if(typeof n=="function"){var l=n;n=function(){var d=du(c);l.call(d)}}var c=Gm(t,0,!1,null,null,!1,!1,"",Hp);return t._reactRootContainer=c,t[Jn]=c.current,Ql(t.nodeType===8?t.parentNode:t),Ja(function(){Wu(e,c,r,n)}),c}function Yu(t,e,r,n,a){var i=r._reactRootContainer;if(i){var o=i;if(typeof a=="function"){var l=a;a=function(){var c=du(o);l.call(c)}}Wu(e,o,t,a)}else o=Xk(r,e,t,a,n);return du(o)}aw=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=fl(e.pendingLanes);r!==0&&(hm(e,r|1),Yt(e,Ze()),!(Ae&6)&&(Io=Ze()+500,ra()))}break;case 13:Ja(function(){var n=Yn(t,1);if(n!==null){var a=Ot();Qr(n,t,1,a)}}),$m(t,1)}};fm=function(t){if(t.tag===13){var e=Yn(t,134217728);if(e!==null){var r=Ot();Qr(e,t,134217728,r)}$m(t,134217728)}};iw=function(t){if(t.tag===13){var e=Qs(t),r=Yn(t,e);if(r!==null){var n=Ot();Qr(r,t,e,n)}$m(t,e)}};ow=function(){return Te};lw=function(t,e){var r=Te;try{return Te=t,e()}finally{Te=r}};Tf=function(t,e,r){switch(e){case"input":if(Af(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var a=Uu(n);if(!a)throw Error(Z(90));Fy(n),Af(n,a)}}}break;case"textarea":zy(t,r);break;case"select":e=r.value,e!=null&&Ci(t,!!r.multiple,e,!1)}};Ky=Um;Jy=Ja;var ej={usingClientEntryPoint:!1,Events:[Tc,pi,Uu,Qy,Wy,Um]},ll={findFiberByHostInstance:ga,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},tj={bundleType:ll.bundleType,version:ll.version,rendererPackageName:ll.rendererPackageName,rendererConfig:ll.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:rs.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Zy(t),t===null?null:t.stateNode},findFiberByHostInstance:ll.findFiberByHostInstance||Zk,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var id=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!id.isDisabled&&id.supportsFiber)try{Ou=id.inject(tj),yn=id}catch{}}dr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ej;dr.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Wm(e))throw Error(Z(200));return qk(t,e,null,r)};dr.createRoot=function(t,e){if(!Wm(t))throw Error(Z(299));var r=!1,n="",a=Pb;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(a=e.onRecoverableError)),e=Gm(t,1,!1,null,null,r,!1,n,a),t[Jn]=e.current,Ql(t.nodeType===8?t.parentNode:t),new Qm(e)};dr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Z(188)):(t=Object.keys(t).join(","),Error(Z(268,t)));return t=Zy(e),t=t===null?null:t.stateNode,t};dr.flushSync=function(t){return Ja(t)};dr.hydrate=function(t,e,r){if(!Ju(e))throw Error(Z(200));return Yu(null,t,e,!0,r)};dr.hydrateRoot=function(t,e,r){if(!Wm(t))throw Error(Z(405));var n=r!=null&&r.hydratedSources||null,a=!1,i="",o=Pb;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),e=Db(e,null,t,1,r??null,a,!1,i,o),t[Jn]=e.current,Ql(t),n)for(t=0;t<n.length;t++)r=n[t],a=r._getVersion,a=a(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,a]:e.mutableSourceEagerHydrationData.push(r,a);return new Ku(e)};dr.render=function(t,e,r){if(!Ju(e))throw Error(Z(200));return Yu(null,t,e,!1,r)};dr.unmountComponentAtNode=function(t){if(!Ju(t))throw Error(Z(40));return t._reactRootContainer?(Ja(function(){Yu(null,null,t,!1,function(){t._reactRootContainer=null,t[Jn]=null})}),!0):!1};dr.unstable_batchedUpdates=Um;dr.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Ju(r))throw Error(Z(200));if(t==null||t._reactInternals===void 0)throw Error(Z(38));return Yu(t,e,r,!1,n)};dr.version="18.3.1-next-f1338f8080-20240426";function Ib(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Ib)}catch(t){console.error(t)}}Ib(),Iy.exports=dr;var rj=Iy.exports,Tb,Vp=rj;Tb=Vp.createRoot,Vp.hydrateRoot;/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var nj={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sj=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),re=(t,e)=>{const r=_.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:l="",children:c,...d},h)=>_.createElement("svg",{ref:h,...nj,width:a,height:a,stroke:n,strokeWidth:o?Number(i)*24/Number(a):i,className:["lucide",`lucide-${sj(t)}`,l].join(" "),...d},[...e.map(([u,f])=>_.createElement(u,f)),...Array.isArray(c)?c:[c]]));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const To=re("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gr=re("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hn=re("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gh=re("Anchor",[["path",{d:"M12 22V8",key:"qkxhtm"}],["path",{d:"M5 12H2a10 10 0 0 0 20 0h-3",key:"1hv3nh"}],["circle",{cx:"12",cy:"5",r:"3",key:"rqqgnr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aj=re("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yo=re("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _b=re("ArrowRightLeft",[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zn=re("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ij=re("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pl=re("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gp=re("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bb=re("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Km=re("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Il=re("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=re("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $p=re("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=re("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oj=re("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qu=re("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pt=re("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qp=re("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lj=re("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wr=re("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rb=re("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ob=re("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cj=re("Droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _o=re("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mb=re("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ha=re("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dj=re("Factory",[["path",{d:"M2 20a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8l-7 5V8l-7 5V4a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"159hny"}],["path",{d:"M17 18h1",key:"uldtlt"}],["path",{d:"M12 18h1",key:"s9uhes"}],["path",{d:"M7 18h1",key:"1neino"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bo=re("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u0=re("FileJson",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qo=re("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bc=re("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uj=re("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hj=re("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tl=re("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fj=re("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mj=re("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gj=re("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ro=re("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h0=re("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tc=re("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wp=re("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jm=re("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pj=re("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xj=re("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yj=re("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wj=re("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lb=re("Maximize",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bj=re("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=re("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ym=re("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fb=re("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rc=re("Recycle",[["path",{d:"M7 19H4.815a1.83 1.83 0 0 1-1.57-.881 1.785 1.785 0 0 1-.004-1.784L7.196 9.5",key:"x6z5xu"}],["path",{d:"M11 19h8.203a1.83 1.83 0 0 0 1.556-.89 1.784 1.784 0 0 0 0-1.775l-1.226-2.12",key:"1x4zh5"}],["path",{d:"m14 16-3 3 3 3",key:"f6jyew"}],["path",{d:"M8.293 13.596 7.196 9.5 3.1 10.598",key:"wf1obh"}],["path",{d:"m9.344 5.811 1.093-1.892A1.83 1.83 0 0 1 11.985 3a1.784 1.784 0 0 1 1.546.888l3.943 6.843",key:"9tzpgr"}],["path",{d:"m13.378 9.633 4.096 1.098 1.097-4.096",key:"1oe83g"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uu=re("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vj=re("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sr=re("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nj=re("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kj=re("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kp=re("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mt=re("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ub=re("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rc=re("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jj=re("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aj=re("Thermometer",[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ej=re("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sj=re("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qm=re("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zm=re("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cj=re("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _l=re("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dj=re("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pj=re("Volume2",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07",key:"ltjumu"}],["path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14",key:"1kegas"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zb=re("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hu=re("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=re("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pr=re("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);class Hb{constructor(){S(this,"dpps",new Map);S(this,"didDocuments",new Map);S(this,"relationships",new Map);S(this,"anchoringEvents",new Map);S(this,"credentials",new Map);S(this,"attestations",new Map);S(this,"specifications",new Map);S(this,"watchers",new Map);S(this,"alerts",new Map);S(this,"searchIndex",{byDID:new Map,byModel:new Map,byOwner:new Map,byType:new Map,byStatus:new Map,byProductType:new Map,fullText:new Map});S(this,"hierarchyCache",new Map);S(this,"CACHE_TTL",5*60*1e3);S(this,"idCounter",0)}generateId(){return`${Date.now()}-${this.idCounter++}`}addToIndex(e){this.searchIndex.byDID.set(e.did,e.id),this.searchIndex.byModel.has(e.model)||this.searchIndex.byModel.set(e.model,new Set),this.searchIndex.byModel.get(e.model).add(e.id),this.searchIndex.byOwner.has(e.owner)||this.searchIndex.byOwner.set(e.owner,new Set),this.searchIndex.byOwner.get(e.owner).add(e.id),this.searchIndex.byType.has(e.type)||this.searchIndex.byType.set(e.type,new Set),this.searchIndex.byType.get(e.type).add(e.id),this.searchIndex.byStatus.has(e.lifecycle_status)||this.searchIndex.byStatus.set(e.lifecycle_status,new Set),this.searchIndex.byStatus.get(e.lifecycle_status).add(e.id);const r=this.extractProductType(e);this.searchIndex.byProductType.has(r)||this.searchIndex.byProductType.set(r,new Set),this.searchIndex.byProductType.get(r).add(e.id),this.indexFullText(e)}indexFullText(e){const r=[e.did,e.model,e.owner,e.type,e.lifecycle_status,...Object.values(e.metadata).map(n=>String(n))].join(" ").toLowerCase().split(/\s+/);for(const n of r)n.length<2||(this.searchIndex.fullText.has(n)||this.searchIndex.fullText.set(n,new Set),this.searchIndex.fullText.get(n).add(e.id))}extractProductType(e){if(e.metadata.productType)return String(e.metadata.productType);const r=e.model.toLowerCase();return r.includes("window")?"window":r.includes("glass")?"glass":r.includes("frame")?"frame":r.includes("door")?"door":"unknown"}getCached(e){const r=this.hierarchyCache.get(e);return r?Date.now()-r.timestamp>r.ttl?(this.hierarchyCache.delete(e),null):r.data:null}setCache(e,r,n=this.CACHE_TTL){this.hierarchyCache.set(e,{data:r,timestamp:Date.now(),ttl:n})}invalidateCache(e){if(!e){this.hierarchyCache.clear();return}for(const r of this.hierarchyCache.keys())r.includes(e)&&this.hierarchyCache.delete(r)}async insertDPP(e){const r=this.generateId(),n=new Date().toISOString(),a={...e,id:r,created_at:n,updated_at:n};return this.dpps.set(r,a),this.addToIndex(a),this.invalidateCache(a.did),a}async getDPPById(e){return this.dpps.get(e)||null}async getDPPByDID(e){const r=this.searchIndex.byDID.get(e);return r&&this.dpps.get(r)||null}async getAllDPPs(){return Array.from(this.dpps.values())}async updateDPP(e,r){const n=this.dpps.get(e);if(!n)return null;const a={...n,...r,metadata:r.metadata?{...n.metadata,...r.metadata}:n.metadata,updated_at:new Date().toISOString()};return this.dpps.set(e,a),(r.did||r.model||r.owner||r.type||r.lifecycle_status||r.metadata)&&this.addToIndex(a),this.invalidateCache(a.did),a}async searchDPPs(e){let r=new Set(Array.from(this.dpps.keys()));if(e.type){const d=this.searchIndex.byType.get(e.type);d?r=new Set([...r].filter(h=>d.has(h))):r.clear()}if(e.productType){const d=this.searchIndex.byProductType.get(e.productType);d?r=new Set([...r].filter(h=>d.has(h))):r.clear()}if(e.componentSubType){const d=this.searchIndex.byProductType.get(e.componentSubType);d?r=new Set([...r].filter(h=>d.has(h))):r.clear()}if(e.status){const d=this.searchIndex.byStatus.get(e.status);d?r=new Set([...r].filter(h=>d.has(h))):r.clear()}if(e.owner){const d=this.searchIndex.byOwner.get(e.owner);d?r=new Set([...r].filter(h=>d.has(h))):r.clear()}if(e.model){const d=this.searchIndex.byModel.get(e.model);d?r=new Set([...r].filter(h=>d.has(h))):r.clear()}if(e.text){const d=e.text.toLowerCase().split(/\s+/),h=new Set;for(const u of d){const f=this.searchIndex.fullText.get(u);f&&f.forEach(g=>h.add(g))}h.size>0?r=new Set([...r].filter(u=>h.has(u))):d.length>0&&r.clear()}const n=r.size,a=Array.from(r),i=e.offset||0,o=e.limit||50;return{dpps:a.slice(i,i+o).map(d=>this.dpps.get(d)).filter(d=>d!==void 0),total:n}}async getFullHierarchy(e,r=10){const n=`hierarchy:${e}:${r}`,a=this.getCached(n);if(a)return a;const i=await this.getDPPByDID(e);if(!i)return null;const o={dpp:i,children:await this.getChildrenRecursive(e,r,0),depth:0};return this.setCache(n,o),o}async getChildrenRecursive(e,r,n){if(n>=r)return[];const a=Array.from(this.relationships.values()).filter(o=>o.parent_did===e).sort((o,l)=>o.position-l.position),i=[];for(const o of a){const l=await this.getDPPByDID(o.child_did);l&&i.push({dpp:l,relationship:o,children:await this.getChildrenRecursive(o.child_did,r,n+1),depth:n+1})}return i}async getAncestryPath(e){const r=[];let n=e;for(;n;){const a=await this.getDPPByDID(n);if(!a)break;r.unshift(a),n=a.parent_did}return r}async insertRelationship(e){const r=this.generateId(),n=new Date().toISOString(),a={...e,id:r,created_at:n,updated_at:n};return this.relationships.set(r,a),this.invalidateCache(e.parent_did),this.invalidateCache(e.child_did),a}async getRelationshipsByParent(e){return Array.from(this.relationships.values()).filter(r=>r.parent_did===e).sort((r,n)=>r.position-n.position)}async getRelationshipsByChild(e){return Array.from(this.relationships.values()).filter(r=>r.child_did===e)}async insertDIDDocument(e){const r=this.generateId(),n=new Date().toISOString(),a={...e,id:r,created_at:n,updated_at:n};return this.didDocuments.set(r,a),a}async getDIDDocumentByDID(e){return Array.from(this.didDocuments.values()).find(r=>r.did===e)||null}async insertAnchoringEvent(e){const r=this.generateId(),n=new Date().toISOString(),a={...e,id:r,timestamp:n};return this.anchoringEvents.set(r,a),a}async getAnchoringEventsByDID(e){return Array.from(this.anchoringEvents.values()).filter(r=>r.did===e)}async insertCredential(e){const r=this.generateId(),n={...e,id:r,created_at:new Date().toISOString()};return this.credentials.set(r,n),n}async getCredentialsByDPPId(e){return Array.from(this.credentials.values()).filter(r=>r.dpp_id===e)}async insertAttestation(e){const r=this.generateId(),n=new Date().toISOString(),a={...e,id:r,timestamp:n,created_at:n};return this.attestations.set(r,a),a}async updateAttestation(e,r){const n=this.attestations.get(e);if(!n)return null;const a={...n,...r};return this.attestations.set(e,a),a}async getAttestationsByDID(e){return Array.from(this.attestations.values()).filter(r=>r.did===e)}async insertSpecification(e){const r=this.generateId(),n=new Date().toISOString(),a={...e,id:r,created_at:n,updated_at:n};return this.specifications.set(r,a),a}async getSpecificationsByDPPId(e){return Array.from(this.specifications.values()).filter(r=>r.dpp_id===e)}async insertWatcher(e){const r=this.generateId(),n={...e,id:r,created_at:new Date().toISOString()};return this.watchers.set(r,n),n}async getAllWatchers(){return Array.from(this.watchers.values())}async insertAlert(e){const r=this.generateId(),n={...e,id:r,created_at:new Date().toISOString()};return this.alerts.set(r,n),n}async getAlertsByWatcherId(e){return Array.from(this.alerts.values()).filter(r=>r.watcher_id===e)}async getAlertsByWatcherDID(e){return Array.from(this.alerts.values()).filter(r=>r.watcher_did===e)}async bulkInsertDPPs(e){const r=[];for(const n of e)r.push(await this.insertDPP(n));return r}async clearAll(){this.dpps.clear(),this.didDocuments.clear(),this.relationships.clear(),this.anchoringEvents.clear(),this.credentials.clear(),this.attestations.clear(),this.specifications.clear(),this.watchers.clear(),this.alerts.clear(),this.searchIndex={byDID:new Map,byModel:new Map,byOwner:new Map,byType:new Map,byStatus:new Map,byProductType:new Map,fullText:new Map},this.invalidateCache(),this.idCounter=0}async getStats(){const e=Array.from(this.dpps.values());return{totalDPPs:e.length,mainProducts:e.filter(r=>r.type==="main").length,components:e.filter(r=>r.type==="component").length,byProductType:Object.fromEntries(Array.from(this.searchIndex.byProductType.entries()).map(([r,n])=>[r,n.size])),byStatus:Object.fromEntries(Array.from(this.searchIndex.byStatus.entries()).map(([r,n])=>[r,n.size]))}}}const te=new Hb,Xm=Object.freeze(Object.defineProperty({__proto__:null,EnhancedDataStore:Hb,enhancedDB:te},Symbol.toStringTag,{value:"Module"})),nc={window:{id:"window",name:"Window",category:"main",version:"1.0.0",description:"Complete window assembly with frame and glazing",color:"#1E40AF",properties:[{key:"dimensions",label:"Dimensions",type:"object",required:!0,description:"Width and height in mm"},{key:"weight",label:"Weight (kg)",type:"number",required:!0,unit:"kg"},{key:"productionDate",label:"Production Date",type:"date",required:!0},{key:"batch",label:"Batch Number",type:"string",required:!1}],componentSlots:[{type:"glazing",label:"Glazing Unit",minQuantity:1,maxQuantity:1,required:!0,allowedTypes:["glass","glazing-unit"]},{type:"frame",label:"Frame",minQuantity:1,maxQuantity:1,required:!0,allowedTypes:["frame"]},{type:"hardware",label:"Hardware",minQuantity:0,maxQuantity:10,required:!1,allowedTypes:["handle","hinge","lock"]}],credentials:[{type:"QualityCertificate",label:"Quality Certificate",issuerTypes:["certification-body"],required:!0,expiryDays:1825,properties:[{key:"certificateNumber",label:"Certificate Number",type:"string",required:!0},{key:"testResults",label:"Test Results",type:"object",required:!0}]},{type:"SustainabilityCredential",label:"Sustainability Assessment",issuerTypes:["environmental-assessor"],required:!1,properties:[{key:"carbonFootprint",label:"Carbon Footprint",type:"object",required:!0},{key:"recycledContent",label:"Recycled Content %",type:"number",required:!0}]}],lifecycleStages:["manufacturing","assembly","quality-check","installation","maintenance","end-of-life"],ui:{listView:{primaryFields:["model","dimensions","productionDate"],secondaryFields:["batch","weight"]}}},glass:{id:"glass",name:"Glass Panel",category:"component",version:"1.0.0",description:"Glass panel for glazing",color:"#7DD3FC",properties:[{key:"thickness",label:"Thickness (mm)",type:"number",required:!0,unit:"mm"},{key:"uValue",label:"U-Value",type:"number",required:!0,unit:"W/mK"},{key:"coating",label:"Coating Type",type:"string",required:!1,validation:{enum:["Low-E","Reflective","Tinted","Clear"]}},{key:"productionDate",label:"Production Date",type:"date",required:!0}],componentSlots:[],credentials:[{type:"ThermalPerformanceCertificate",label:"Thermal Performance",issuerTypes:["testing-lab"],required:!0,properties:[{key:"uValue",label:"U-Value",type:"number",required:!0},{key:"solarHeatGainCoefficient",label:"SHGC",type:"number",required:!0}]}],lifecycleStages:["manufacturing","quality-check","transport","installation"],ui:{listView:{primaryFields:["model","thickness","uValue"],secondaryFields:["coating","productionDate"]}}},frame:{id:"frame",name:"Window Frame",category:"component",version:"1.0.0",description:"Frame structure for window",color:"#8B5CF6",properties:[{key:"material",label:"Material",type:"string",required:!0,validation:{enum:["Aluminum","UPVC","Wood","Composite"]}},{key:"finish",label:"Surface Finish",type:"string",required:!0},{key:"thermalBreak",label:"Thermal Break",type:"boolean",required:!0},{key:"productionDate",label:"Production Date",type:"date",required:!0}],componentSlots:[],credentials:[{type:"StructuralCertificate",label:"Structural Integrity",issuerTypes:["testing-lab"],required:!0,properties:[{key:"loadCapacity",label:"Load Capacity",type:"number",required:!0},{key:"windResistance",label:"Wind Resistance",type:"string",required:!0}]}],lifecycleStages:["manufacturing","quality-check","transport","installation"],ui:{listView:{primaryFields:["model","material","thermalBreak"],secondaryFields:["finish","productionDate"]}}}};function f0(t){return nc[t]||null}function Ij({onFilterChange:t,stats:e}){const[r,n]=_.useState({text:"",type:"all",productType:"",componentSubType:"",status:"",owner:"",sortBy:"date",sortOrder:"desc"}),[a,i]=_.useState(!1);_.useEffect(()=>{const d=setTimeout(()=>{t(r)},300);return()=>clearTimeout(d)},[r,t]);const o=(d,h)=>{n(u=>({...u,[d]:h}))},l=()=>{n({text:"",type:"all",productType:"",componentSubType:"",status:"",owner:"",sortBy:"date",sortOrder:"desc"})},c=Object.entries(r).filter(([d,h])=>d!=="text"&&d!=="sortBy"&&d!=="sortOrder"&&h&&h!=="all").length;return s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-4 space-y-4 transition-colors",children:[s.jsxs("div",{className:"relative",children:[s.jsx(Sr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400 dark:text-gray-500"}),s.jsx("input",{type:"text",value:r.text,onChange:d=>o("text",d.target.value),placeholder:"Search by model, dimensions, batch number...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 transition-colors"})]}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Type:"}),["all","main","component"].map(d=>s.jsx("button",{onClick:()=>{o("type",d),d!=="component"&&o("componentSubType","")},className:`px-3 py-1 rounded-full text-sm font-medium transition-colors ${r.type===d?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:d==="all"?"All":d==="main"?"Main":"Component"},d))]}),r.type==="component"&&s.jsxs("div",{className:"flex items-center gap-2 pl-4 border-l border-gray-300 dark:border-gray-600",children:[s.jsxs("button",{onClick:()=>o("componentSubType","glass"),className:`flex items-center gap-1.5 px-3 py-1 rounded-full text-sm font-medium transition-colors ${r.componentSubType==="glass"?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:[s.jsx(Rc,{className:"w-3.5 h-3.5"}),"Glass"]}),s.jsxs("button",{onClick:()=>o("componentSubType","frame"),className:`flex items-center gap-1.5 px-3 py-1 rounded-full text-sm font-medium transition-colors ${r.componentSubType==="frame"?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:[s.jsx(Lb,{className:"w-3.5 h-3.5"}),"Frame"]}),r.componentSubType&&s.jsx("button",{onClick:()=>o("componentSubType",""),className:"flex items-center gap-1 px-2 py-1 text-xs text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200",children:s.jsx(Pr,{className:"w-3 h-3"})})]}),s.jsxs("button",{onClick:()=>i(!a),className:"ml-auto flex items-center gap-1 px-3 py-1 text-sm font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white transition-colors",children:[s.jsx(Bc,{className:"w-4 h-4"}),"Advanced",c>0&&s.jsx("span",{className:"ml-1 px-2 py-0.5 bg-blue-600 text-white rounded-full text-xs",children:c}),s.jsx(lt,{className:`w-4 h-4 transition-transform ${a?"rotate-180":""}`})]}),c>0&&s.jsxs("button",{onClick:l,className:"flex items-center gap-1 px-3 py-1 text-sm text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300 transition-colors",children:[s.jsx(Pr,{className:"w-4 h-4"}),"Remove filters"]})]}),a&&s.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Product Type"}),s.jsxs("select",{value:r.productType,onChange:d=>o("productType",d.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white transition-colors",children:[s.jsx("option",{value:"",children:"All types"}),Object.keys(nc).map(d=>s.jsxs("option",{value:d,children:[nc[d].name,(e==null?void 0:e.byProductType[d])&&` (${e.byProductType[d]})`]},d))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Lifecycle Status"}),s.jsxs("select",{value:r.status,onChange:d=>o("status",d.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white transition-colors",children:[s.jsx("option",{value:"",children:"All Status"}),s.jsx("option",{value:"active",children:"Active"}),s.jsx("option",{value:"installed",children:"Installed"}),s.jsx("option",{value:"storage",children:"Storage"}),s.jsx("option",{value:"archived",children:"Archived"}),s.jsx("option",{value:"manufactured",children:"Manufactured"}),s.jsx("option",{value:"in_transit",children:"In Transit"}),s.jsx("option",{value:"maintenance",children:"Maintenance"}),s.jsx("option",{value:"end_of_life",children:"End of Life"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Owner"}),s.jsx("input",{type:"text",value:r.owner,onChange:d=>o("owner",d.target.value),placeholder:"Filter by owner DID...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 transition-colors"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Sort By"}),s.jsxs("select",{value:r.sortBy,onChange:d=>o("sortBy",d.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white transition-colors",children:[s.jsx("option",{value:"date",children:"Date Created"}),s.jsx("option",{value:"name",children:"Product Name"}),s.jsx("option",{value:"trustScore",children:"Trust Score"}),s.jsx("option",{value:"warranty",children:"Warranty Status"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Sort Order"}),s.jsxs("select",{value:r.sortOrder,onChange:d=>o("sortOrder",d.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white transition-colors",children:[s.jsx("option",{value:"desc",children:"Newest First"}),s.jsx("option",{value:"asc",children:"Oldest First"})]})]})]})]})]})}const Vb=_.createContext(void 0),Tj={Recycler:"did:webvh:example.com:roles:recycler-001",Manufacturer:"did:webvh:example.com:organizations:window-manufacturer","Manufacturer A":"did:webvh:glass-solutions.com:organizations:manufacturer","Manufacturer B":"did:webvh:frame-masters.com:organizations:manufacturer",Supervisor:"did:webvh:example.com:roles:supervisor-001",Witness:"did:webvh:example.com:witnesses:witness-node-001",Watcher:"did:webvh:example.com:watchers:watcher-node-001",Resolver:"did:webvh:example.com:resolvers:resolver-node-001",Consumer:"did:webvh:example.com:consumers:public-user"},_j={Recycler:["basic","materials","dimensions","weight","hazardous"],Manufacturer:["basic","materials","lifecycle","operations","manufacturing","suppliers","costs"],"Manufacturer A":["basic","materials","lifecycle","operations","manufacturing","suppliers","costs"],"Manufacturer B":["basic","materials","lifecycle","operations","manufacturing","suppliers","costs"],Supervisor:["basic","materials","lifecycle","operations","manufacturing","suppliers","costs","sensitive","all"],Witness:["basic","operations","did-events"],Watcher:["basic","operations","did-events","monitoring","alerts"],Resolver:["basic","operations","did-events","history","verification"],Consumer:["basic","origin","maintenance","warranty"]};function Bj({children:t}){const[e,r]=_.useState("Manufacturer A"),n=o=>{r(o)},a=o=>{const l=_j[e];return l.includes("all")||l.includes(o)},i=Tj[e];return s.jsx(Vb.Provider,{value:{currentRole:e,currentRoleDID:i,setRole:n,canSeeField:a},children:t})}function Xt(){const t=_.useContext(Vb);if(t===void 0)throw new Error("useRole must be used within a RoleProvider");return t}const Jp={batch:"operations",productionDate:"operations",custodian:"operations"};function Gb({dpp:t,onClick:e,viewMode:r}){var g,b,y,k;const{canSeeField:n}=Xt(),a=t.metadata.productType||"unknown",i=f0(a),o=(i==null?void 0:i.color)||"#6B7280",l=t.type==="main",c=((b=(g=i==null?void 0:i.ui)==null?void 0:g.listView)==null?void 0:b.primaryFields)||["model"],d=((k=(y=i==null?void 0:i.ui)==null?void 0:y.listView)==null?void 0:k.secondaryFields)||[],h=c.filter(m=>{const x=Jp[m];return!x||n(x)}),u=d.filter(m=>{const x=Jp[m];return!x||n(x)}),f=m=>{const x=m==="model"?t.model:t.metadata[m];if(!x)return null;const p=i==null?void 0:i.properties.find(A=>A.key===m),v=(p==null?void 0:p.label)||(m==="model"?"Model":m);let N="";return typeof x=="object"&&x!==null?"width"in x&&"height"in x?N=`${x.width}mm x ${x.height}mm`:N=JSON.stringify(x):N=String(x),s.jsxs("div",{className:"text-sm",children:[s.jsxs("span",{className:"text-gray-500 dark:text-gray-400",children:[v,":"]})," ",s.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:N})]},m)};return r==="list"?s.jsxs("button",{onClick:m=>{console.log("DPPCard (list) clicked:",t.did,"type:",t.type),m.stopPropagation(),e()},className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600 rounded-lg p-4 transition-all hover:shadow-md text-left flex items-center gap-4",children:[s.jsx("div",{className:"p-3 rounded-lg flex-shrink-0",style:{backgroundColor:`${o}20`},children:s.jsx(Re,{className:"w-6 h-6",style:{color:o}})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-start justify-between gap-4 mb-2",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white truncate",children:t.model}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 font-mono truncate",children:t.did})]}),s.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[l&&s.jsx("span",{className:"px-2 py-1 bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 text-xs font-semibold rounded-full",children:"MAIN"}),s.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-full",style:{backgroundColor:`${o}20`,color:o},children:(i==null?void 0:i.name)||a}),s.jsx("span",{className:"px-2 py-1 bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 text-xs font-medium rounded-full capitalize",children:t.lifecycle_status})]})]}),s.jsx("div",{className:"flex items-center gap-4 text-sm text-gray-600 dark:text-gray-400",children:h.map(f)})]}),s.jsx(qu,{className:"w-5 h-5 text-gray-400 dark:text-gray-500 flex-shrink-0"})]}):s.jsxs("button",{onClick:m=>{console.log("DPPCard clicked:",t.did,"type:",t.type),m.stopPropagation(),e()},className:"w-full bg-white dark:bg-gray-800 border-2 hover:border-gray-300 dark:hover:border-gray-600 rounded-lg p-5 transition-all hover:shadow-lg text-left group",style:{borderColor:l?o:void 0},children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsx("div",{className:"p-3 rounded-lg group-hover:scale-110 transition-transform",style:{backgroundColor:`${o}20`},children:s.jsx(Re,{className:"w-7 h-7",style:{color:o}})}),s.jsxs("div",{className:"flex flex-col items-end gap-1",children:[l&&s.jsx("span",{className:"px-3 py-1 bg-gradient-to-r from-blue-500 to-blue-600 text-white text-xs font-bold rounded-full shadow-sm",children:"MAIN PRODUCT"}),s.jsx("span",{className:"px-3 py-1 text-xs font-semibold rounded-full",style:{backgroundColor:`${o}20`,color:o},children:(i==null?void 0:i.name)||a})]})]}),s.jsx("h3",{className:"font-bold text-lg text-gray-900 dark:text-white mb-2 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors",children:t.model}),s.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded p-2 mb-3 border border-gray-200 dark:border-gray-600 transition-colors",children:[s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"DID"}),s.jsx("p",{className:"text-xs font-mono text-gray-700 dark:text-gray-300 break-all leading-relaxed",children:t.did})]}),s.jsx("div",{className:"space-y-2 mb-4",children:h.map(f)}),u.length>0&&s.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:u.map(m=>{const x=t.metadata[m];if(!x)return null;const p=i==null?void 0:i.properties.find(N=>N.key===m);let v=String(x);return p!=null&&p.unit&&(v+=` ${p.unit}`),s.jsx("span",{className:"px-2 py-1 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 text-xs rounded transition-colors",children:v},m)})}),s.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200 dark:border-gray-700",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[t.lifecycle_status==="active"?s.jsx(fe,{className:"w-4 h-4 text-green-600 dark:text-green-400"}):s.jsx(Gr,{className:"w-4 h-4 text-yellow-600 dark:text-yellow-400"}),s.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 capitalize",children:t.lifecycle_status})]}),s.jsxs("div",{className:"flex items-center gap-1 text-blue-600 dark:text-blue-400 group-hover:gap-2 transition-all",children:[s.jsx("span",{className:"text-sm font-medium",children:"Details"}),s.jsx(_o,{className:"w-4 h-4"})]})]})]})}const Rj="modulepreload",Oj=function(t){return"/"+t},Yp={},Bi=function(e,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=Promise.allSettled(r.map(c=>{if(c=Oj(c),c in Yp)return;Yp[c]=!0;const d=c.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${h}`))return;const u=document.createElement("link");if(u.rel=d?"stylesheet":Rj,d||(u.as="script"),u.crossOrigin="",u.href=c,l&&u.setAttribute("nonce",l),document.head.appendChild(u),d)return new Promise((f,g)=>{u.addEventListener("load",f),u.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return a.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})},It={BASE_URL:"http://localhost:3000/api",IDENTITY:{CREATE:"/products/create",GET:"/identity",LIST:"/identities",EVENTS:"/events"},WITNESS:{ATTEST:"/witness/attest",BATCHES:"/witness/batches",PROOF:"/witness/proof"},WATCHER:{AUDITS:"/watcher/audits",STATUS:"/watcher/status"},BLOCKCHAIN:{RPC_URL:"http://127.0.0.1:8545",EXPLORER_URL:"https://sepolia.etherscan.io"}};function Mj(t){return`${It.BASE_URL}${t}`}function $b(t){return`${It.BLOCKCHAIN.EXPLORER_URL}/tx/${t}`}function Zu(t){return`${It.BLOCKCHAIN.EXPLORER_URL}/block/${t}`}async function Hr(t,e={}){const r=Mj(t),n=await fetch(r,{...e,headers:{"Content-Type":"application/json",...e.headers}});if(!n.ok){const a=await n.json().catch(()=>({error:`HTTP ${n.status}: ${n.statusText}`}));throw new Error(a.error||"API request failed")}return n.json()}const Lj={async createProduct(t){return Hr(It.IDENTITY.CREATE,{method:"POST",body:JSON.stringify(t)})},async getIdentity(t){return Hr(`${It.IDENTITY.GET}/${t}`)},async listIdentities(){return Hr(It.IDENTITY.LIST)},async addEvent(t){return Hr(`${It.IDENTITY.EVENTS}/add`,{method:"POST",body:JSON.stringify(t)})},async getEvents(t){return Hr(`${It.IDENTITY.EVENTS}?did=${encodeURIComponent(t)}`)}},Fj={async requestAttestation(t){return Hr(It.WITNESS.ATTEST,{method:"POST",body:JSON.stringify(t)})},async getBatches(){return Hr(It.WITNESS.BATCHES)},async getMerkleProof(t){return Hr(`${It.WITNESS.PROOF}/${t}`)}},Uj={async getAudits(t){const e=t?`?did=${encodeURIComponent(t)}`:"";return Hr(`${It.WATCHER.AUDITS}${e}`)},async getStatus(){return Hr(It.WATCHER.STATUS)},async triggerAudit(t){return Hr(`${It.WATCHER.AUDITS}/trigger`,{method:"POST",body:JSON.stringify({did:t})})}},ns={identity:Lj,witness:Fj,watcher:Uj},zj="6.16.0";function Hj(t,e,r){const n=e.split("|").map(i=>i.trim());for(let i=0;i<n.length;i++)switch(e){case"any":return;case"bigint":case"boolean":case"number":case"string":if(typeof t===e)return}const a=new Error(`invalid value for type ${e}`);throw a.code="INVALID_ARGUMENT",a.argument=`value.${r}`,a.value=t,a}async function Dt(t){const e=Object.keys(t);return(await Promise.all(e.map(n=>Promise.resolve(t[n])))).reduce((n,a,i)=>(n[e[i]]=a,n),{})}function me(t,e,r){for(let n in e){let a=e[n];const i=r?r[n]:null;i&&Hj(a,i,n),Object.defineProperty(t,n,{enumerable:!0,value:a,writable:!1})}}function ki(t,e){if(t==null)return"null";if(e==null&&(e=new Set),typeof t=="object"){if(e.has(t))return"[Circular]";e.add(t)}if(Array.isArray(t))return"[ "+t.map(r=>ki(r,e)).join(", ")+" ]";if(t instanceof Uint8Array){const r="0123456789abcdef";let n="0x";for(let a=0;a<t.length;a++)n+=r[t[a]>>4],n+=r[t[a]&15];return n}if(typeof t=="object"&&typeof t.toJSON=="function")return ki(t.toJSON(),e);switch(typeof t){case"boolean":case"number":case"symbol":return t.toString();case"bigint":return BigInt(t).toString();case"string":return JSON.stringify(t);case"object":{const r=Object.keys(t);return r.sort(),"{ "+r.map(n=>`${ki(n,e)}: ${ki(t[n],e)}`).join(", ")+" }"}}return"[ COULD NOT SERIALIZE ]"}function mt(t,e){return t&&t.code===e}function eg(t){return mt(t,"CALL_EXCEPTION")}function Ve(t,e,r){let n=t;{const i=[];if(r){if("message"in r||"code"in r||"name"in r)throw new Error(`value will overwrite populated values: ${ki(r)}`);for(const o in r){if(o==="shortMessage")continue;const l=r[o];i.push(o+"="+ki(l))}}i.push(`code=${e}`),i.push(`version=${zj}`),i.length&&(t+=" ("+i.join(", ")+")")}let a;switch(e){case"INVALID_ARGUMENT":a=new TypeError(t);break;case"NUMERIC_FAULT":case"BUFFER_OVERRUN":a=new RangeError(t);break;default:a=new Error(t)}return me(a,{code:e}),r&&Object.assign(a,r),a.shortMessage==null&&me(a,{shortMessage:n}),a}function J(t,e,r,n){if(!t)throw Ve(e,r,n)}function P(t,e,r,n){J(t,e,"INVALID_ARGUMENT",{argument:r,value:n})}function Qb(t,e,r){r==null&&(r=""),r&&(r=": "+r),J(t>=e,"missing argument"+r,"MISSING_ARGUMENT",{count:t,expectedCount:e}),J(t<=e,"too many arguments"+r,"UNEXPECTED_ARGUMENT",{count:t,expectedCount:e})}["NFD","NFC","NFKD","NFKC"].reduce((t,e)=>{try{if("test".normalize(e)!=="test")throw new Error("bad");if(e==="NFD"&&"".normalize("NFD")!=="e")throw new Error("broken");t.push(e)}catch{}return t},[]);function Xu(t,e,r){if(r==null&&(r=""),t!==e){let n=r,a="new";r&&(n+=".",a+=" "+r),J(!1,`private constructor; use ${n}from* methods`,"UNSUPPORTED_OPERATION",{operation:a})}}function Wb(t,e,r){if(t instanceof Uint8Array)return r?new Uint8Array(t):t;if(typeof t=="string"&&t.length%2===0&&t.match(/^0x[0-9a-f]*$/i)){const n=new Uint8Array((t.length-2)/2);let a=2;for(let i=0;i<n.length;i++)n[i]=parseInt(t.substring(a,a+2),16),a+=2;return n}P(!1,"invalid BytesLike value",e||"value",t)}function xe(t,e){return Wb(t,e,!1)}function Tt(t,e){return Wb(t,e,!0)}function Me(t,e){return!(typeof t!="string"||!t.match(/^0x[0-9A-Fa-f]*$/)||typeof e=="number"&&t.length!==2+2*e||e===!0&&t.length%2!==0)}function tg(t){return Me(t,!0)||t instanceof Uint8Array}const qp="0123456789abcdef";function se(t){const e=xe(t);let r="0x";for(let n=0;n<e.length;n++){const a=e[n];r+=qp[(a&240)>>4]+qp[a&15]}return r}function He(t){return"0x"+t.map(e=>se(e).substring(2)).join("")}function Ri(t){return Me(t,!0)?(t.length-2)/2:xe(t).length}function Je(t,e,r){const n=xe(t);return r!=null&&r>n.length&&J(!1,"cannot slice beyond data bounds","BUFFER_OVERRUN",{buffer:n,length:n.length,offset:r}),se(n.slice(e??0,r??n.length))}function Kb(t,e,r){const n=xe(t);J(e>=n.length,"padding exceeds data length","BUFFER_OVERRUN",{buffer:new Uint8Array(n),length:e,offset:e+1});const a=new Uint8Array(e);return a.fill(0),r?a.set(n,e-n.length):a.set(n,0),se(a)}function Xn(t,e){return Kb(t,e,!0)}function Vj(t,e){return Kb(t,e,!1)}const Oc=BigInt(0),Vr=BigInt(1),ji=9007199254740991;function Gj(t,e){const r=eh(t,"value"),n=BigInt(ye(e,"width"));if(J(r>>n===Oc,"overflow","NUMERIC_FAULT",{operation:"fromTwos",fault:"overflow",value:t}),r>>n-Vr){const a=(Vr<<n)-Vr;return-((~r&a)+Vr)}return r}function Jb(t,e){let r=de(t,"value");const n=BigInt(ye(e,"width")),a=Vr<<n-Vr;if(r<Oc){r=-r,J(r<=a,"too low","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:t});const i=(Vr<<n)-Vr;return(~r&i)+Vr}else J(r<a,"too high","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:t});return r}function gl(t,e){const r=eh(t,"value"),n=BigInt(ye(e,"bits"));return r&(Vr<<n)-Vr}function de(t,e){switch(typeof t){case"bigint":return t;case"number":return P(Number.isInteger(t),"underflow",e||"value",t),P(t>=-ji&&t<=ji,"overflow",e||"value",t),BigInt(t);case"string":try{if(t==="")throw new Error("empty string");return t[0]==="-"&&t[1]!=="-"?-BigInt(t.substring(1)):BigInt(t)}catch(r){P(!1,`invalid BigNumberish string: ${r.message}`,e||"value",t)}}P(!1,"invalid BigNumberish value",e||"value",t)}function eh(t,e){const r=de(t,e);return J(r>=Oc,"unsigned value cannot be negative","NUMERIC_FAULT",{fault:"overflow",operation:"getUint",value:t}),r}const Zp="0123456789abcdef";function rg(t){if(t instanceof Uint8Array){let e="0x0";for(const r of t)e+=Zp[r>>4],e+=Zp[r&15];return BigInt(e)}return de(t)}function ye(t,e){switch(typeof t){case"bigint":return P(t>=-ji&&t<=ji,"overflow",e||"value",t),Number(t);case"number":return P(Number.isInteger(t),"underflow",e||"value",t),P(t>=-ji&&t<=ji,"overflow",e||"value",t),t;case"string":try{if(t==="")throw new Error("empty string");return ye(BigInt(t),e)}catch(r){P(!1,`invalid numeric string: ${r.message}`,e||"value",t)}}P(!1,"invalid numeric value",e||"value",t)}function $j(t){return ye(rg(t))}function Zs(t,e){const r=eh(t,"value");let n=r.toString(16);if(e==null)n.length%2&&(n="0"+n);else{const a=ye(e,"width");if(a===0&&r===Oc)return"0x";for(J(a*2>=n.length,`value exceeds width (${a} bytes)`,"NUMERIC_FAULT",{operation:"toBeHex",fault:"overflow",value:t});n.length<a*2;)n="0"+n}return"0x"+n}function rt(t,e){const r=eh(t,"value");if(r===Oc)return new Uint8Array(0);let n=r.toString(16);n.length%2&&(n="0"+n);const a=new Uint8Array(n.length/2);for(let i=0;i<a.length;i++){const o=i*2;a[i]=parseInt(n.substring(o,o+2),16)}return a}function zr(t){let e=se(tg(t)?t:rt(t)).substring(2);for(;e.startsWith("0");)e=e.substring(1);return e===""&&(e="0"),"0x"+e}const Xp="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";BigInt(0);const ex=BigInt(58);function Qj(t){const e=xe(t);let r=rg(e),n="";for(;r;)n=Xp[Number(r%ex)]+n,r/=ex;for(let a=0;a<e.length&&!e[a];a++)n=Xp[0]+n;return n}function Wj(t){t=atob(t);const e=new Uint8Array(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return xe(e)}function Kj(t){const e=xe(t);let r="";for(let n=0;n<e.length;n++)r+=String.fromCharCode(e[n]);return btoa(r)}var Li;class Yb{constructor(e,r,n){S(this,"filter");S(this,"emitter");U(this,Li);j(this,Li,r),me(this,{emitter:e,filter:n})}async removeListener(){w(this,Li)!=null&&await this.emitter.off(this.filter,w(this,Li))}}Li=new WeakMap;function Jj(t,e,r,n,a){P(!1,`invalid codepoint at offset ${e}; ${t}`,"bytes",r)}function qb(t,e,r,n,a){if(t==="BAD_PREFIX"||t==="UNEXPECTED_CONTINUE"){let i=0;for(let o=e+1;o<r.length&&r[o]>>6===2;o++)i++;return i}return t==="OVERRUN"?r.length-e-1:0}function Yj(t,e,r,n,a){return t==="OVERLONG"?(P(typeof a=="number","invalid bad code point for replacement","badCodepoint",a),n.push(a),0):(n.push(65533),qb(t,e,r))}const qj=Object.freeze({error:Jj,ignore:qb,replace:Yj});function Zj(t,e){e==null&&(e=qj.error);const r=xe(t,"bytes"),n=[];let a=0;for(;a<r.length;){const i=r[a++];if(!(i>>7)){n.push(i);continue}let o=null,l=null;if((i&224)===192)o=1,l=127;else if((i&240)===224)o=2,l=2047;else if((i&248)===240)o=3,l=65535;else{(i&192)===128?a+=e("UNEXPECTED_CONTINUE",a-1,r,n):a+=e("BAD_PREFIX",a-1,r,n);continue}if(a-1+o>=r.length){a+=e("OVERRUN",a-1,r,n);continue}let c=i&(1<<8-o-1)-1;for(let d=0;d<o;d++){let h=r[a];if((h&192)!=128){a+=e("MISSING_CONTINUE",a,r,n),c=null;break}c=c<<6|h&63,a++}if(c!==null){if(c>1114111){a+=e("OUT_OF_RANGE",a-1-o,r,n,c);continue}if(c>=55296&&c<=57343){a+=e("UTF16_SURROGATE",a-1-o,r,n,c);continue}if(c<=l){a+=e("OVERLONG",a-1-o,r,n,c);continue}n.push(c)}}return n}function $n(t,e){P(typeof t=="string","invalid string value","str",t);let r=[];for(let n=0;n<t.length;n++){const a=t.charCodeAt(n);if(a<128)r.push(a);else if(a<2048)r.push(a>>6|192),r.push(a&63|128);else if((a&64512)==55296){n++;const i=t.charCodeAt(n);P(n<t.length&&(i&64512)===56320,"invalid surrogate pair","str",t);const o=65536+((a&1023)<<10)+(i&1023);r.push(o>>18|240),r.push(o>>12&63|128),r.push(o>>6&63|128),r.push(o&63|128)}else r.push(a>>12|224),r.push(a>>6&63|128),r.push(a&63|128)}return new Uint8Array(r)}function Xj(t){return t.map(e=>e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode((e>>10&1023)+55296,(e&1023)+56320))).join("")}function fu(t,e){return Xj(Zj(t,e))}function Zb(t){async function e(r,n){J(n==null||!n.cancelled,"request cancelled before sending","CANCELLED");const a=r.url.split(":")[0].toLowerCase();J(a==="http"||a==="https",`unsupported protocol ${a}`,"UNSUPPORTED_OPERATION",{info:{protocol:a},operation:"request"}),J(a==="https"||!r.credentials||r.allowInsecureAuthentication,"insecure authorized connections unsupported","UNSUPPORTED_OPERATION",{operation:"request"});let i=null;const o=new AbortController,l=setTimeout(()=>{i=Ve("request timeout","TIMEOUT"),o.abort()},r.timeout);n&&n.addListener(()=>{i=Ve("request cancelled","CANCELLED"),o.abort()});const c=Object.assign({},t,{method:r.method,headers:new Headers(Array.from(r)),body:r.body||void 0,signal:o.signal});let d;try{d=await fetch(r.url,c)}catch(g){throw clearTimeout(l),i||g}clearTimeout(l);const h={};d.headers.forEach((g,b)=>{h[b.toLowerCase()]=g});const u=await d.arrayBuffer(),f=u==null?null:new Uint8Array(u);return{statusCode:d.status,statusMessage:d.statusText,headers:h,body:f}}return e}const eA=12,tA=250;let tx=Zb();const rA=new RegExp("^data:([^;:]*)?(;base64)?,(.*)$","i"),nA=new RegExp("^ipfs://(ipfs/)?(.*)$","i");let $h=!1;async function Xb(t,e){try{const r=t.match(rA);if(!r)throw new Error("invalid data");return new Ks(200,"OK",{"content-type":r[1]||"text/plain"},r[2]?Wj(r[3]):aA(r[3]))}catch{return new Ks(599,"BAD REQUEST (invalid data: URI)",{},null,new es(t))}}function ev(t){async function e(r,n){try{const a=r.match(nA);if(!a)throw new Error("invalid link");return new es(`${t}${a[2]}`)}catch{return new Ks(599,"BAD REQUEST (invalid IPFS URI)",{},null,new es(r))}}return e}const od={data:Xb,ipfs:ev("https://gateway.ipfs.io/ipfs/")},tv=new WeakMap;var va,ws;class sA{constructor(e){U(this,va);U(this,ws);j(this,va,[]),j(this,ws,!1),tv.set(e,()=>{if(!w(this,ws)){j(this,ws,!0);for(const r of w(this,va))setTimeout(()=>{r()},0);j(this,va,[])}})}addListener(e){J(!w(this,ws),"singal already cancelled","UNSUPPORTED_OPERATION",{operation:"fetchCancelSignal.addCancelListener"}),w(this,va).push(e)}get cancelled(){return w(this,ws)}checkSignal(){J(!this.cancelled,"cancelled","CANCELLED",{})}}va=new WeakMap,ws=new WeakMap;function ld(t){if(t==null)throw new Error("missing signal; should not happen");return t.checkSignal(),t}var Fi,Ui,Br,Cn,zi,Hi,at,rr,Dn,Na,ka,ja,sn,Rr,bs,Aa,pl;const Cu=class Cu{constructor(e){U(this,Aa);U(this,Fi);U(this,Ui);U(this,Br);U(this,Cn);U(this,zi);U(this,Hi);U(this,at);U(this,rr);U(this,Dn);U(this,Na);U(this,ka);U(this,ja);U(this,sn);U(this,Rr);U(this,bs);j(this,Hi,String(e)),j(this,Fi,!1),j(this,Ui,!0),j(this,Br,{}),j(this,Cn,""),j(this,zi,3e5),j(this,Rr,{slotInterval:tA,maxAttempts:eA}),j(this,bs,null)}get url(){return w(this,Hi)}set url(e){j(this,Hi,String(e))}get body(){return w(this,at)==null?null:new Uint8Array(w(this,at))}set body(e){if(e==null)j(this,at,void 0),j(this,rr,void 0);else if(typeof e=="string")j(this,at,$n(e)),j(this,rr,"text/plain");else if(e instanceof Uint8Array)j(this,at,e),j(this,rr,"application/octet-stream");else if(typeof e=="object")j(this,at,$n(JSON.stringify(e))),j(this,rr,"application/json");else throw new Error("invalid body")}hasBody(){return w(this,at)!=null}get method(){return w(this,Cn)?w(this,Cn):this.hasBody()?"POST":"GET"}set method(e){e==null&&(e=""),j(this,Cn,String(e).toUpperCase())}get headers(){const e=Object.assign({},w(this,Br));return w(this,Dn)&&(e.authorization=`Basic ${Kj($n(w(this,Dn)))}`),this.allowGzip&&(e["accept-encoding"]="gzip"),e["content-type"]==null&&w(this,rr)&&(e["content-type"]=w(this,rr)),this.body&&(e["content-length"]=String(this.body.length)),e}getHeader(e){return this.headers[e.toLowerCase()]}setHeader(e,r){w(this,Br)[String(e).toLowerCase()]=String(r)}clearHeaders(){j(this,Br,{})}[Symbol.iterator](){const e=this.headers,r=Object.keys(e);let n=0;return{next:()=>{if(n<r.length){const a=r[n++];return{value:[a,e[a]],done:!1}}return{value:void 0,done:!0}}}}get credentials(){return w(this,Dn)||null}setCredentials(e,r){P(!e.match(/:/),"invalid basic authentication username","username","[REDACTED]"),j(this,Dn,`${e}:${r}`)}get allowGzip(){return w(this,Ui)}set allowGzip(e){j(this,Ui,!!e)}get allowInsecureAuthentication(){return!!w(this,Fi)}set allowInsecureAuthentication(e){j(this,Fi,!!e)}get timeout(){return w(this,zi)}set timeout(e){P(e>=0,"timeout must be non-zero","timeout",e),j(this,zi,e)}get preflightFunc(){return w(this,Na)||null}set preflightFunc(e){j(this,Na,e)}get processFunc(){return w(this,ka)||null}set processFunc(e){j(this,ka,e)}get retryFunc(){return w(this,ja)||null}set retryFunc(e){j(this,ja,e)}get getUrlFunc(){return w(this,bs)||tx}set getUrlFunc(e){j(this,bs,e)}toString(){return`<FetchRequest method=${JSON.stringify(this.method)} url=${JSON.stringify(this.url)} headers=${JSON.stringify(this.headers)} body=${w(this,at)?se(w(this,at)):"null"}>`}setThrottleParams(e){e.slotInterval!=null&&(w(this,Rr).slotInterval=e.slotInterval),e.maxAttempts!=null&&(w(this,Rr).maxAttempts=e.maxAttempts)}send(){return J(w(this,sn)==null,"request already sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.send"}),j(this,sn,new sA(this)),ne(this,Aa,pl).call(this,0,rx()+this.timeout,0,this,new Ks(0,"",{},null,this))}cancel(){J(w(this,sn)!=null,"request has not been sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.cancel"});const e=tv.get(this);if(!e)throw new Error("missing signal; should not happen");e()}redirect(e){const r=this.url.split(":")[0].toLowerCase(),n=e.split(":")[0].toLowerCase();J(this.method==="GET"&&(r!=="https"||n!=="http")&&e.match(/^https?:/),"unsupported redirect","UNSUPPORTED_OPERATION",{operation:`redirect(${this.method} ${JSON.stringify(this.url)} => ${JSON.stringify(e)})`});const a=new Cu(e);return a.method="GET",a.allowGzip=this.allowGzip,a.timeout=this.timeout,j(a,Br,Object.assign({},w(this,Br))),w(this,at)&&j(a,at,new Uint8Array(w(this,at))),j(a,rr,w(this,rr)),a}clone(){const e=new Cu(this.url);return j(e,Cn,w(this,Cn)),w(this,at)&&j(e,at,w(this,at)),j(e,rr,w(this,rr)),j(e,Br,Object.assign({},w(this,Br))),j(e,Dn,w(this,Dn)),this.allowGzip&&(e.allowGzip=!0),e.timeout=this.timeout,this.allowInsecureAuthentication&&(e.allowInsecureAuthentication=!0),j(e,Na,w(this,Na)),j(e,ka,w(this,ka)),j(e,ja,w(this,ja)),j(e,Rr,Object.assign({},w(this,Rr))),j(e,bs,w(this,bs)),e}static lockConfig(){$h=!0}static getGateway(e){return od[e.toLowerCase()]||null}static registerGateway(e,r){if(e=e.toLowerCase(),e==="http"||e==="https")throw new Error(`cannot intercept ${e}; use registerGetUrl`);if($h)throw new Error("gateways locked");od[e]=r}static registerGetUrl(e){if($h)throw new Error("gateways locked");tx=e}static createGetUrlFunc(e){return Zb(e)}static createDataGateway(){return Xb}static createIpfsGatewayFunc(e){return ev(e)}};Fi=new WeakMap,Ui=new WeakMap,Br=new WeakMap,Cn=new WeakMap,zi=new WeakMap,Hi=new WeakMap,at=new WeakMap,rr=new WeakMap,Dn=new WeakMap,Na=new WeakMap,ka=new WeakMap,ja=new WeakMap,sn=new WeakMap,Rr=new WeakMap,bs=new WeakMap,Aa=new WeakSet,pl=async function(e,r,n,a,i){var h,u,f;if(e>=w(this,Rr).maxAttempts)return i.makeServerError("exceeded maximum retry limit");J(rx()<=r,"timeout","TIMEOUT",{operation:"request.send",reason:"timeout",request:a}),n>0&&await iA(n);let o=this.clone();const l=(o.url.split(":")[0]||"").toLowerCase();if(l in od){const g=await od[l](o.url,ld(w(a,sn)));if(g instanceof Ks){let b=g;if(this.processFunc){ld(w(a,sn));try{b=await this.processFunc(o,b)}catch(y){(y.throttle==null||typeof y.stall!="number")&&b.makeServerError("error in post-processing function",y).assertOk()}}return b}o=g}this.preflightFunc&&(o=await this.preflightFunc(o));const c=await this.getUrlFunc(o,ld(w(a,sn)));let d=new Ks(c.statusCode,c.statusMessage,c.headers,c.body,a);if(d.statusCode===301||d.statusCode===302){try{const g=d.headers.location||"";return ne(h=o.redirect(g),Aa,pl).call(h,e+1,r,0,a,d)}catch{}return d}else if(d.statusCode===429&&(this.retryFunc==null||await this.retryFunc(o,d,e))){const g=d.headers["retry-after"];let b=w(this,Rr).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return typeof g=="string"&&g.match(/^[1-9][0-9]*$/)&&(b=parseInt(g)),ne(u=o.clone(),Aa,pl).call(u,e+1,r,b,a,d)}if(this.processFunc){ld(w(a,sn));try{d=await this.processFunc(o,d)}catch(g){(g.throttle==null||typeof g.stall!="number")&&d.makeServerError("error in post-processing function",g).assertOk();let b=w(this,Rr).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return g.stall>=0&&(b=g.stall),ne(f=o.clone(),Aa,pl).call(f,e+1,r,b,a,d)}}return d};let es=Cu;var xc,yc,wc,nr,Vi,Ea;const Cg=class Cg{constructor(e,r,n,a,i){U(this,xc);U(this,yc);U(this,wc);U(this,nr);U(this,Vi);U(this,Ea);j(this,xc,e),j(this,yc,r),j(this,wc,Object.keys(n).reduce((o,l)=>(o[l.toLowerCase()]=String(n[l]),o),{})),j(this,nr,a==null?null:new Uint8Array(a)),j(this,Vi,i||null),j(this,Ea,{message:""})}toString(){return`<FetchResponse status=${this.statusCode} body=${w(this,nr)?se(w(this,nr)):"null"}>`}get statusCode(){return w(this,xc)}get statusMessage(){return w(this,yc)}get headers(){return Object.assign({},w(this,wc))}get body(){return w(this,nr)==null?null:new Uint8Array(w(this,nr))}get bodyText(){try{return w(this,nr)==null?"":fu(w(this,nr))}catch{J(!1,"response body is not valid UTF-8 data","UNSUPPORTED_OPERATION",{operation:"bodyText",info:{response:this}})}}get bodyJson(){try{return JSON.parse(this.bodyText)}catch{J(!1,"response body is not valid JSON","UNSUPPORTED_OPERATION",{operation:"bodyJson",info:{response:this}})}}[Symbol.iterator](){const e=this.headers,r=Object.keys(e);let n=0;return{next:()=>{if(n<r.length){const a=r[n++];return{value:[a,e[a]],done:!1}}return{value:void 0,done:!0}}}}makeServerError(e,r){let n;e?n=`CLIENT ESCALATED SERVER ERROR (${this.statusCode} ${this.statusMessage}; ${e})`:(e=`${this.statusCode} ${this.statusMessage}`,n=`CLIENT ESCALATED SERVER ERROR (${e})`);const a=new Cg(599,n,this.headers,this.body,w(this,Vi)||void 0);return j(a,Ea,{message:e,error:r}),a}throwThrottleError(e,r){r==null?r=-1:P(Number.isInteger(r)&&r>=0,"invalid stall timeout","stall",r);const n=new Error(e||"throttling requests");throw me(n,{stall:r,throttle:!0}),n}getHeader(e){return this.headers[e.toLowerCase()]}hasBody(){return w(this,nr)!=null}get request(){return w(this,Vi)}ok(){return w(this,Ea).message===""&&this.statusCode>=200&&this.statusCode<300}assertOk(){if(this.ok())return;let{message:e,error:r}=w(this,Ea);e===""&&(e=`server response ${this.statusCode} ${this.statusMessage}`);let n=null;this.request&&(n=this.request.url);let a=null;try{w(this,nr)&&(a=fu(w(this,nr)))}catch{}J(!1,e,"SERVER_ERROR",{request:this.request||"unknown request",response:this,error:r,info:{requestUrl:n,responseBody:a,responseStatus:`${this.statusCode} ${this.statusMessage}`}})}};xc=new WeakMap,yc=new WeakMap,wc=new WeakMap,nr=new WeakMap,Vi=new WeakMap,Ea=new WeakMap;let Ks=Cg;function rx(){return new Date().getTime()}function aA(t){return $n(t.replace(/%([0-9a-f][0-9a-f])/gi,(e,r)=>String.fromCharCode(parseInt(r,16))))}function iA(t){return new Promise(e=>setTimeout(e,t))}function oA(t){let e=t.toString(16);for(;e.length<2;)e="0"+e;return"0x"+e}function nx(t,e,r){let n=0;for(let a=0;a<r;a++)n=n*256+t[e+a];return n}function sx(t,e,r,n){const a=[];for(;r<e+1+n;){const i=rv(t,r);a.push(i.result),r+=i.consumed,J(r<=e+1+n,"child data too short","BUFFER_OVERRUN",{buffer:t,length:n,offset:e})}return{consumed:1+n,result:a}}function rv(t,e){J(t.length!==0,"data too short","BUFFER_OVERRUN",{buffer:t,length:0,offset:1});const r=n=>{J(n<=t.length,"data short segment too short","BUFFER_OVERRUN",{buffer:t,length:t.length,offset:n})};if(t[e]>=248){const n=t[e]-247;r(e+1+n);const a=nx(t,e+1,n);return r(e+1+n+a),sx(t,e,e+1+n,n+a)}else if(t[e]>=192){const n=t[e]-192;return r(e+1+n),sx(t,e,e+1,n)}else if(t[e]>=184){const n=t[e]-183;r(e+1+n);const a=nx(t,e+1,n);r(e+1+n+a);const i=se(t.slice(e+1+n,e+1+n+a));return{consumed:1+n+a,result:i}}else if(t[e]>=128){const n=t[e]-128;r(e+1+n);const a=se(t.slice(e+1,e+1+n));return{consumed:1+n,result:a}}return{consumed:1,result:oA(t[e])}}function Mc(t){const e=xe(t,"data"),r=rv(e,0);return P(r.consumed===e.length,"unexpected junk after rlp payload","data",t),r.result}function ax(t){const e=[];for(;t;)e.unshift(t&255),t>>=8;return e}function nv(t){if(Array.isArray(t)){let n=[];if(t.forEach(function(i){n=n.concat(nv(i))}),n.length<=55)return n.unshift(192+n.length),n;const a=ax(n.length);return a.unshift(247+a.length),a.concat(n)}const e=Array.prototype.slice.call(xe(t,"object"));if(e.length===1&&e[0]<=127)return e;if(e.length<=55)return e.unshift(128+e.length),e;const r=ax(e.length);return r.unshift(183+r.length),r.concat(e)}const ix="0123456789abcdef";function Qn(t){let e="0x";for(const r of nv(t))e+=ix[r>>4],e+=ix[r&15];return e}const _t=32,m0=new Uint8Array(_t),lA=["then"],cd={},sv=new WeakMap;function ua(t){return sv.get(t)}function ox(t,e){sv.set(t,e)}function cl(t,e){const r=new Error(`deferred error during ABI decoding triggered accessing ${t}`);throw r.error=e,r}function g0(t,e,r){return t.indexOf(null)>=0?e.map((n,a)=>n instanceof Oo?g0(ua(n),n,r):n):t.reduce((n,a,i)=>{let o=e.getValue(a);return a in n||(r&&o instanceof Oo&&(o=g0(ua(o),o,r)),n[a]=o),n},{})}var Gi;const Ai=class Ai extends Array{constructor(...r){const n=r[0];let a=r[1],i=(r[2]||[]).slice(),o=!0;n!==cd&&(a=r,i=[],o=!1);super(a.length);U(this,Gi);a.forEach((d,h)=>{this[h]=d});const l=i.reduce((d,h)=>(typeof h=="string"&&d.set(h,(d.get(h)||0)+1),d),new Map);if(ox(this,Object.freeze(a.map((d,h)=>{const u=i[h];return u!=null&&l.get(u)===1?u:null}))),j(this,Gi,[]),w(this,Gi)==null&&w(this,Gi),!o)return;Object.freeze(this);const c=new Proxy(this,{get:(d,h,u)=>{if(typeof h=="string"){if(h.match(/^[0-9]+$/)){const g=ye(h,"%index");if(g<0||g>=this.length)throw new RangeError("out of result range");const b=d[g];return b instanceof Error&&cl(`index ${g}`,b),b}if(lA.indexOf(h)>=0)return Reflect.get(d,h,u);const f=d[h];if(f instanceof Function)return function(...g){return f.apply(this===u?d:this,g)};if(!(h in d))return d.getValue.apply(this===u?d:this,[h])}return Reflect.get(d,h,u)}});return ox(c,ua(this)),c}toArray(r){const n=[];return this.forEach((a,i)=>{a instanceof Error&&cl(`index ${i}`,a),r&&a instanceof Ai&&(a=a.toArray(r)),n.push(a)}),n}toObject(r){const n=ua(this);return n.reduce((a,i,o)=>(J(i!=null,`value at index ${o} unnamed`,"UNSUPPORTED_OPERATION",{operation:"toObject()"}),g0(n,this,r)),{})}slice(r,n){r==null&&(r=0),r<0&&(r+=this.length,r<0&&(r=0)),n==null&&(n=this.length),n<0&&(n+=this.length,n<0&&(n=0)),n>this.length&&(n=this.length);const a=ua(this),i=[],o=[];for(let l=r;l<n;l++)i.push(this[l]),o.push(a[l]);return new Ai(cd,i,o)}filter(r,n){const a=ua(this),i=[],o=[];for(let l=0;l<this.length;l++){const c=this[l];c instanceof Error&&cl(`index ${l}`,c),r.call(n,c,l,this)&&(i.push(c),o.push(a[l]))}return new Ai(cd,i,o)}map(r,n){const a=[];for(let i=0;i<this.length;i++){const o=this[i];o instanceof Error&&cl(`index ${i}`,o),a.push(r.call(n,o,i,this))}return a}getValue(r){const n=ua(this).indexOf(r);if(n===-1)return;const a=this[n];return a instanceof Error&&cl(`property ${JSON.stringify(r)}`,a.error),a}static fromItems(r,n){return new Ai(cd,r,n)}};Gi=new WeakMap;let Oo=Ai;function lx(t){let e=rt(t);return J(e.length<=_t,"value out-of-bounds","BUFFER_OVERRUN",{buffer:e,length:_t,offset:e.length}),e.length!==_t&&(e=Tt(He([m0.slice(e.length%_t),e]))),e}class ss{constructor(e,r,n,a){S(this,"name");S(this,"type");S(this,"localName");S(this,"dynamic");me(this,{name:e,type:r,localName:n,dynamic:a},{name:"string",type:"string",localName:"string",dynamic:"boolean"})}_throwError(e,r){P(!1,e,this.localName,r)}}var Pn,Sa,$i,Pd;class p0{constructor(){U(this,$i);U(this,Pn);U(this,Sa);j(this,Pn,[]),j(this,Sa,0)}get data(){return He(w(this,Pn))}get length(){return w(this,Sa)}appendWriter(e){return ne(this,$i,Pd).call(this,Tt(e.data))}writeBytes(e){let r=Tt(e);const n=r.length%_t;return n&&(r=Tt(He([r,m0.slice(n)]))),ne(this,$i,Pd).call(this,r)}writeValue(e){return ne(this,$i,Pd).call(this,lx(e))}writeUpdatableValue(){const e=w(this,Pn).length;return w(this,Pn).push(m0),j(this,Sa,w(this,Sa)+_t),r=>{w(this,Pn)[e]=lx(r)}}}Pn=new WeakMap,Sa=new WeakMap,$i=new WeakSet,Pd=function(e){return w(this,Pn).push(e),j(this,Sa,w(this,Sa)+e.length),e.length};var zt,sr,Ca,Da,vs,ei,y0,av;const Dg=class Dg{constructor(e,r,n){U(this,ei);S(this,"allowLoose");U(this,zt);U(this,sr);U(this,Ca);U(this,Da);U(this,vs);me(this,{allowLoose:!!r}),j(this,zt,Tt(e)),j(this,Ca,0),j(this,Da,null),j(this,vs,n??1024),j(this,sr,0)}get data(){return se(w(this,zt))}get dataLength(){return w(this,zt).length}get consumed(){return w(this,sr)}get bytes(){return new Uint8Array(w(this,zt))}subReader(e){const r=new Dg(w(this,zt).slice(w(this,sr)+e),this.allowLoose,w(this,vs));return j(r,Da,this),r}readBytes(e,r){let n=ne(this,ei,av).call(this,0,e,!!r);return ne(this,ei,y0).call(this,e),j(this,sr,w(this,sr)+n.length),n.slice(0,e)}readValue(){return rg(this.readBytes(_t))}readIndex(){return $j(this.readBytes(_t))}};zt=new WeakMap,sr=new WeakMap,Ca=new WeakMap,Da=new WeakMap,vs=new WeakMap,ei=new WeakSet,y0=function(e){var r;if(w(this,Da))return ne(r=w(this,Da),ei,y0).call(r,e);j(this,Ca,w(this,Ca)+e),J(w(this,vs)<1||w(this,Ca)<=w(this,vs)*this.dataLength,`compressed ABI data exceeds inflation ratio of ${w(this,vs)} ( see: https://github.com/ethers-io/ethers.js/issues/4537 )`,"BUFFER_OVERRUN",{buffer:Tt(w(this,zt)),offset:w(this,sr),length:e,info:{bytesRead:w(this,Ca),dataLength:this.dataLength}})},av=function(e,r,n){let a=Math.ceil(r/_t)*_t;return w(this,sr)+a>w(this,zt).length&&(this.allowLoose&&n&&w(this,sr)+r<=w(this,zt).length?a=r:J(!1,"data out-of-bounds","BUFFER_OVERRUN",{buffer:Tt(w(this,zt)),length:w(this,zt).length,offset:w(this,sr)+a})),w(this,zt).slice(w(this,sr),w(this,sr)+a)};let x0=Dg;function cx(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function iv(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function mu(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function ov(t,e){iv(t);const r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const cA=t=>t instanceof Uint8Array,dA=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),Qh=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),Xr=(t,e)=>t<<32-e|t>>>e,uA=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!uA)throw new Error("Non little-endian hardware is not supported");function hA(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function ng(t){if(typeof t=="string"&&(t=hA(t)),!cA(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}let lv=class{clone(){return this._cloneInto()}};function sg(t){const e=n=>t().update(ng(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function fA(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const a=BigInt(32),i=BigInt(4294967295),o=Number(r>>a&i),l=Number(r&i),c=n?4:0,d=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+d,l,n)}let cv=class extends lv{constructor(e,r,n,a){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=a,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Qh(this.buffer)}update(e){mu(this);const{view:r,buffer:n,blockLen:a}=this;e=ng(e);const i=e.length;for(let o=0;o<i;){const l=Math.min(a-this.pos,i-o);if(l===a){const c=Qh(e);for(;a<=i-o;o+=a)this.process(c,o);continue}n.set(e.subarray(o,o+l),this.pos),this.pos+=l,o+=l,this.pos===a&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){mu(this),ov(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:a,isLE:i}=this;let{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>a-o&&(this.process(n,0),o=0);for(let u=o;u<a;u++)r[u]=0;fA(n,a-8,BigInt(this.length*8),i),this.process(n,0);const l=Qh(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const d=c/4,h=this.get();if(d>h.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<d;u++)l.setUint32(4*u,h[u],i)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:a,finished:i,destroyed:o,pos:l}=this;return e.length=a,e.pos=l,e.finished=i,e.destroyed=o,a%r&&e.buffer.set(n),e}};const mA=(t,e,r)=>t&e^~t&r,gA=(t,e,r)=>t&e^t&r^e&r,pA=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),is=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),os=new Uint32Array(64);let xA=class extends cv{constructor(){super(64,32,8,!1),this.A=is[0]|0,this.B=is[1]|0,this.C=is[2]|0,this.D=is[3]|0,this.E=is[4]|0,this.F=is[5]|0,this.G=is[6]|0,this.H=is[7]|0}get(){const{A:e,B:r,C:n,D:a,E:i,F:o,G:l,H:c}=this;return[e,r,n,a,i,o,l,c]}set(e,r,n,a,i,o,l,c){this.A=e|0,this.B=r|0,this.C=n|0,this.D=a|0,this.E=i|0,this.F=o|0,this.G=l|0,this.H=c|0}process(e,r){for(let u=0;u<16;u++,r+=4)os[u]=e.getUint32(r,!1);for(let u=16;u<64;u++){const f=os[u-15],g=os[u-2],b=Xr(f,7)^Xr(f,18)^f>>>3,y=Xr(g,17)^Xr(g,19)^g>>>10;os[u]=y+os[u-7]+b+os[u-16]|0}let{A:n,B:a,C:i,D:o,E:l,F:c,G:d,H:h}=this;for(let u=0;u<64;u++){const f=Xr(l,6)^Xr(l,11)^Xr(l,25),g=h+f+mA(l,c,d)+pA[u]+os[u]|0,y=(Xr(n,2)^Xr(n,13)^Xr(n,22))+gA(n,a,i)|0;h=d,d=c,c=l,l=o+g|0,o=i,i=a,a=n,n=g+y|0}n=n+this.A|0,a=a+this.B|0,i=i+this.C|0,o=o+this.D|0,l=l+this.E|0,c=c+this.F|0,d=d+this.G|0,h=h+this.H|0,this.set(n,a,i,o,l,c,d,h)}roundClean(){os.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};const yA=sg(()=>new xA),dd=BigInt(2**32-1),w0=BigInt(32);function dv(t,e=!1){return e?{h:Number(t&dd),l:Number(t>>w0&dd)}:{h:Number(t>>w0&dd)|0,l:Number(t&dd)|0}}function uv(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let a=0;a<t.length;a++){const{h:i,l:o}=dv(t[a],e);[r[a],n[a]]=[i,o]}return[r,n]}const wA=(t,e)=>BigInt(t>>>0)<<w0|BigInt(e>>>0),bA=(t,e,r)=>t>>>r,vA=(t,e,r)=>t<<32-r|e>>>r,NA=(t,e,r)=>t>>>r|e<<32-r,kA=(t,e,r)=>t<<32-r|e>>>r,jA=(t,e,r)=>t<<64-r|e>>>r-32,AA=(t,e,r)=>t>>>r-32|e<<64-r,EA=(t,e)=>e,SA=(t,e)=>t,hv=(t,e,r)=>t<<r|e>>>32-r,fv=(t,e,r)=>e<<r|t>>>32-r,mv=(t,e,r)=>e<<r-32|t>>>64-r,gv=(t,e,r)=>t<<r-32|e>>>64-r;function CA(t,e,r,n){const a=(e>>>0)+(n>>>0);return{h:t+r+(a/2**32|0)|0,l:a|0}}const DA=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),PA=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,IA=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),TA=(t,e,r,n,a)=>e+r+n+a+(t/2**32|0)|0,_A=(t,e,r,n,a)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(a>>>0),BA=(t,e,r,n,a,i)=>e+r+n+a+i+(t/2**32|0)|0,pe={fromBig:dv,split:uv,toBig:wA,shrSH:bA,shrSL:vA,rotrSH:NA,rotrSL:kA,rotrBH:jA,rotrBL:AA,rotr32H:EA,rotr32L:SA,rotlSH:hv,rotlSL:fv,rotlBH:mv,rotlBL:gv,add:CA,add3L:DA,add3H:PA,add4L:IA,add4H:TA,add5H:BA,add5L:_A},[RA,OA]=pe.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),ls=new Uint32Array(80),cs=new Uint32Array(80);class MA extends cv{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:r,Bh:n,Bl:a,Ch:i,Cl:o,Dh:l,Dl:c,Eh:d,El:h,Fh:u,Fl:f,Gh:g,Gl:b,Hh:y,Hl:k}=this;return[e,r,n,a,i,o,l,c,d,h,u,f,g,b,y,k]}set(e,r,n,a,i,o,l,c,d,h,u,f,g,b,y,k){this.Ah=e|0,this.Al=r|0,this.Bh=n|0,this.Bl=a|0,this.Ch=i|0,this.Cl=o|0,this.Dh=l|0,this.Dl=c|0,this.Eh=d|0,this.El=h|0,this.Fh=u|0,this.Fl=f|0,this.Gh=g|0,this.Gl=b|0,this.Hh=y|0,this.Hl=k|0}process(e,r){for(let p=0;p<16;p++,r+=4)ls[p]=e.getUint32(r),cs[p]=e.getUint32(r+=4);for(let p=16;p<80;p++){const v=ls[p-15]|0,N=cs[p-15]|0,A=pe.rotrSH(v,N,1)^pe.rotrSH(v,N,8)^pe.shrSH(v,N,7),D=pe.rotrSL(v,N,1)^pe.rotrSL(v,N,8)^pe.shrSL(v,N,7),E=ls[p-2]|0,L=cs[p-2]|0,C=pe.rotrSH(E,L,19)^pe.rotrBH(E,L,61)^pe.shrSH(E,L,6),O=pe.rotrSL(E,L,19)^pe.rotrBL(E,L,61)^pe.shrSL(E,L,6),V=pe.add4L(D,O,cs[p-7],cs[p-16]),M=pe.add4H(V,A,C,ls[p-7],ls[p-16]);ls[p]=M|0,cs[p]=V|0}let{Ah:n,Al:a,Bh:i,Bl:o,Ch:l,Cl:c,Dh:d,Dl:h,Eh:u,El:f,Fh:g,Fl:b,Gh:y,Gl:k,Hh:m,Hl:x}=this;for(let p=0;p<80;p++){const v=pe.rotrSH(u,f,14)^pe.rotrSH(u,f,18)^pe.rotrBH(u,f,41),N=pe.rotrSL(u,f,14)^pe.rotrSL(u,f,18)^pe.rotrBL(u,f,41),A=u&g^~u&y,D=f&b^~f&k,E=pe.add5L(x,N,D,OA[p],cs[p]),L=pe.add5H(E,m,v,A,RA[p],ls[p]),C=E|0,O=pe.rotrSH(n,a,28)^pe.rotrBH(n,a,34)^pe.rotrBH(n,a,39),V=pe.rotrSL(n,a,28)^pe.rotrBL(n,a,34)^pe.rotrBL(n,a,39),M=n&i^n&l^i&l,ie=a&o^a&c^o&c;m=y|0,x=k|0,y=g|0,k=b|0,g=u|0,b=f|0,{h:u,l:f}=pe.add(d|0,h|0,L|0,C|0),d=l|0,h=c|0,l=i|0,c=o|0,i=n|0,o=a|0;const z=pe.add3L(C,V,ie);n=pe.add3H(z,L,O,M),a=z|0}({h:n,l:a}=pe.add(this.Ah|0,this.Al|0,n|0,a|0)),{h:i,l:o}=pe.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:l,l:c}=pe.add(this.Ch|0,this.Cl|0,l|0,c|0),{h:d,l:h}=pe.add(this.Dh|0,this.Dl|0,d|0,h|0),{h:u,l:f}=pe.add(this.Eh|0,this.El|0,u|0,f|0),{h:g,l:b}=pe.add(this.Fh|0,this.Fl|0,g|0,b|0),{h:y,l:k}=pe.add(this.Gh|0,this.Gl|0,y|0,k|0),{h:m,l:x}=pe.add(this.Hh|0,this.Hl|0,m|0,x|0),this.set(n,a,i,o,l,c,d,h,u,f,g,b,y,k,m,x)}roundClean(){ls.fill(0),cs.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const LA=sg(()=>new MA);function FA(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}const dx=FA();dx.crypto||dx.msCrypto;function UA(t){switch(t){case"sha256":return yA.create();case"sha512":return LA.create()}P(!1,"invalid hashing algorithm name","algorithm",t)}const[pv,xv,yv]=[[],[],[]],zA=BigInt(0),dl=BigInt(1),HA=BigInt(2),VA=BigInt(7),GA=BigInt(256),$A=BigInt(113);for(let t=0,e=dl,r=1,n=0;t<24;t++){[r,n]=[n,(2*r+3*n)%5],pv.push(2*(5*n+r)),xv.push((t+1)*(t+2)/2%64);let a=zA;for(let i=0;i<7;i++)e=(e<<dl^(e>>VA)*$A)%GA,e&HA&&(a^=dl<<(dl<<BigInt(i))-dl);yv.push(a)}const[QA,WA]=uv(yv,!0),ux=(t,e,r)=>r>32?mv(t,e,r):hv(t,e,r),hx=(t,e,r)=>r>32?gv(t,e,r):fv(t,e,r);function KA(t,e=24){const r=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)r[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const l=(o+8)%10,c=(o+2)%10,d=r[c],h=r[c+1],u=ux(d,h,1)^r[l],f=hx(d,h,1)^r[l+1];for(let g=0;g<50;g+=10)t[o+g]^=u,t[o+g+1]^=f}let a=t[2],i=t[3];for(let o=0;o<24;o++){const l=xv[o],c=ux(a,i,l),d=hx(a,i,l),h=pv[o];a=t[h],i=t[h+1],t[h]=c,t[h+1]=d}for(let o=0;o<50;o+=10){for(let l=0;l<10;l++)r[l]=t[o+l];for(let l=0;l<10;l++)t[o+l]^=~r[(l+2)%10]&r[(l+4)%10]}t[0]^=QA[n],t[1]^=WA[n]}r.fill(0)}class ag extends lv{constructor(e,r,n,a=!1,i=24){if(super(),this.blockLen=e,this.suffix=r,this.outputLen=n,this.enableXOF=a,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,cx(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=dA(this.state)}keccak(){KA(this.state32,this.rounds),this.posOut=0,this.pos=0}update(e){mu(this);const{blockLen:r,state:n}=this;e=ng(e);const a=e.length;for(let i=0;i<a;){const o=Math.min(r-this.pos,a-i);for(let l=0;l<o;l++)n[this.pos++]^=e[i++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:r,pos:n,blockLen:a}=this;e[n]^=r,r&128&&n===a-1&&this.keccak(),e[a-1]^=128,this.keccak()}writeInto(e){mu(this,!1),iv(e),this.finish();const r=this.state,{blockLen:n}=this;for(let a=0,i=e.length;a<i;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,i-a);e.set(r.subarray(this.posOut,this.posOut+o),a),this.posOut+=o,a+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return cx(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(ov(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:r,suffix:n,outputLen:a,rounds:i,enableXOF:o}=this;return e||(e=new ag(r,n,a,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=n,e.outputLen=a,e.enableXOF=o,e.destroyed=this.destroyed,e}}const JA=(t,e,r)=>sg(()=>new ag(e,t,r)),YA=JA(1,136,256/8);let wv=!1;const bv=function(t){return YA(t)};let vv=bv;function tt(t){const e=xe(t,"data");return se(vv(e))}tt._=bv;tt.lock=function(){wv=!0};tt.register=function(t){if(wv)throw new TypeError("keccak256 is locked");vv=t};Object.freeze(tt);const Nv=function(t){return UA("sha256").update(t).digest()};let kv=Nv,jv=!1;function Zo(t){const e=xe(t,"data");return se(kv(e))}Zo._=Nv;Zo.lock=function(){jv=!0};Zo.register=function(t){if(jv)throw new Error("sha256 is locked");kv=t};Object.freeze(Zo);Object.freeze(Zo);function fx(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function Av(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function qA(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");fx(t.outputLen),fx(t.blockLen)}function gu(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function ZA(t,e){Av(t);const r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}const Wh=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Ev=t=>t instanceof Uint8Array,Kh=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),en=(t,e)=>t<<32-e|t>>>e,XA=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!XA)throw new Error("Non little-endian hardware is not supported");function e4(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function ig(t){if(typeof t=="string"&&(t=e4(t)),!Ev(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}function t4(...t){const e=new Uint8Array(t.reduce((n,a)=>n+a.length,0));let r=0;return t.forEach(n=>{if(!Ev(n))throw new Error("Uint8Array expected");e.set(n,r),r+=n.length}),e}class Sv{clone(){return this._cloneInto()}}function r4(t){const e=n=>t().update(ig(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function n4(t=32){if(Wh&&typeof Wh.getRandomValues=="function")return Wh.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}function s4(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const a=BigInt(32),i=BigInt(4294967295),o=Number(r>>a&i),l=Number(r&i),c=n?4:0,d=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+d,l,n)}class a4 extends Sv{constructor(e,r,n,a){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=a,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Kh(this.buffer)}update(e){gu(this);const{view:r,buffer:n,blockLen:a}=this;e=ig(e);const i=e.length;for(let o=0;o<i;){const l=Math.min(a-this.pos,i-o);if(l===a){const c=Kh(e);for(;a<=i-o;o+=a)this.process(c,o);continue}n.set(e.subarray(o,o+l),this.pos),this.pos+=l,o+=l,this.pos===a&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){gu(this),ZA(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:a,isLE:i}=this;let{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>a-o&&(this.process(n,0),o=0);for(let u=o;u<a;u++)r[u]=0;s4(n,a-8,BigInt(this.length*8),i),this.process(n,0);const l=Kh(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const d=c/4,h=this.get();if(d>h.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<d;u++)l.setUint32(4*u,h[u],i)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:a,finished:i,destroyed:o,pos:l}=this;return e.length=a,e.pos=l,e.finished=i,e.destroyed=o,a%r&&e.buffer.set(n),e}}const i4=(t,e,r)=>t&e^~t&r,o4=(t,e,r)=>t&e^t&r^e&r,l4=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ds=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),us=new Uint32Array(64);class c4 extends a4{constructor(){super(64,32,8,!1),this.A=ds[0]|0,this.B=ds[1]|0,this.C=ds[2]|0,this.D=ds[3]|0,this.E=ds[4]|0,this.F=ds[5]|0,this.G=ds[6]|0,this.H=ds[7]|0}get(){const{A:e,B:r,C:n,D:a,E:i,F:o,G:l,H:c}=this;return[e,r,n,a,i,o,l,c]}set(e,r,n,a,i,o,l,c){this.A=e|0,this.B=r|0,this.C=n|0,this.D=a|0,this.E=i|0,this.F=o|0,this.G=l|0,this.H=c|0}process(e,r){for(let u=0;u<16;u++,r+=4)us[u]=e.getUint32(r,!1);for(let u=16;u<64;u++){const f=us[u-15],g=us[u-2],b=en(f,7)^en(f,18)^f>>>3,y=en(g,17)^en(g,19)^g>>>10;us[u]=y+us[u-7]+b+us[u-16]|0}let{A:n,B:a,C:i,D:o,E:l,F:c,G:d,H:h}=this;for(let u=0;u<64;u++){const f=en(l,6)^en(l,11)^en(l,25),g=h+f+i4(l,c,d)+l4[u]+us[u]|0,y=(en(n,2)^en(n,13)^en(n,22))+o4(n,a,i)|0;h=d,d=c,c=l,l=o+g|0,o=i,i=a,a=n,n=g+y|0}n=n+this.A|0,a=a+this.B|0,i=i+this.C|0,o=o+this.D|0,l=l+this.E|0,c=c+this.F|0,d=d+this.G|0,h=h+this.H|0,this.set(n,a,i,o,l,c,d,h)}roundClean(){us.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const d4=r4(()=>new c4);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Cv=BigInt(0),th=BigInt(1),u4=BigInt(2),rh=t=>t instanceof Uint8Array,h4=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Mo(t){if(!rh(t))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=h4[t[r]];return e}function Dv(t){const e=t.toString(16);return e.length&1?`0${e}`:e}function og(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}function Lo(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(e/2);for(let n=0;n<r.length;n++){const a=n*2,i=t.slice(a,a+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");r[n]=o}return r}function Va(t){return og(Mo(t))}function lg(t){if(!rh(t))throw new Error("Uint8Array expected");return og(Mo(Uint8Array.from(t).reverse()))}function Fo(t,e){return Lo(t.toString(16).padStart(e*2,"0"))}function cg(t,e){return Fo(t,e).reverse()}function f4(t){return Lo(Dv(t))}function _r(t,e,r){let n;if(typeof e=="string")try{n=Lo(e)}catch(i){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${i}`)}else if(rh(e))n=Uint8Array.from(e);else throw new Error(`${t} must be hex string or Uint8Array`);const a=n.length;if(typeof r=="number"&&a!==r)throw new Error(`${t} expected ${r} bytes, got ${a}`);return n}function sc(...t){const e=new Uint8Array(t.reduce((n,a)=>n+a.length,0));let r=0;return t.forEach(n=>{if(!rh(n))throw new Error("Uint8Array expected");e.set(n,r),r+=n.length}),e}function m4(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function g4(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function p4(t){let e;for(e=0;t>Cv;t>>=th,e+=1);return e}function x4(t,e){return t>>BigInt(e)&th}const y4=(t,e,r)=>t|(r?th:Cv)<<BigInt(e),dg=t=>(u4<<BigInt(t-1))-th,Jh=t=>new Uint8Array(t),mx=t=>Uint8Array.from(t);function Pv(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=Jh(t),a=Jh(t),i=0;const o=()=>{n.fill(1),a.fill(0),i=0},l=(...u)=>r(a,n,...u),c=(u=Jh())=>{a=l(mx([0]),u),n=l(),u.length!==0&&(a=l(mx([1]),u),n=l())},d=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let u=0;const f=[];for(;u<e;){n=l();const g=n.slice();f.push(g),u+=n.length}return sc(...f)};return(u,f)=>{o(),c(u);let g;for(;!(g=f(d()));)c();return o(),g}}const w4={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||t instanceof Uint8Array,isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function Lc(t,e,r={}){const n=(a,i,o)=>{const l=w4[i];if(typeof l!="function")throw new Error(`Invalid validator "${i}", expected function`);const c=t[a];if(!(o&&c===void 0)&&!l(c,t))throw new Error(`Invalid param ${String(a)}=${c} (${typeof c}), expected ${i}`)};for(const[a,i]of Object.entries(e))n(a,i,!1);for(const[a,i]of Object.entries(r))n(a,i,!0);return t}const b4=Object.freeze(Object.defineProperty({__proto__:null,bitGet:x4,bitLen:p4,bitMask:dg,bitSet:y4,bytesToHex:Mo,bytesToNumberBE:Va,bytesToNumberLE:lg,concatBytes:sc,createHmacDrbg:Pv,ensureBytes:_r,equalBytes:m4,hexToBytes:Lo,hexToNumber:og,numberToBytesBE:Fo,numberToBytesLE:cg,numberToHexUnpadded:Dv,numberToVarBytesBE:f4,utf8ToBytes:g4,validateObject:Lc},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ct=BigInt(0),Xe=BigInt(1),ha=BigInt(2),v4=BigInt(3),b0=BigInt(4),gx=BigInt(5),px=BigInt(8);BigInt(9);BigInt(16);function Vt(t,e){const r=t%e;return r>=ct?r:e+r}function N4(t,e,r){if(r<=ct||e<ct)throw new Error("Expected power/modulo > 0");if(r===Xe)return ct;let n=Xe;for(;e>ct;)e&Xe&&(n=n*t%r),t=t*t%r,e>>=Xe;return n}function mr(t,e,r){let n=t;for(;e-- >ct;)n*=n,n%=r;return n}function v0(t,e){if(t===ct||e<=ct)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=Vt(t,e),n=e,a=ct,i=Xe;for(;r!==ct;){const l=n/r,c=n%r,d=a-i*l;n=r,r=c,a=i,i=d}if(n!==Xe)throw new Error("invert: does not exist");return Vt(a,e)}function k4(t){const e=(t-Xe)/ha;let r,n,a;for(r=t-Xe,n=0;r%ha===ct;r/=ha,n++);for(a=ha;a<t&&N4(a,e,t)!==t-Xe;a++);if(n===1){const o=(t+Xe)/b0;return function(c,d){const h=c.pow(d,o);if(!c.eql(c.sqr(h),d))throw new Error("Cannot find square root");return h}}const i=(r+Xe)/ha;return function(l,c){if(l.pow(c,e)===l.neg(l.ONE))throw new Error("Cannot find square root");let d=n,h=l.pow(l.mul(l.ONE,a),r),u=l.pow(c,i),f=l.pow(c,r);for(;!l.eql(f,l.ONE);){if(l.eql(f,l.ZERO))return l.ZERO;let g=1;for(let y=l.sqr(f);g<d&&!l.eql(y,l.ONE);g++)y=l.sqr(y);const b=l.pow(h,Xe<<BigInt(d-g-1));h=l.sqr(b),u=l.mul(u,b),f=l.mul(f,h),d=g}return u}}function j4(t){if(t%b0===v4){const e=(t+Xe)/b0;return function(n,a){const i=n.pow(a,e);if(!n.eql(n.sqr(i),a))throw new Error("Cannot find square root");return i}}if(t%px===gx){const e=(t-gx)/px;return function(n,a){const i=n.mul(a,ha),o=n.pow(i,e),l=n.mul(a,o),c=n.mul(n.mul(l,ha),o),d=n.mul(l,n.sub(c,n.ONE));if(!n.eql(n.sqr(d),a))throw new Error("Cannot find square root");return d}}return k4(t)}const A4=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function E4(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=A4.reduce((n,a)=>(n[a]="function",n),e);return Lc(t,r)}function S4(t,e,r){if(r<ct)throw new Error("Expected power > 0");if(r===ct)return t.ONE;if(r===Xe)return e;let n=t.ONE,a=e;for(;r>ct;)r&Xe&&(n=t.mul(n,a)),a=t.sqr(a),r>>=Xe;return n}function C4(t,e){const r=new Array(e.length),n=e.reduce((i,o,l)=>t.is0(o)?i:(r[l]=i,t.mul(i,o)),t.ONE),a=t.inv(n);return e.reduceRight((i,o,l)=>t.is0(o)?i:(r[l]=t.mul(i,r[l]),t.mul(i,o)),a),r}function Iv(t,e){const r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function D4(t,e,r=!1,n={}){if(t<=ct)throw new Error(`Expected Field ORDER > 0, got ${t}`);const{nBitLength:a,nByteLength:i}=Iv(t,e);if(i>2048)throw new Error("Field lengths over 2048 bytes are not supported");const o=j4(t),l=Object.freeze({ORDER:t,BITS:a,BYTES:i,MASK:dg(a),ZERO:ct,ONE:Xe,create:c=>Vt(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof c}`);return ct<=c&&c<t},is0:c=>c===ct,isOdd:c=>(c&Xe)===Xe,neg:c=>Vt(-c,t),eql:(c,d)=>c===d,sqr:c=>Vt(c*c,t),add:(c,d)=>Vt(c+d,t),sub:(c,d)=>Vt(c-d,t),mul:(c,d)=>Vt(c*d,t),pow:(c,d)=>S4(l,c,d),div:(c,d)=>Vt(c*v0(d,t),t),sqrN:c=>c*c,addN:(c,d)=>c+d,subN:(c,d)=>c-d,mulN:(c,d)=>c*d,inv:c=>v0(c,t),sqrt:n.sqrt||(c=>o(l,c)),invertBatch:c=>C4(l,c),cmov:(c,d,h)=>h?d:c,toBytes:c=>r?cg(c,i):Fo(c,i),fromBytes:c=>{if(c.length!==i)throw new Error(`Fp.fromBytes: expected ${i}, got ${c.length}`);return r?lg(c):Va(c)}});return Object.freeze(l)}function Tv(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function _v(t){const e=Tv(t);return e+Math.ceil(e/2)}function P4(t,e,r=!1){const n=t.length,a=Tv(e),i=_v(e);if(n<16||n<i||n>1024)throw new Error(`expected ${i}-1024 bytes of input, got ${n}`);const o=r?Va(t):lg(t),l=Vt(o,e-Xe)+Xe;return r?cg(l,a):Fo(l,a)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const I4=BigInt(0),Yh=BigInt(1);function T4(t,e){const r=(a,i)=>{const o=i.negate();return a?o:i},n=a=>{const i=Math.ceil(e/a)+1,o=2**(a-1);return{windows:i,windowSize:o}};return{constTimeNegate:r,unsafeLadder(a,i){let o=t.ZERO,l=a;for(;i>I4;)i&Yh&&(o=o.add(l)),l=l.double(),i>>=Yh;return o},precomputeWindow(a,i){const{windows:o,windowSize:l}=n(i),c=[];let d=a,h=d;for(let u=0;u<o;u++){h=d,c.push(h);for(let f=1;f<l;f++)h=h.add(d),c.push(h);d=h.double()}return c},wNAF(a,i,o){const{windows:l,windowSize:c}=n(a);let d=t.ZERO,h=t.BASE;const u=BigInt(2**a-1),f=2**a,g=BigInt(a);for(let b=0;b<l;b++){const y=b*c;let k=Number(o&u);o>>=g,k>c&&(k-=f,o+=Yh);const m=y,x=y+Math.abs(k)-1,p=b%2!==0,v=k<0;k===0?h=h.add(r(p,i[m])):d=d.add(r(v,i[x]))}return{p:d,f:h}},wNAFCached(a,i,o,l){const c=a._WINDOW_SIZE||1;let d=i.get(a);return d||(d=this.precomputeWindow(a,c),c!==1&&i.set(a,l(d))),this.wNAF(c,d,o)}}}function Bv(t){return E4(t.Fp),Lc(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Iv(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function _4(t){const e=Bv(t);Lc(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:r,Fp:n,a}=e;if(r){if(!n.eql(a,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:B4,hexToBytes:R4}=b4,ya={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(t){const{Err:e}=ya;if(t.length<2||t[0]!==2)throw new e("Invalid signature integer tag");const r=t[1],n=t.subarray(2,r+2);if(!r||n.length!==r)throw new e("Invalid signature integer: wrong length");if(n[0]&128)throw new e("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:B4(n),l:t.subarray(r+2)}},toSig(t){const{Err:e}=ya,r=typeof t=="string"?R4(t):t;if(!(r instanceof Uint8Array))throw new Error("ui8a expected");let n=r.length;if(n<2||r[0]!=48)throw new e("Invalid signature tag");if(r[1]!==n-2)throw new e("Invalid signature: incorrect length");const{d:a,l:i}=ya._parseInt(r.subarray(2)),{d:o,l}=ya._parseInt(i);if(l.length)throw new e("Invalid signature: left bytes after parsing");return{r:a,s:o}},hexFromSig(t){const e=d=>Number.parseInt(d[0],16)&8?"00"+d:d,r=d=>{const h=d.toString(16);return h.length&1?`0${h}`:h},n=e(r(t.s)),a=e(r(t.r)),i=n.length/2,o=a.length/2,l=r(i),c=r(o);return`30${r(o+i+4)}02${c}${a}02${l}${n}`}},Fn=BigInt(0),Nr=BigInt(1);BigInt(2);const xx=BigInt(3);BigInt(4);function O4(t){const e=_4(t),{Fp:r}=e,n=e.toBytes||((b,y,k)=>{const m=y.toAffine();return sc(Uint8Array.from([4]),r.toBytes(m.x),r.toBytes(m.y))}),a=e.fromBytes||(b=>{const y=b.subarray(1),k=r.fromBytes(y.subarray(0,r.BYTES)),m=r.fromBytes(y.subarray(r.BYTES,2*r.BYTES));return{x:k,y:m}});function i(b){const{a:y,b:k}=e,m=r.sqr(b),x=r.mul(m,b);return r.add(r.add(x,r.mul(b,y)),k)}if(!r.eql(r.sqr(e.Gy),i(e.Gx)))throw new Error("bad generator point: equation left != right");function o(b){return typeof b=="bigint"&&Fn<b&&b<e.n}function l(b){if(!o(b))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(b){const{allowedPrivateKeyLengths:y,nByteLength:k,wrapPrivateKey:m,n:x}=e;if(y&&typeof b!="bigint"){if(b instanceof Uint8Array&&(b=Mo(b)),typeof b!="string"||!y.includes(b.length))throw new Error("Invalid key");b=b.padStart(k*2,"0")}let p;try{p=typeof b=="bigint"?b:Va(_r("private key",b,k))}catch{throw new Error(`private key must be ${k} bytes, hex or bigint, not ${typeof b}`)}return m&&(p=Vt(p,x)),l(p),p}const d=new Map;function h(b){if(!(b instanceof u))throw new Error("ProjectivePoint expected")}class u{constructor(y,k,m){if(this.px=y,this.py=k,this.pz=m,y==null||!r.isValid(y))throw new Error("x required");if(k==null||!r.isValid(k))throw new Error("y required");if(m==null||!r.isValid(m))throw new Error("z required")}static fromAffine(y){const{x:k,y:m}=y||{};if(!y||!r.isValid(k)||!r.isValid(m))throw new Error("invalid affine point");if(y instanceof u)throw new Error("projective point not allowed");const x=p=>r.eql(p,r.ZERO);return x(k)&&x(m)?u.ZERO:new u(k,m,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(y){const k=r.invertBatch(y.map(m=>m.pz));return y.map((m,x)=>m.toAffine(k[x])).map(u.fromAffine)}static fromHex(y){const k=u.fromAffine(a(_r("pointHex",y)));return k.assertValidity(),k}static fromPrivateKey(y){return u.BASE.multiply(c(y))}_setWindowSize(y){this._WINDOW_SIZE=y,d.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!r.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:y,y:k}=this.toAffine();if(!r.isValid(y)||!r.isValid(k))throw new Error("bad point: x or y not FE");const m=r.sqr(k),x=i(y);if(!r.eql(m,x))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y}=this.toAffine();if(r.isOdd)return!r.isOdd(y);throw new Error("Field doesn't support isOdd")}equals(y){h(y);const{px:k,py:m,pz:x}=this,{px:p,py:v,pz:N}=y,A=r.eql(r.mul(k,N),r.mul(p,x)),D=r.eql(r.mul(m,N),r.mul(v,x));return A&&D}negate(){return new u(this.px,r.neg(this.py),this.pz)}double(){const{a:y,b:k}=e,m=r.mul(k,xx),{px:x,py:p,pz:v}=this;let N=r.ZERO,A=r.ZERO,D=r.ZERO,E=r.mul(x,x),L=r.mul(p,p),C=r.mul(v,v),O=r.mul(x,p);return O=r.add(O,O),D=r.mul(x,v),D=r.add(D,D),N=r.mul(y,D),A=r.mul(m,C),A=r.add(N,A),N=r.sub(L,A),A=r.add(L,A),A=r.mul(N,A),N=r.mul(O,N),D=r.mul(m,D),C=r.mul(y,C),O=r.sub(E,C),O=r.mul(y,O),O=r.add(O,D),D=r.add(E,E),E=r.add(D,E),E=r.add(E,C),E=r.mul(E,O),A=r.add(A,E),C=r.mul(p,v),C=r.add(C,C),E=r.mul(C,O),N=r.sub(N,E),D=r.mul(C,L),D=r.add(D,D),D=r.add(D,D),new u(N,A,D)}add(y){h(y);const{px:k,py:m,pz:x}=this,{px:p,py:v,pz:N}=y;let A=r.ZERO,D=r.ZERO,E=r.ZERO;const L=e.a,C=r.mul(e.b,xx);let O=r.mul(k,p),V=r.mul(m,v),M=r.mul(x,N),ie=r.add(k,m),z=r.add(p,v);ie=r.mul(ie,z),z=r.add(O,V),ie=r.sub(ie,z),z=r.add(k,x);let Y=r.add(p,N);return z=r.mul(z,Y),Y=r.add(O,M),z=r.sub(z,Y),Y=r.add(m,x),A=r.add(v,N),Y=r.mul(Y,A),A=r.add(V,M),Y=r.sub(Y,A),E=r.mul(L,z),A=r.mul(C,M),E=r.add(A,E),A=r.sub(V,E),E=r.add(V,E),D=r.mul(A,E),V=r.add(O,O),V=r.add(V,O),M=r.mul(L,M),z=r.mul(C,z),V=r.add(V,M),M=r.sub(O,M),M=r.mul(L,M),z=r.add(z,M),O=r.mul(V,z),D=r.add(D,O),O=r.mul(Y,z),A=r.mul(ie,A),A=r.sub(A,O),O=r.mul(ie,V),E=r.mul(Y,E),E=r.add(E,O),new u(A,D,E)}subtract(y){return this.add(y.negate())}is0(){return this.equals(u.ZERO)}wNAF(y){return g.wNAFCached(this,d,y,k=>{const m=r.invertBatch(k.map(x=>x.pz));return k.map((x,p)=>x.toAffine(m[p])).map(u.fromAffine)})}multiplyUnsafe(y){const k=u.ZERO;if(y===Fn)return k;if(l(y),y===Nr)return this;const{endo:m}=e;if(!m)return g.unsafeLadder(this,y);let{k1neg:x,k1:p,k2neg:v,k2:N}=m.splitScalar(y),A=k,D=k,E=this;for(;p>Fn||N>Fn;)p&Nr&&(A=A.add(E)),N&Nr&&(D=D.add(E)),E=E.double(),p>>=Nr,N>>=Nr;return x&&(A=A.negate()),v&&(D=D.negate()),D=new u(r.mul(D.px,m.beta),D.py,D.pz),A.add(D)}multiply(y){l(y);let k=y,m,x;const{endo:p}=e;if(p){const{k1neg:v,k1:N,k2neg:A,k2:D}=p.splitScalar(k);let{p:E,f:L}=this.wNAF(N),{p:C,f:O}=this.wNAF(D);E=g.constTimeNegate(v,E),C=g.constTimeNegate(A,C),C=new u(r.mul(C.px,p.beta),C.py,C.pz),m=E.add(C),x=L.add(O)}else{const{p:v,f:N}=this.wNAF(k);m=v,x=N}return u.normalizeZ([m,x])[0]}multiplyAndAddUnsafe(y,k,m){const x=u.BASE,p=(N,A)=>A===Fn||A===Nr||!N.equals(x)?N.multiplyUnsafe(A):N.multiply(A),v=p(this,k).add(p(y,m));return v.is0()?void 0:v}toAffine(y){const{px:k,py:m,pz:x}=this,p=this.is0();y==null&&(y=p?r.ONE:r.inv(x));const v=r.mul(k,y),N=r.mul(m,y),A=r.mul(x,y);if(p)return{x:r.ZERO,y:r.ZERO};if(!r.eql(A,r.ONE))throw new Error("invZ was invalid");return{x:v,y:N}}isTorsionFree(){const{h:y,isTorsionFree:k}=e;if(y===Nr)return!0;if(k)return k(u,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:y,clearCofactor:k}=e;return y===Nr?this:k?k(u,this):this.multiplyUnsafe(e.h)}toRawBytes(y=!0){return this.assertValidity(),n(u,this,y)}toHex(y=!0){return Mo(this.toRawBytes(y))}}u.BASE=new u(e.Gx,e.Gy,r.ONE),u.ZERO=new u(r.ZERO,r.ONE,r.ZERO);const f=e.nBitLength,g=T4(u,e.endo?Math.ceil(f/2):f);return{CURVE:e,ProjectivePoint:u,normPrivateKeyToScalar:c,weierstrassEquation:i,isWithinCurveOrder:o}}function M4(t){const e=Bv(t);return Lc(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function L4(t){const e=M4(t),{Fp:r,n}=e,a=r.BYTES+1,i=2*r.BYTES+1;function o(z){return Fn<z&&z<r.ORDER}function l(z){return Vt(z,n)}function c(z){return v0(z,n)}const{ProjectivePoint:d,normPrivateKeyToScalar:h,weierstrassEquation:u,isWithinCurveOrder:f}=O4({...e,toBytes(z,Y,T){const B=Y.toAffine(),R=r.toBytes(B.x),G=sc;return T?G(Uint8Array.from([Y.hasEvenY()?2:3]),R):G(Uint8Array.from([4]),R,r.toBytes(B.y))},fromBytes(z){const Y=z.length,T=z[0],B=z.subarray(1);if(Y===a&&(T===2||T===3)){const R=Va(B);if(!o(R))throw new Error("Point is not on curve");const G=u(R);let F=r.sqrt(G);const H=(F&Nr)===Nr;return(T&1)===1!==H&&(F=r.neg(F)),{x:R,y:F}}else if(Y===i&&T===4){const R=r.fromBytes(B.subarray(0,r.BYTES)),G=r.fromBytes(B.subarray(r.BYTES,2*r.BYTES));return{x:R,y:G}}else throw new Error(`Point of length ${Y} was invalid. Expected ${a} compressed bytes or ${i} uncompressed bytes`)}}),g=z=>Mo(Fo(z,e.nByteLength));function b(z){const Y=n>>Nr;return z>Y}function y(z){return b(z)?l(-z):z}const k=(z,Y,T)=>Va(z.slice(Y,T));class m{constructor(Y,T,B){this.r=Y,this.s=T,this.recovery=B,this.assertValidity()}static fromCompact(Y){const T=e.nByteLength;return Y=_r("compactSignature",Y,T*2),new m(k(Y,0,T),k(Y,T,2*T))}static fromDER(Y){const{r:T,s:B}=ya.toSig(_r("DER",Y));return new m(T,B)}assertValidity(){if(!f(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!f(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(Y){return new m(this.r,this.s,Y)}recoverPublicKey(Y){const{r:T,s:B,recovery:R}=this,G=D(_r("msgHash",Y));if(R==null||![0,1,2,3].includes(R))throw new Error("recovery id invalid");const F=R===2||R===3?T+e.n:T;if(F>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");const H=R&1?"03":"02",$=d.fromHex(H+g(F)),I=c(F),W=l(-G*I),q=l(B*I),ae=d.BASE.multiplyAndAddUnsafe($,W,q);if(!ae)throw new Error("point at infinify");return ae.assertValidity(),ae}hasHighS(){return b(this.s)}normalizeS(){return this.hasHighS()?new m(this.r,l(-this.s),this.recovery):this}toDERRawBytes(){return Lo(this.toDERHex())}toDERHex(){return ya.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Lo(this.toCompactHex())}toCompactHex(){return g(this.r)+g(this.s)}}const x={isValidPrivateKey(z){try{return h(z),!0}catch{return!1}},normPrivateKeyToScalar:h,randomPrivateKey:()=>{const z=_v(e.n);return P4(e.randomBytes(z),e.n)},precompute(z=8,Y=d.BASE){return Y._setWindowSize(z),Y.multiply(BigInt(3)),Y}};function p(z,Y=!0){return d.fromPrivateKey(z).toRawBytes(Y)}function v(z){const Y=z instanceof Uint8Array,T=typeof z=="string",B=(Y||T)&&z.length;return Y?B===a||B===i:T?B===2*a||B===2*i:z instanceof d}function N(z,Y,T=!0){if(v(z))throw new Error("first arg must be private key");if(!v(Y))throw new Error("second arg must be public key");return d.fromHex(Y).multiply(h(z)).toRawBytes(T)}const A=e.bits2int||function(z){const Y=Va(z),T=z.length*8-e.nBitLength;return T>0?Y>>BigInt(T):Y},D=e.bits2int_modN||function(z){return l(A(z))},E=dg(e.nBitLength);function L(z){if(typeof z!="bigint")throw new Error("bigint expected");if(!(Fn<=z&&z<E))throw new Error(`bigint expected < 2^${e.nBitLength}`);return Fo(z,e.nByteLength)}function C(z,Y,T=O){if(["recovered","canonical"].some(ue=>ue in T))throw new Error("sign() legacy options not supported");const{hash:B,randomBytes:R}=e;let{lowS:G,prehash:F,extraEntropy:H}=T;G==null&&(G=!0),z=_r("msgHash",z),F&&(z=_r("prehashed msgHash",B(z)));const $=D(z),I=h(Y),W=[L(I),L($)];if(H!=null){const ue=H===!0?R(r.BYTES):H;W.push(_r("extraEntropy",ue))}const q=sc(...W),ae=$;function Q(ue){const oe=A(ue);if(!f(oe))return;const ve=c(oe),X=d.BASE.multiply(oe).toAffine(),ge=l(X.x);if(ge===Fn)return;const Ee=l(ve*l(ae+ge*I));if(Ee===Fn)return;let K=(X.x===ge?0:2)|Number(X.y&Nr),ee=Ee;return G&&b(Ee)&&(ee=y(Ee),K^=1),new m(ge,ee,K)}return{seed:q,k2sig:Q}}const O={lowS:e.lowS,prehash:!1},V={lowS:e.lowS,prehash:!1};function M(z,Y,T=O){const{seed:B,k2sig:R}=C(z,Y,T),G=e;return Pv(G.hash.outputLen,G.nByteLength,G.hmac)(B,R)}d.BASE._setWindowSize(8);function ie(z,Y,T,B=V){var X;const R=z;if(Y=_r("msgHash",Y),T=_r("publicKey",T),"strict"in B)throw new Error("options.strict was renamed to lowS");const{lowS:G,prehash:F}=B;let H,$;try{if(typeof R=="string"||R instanceof Uint8Array)try{H=m.fromDER(R)}catch(ge){if(!(ge instanceof ya.Err))throw ge;H=m.fromCompact(R)}else if(typeof R=="object"&&typeof R.r=="bigint"&&typeof R.s=="bigint"){const{r:ge,s:Ee}=R;H=new m(ge,Ee)}else throw new Error("PARSE");$=d.fromHex(T)}catch(ge){if(ge.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(G&&H.hasHighS())return!1;F&&(Y=e.hash(Y));const{r:I,s:W}=H,q=D(Y),ae=c(W),Q=l(q*ae),ue=l(I*ae),oe=(X=d.BASE.multiplyAndAddUnsafe($,Q,ue))==null?void 0:X.toAffine();return oe?l(oe.x)===I:!1}return{CURVE:e,getPublicKey:p,getSharedSecret:N,sign:M,verify:ie,ProjectivePoint:d,Signature:m,utils:x}}class Rv extends Sv{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,qA(e);const n=ig(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const a=this.blockLen,i=new Uint8Array(a);i.set(n.length>a?e.create().update(n).digest():n);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),i.fill(0)}update(e){return gu(this),this.iHash.update(e),this}digestInto(e){gu(this),Av(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:n,finished:a,destroyed:i,blockLen:o,outputLen:l}=this;return e=e,e.finished=a,e.destroyed=i,e.blockLen=o,e.outputLen=l,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Ov=(t,e,r)=>new Rv(t,e).update(r).digest();Ov.create=(t,e)=>new Rv(t,e);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function F4(t){return{hash:t,hmac:(e,...r)=>Ov(t,e,t4(...r)),randomBytes:n4}}function U4(t,e){const r=n=>L4({...t,...F4(n)});return Object.freeze({...r(e),create:r})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Mv=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),yx=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),z4=BigInt(1),N0=BigInt(2),wx=(t,e)=>(t+e/N0)/e;function H4(t){const e=Mv,r=BigInt(3),n=BigInt(6),a=BigInt(11),i=BigInt(22),o=BigInt(23),l=BigInt(44),c=BigInt(88),d=t*t*t%e,h=d*d*t%e,u=mr(h,r,e)*h%e,f=mr(u,r,e)*h%e,g=mr(f,N0,e)*d%e,b=mr(g,a,e)*g%e,y=mr(b,i,e)*b%e,k=mr(y,l,e)*y%e,m=mr(k,c,e)*k%e,x=mr(m,l,e)*y%e,p=mr(x,r,e)*h%e,v=mr(p,o,e)*b%e,N=mr(v,n,e)*d%e,A=mr(N,N0,e);if(!k0.eql(k0.sqr(A),t))throw new Error("Cannot find square root");return A}const k0=D4(Mv,void 0,void 0,{sqrt:H4}),ms=U4({a:BigInt(0),b:BigInt(7),Fp:k0,n:yx,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=yx,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-z4*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),a=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=r,o=BigInt("0x100000000000000000000000000000000"),l=wx(i*t,e),c=wx(-n*t,e);let d=Vt(t-l*r-c*a,e),h=Vt(-l*n-c*i,e);const u=d>o,f=h>o;if(u&&(d=e-d),f&&(h=e-h),d>o||h>o)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:u,k1:d,k2neg:f,k2:h}}}},d4);BigInt(0);ms.ProjectivePoint;const ac="0x0000000000000000000000000000000000000000",bx="0x0000000000000000000000000000000000000000000000000000000000000000",vx=BigInt(0),Nx=BigInt(1),j0=BigInt(2),kx=BigInt(27),jx=BigInt(28),ud=BigInt(35),Lv=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),V4=Lv/j0,G4=Symbol.for("nodejs.util.inspect.custom"),ia={};function qh(t){return Xn(rt(t),32)}var Qi,an,Wi,Ns;const gr=class gr{constructor(e,r,n,a){U(this,Qi);U(this,an);U(this,Wi);U(this,Ns);Xu(e,ia,"Signature"),j(this,Qi,r),j(this,an,n),j(this,Wi,a),j(this,Ns,null)}get r(){return w(this,Qi)}set r(e){P(Ri(e)===32,"invalid r","value",e),j(this,Qi,se(e))}get s(){return P(parseInt(w(this,an).substring(0,3))<8,"non-canonical s; use ._s","s",w(this,an)),w(this,an)}set s(e){P(Ri(e)===32,"invalid s","value",e),j(this,an,se(e))}get _s(){return w(this,an)}isValid(){return BigInt(w(this,an))<=V4}get v(){return w(this,Wi)}set v(e){const r=ye(e,"value");P(r===27||r===28,"invalid v","v",e),j(this,Wi,r)}get networkV(){return w(this,Ns)}get legacyChainId(){const e=this.networkV;return e==null?null:gr.getChainId(e)}get yParity(){return this.v===27?0:1}get yParityAndS(){const e=xe(this.s);return this.yParity&&(e[0]|=128),se(e)}get compactSerialized(){return He([this.r,this.yParityAndS])}get serialized(){return He([this.r,this.s,this.yParity?"0x1c":"0x1b"])}getCanonical(){if(this.isValid())return this;const e=Lv-BigInt(this._s),r=55-this.v,n=new gr(ia,this.r,qh(e),r);return this.networkV&&j(n,Ns,this.networkV),n}clone(){const e=new gr(ia,this.r,this._s,this.v);return this.networkV&&j(e,Ns,this.networkV),e}toJSON(){const e=this.networkV;return{_type:"signature",networkV:e!=null?e.toString():null,r:this.r,s:this._s,v:this.v}}[G4](){return this.toString()}toString(){return this.isValid()?`Signature { r: ${this.r}, s: ${this._s}, v: ${this.v} }`:`Signature { r: ${this.r}, s: ${this._s}, v: ${this.v}, valid: false }`}static getChainId(e){const r=de(e,"v");return r==kx||r==jx?vx:(P(r>=ud,"invalid EIP-155 v","v",e),(r-ud)/j0)}static getChainIdV(e,r){return de(e)*j0+BigInt(35+r-27)}static getNormalizedV(e){const r=de(e);return r===vx||r===kx?27:r===Nx||r===jx?28:(P(r>=ud,"invalid v","v",e),r&Nx?27:28)}static from(e){function r(d,h){P(d,h,"signature",e)}if(e==null)return new gr(ia,bx,bx,27);if(typeof e=="string"){const d=xe(e,"signature");if(d.length===64){const h=se(d.slice(0,32)),u=d.slice(32,64),f=u[0]&128?28:27;return u[0]&=127,new gr(ia,h,se(u),f)}if(d.length===65){const h=se(d.slice(0,32)),u=se(d.slice(32,64)),f=gr.getNormalizedV(d[64]);return new gr(ia,h,u,f)}r(!1,"invalid raw signature length")}if(e instanceof gr)return e.clone();const n=e.r;r(n!=null,"missing r");const a=qh(n),i=function(d,h){if(d!=null)return qh(d);if(h!=null){r(Me(h,32),"invalid yParityAndS");const u=xe(h);return u[0]&=127,se(u)}r(!1,"missing s")}(e.s,e.yParityAndS),{networkV:o,v:l}=function(d,h,u){if(d!=null){const f=de(d);return{networkV:f>=ud?f:void 0,v:gr.getNormalizedV(f)}}if(h!=null)return r(Me(h,32),"invalid yParityAndS"),{v:xe(h)[0]&128?28:27};if(u!=null){switch(ye(u,"sig.yParity")){case 0:return{v:27};case 1:return{v:28}}r(!1,"invalid yParity")}r(!1,"missing v")}(e.v,e.yParityAndS,e.yParity),c=new gr(ia,a,i,l);return o&&j(c,Ns,o),r(e.yParity==null||ye(e.yParity,"sig.yParity")===c.yParity,"yParity mismatch"),r(e.yParityAndS==null||e.yParityAndS===c.yParityAndS,"yParityAndS mismatch"),c}};Qi=new WeakMap,an=new WeakMap,Wi=new WeakMap,Ns=new WeakMap;let qt=gr;var In;const fa=class fa{constructor(e){U(this,In);P(Ri(e)===32,"invalid private key","privateKey","[REDACTED]"),j(this,In,se(e))}get privateKey(){return w(this,In)}get publicKey(){return fa.computePublicKey(w(this,In))}get compressedPublicKey(){return fa.computePublicKey(w(this,In),!0)}sign(e){P(Ri(e)===32,"invalid digest length","digest",e);const r=ms.sign(Tt(e),Tt(w(this,In)),{lowS:!0});return qt.from({r:Zs(r.r,32),s:Zs(r.s,32),v:r.recovery?28:27})}computeSharedSecret(e){const r=fa.computePublicKey(e);return se(ms.getSharedSecret(Tt(w(this,In)),xe(r),!1))}static computePublicKey(e,r){let n=xe(e,"key");if(n.length===32){const i=ms.getPublicKey(n,!!r);return se(i)}if(n.length===64){const i=new Uint8Array(65);i[0]=4,i.set(n,1),n=i}const a=ms.ProjectivePoint.fromHex(n);return se(a.toRawBytes(r))}static recoverPublicKey(e,r){P(Ri(e)===32,"invalid digest length","digest",e);const n=qt.from(r);let a=ms.Signature.fromCompact(Tt(He([n.r,n.s])));a=a.addRecoveryBit(n.yParity);const i=a.recoverPublicKey(Tt(e));return P(i!=null,"invalid signature for digest","signature",r),"0x"+i.toHex(!1)}static addPoints(e,r,n){const a=ms.ProjectivePoint.fromHex(fa.computePublicKey(e).substring(2)),i=ms.ProjectivePoint.fromHex(fa.computePublicKey(r).substring(2));return"0x"+a.add(i).toHex(!!n)}};In=new WeakMap;let ic=fa;const $4=BigInt(0),Q4=BigInt(36);function Ax(t){t=t.toLowerCase();const e=t.substring(2).split(""),r=new Uint8Array(40);for(let a=0;a<40;a++)r[a]=e[a].charCodeAt(0);const n=xe(tt(r));for(let a=0;a<40;a+=2)n[a>>1]>>4>=8&&(e[a]=e[a].toUpperCase()),(n[a>>1]&15)>=8&&(e[a+1]=e[a+1].toUpperCase());return"0x"+e.join("")}const ug={};for(let t=0;t<10;t++)ug[String(t)]=String(t);for(let t=0;t<26;t++)ug[String.fromCharCode(65+t)]=String(10+t);const Ex=15;function W4(t){t=t.toUpperCase(),t=t.substring(4)+t.substring(0,2)+"00";let e=t.split("").map(n=>ug[n]).join("");for(;e.length>=Ex;){let n=e.substring(0,Ex);e=parseInt(n,10)%97+e.substring(n.length)}let r=String(98-parseInt(e,10)%97);for(;r.length<2;)r="0"+r;return r}const K4=function(){const t={};for(let e=0;e<36;e++){const r="0123456789abcdefghijklmnopqrstuvwxyz"[e];t[r]=BigInt(e)}return t}();function J4(t){t=t.toLowerCase();let e=$4;for(let r=0;r<t.length;r++)e=e*Q4+K4[t[r]];return e}function Ie(t){if(P(typeof t=="string","invalid address","address",t),t.match(/^(0x)?[0-9a-fA-F]{40}$/)){t.startsWith("0x")||(t="0x"+t);const e=Ax(t);return P(!t.match(/([A-F].*[a-f])|([a-f].*[A-F])/)||e===t,"bad address checksum","address",t),e}if(t.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){P(t.substring(2,4)===W4(t),"bad icap checksum","address",t);let e=J4(t.substring(4)).toString(16);for(;e.length<40;)e="0"+e;return Ax("0x"+e)}P(!1,"invalid address","address",t)}function Y4(t){const e=Ie(t.from);let n=de(t.nonce,"tx.nonce").toString(16);return n==="0"?n="0x":n.length%2?n="0x0"+n:n="0x"+n,Ie(Je(tt(Qn([e,n])),12))}function Fv(t){return t&&typeof t.getAddress=="function"}async function Zh(t,e){const r=await e;return(r==null||r==="0x0000000000000000000000000000000000000000")&&(J(typeof t!="string","unconfigured name","UNCONFIGURED_NAME",{value:t}),P(!1,"invalid AddressLike value; did not resolve to a value address","target",t)),Ie(r)}function Bt(t,e){if(typeof t=="string")return t.match(/^0x[0-9a-f]{40}$/i)?Ie(t):(J(e!=null,"ENS resolution requires a provider","UNSUPPORTED_OPERATION",{operation:"resolveName"}),Zh(t,e.resolveName(t)));if(Fv(t))return Zh(t,t.getAddress());if(t&&typeof t.then=="function")return Zh(t,t);P(!1,"unsupported addressable value","target",t)}const jn={};function le(t,e){let r=!1;return e<0&&(r=!0,e*=-1),new At(jn,`${r?"":"u"}int${e}`,t,{signed:r,width:e})}function De(t,e){return new At(jn,`bytes${e||""}`,t,{size:e})}const Sx=Symbol.for("_ethers_typed");var Pa;const An=class An{constructor(e,r,n,a){S(this,"type");S(this,"value");U(this,Pa);S(this,"_typedSymbol");a==null&&(a=null),Xu(jn,e,"Typed"),me(this,{_typedSymbol:Sx,type:r,value:n}),j(this,Pa,a),this.format()}format(){if(this.type==="array")throw new Error("");if(this.type==="dynamicArray")throw new Error("");return this.type==="tuple"?`tuple(${this.value.map(e=>e.format()).join(",")})`:this.type}defaultValue(){return 0}minValue(){return 0}maxValue(){return 0}isBigInt(){return!!this.type.match(/^u?int[0-9]+$/)}isData(){return this.type.startsWith("bytes")}isString(){return this.type==="string"}get tupleName(){if(this.type!=="tuple")throw TypeError("not a tuple");return w(this,Pa)}get arrayLength(){if(this.type!=="array")throw TypeError("not an array");return w(this,Pa)===!0?-1:w(this,Pa)===!1?this.value.length:null}static from(e,r){return new An(jn,e,r)}static uint8(e){return le(e,8)}static uint16(e){return le(e,16)}static uint24(e){return le(e,24)}static uint32(e){return le(e,32)}static uint40(e){return le(e,40)}static uint48(e){return le(e,48)}static uint56(e){return le(e,56)}static uint64(e){return le(e,64)}static uint72(e){return le(e,72)}static uint80(e){return le(e,80)}static uint88(e){return le(e,88)}static uint96(e){return le(e,96)}static uint104(e){return le(e,104)}static uint112(e){return le(e,112)}static uint120(e){return le(e,120)}static uint128(e){return le(e,128)}static uint136(e){return le(e,136)}static uint144(e){return le(e,144)}static uint152(e){return le(e,152)}static uint160(e){return le(e,160)}static uint168(e){return le(e,168)}static uint176(e){return le(e,176)}static uint184(e){return le(e,184)}static uint192(e){return le(e,192)}static uint200(e){return le(e,200)}static uint208(e){return le(e,208)}static uint216(e){return le(e,216)}static uint224(e){return le(e,224)}static uint232(e){return le(e,232)}static uint240(e){return le(e,240)}static uint248(e){return le(e,248)}static uint256(e){return le(e,256)}static uint(e){return le(e,256)}static int8(e){return le(e,-8)}static int16(e){return le(e,-16)}static int24(e){return le(e,-24)}static int32(e){return le(e,-32)}static int40(e){return le(e,-40)}static int48(e){return le(e,-48)}static int56(e){return le(e,-56)}static int64(e){return le(e,-64)}static int72(e){return le(e,-72)}static int80(e){return le(e,-80)}static int88(e){return le(e,-88)}static int96(e){return le(e,-96)}static int104(e){return le(e,-104)}static int112(e){return le(e,-112)}static int120(e){return le(e,-120)}static int128(e){return le(e,-128)}static int136(e){return le(e,-136)}static int144(e){return le(e,-144)}static int152(e){return le(e,-152)}static int160(e){return le(e,-160)}static int168(e){return le(e,-168)}static int176(e){return le(e,-176)}static int184(e){return le(e,-184)}static int192(e){return le(e,-192)}static int200(e){return le(e,-200)}static int208(e){return le(e,-208)}static int216(e){return le(e,-216)}static int224(e){return le(e,-224)}static int232(e){return le(e,-232)}static int240(e){return le(e,-240)}static int248(e){return le(e,-248)}static int256(e){return le(e,-256)}static int(e){return le(e,-256)}static bytes1(e){return De(e,1)}static bytes2(e){return De(e,2)}static bytes3(e){return De(e,3)}static bytes4(e){return De(e,4)}static bytes5(e){return De(e,5)}static bytes6(e){return De(e,6)}static bytes7(e){return De(e,7)}static bytes8(e){return De(e,8)}static bytes9(e){return De(e,9)}static bytes10(e){return De(e,10)}static bytes11(e){return De(e,11)}static bytes12(e){return De(e,12)}static bytes13(e){return De(e,13)}static bytes14(e){return De(e,14)}static bytes15(e){return De(e,15)}static bytes16(e){return De(e,16)}static bytes17(e){return De(e,17)}static bytes18(e){return De(e,18)}static bytes19(e){return De(e,19)}static bytes20(e){return De(e,20)}static bytes21(e){return De(e,21)}static bytes22(e){return De(e,22)}static bytes23(e){return De(e,23)}static bytes24(e){return De(e,24)}static bytes25(e){return De(e,25)}static bytes26(e){return De(e,26)}static bytes27(e){return De(e,27)}static bytes28(e){return De(e,28)}static bytes29(e){return De(e,29)}static bytes30(e){return De(e,30)}static bytes31(e){return De(e,31)}static bytes32(e){return De(e,32)}static address(e){return new An(jn,"address",e)}static bool(e){return new An(jn,"bool",!!e)}static bytes(e){return new An(jn,"bytes",e)}static string(e){return new An(jn,"string",e)}static array(e,r){throw new Error("not implemented yet")}static tuple(e,r){throw new Error("not implemented yet")}static overrides(e){return new An(jn,"overrides",Object.assign({},e))}static isTyped(e){return e&&typeof e=="object"&&"_typedSymbol"in e&&e._typedSymbol===Sx}static dereference(e,r){if(An.isTyped(e)){if(e.type!==r)throw new Error(`invalid type: expecetd ${r}, got ${e.type}`);return e.value}return e}};Pa=new WeakMap;let At=An;class q4 extends ss{constructor(e){super("address","address",e,!1)}defaultValue(){return"0x0000000000000000000000000000000000000000"}encode(e,r){let n=At.dereference(r,"string");try{n=Ie(n)}catch(a){return this._throwError(a.message,r)}return e.writeValue(n)}decode(e){return Ie(Zs(e.readValue(),20))}}class Z4 extends ss{constructor(r){super(r.name,r.type,"_",r.dynamic);S(this,"coder");this.coder=r}defaultValue(){return this.coder.defaultValue()}encode(r,n){return this.coder.encode(r,n)}decode(r){return this.coder.decode(r)}}function Uv(t,e,r){let n=[];if(Array.isArray(r))n=r;else if(r&&typeof r=="object"){let c={};n=e.map(d=>{const h=d.localName;return J(h,"cannot encode object for signature with missing names","INVALID_ARGUMENT",{argument:"values",info:{coder:d},value:r}),J(!c[h],"cannot encode object for signature with duplicate names","INVALID_ARGUMENT",{argument:"values",info:{coder:d},value:r}),c[h]=!0,r[h]})}else P(!1,"invalid tuple value","tuple",r);P(e.length===n.length,"types/value length mismatch","tuple",r);let a=new p0,i=new p0,o=[];e.forEach((c,d)=>{let h=n[d];if(c.dynamic){let u=i.length;c.encode(i,h);let f=a.writeUpdatableValue();o.push(g=>{f(g+u)})}else c.encode(a,h)}),o.forEach(c=>{c(a.length)});let l=t.appendWriter(a);return l+=t.appendWriter(i),l}function zv(t,e){let r=[],n=[],a=t.subReader(0);return e.forEach(i=>{let o=null;if(i.dynamic){let l=t.readIndex(),c=a.subReader(l);try{o=i.decode(c)}catch(d){if(mt(d,"BUFFER_OVERRUN"))throw d;o=d,o.baseType=i.name,o.name=i.localName,o.type=i.type}}else try{o=i.decode(t)}catch(l){if(mt(l,"BUFFER_OVERRUN"))throw l;o=l,o.baseType=i.name,o.name=i.localName,o.type=i.type}if(o==null)throw new Error("investigate");r.push(o),n.push(i.localName||null)}),Oo.fromItems(r,n)}class X4 extends ss{constructor(r,n,a){const i=r.type+"["+(n>=0?n:"")+"]",o=n===-1||r.dynamic;super("array",i,a,o);S(this,"coder");S(this,"length");me(this,{coder:r,length:n})}defaultValue(){const r=this.coder.defaultValue(),n=[];for(let a=0;a<this.length;a++)n.push(r);return n}encode(r,n){const a=At.dereference(n,"array");Array.isArray(a)||this._throwError("expected array value",a);let i=this.length;i===-1&&(i=a.length,r.writeValue(a.length)),Qb(a.length,i,"coder array"+(this.localName?" "+this.localName:""));let o=[];for(let l=0;l<a.length;l++)o.push(this.coder);return Uv(r,o,a)}decode(r){let n=this.length;n===-1&&(n=r.readIndex(),J(n*_t<=r.dataLength,"insufficient data length","BUFFER_OVERRUN",{buffer:r.bytes,offset:n*_t,length:r.dataLength}));let a=[];for(let i=0;i<n;i++)a.push(new Z4(this.coder));return zv(r,a)}}class e3 extends ss{constructor(e){super("bool","bool",e,!1)}defaultValue(){return!1}encode(e,r){const n=At.dereference(r,"bool");return e.writeValue(n?1:0)}decode(e){return!!e.readValue()}}class Hv extends ss{constructor(e,r){super(e,e,r,!0)}defaultValue(){return"0x"}encode(e,r){r=Tt(r);let n=e.writeValue(r.length);return n+=e.writeBytes(r),n}decode(e){return e.readBytes(e.readIndex(),!0)}}class t3 extends Hv{constructor(e){super("bytes",e)}decode(e){return se(super.decode(e))}}class r3 extends ss{constructor(r,n){let a="bytes"+String(r);super(a,a,n,!1);S(this,"size");me(this,{size:r},{size:"number"})}defaultValue(){return"0x0000000000000000000000000000000000000000000000000000000000000000".substring(0,2+this.size*2)}encode(r,n){let a=Tt(At.dereference(n,this.type));return a.length!==this.size&&this._throwError("incorrect data length",n),r.writeBytes(a)}decode(r){return se(r.readBytes(this.size))}}const n3=new Uint8Array([]);class s3 extends ss{constructor(e){super("null","",e,!1)}defaultValue(){return null}encode(e,r){return r!=null&&this._throwError("not null",r),e.writeBytes(n3)}decode(e){return e.readBytes(0),null}}const a3=BigInt(0),i3=BigInt(1),o3=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");class l3 extends ss{constructor(r,n,a){const i=(n?"int":"uint")+r*8;super(i,i,a,!1);S(this,"size");S(this,"signed");me(this,{size:r,signed:n},{size:"number",signed:"boolean"})}defaultValue(){return 0}encode(r,n){let a=de(At.dereference(n,this.type)),i=gl(o3,_t*8);if(this.signed){let o=gl(i,this.size*8-1);(a>o||a<-(o+i3))&&this._throwError("value out-of-bounds",n),a=Jb(a,8*_t)}else(a<a3||a>gl(i,this.size*8))&&this._throwError("value out-of-bounds",n);return r.writeValue(a)}decode(r){let n=gl(r.readValue(),this.size*8);return this.signed&&(n=Gj(n,this.size*8)),n}}class c3 extends Hv{constructor(e){super("string",e)}defaultValue(){return""}encode(e,r){return super.encode(e,$n(At.dereference(r,"string")))}decode(e){return fu(super.decode(e))}}class hd extends ss{constructor(r,n){let a=!1;const i=[];r.forEach(l=>{l.dynamic&&(a=!0),i.push(l.type)});const o="tuple("+i.join(",")+")";super("tuple",o,n,a);S(this,"coders");me(this,{coders:Object.freeze(r.slice())})}defaultValue(){const r=[];this.coders.forEach(a=>{r.push(a.defaultValue())});const n=this.coders.reduce((a,i)=>{const o=i.localName;return o&&(a[o]||(a[o]=0),a[o]++),a},{});return this.coders.forEach((a,i)=>{let o=a.localName;!o||n[o]!==1||(o==="length"&&(o="_length"),r[o]==null&&(r[o]=r[i]))}),Object.freeze(r)}encode(r,n){const a=At.dereference(n,"tuple");return Uv(r,this.coders,a)}decode(r){return zv(r,this.coders)}}function Xh(t,e){return{address:Ie(t),storageKeys:e.map((r,n)=>(P(Me(r,32),"invalid slot",`storageKeys[${n}]`,r),r.toLowerCase()))}}function ni(t){if(Array.isArray(t))return t.map((r,n)=>Array.isArray(r)?(P(r.length===2,"invalid slot set",`value[${n}]`,r),Xh(r[0],r[1])):(P(r!=null&&typeof r=="object","invalid address-slot set","value",t),Xh(r.address,r.storageKeys)));P(t!=null&&typeof t=="object","invalid access list","value",t);const e=Object.keys(t).map(r=>{const n=t[r].reduce((a,i)=>(a[i]=!0,a),{});return Xh(r,Object.keys(n).sort())});return e.sort((r,n)=>r.address.localeCompare(n.address)),e}function Vv(t){return{address:Ie(t.address),nonce:de(t.nonce!=null?t.nonce:0),chainId:de(t.chainId!=null?t.chainId:0),signature:qt.from(t.signature)}}function d3(t){let e;return typeof t=="string"?e=ic.computePublicKey(t,!1):e=t.publicKey,Ie(tt("0x"+e.substring(4)).substring(26))}function u3(t,e){return d3(ic.recoverPublicKey(t,e))}const ot=BigInt(0),h3=BigInt(2),f3=BigInt(27),m3=BigInt(28),g3=BigInt(35),p3=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),x3=Symbol.for("nodejs.util.inspect.custom"),ef=4096*32,Id=128;function y3(t){return{blobToKzgCommitment:n=>{if("computeBlobProof"in t){if("blobToKzgCommitment"in t&&typeof t.blobToKzgCommitment=="function")return xe(t.blobToKzgCommitment(se(n)))}else if("blobToKzgCommitment"in t&&typeof t.blobToKzgCommitment=="function")return xe(t.blobToKzgCommitment(n));if("blobToKZGCommitment"in t&&typeof t.blobToKZGCommitment=="function")return xe(t.blobToKZGCommitment(se(n)));P(!1,"unsupported KZG library","kzg",t)},computeBlobKzgProof:(n,a)=>{if("computeBlobProof"in t&&typeof t.computeBlobProof=="function")return xe(t.computeBlobProof(se(n),se(a)));if("computeBlobKzgProof"in t&&typeof t.computeBlobKzgProof=="function")return t.computeBlobKzgProof(n,a);if("computeBlobKZGProof"in t&&typeof t.computeBlobKZGProof=="function")return xe(t.computeBlobKZGProof(se(n),se(a)));P(!1,"unsupported KZG library","kzg",t)}}}function Cx(t,e){let r=t.toString(16);for(;r.length<2;)r="0"+r;return r+=Zo(e).substring(4),"0x"+r}function Xo(t){return t==="0x"?null:Ie(t)}function nh(t,e){try{return ni(t)}catch(r){P(!1,r.message,e,t)}}function w3(t,e){try{if(!Array.isArray(t))throw new Error("authorizationList: invalid array");const r=[];for(let n=0;n<t.length;n++){const a=t[n];if(!Array.isArray(a))throw new Error(`authorization[${n}]: invalid array`);if(a.length!==6)throw new Error(`authorization[${n}]: wrong length`);if(!a[1])throw new Error(`authorization[${n}]: null address`);r.push({address:Xo(a[1]),nonce:Be(a[2],"nonce"),chainId:Be(a[0],"chainId"),signature:qt.from({yParity:si(a[3],"yParity"),r:Xn(a[4],32),s:Xn(a[5],32)})})}return r}catch(r){P(!1,r.message,e,t)}}function si(t,e){return t==="0x"?0:ye(t,e)}function Be(t,e){if(t==="0x")return ot;const r=de(t,e);return P(r<=p3,"value exceeds uint size",e,r),r}function ke(t,e){const r=de(t,"value"),n=rt(r);return P(n.length<=32,"value too large",`tx.${e}`,r),n}function sh(t){return ni(t).map(e=>[e.address,e.storageKeys])}function b3(t){return t.map(e=>[ke(e.chainId,"chainId"),e.address,ke(e.nonce,"nonce"),ke(e.signature.yParity,"yParity"),rt(e.signature.r),rt(e.signature._s)])}function v3(t,e){P(Array.isArray(t),`invalid ${e}`,"value",t);for(let r=0;r<t.length;r++)P(Me(t[r],32),"invalid ${ param } hash",`value[${r}]`,t[r]);return t}function N3(t){const e=Mc(t);P(Array.isArray(e)&&(e.length===9||e.length===6),"invalid field count for legacy transaction","data",t);const r={type:0,nonce:si(e[0],"nonce"),gasPrice:Be(e[1],"gasPrice"),gasLimit:Be(e[2],"gasLimit"),to:Xo(e[3]),value:Be(e[4],"value"),data:se(e[5]),chainId:ot};if(e.length===6)return r;const n=Be(e[6],"v"),a=Be(e[7],"r"),i=Be(e[8],"s");if(a===ot&&i===ot)r.chainId=n;else{let o=(n-g3)/h3;o<ot&&(o=ot),r.chainId=o,P(o!==ot||n===f3||n===m3,"non-canonical legacy v","v",e[6]),r.signature=qt.from({r:Xn(e[7],32),s:Xn(e[8],32),v:n})}return r}function k3(t,e){const r=[ke(t.nonce,"nonce"),ke(t.gasPrice||0,"gasPrice"),ke(t.gasLimit,"gasLimit"),t.to||"0x",ke(t.value,"value"),t.data];let n=ot;if(t.chainId!=ot)n=de(t.chainId,"tx.chainId"),P(!e||e.networkV==null||e.legacyChainId===n,"tx.chainId/sig.v mismatch","sig",e);else if(t.signature){const i=t.signature.legacyChainId;i!=null&&(n=i)}if(!e)return n!==ot&&(r.push(rt(n)),r.push("0x"),r.push("0x")),Qn(r);let a=BigInt(27+e.yParity);return n!==ot?a=qt.getChainIdV(n,e.v):BigInt(e.v)!==a&&P(!1,"tx.chainId/sig.v mismatch","sig",e),r.push(rt(a)),r.push(rt(e.r)),r.push(rt(e._s)),Qn(r)}function ah(t,e){let r;try{if(r=si(e[0],"yParity"),r!==0&&r!==1)throw new Error("bad yParity")}catch{P(!1,"invalid yParity","yParity",e[0])}const n=Xn(e[1],32),a=Xn(e[2],32),i=qt.from({r:n,s:a,yParity:r});t.signature=i}function j3(t){const e=Mc(xe(t).slice(1));P(Array.isArray(e)&&(e.length===9||e.length===12),"invalid field count for transaction type: 2","data",se(t));const r={type:2,chainId:Be(e[0],"chainId"),nonce:si(e[1],"nonce"),maxPriorityFeePerGas:Be(e[2],"maxPriorityFeePerGas"),maxFeePerGas:Be(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:Be(e[4],"gasLimit"),to:Xo(e[5]),value:Be(e[6],"value"),data:se(e[7]),accessList:nh(e[8],"accessList")};return e.length===9||ah(r,e.slice(9)),r}function A3(t,e){const r=[ke(t.chainId,"chainId"),ke(t.nonce,"nonce"),ke(t.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),ke(t.maxFeePerGas||0,"maxFeePerGas"),ke(t.gasLimit,"gasLimit"),t.to||"0x",ke(t.value,"value"),t.data,sh(t.accessList||[])];return e&&(r.push(ke(e.yParity,"yParity")),r.push(rt(e.r)),r.push(rt(e.s))),He(["0x02",Qn(r)])}function E3(t){const e=Mc(xe(t).slice(1));P(Array.isArray(e)&&(e.length===8||e.length===11),"invalid field count for transaction type: 1","data",se(t));const r={type:1,chainId:Be(e[0],"chainId"),nonce:si(e[1],"nonce"),gasPrice:Be(e[2],"gasPrice"),gasLimit:Be(e[3],"gasLimit"),to:Xo(e[4]),value:Be(e[5],"value"),data:se(e[6]),accessList:nh(e[7],"accessList")};return e.length===8||ah(r,e.slice(8)),r}function S3(t,e){const r=[ke(t.chainId,"chainId"),ke(t.nonce,"nonce"),ke(t.gasPrice||0,"gasPrice"),ke(t.gasLimit,"gasLimit"),t.to||"0x",ke(t.value,"value"),t.data,sh(t.accessList||[])];return e&&(r.push(ke(e.yParity,"recoveryParam")),r.push(rt(e.r)),r.push(rt(e.s))),He(["0x01",Qn(r)])}function C3(t){let e=Mc(xe(t).slice(1)),r="3",n=null,a=null;if(e.length===4&&Array.isArray(e[0])){r="3 (network format)";const o=e[1],l=e[2],c=e[3];P(Array.isArray(o),"invalid network format: blobs not an array","fields[1]",o),P(Array.isArray(l),"invalid network format: commitments not an array","fields[2]",l),P(Array.isArray(c),"invalid network format: proofs not an array","fields[3]",c),P(o.length===l.length,"invalid network format: blobs/commitments length mismatch","fields",e),P(o.length===c.length,"invalid network format: blobs/proofs length mismatch","fields",e),a=[];for(let d=0;d<e[1].length;d++)a.push({data:o[d],commitment:l[d],proof:c[d]});e=e[0]}else if(e.length===5&&Array.isArray(e[0])){r="3 (EIP-7594 network format)",n=ye(e[1]);const o=e[2],l=e[3],c=e[4];P(n===1,`unsupported EIP-7594 network format version: ${n}`,"fields[1]",n),P(Array.isArray(o),"invalid EIP-7594 network format: blobs not an array","fields[2]",o),P(Array.isArray(l),"invalid EIP-7594 network format: commitments not an array","fields[3]",l),P(Array.isArray(c),"invalid EIP-7594 network format: proofs not an array","fields[4]",c),P(o.length===l.length,"invalid network format: blobs/commitments length mismatch","fields",e),P(o.length*Id===c.length,"invalid network format: blobs/proofs length mismatch","fields",e),a=[];for(let d=0;d<o.length;d++){const h=[];for(let u=0;u<Id;u++)h.push(c[d*Id+u]);a.push({data:o[d],commitment:l[d],proof:He(h)})}e=e[0]}P(Array.isArray(e)&&(e.length===11||e.length===14),`invalid field count for transaction type: ${r}`,"data",se(t));const i={type:3,chainId:Be(e[0],"chainId"),nonce:si(e[1],"nonce"),maxPriorityFeePerGas:Be(e[2],"maxPriorityFeePerGas"),maxFeePerGas:Be(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:Be(e[4],"gasLimit"),to:Xo(e[5]),value:Be(e[6],"value"),data:se(e[7]),accessList:nh(e[8],"accessList"),maxFeePerBlobGas:Be(e[9],"maxFeePerBlobGas"),blobVersionedHashes:e[10],blobWrapperVersion:n};a&&(i.blobs=a),P(i.to!=null,`invalid address for transaction type: ${r}`,"data",t),P(Array.isArray(i.blobVersionedHashes),"invalid blobVersionedHashes: must be an array","data",t);for(let o=0;o<i.blobVersionedHashes.length;o++)P(Me(i.blobVersionedHashes[o],32),`invalid blobVersionedHash at index ${o}: must be length 32`,"data",t);return e.length===11||ah(i,e.slice(11)),i}function D3(t,e,r){const n=[ke(t.chainId,"chainId"),ke(t.nonce,"nonce"),ke(t.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),ke(t.maxFeePerGas||0,"maxFeePerGas"),ke(t.gasLimit,"gasLimit"),t.to||ac,ke(t.value,"value"),t.data,sh(t.accessList||[]),ke(t.maxFeePerBlobGas||0,"maxFeePerBlobGas"),v3(t.blobVersionedHashes||[],"blobVersionedHashes")];if(e&&(n.push(ke(e.yParity,"yParity")),n.push(rt(e.r)),n.push(rt(e.s)),r)){if(t.blobWrapperVersion!=null){const a=rt(t.blobWrapperVersion),i=[];for(const{proof:o}of r){const l=xe(o),c=l.length/Id;for(let d=0;d<l.length;d+=c)i.push(l.subarray(d,d+c))}return He(["0x03",Qn([n,a,r.map(o=>o.data),r.map(o=>o.commitment),i])])}return He(["0x03",Qn([n,r.map(a=>a.data),r.map(a=>a.commitment),r.map(a=>a.proof)])])}return He(["0x03",Qn(n)])}function P3(t){const e=Mc(xe(t).slice(1));P(Array.isArray(e)&&(e.length===10||e.length===13),"invalid field count for transaction type: 4","data",se(t));const r={type:4,chainId:Be(e[0],"chainId"),nonce:si(e[1],"nonce"),maxPriorityFeePerGas:Be(e[2],"maxPriorityFeePerGas"),maxFeePerGas:Be(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:Be(e[4],"gasLimit"),to:Xo(e[5]),value:Be(e[6],"value"),data:se(e[7]),accessList:nh(e[8],"accessList"),authorizationList:w3(e[9],"authorizationList")};return e.length===10||ah(r,e.slice(10)),r}function I3(t,e){const r=[ke(t.chainId,"chainId"),ke(t.nonce,"nonce"),ke(t.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),ke(t.maxFeePerGas||0,"maxFeePerGas"),ke(t.gasLimit,"gasLimit"),t.to||"0x",ke(t.value,"value"),t.data,sh(t.accessList||[]),b3(t.authorizationList||[])];return e&&(r.push(ke(e.yParity,"yParity")),r.push(rt(e.r)),r.push(rt(e.s))),He(["0x04",Qn(r)])}var Or,Ki,Ji,Yi,qi,Zi,Xi,eo,to,ro,no,so,Ia,ks,on,js,ao,io,oo,Td;const nn=class nn{constructor(){U(this,oo);U(this,Or);U(this,Ki);U(this,Ji);U(this,Yi);U(this,qi);U(this,Zi);U(this,Xi);U(this,eo);U(this,to);U(this,ro);U(this,no);U(this,so);U(this,Ia);U(this,ks);U(this,on);U(this,js);U(this,ao);U(this,io);j(this,Or,null),j(this,Ki,null),j(this,Yi,0),j(this,qi,ot),j(this,Zi,null),j(this,Xi,null),j(this,eo,null),j(this,Ji,"0x"),j(this,to,ot),j(this,ro,ot),j(this,no,null),j(this,so,null),j(this,Ia,null),j(this,ks,null),j(this,on,null),j(this,js,null),j(this,ao,null),j(this,io,null)}get type(){return w(this,Or)}set type(e){switch(e){case null:j(this,Or,null);break;case 0:case"legacy":j(this,Or,0);break;case 1:case"berlin":case"eip-2930":j(this,Or,1);break;case 2:case"london":case"eip-1559":j(this,Or,2);break;case 3:case"cancun":case"eip-4844":j(this,Or,3);break;case 4:case"pectra":case"eip-7702":j(this,Or,4);break;default:P(!1,"unsupported transaction type","type",e)}}get typeName(){switch(this.type){case 0:return"legacy";case 1:return"eip-2930";case 2:return"eip-1559";case 3:return"eip-4844";case 4:return"eip-7702"}return null}get to(){const e=w(this,Ki);return e==null&&this.type===3?ac:e}set to(e){j(this,Ki,e==null?null:Ie(e))}get nonce(){return w(this,Yi)}set nonce(e){j(this,Yi,ye(e,"value"))}get gasLimit(){return w(this,qi)}set gasLimit(e){j(this,qi,de(e))}get gasPrice(){const e=w(this,Zi);return e==null&&(this.type===0||this.type===1)?ot:e}set gasPrice(e){j(this,Zi,e==null?null:de(e,"gasPrice"))}get maxPriorityFeePerGas(){const e=w(this,Xi);return e??(this.type===2||this.type===3?ot:null)}set maxPriorityFeePerGas(e){j(this,Xi,e==null?null:de(e,"maxPriorityFeePerGas"))}get maxFeePerGas(){const e=w(this,eo);return e??(this.type===2||this.type===3?ot:null)}set maxFeePerGas(e){j(this,eo,e==null?null:de(e,"maxFeePerGas"))}get data(){return w(this,Ji)}set data(e){j(this,Ji,se(e))}get value(){return w(this,to)}set value(e){j(this,to,de(e,"value"))}get chainId(){return w(this,ro)}set chainId(e){j(this,ro,de(e))}get signature(){return w(this,no)||null}set signature(e){j(this,no,e==null?null:qt.from(e))}isValid(){const e=this.signature;if(e&&!e.isValid())return!1;const r=this.authorizationList;if(r){for(const n of r)if(!n.signature.isValid())return!1}return!0}get accessList(){const e=w(this,so)||null;return e??(this.type===1||this.type===2||this.type===3?[]:null)}set accessList(e){j(this,so,e==null?null:ni(e))}get authorizationList(){const e=w(this,ao)||null;return e==null&&this.type===4?[]:e}set authorizationList(e){j(this,ao,e==null?null:e.map(r=>Vv(r)))}get maxFeePerBlobGas(){const e=w(this,Ia);return e==null&&this.type===3?ot:e}set maxFeePerBlobGas(e){j(this,Ia,e==null?null:de(e,"maxFeePerBlobGas"))}get blobVersionedHashes(){let e=w(this,ks);return e==null&&this.type===3?[]:e}set blobVersionedHashes(e){if(e!=null){P(Array.isArray(e),"blobVersionedHashes must be an Array","value",e),e=e.slice();for(let r=0;r<e.length;r++)P(Me(e[r],32),"invalid blobVersionedHash",`value[${r}]`,e[r])}j(this,ks,e)}get blobs(){return w(this,js)==null?null:w(this,js).map(e=>Object.assign({},e))}set blobs(e){if(e==null){j(this,js,null);return}const r=[],n=[];for(let a=0;a<e.length;a++){const i=e[a];if(tg(i)){J(w(this,on),"adding a raw blob requires a KZG library","UNSUPPORTED_OPERATION",{operation:"set blobs()"});let o=xe(i);if(P(o.length<=ef,"blob is too large",`blobs[${a}]`,i),o.length!==ef){const d=new Uint8Array(ef);d.set(o),o=d}const l=w(this,on).blobToKzgCommitment(o),c=se(w(this,on).computeBlobKzgProof(o,l));r.push({data:se(o),commitment:se(l),proof:c}),n.push(Cx(1,l))}else{const o=se(i.data),l=se(i.commitment),c=se(i.proof);r.push({data:o,commitment:l,proof:c}),n.push(Cx(1,l))}}j(this,js,r),j(this,ks,n)}get kzg(){return w(this,on)}set kzg(e){e==null?j(this,on,null):j(this,on,y3(e))}get blobWrapperVersion(){return w(this,io)}set blobWrapperVersion(e){j(this,io,e)}get hash(){return this.signature==null?null:tt(ne(this,oo,Td).call(this,!0,!1))}get unsignedHash(){return tt(this.unsignedSerialized)}get from(){return this.signature==null?null:u3(this.unsignedHash,this.signature.getCanonical())}get fromPublicKey(){return this.signature==null?null:ic.recoverPublicKey(this.unsignedHash,this.signature.getCanonical())}isSigned(){return this.signature!=null}get serialized(){return ne(this,oo,Td).call(this,!0,!0)}get unsignedSerialized(){return ne(this,oo,Td).call(this,!1,!1)}inferType(){const e=this.inferTypes();return e.indexOf(2)>=0?2:e.pop()}inferTypes(){const e=this.gasPrice!=null,r=this.maxFeePerGas!=null||this.maxPriorityFeePerGas!=null,n=this.accessList!=null,a=w(this,Ia)!=null||w(this,ks);this.maxFeePerGas!=null&&this.maxPriorityFeePerGas!=null&&J(this.maxFeePerGas>=this.maxPriorityFeePerGas,"priorityFee cannot be more than maxFee","BAD_DATA",{value:this}),J(!r||this.type!==0&&this.type!==1,"transaction type cannot have maxFeePerGas or maxPriorityFeePerGas","BAD_DATA",{value:this}),J(this.type!==0||!n,"legacy transaction cannot have accessList","BAD_DATA",{value:this});const i=[];return this.type!=null?i.push(this.type):this.authorizationList&&this.authorizationList.length?i.push(4):r?i.push(2):e?(i.push(1),n||i.push(0)):n?(i.push(1),i.push(2)):(a&&this.to||(i.push(0),i.push(1),i.push(2)),i.push(3)),i.sort(),i}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}clone(){return nn.from(this)}toJSON(){const e=r=>r==null?null:r.toString();return{type:this.type,to:this.to,data:this.data,nonce:this.nonce,gasLimit:e(this.gasLimit),gasPrice:e(this.gasPrice),maxPriorityFeePerGas:e(this.maxPriorityFeePerGas),maxFeePerGas:e(this.maxFeePerGas),value:e(this.value),chainId:e(this.chainId),sig:this.signature?this.signature.toJSON():null,accessList:this.accessList}}[x3](){return this.toString()}toString(){const e=[],r=a=>{let i=this[a];typeof i=="string"&&(i=JSON.stringify(i)),e.push(`${a}: ${i}`)};this.type&&r("type"),r("to"),r("data"),r("nonce"),r("gasLimit"),r("value"),this.chainId!=null&&r("chainId"),this.signature&&(r("from"),e.push(`signature: ${this.signature.toString()}`));const n=this.authorizationList;if(n){const a=[];for(const i of n){const o=[];o.push(`address: ${JSON.stringify(i.address)}`),i.nonce!=null&&o.push(`nonce: ${i.nonce}`),i.chainId!=null&&o.push(`chainId: ${i.chainId}`),i.signature&&o.push(`signature: ${i.signature.toString()}`),a.push(`Authorization { ${o.join(", ")} }`)}e.push(`authorizations: [ ${a.join(", ")} ]`)}return`Transaction { ${e.join(", ")} }`}static from(e){if(e==null)return new nn;if(typeof e=="string"){const n=xe(e);if(n[0]>=127)return nn.from(N3(n));switch(n[0]){case 1:return nn.from(E3(n));case 2:return nn.from(j3(n));case 3:return nn.from(C3(n));case 4:return nn.from(P3(n))}J(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:"from"})}const r=new nn;return e.type!=null&&(r.type=e.type),e.to!=null&&(r.to=e.to),e.nonce!=null&&(r.nonce=e.nonce),e.gasLimit!=null&&(r.gasLimit=e.gasLimit),e.gasPrice!=null&&(r.gasPrice=e.gasPrice),e.maxPriorityFeePerGas!=null&&(r.maxPriorityFeePerGas=e.maxPriorityFeePerGas),e.maxFeePerGas!=null&&(r.maxFeePerGas=e.maxFeePerGas),e.maxFeePerBlobGas!=null&&(r.maxFeePerBlobGas=e.maxFeePerBlobGas),e.data!=null&&(r.data=e.data),e.value!=null&&(r.value=e.value),e.chainId!=null&&(r.chainId=e.chainId),e.signature!=null&&(r.signature=qt.from(e.signature)),e.accessList!=null&&(r.accessList=e.accessList),e.authorizationList!=null&&(r.authorizationList=e.authorizationList),e.blobVersionedHashes!=null&&(r.blobVersionedHashes=e.blobVersionedHashes),e.kzg!=null&&(r.kzg=e.kzg),e.blobWrapperVersion!=null&&(r.blobWrapperVersion=e.blobWrapperVersion),e.blobs!=null&&(r.blobs=e.blobs),e.hash!=null&&(P(r.isSigned(),"unsigned transaction cannot define '.hash'","tx",e),P(r.hash===e.hash,"hash mismatch","tx",e)),e.from!=null&&(P(r.isSigned(),"unsigned transaction cannot define '.from'","tx",e),P(r.from.toLowerCase()===(e.from||"").toLowerCase(),"from mismatch","tx",e)),r}};Or=new WeakMap,Ki=new WeakMap,Ji=new WeakMap,Yi=new WeakMap,qi=new WeakMap,Zi=new WeakMap,Xi=new WeakMap,eo=new WeakMap,to=new WeakMap,ro=new WeakMap,no=new WeakMap,so=new WeakMap,Ia=new WeakMap,ks=new WeakMap,on=new WeakMap,js=new WeakMap,ao=new WeakMap,io=new WeakMap,oo=new WeakSet,Td=function(e,r){J(!e||this.signature!=null,"cannot serialize unsigned transaction; maybe you meant .unsignedSerialized","UNSUPPORTED_OPERATION",{operation:".serialized"});const n=e?this.signature:null;switch(this.inferType()){case 0:return k3(this,n);case 1:return S3(this,n);case 2:return A3(this,n);case 3:return D3(this,n,r?this.blobs:null);case 4:return I3(this,n)}J(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:".serialized"})};let pu=nn;function Ya(t){return tt($n(t))}var T3="AEEUdwmgDS8BxQKKAP4BOgDjATAAngDUAIMAoABoAOAAagCOAEQAhABMAHIAOwA9ACsANgAmAGIAHgAuACgAJwAXAC0AGgAjAB8ALwAUACkAEgAeAAkAGwARABkAFgA5ACgALQArADcAFQApABAAHgAiABAAGgAeABMAGAUhBe8BFxREN8sF2wC5AK5HAW8ArQkDzQCuhzc3NzcBP68NEfMABQdHBuw5BV8FYAA9MzkI9r4ZBg7QyQAWA9CeOwLNCjcCjqkChuA/lm+RAsXTAoP6ASfnEQDytQFJAjWVCkeXAOsA6godAB/cwdAUE0WlBCN/AQUCQRjFD/MRBjHxDQSJbw0jBzUAswBxme+tnIcAYwabAysG8QAjAEMMmxcDqgPKQyDXCMMxA7kUQwD3NXOrAKmFIAAfBC0D3x4BJQDBGdUFAhEgVD8JnwmQJiNWYUzrg0oAGwAUAB0AFnNcACkAFgBP9h3gPfsDOWDKneY2ChglX1UDYD30ABsAFAAdABZzIGRAnwDD8wAjAEEMzRbDqgMB2sAFYwXqAtCnAsS4AwpUJKRtFHsadUz9AMMVbwLpABM1NJEX0ZkCgYMBEyMAxRVvAukAEzUBUFAtmUwSAy4DBTER33EftQHfSwB5MxJ/AjkWKQLzL8E/cwBB6QH9LQDPDtO9ASNriQC5DQANAwCK21EFI91zHwCoL9kBqQcHBwcHKzUDowBvAQohPvU3fAQgHwCyAc8CKQMA5zMSezr7ULgFmDp/LzVQBgEGAi8FYQVgt8AFcTtlQhpCWEmfe5tmZ6IAExsDzQ8t+X8rBKtTAltbAn0jsy8Bl6utPWMDTR8Ei2kRANkDBrNHNysDBzECQWUAcwFpJ3kAiyUhAJ0BUb8AL3EfAbfNAz81KUsFWwF3YQZtAm0A+VEfAzEJDQBRSQCzAQBlAHsAM70GD/v3IZWHBwARKQAxALsjTwHZAeMPEzmXgIHwABIAGQA8AEUAQDt3gdvIEGcQZAkGTRFMdEIVEwK0D64L7REdDNkq09PgADSxB/MDWwfzA1sDWwfzB/MDWwfzA1sDWwNbA1scEvAi28gQZw9QBHUFlgWTBN4IiyZREYkHMAjaVBV0JhxPA00BBCMtSSQ7mzMTJUpMFE0LCAQ2SmyvfUADTzGzVP2QqgPTMlc5dAkGHnkSqAAyD3skNb1OhnpPcagKU0+2tYdJak5vAsY6sEAACikJm2/Dd1YGRRAfJ6kQ+ww3AbkBPw3xS9wE9QY/BM0fgRkdD9GVoAipLeEM8SbnLqWAXiP5KocF8Uv4POELUVFsD10LaQnnOmeBUgMlAREijwrhDT0IcRD3Cs1vDekRSQc9A9lJngCpBwULFR05FbkmFGKwCw05ewb/GvoLkyazEy17AAXXGiUGUQEtGwMA0y7rhbRaNVwgT2MGBwspI8sUrFAkDSlAu3hMGh8HGSWtApVDdEqLUToelyH6PEENai4XUYAH+TwJGVMLhTyiRq9FEhHWPpE9TCJNTDAEOYMsMyePCdMPiQy9fHYBXQklCbUMdRM1ERs3yQg9Bx0xlygnGQglRplgngT7owP3E9UDDwVDCUUHFwO5HDETMhUtBRGBKNsC9zbZLrcCk1aEARsFzw8pH+MQVEfkDu0InwJpA4cl7wAxFSUAGyKfCEdnAGOP3FMJLs8Iy2pwI3gDaxTrZRF3B5UOWwerHDcVwxzlcMxeD4YMKKezCV8BeQmdAWME5wgNNV+MpCBFZ1eLXBifIGVBQ14AAjUMaRWjRMGHfAKPD28SHwE5AXcHPQ0FAnsR8RFvEJkI74YINbkz/DopBFMhhyAVCisDU2zSCysm/Qz8bQGnEmYDEDRBd/Jnr2C6KBgBBx0yyUFkIfULlk/RDKAaxRhGVDIZ6AfDA/ca9yfuQVsGAwOnBxc6UTPyBMELbQiPCUMATQ6nGwfbGG4KdYzUATWPAbudA1uVhwJzkwY7Bw8Aaw+LBX3pACECqwinAAkA0wNbAD0CsQehAB0AiUUBQQMrMwEl6QKTA5cINc8BmTMB9y0EH8cMGQD7O25OAsO1AoBuZqYF4VwCkgJNOQFRKQQJUktVA7N15QDfAE8GF+NLARmvTs8e50cB43MvAMsA/wAJOQcJRQHRAfdxALsBYws1Caa3uQFR7S0AhwAZbwHbAo0A4QA5AIP1AVcAUQVd/QXXAlNNARU1HC9bZQG/AyMBNwERAH0Gz5GpzQsjBHEH1wIQHxXlAu8yB7kFAyLjE9FCyQK94lkAMhoKPAqrCqpgX2Q3CjV2PVQAEh+sPss/UgVVO1c7XDtXO1w7VztcO1c7XDtXO1wDm8Pmw+YKcF9JYe8Mqg3YRMw6TRPfYFVgNhPMLbsUxRXSJVoZQRrAJwkl6FUNDwgt12Y0CDA0eRfAAEMpbINFY4oeNApPHOtTlVT8LR8AtUumM7MNsBsZREQFS3XxYi4WEgomAmSFAmJGX1GzAV83JAKh+wJonAJmDQKfiDgfDwJmPwJmKgRyBIMDfxcDfpY5Cjl7GzmGOicnAmwhAjI6OA4CbcsCbbLzjgM3a0kvAWsA4gDlAE4JB5wMkQECD8YAEbkCdzMCdqZDAnlPRwJ4viFg30WyRvcCfEMCeswCfQ0CfPRIBEiBZygALxlJXEpfGRtK0ALRBQLQ0EsrA4hTA4fqRMmRNgLypV0HAwOyS9JMMSkH001QTbMCi0MCitzFHwshR2sJuwKOOwKOYESbhQKO3QKOYHxRuFM5AQ5S2FSJApP/ApMQAO0AIFUiVbNV1AosHymZijLleGpFPz0Cl6MC77ZYJawAXSkClpMCloCgAK1ZsFoNhVEAPwKWuQKWUlxIXNUCmc8CmWhczl0LHQKcnznGOqECnBoCn58CnryOACETNS4TAp31Ap6WALlBYThh8wKe1wKgcgGtAp6jIwKeUqljzGQrKS8CJ7MCJoICoP8CoFDbAqYzAqXSAqgDAIECp/ZogGi1AAdNaiBq1QKs5wKssgKtawKtBgJXIQJV4AKx5dsDH1JsmwKywRECsuwbbORtZ21MYwMl0QK2YD9DbpQDKUkCuGICuUsZArkue3A6cOUCvR0DLbYDMhUCvoxyBgMzdQK+HnMmc1MCw88CwwhzhnRPOUl05AM8qwEDPJ4DPcMCxYACxksCxhSNAshtVQLISALJUwLJMgJkoQLd1nh9ZXiyeSlL1AMYp2cGAmH4GfeVKHsPXpZevxUCz28Cz3AzT1fW9xejAMqxAs93AS3uA04Wfk8JAtwrAtuOAtJTA1JgA1NjAQUDVZCAjUMEzxrxZEl5A4LSg5EC2ssC2eKEFIRNp0ADhqkAMwNkEoZ1Xf0AWQLfaQLevHd7AuIz7RgB8zQrAfSfAfLWiwLr9wLpdH0DAur9AuroAP1LAb0C7o0C66CWrpcHAu5DA4XkmH1w5HGlAvMHAG0DjhqZlwL3FwORcgOSiwL3nAL53QL4apogmq+/O5siA52HAv7+AR8APZ8gAZ+3AwWRA6ZuA6bdANXJAwZuoYyiCQ0DDE0BEwEjB3EGZb1rCQC/BG/DFY8etxEAG3k9ACcDNxJRA42DAWcrJQCM8wAlAOanC6OVCLsGI6fJBgCvBRnDBvElRUYFFoAFcD9GSDNCKUK8X3kZX8QAls0FOgCQVCGbwTsuYDoZutcONxjOGJHJ/gVfBWAFXwVgBWsFYAVfBWAFXwVgBV8FYAVfBWBOHQjfjW8KCgoKbF7xMwTRA7kGN8PDAMMEr8MA70gxFroFTj5xPnhCR0K+X30/X/AAWBkzswCNBsxzzASm70aCRS4rDDMeLz49fnXfcsH5GcoscQFz13Y4HwVnBXLJycnACNdRYwgICAqEXoWTxgA7P4kACxbZBu21Kw0AjMsTAwkVAOVtJUUsJ1JCuULESUArXy9gPi9AKwnJRQYKTD9LPoA+iT54PnkCkULEUUpDX9NWV3JVEjQAc1w3A3IBE3YnX+g7QiMJb6MKaiszRCUuQrNCxDPMCcwEX9EWJzYREBEEBwIHKn6l33JCNVIfybPJtAltydPUCmhBZw/tEKsZAJOVJU1CLRuxbUHOQAo7P0s+eEJHHA8SJVRPdGM0NVrpvBoKhfUlM0JHHGUQUhEWO1xLSj8MO0ucNAqJIzVCRxv9EFsqKyA4OQgNj2nwZgp5ZNFgE2A1K3YHS2AhQQojJmC7DgpzGG1WYFUZCQYHZO9gHWCdYIVgu2BTYJlwFh8GvRbcXbG8YgtDHrMBwzPVyQonHQgkCyYBgQJ0Ajc4nVqIAwGSCsBPIgDsK3SWEtIVBa5N8gGjAo+kVwVIZwD/AEUSCDweX4ITrRQsJ8K3TwBXFDwEAB0TvzVcAtoTS20RIwDgVgZ9BBImYgA5AL4Coi8LFnezOkCnIQFjAY4KBAPh9RcGsgZSBsEAJctdsWIRu2kTkQstRw7DAcMBKgpPBGIGMDAwKCYnKTQaLg4AKRSVAFwCdl+YUZ0JdicFD3lPAdt1F9ZZKCGxuE3yBxkFVGcA/wBFEgiCBwAOLHQSjxOtQDg1z7deFRMAZ8QTAGtKb1ApIiPHADkAvgKiLy1DFtYCmBiDAlDDWNB0eo7fpaMO/aEVRRv0ATEQZBIODyMEAc8JQhCbDRgzFD4TAEMAu9YBCgCsAOkAm5I3ABwAYxvONnR+MhXJAxgKQyxL2+kkJhMbhQKDBMkSsvF0AD9BNQ6uQC7WqSQHwxEAEEIu1hkhAH2z4iQPwyJPHNWpdyYBRSpnJALzoBAEVPPsH20MxA0CCEQKRgAFyAtFAlMNwwjEDUQJRArELtapMg7DDZgJIw+TGukEIwvDFkMAqAtDEMMMBhioe+QAO3MMRAACrgnEBSPY9Q0FDnbSBoMAB8MSYxkSxAEJAPIJAAB8FWMOFtMc/HcXwxhDAC7DAvOowwAewwJdKDKHAAHDAALrFUQVwwAbwyvzpWMWv8wA/ABpAy++bcYDUKPD0KhDCwKmJ1MAAmMA5+UZwxAagwipBRL/eADfw6fDGOMCGsOjk3l6BwOpo4sAEsMOGxMAA5sAbcMOAAvDp0MJGkMDwgipnNIPAwfIqUMGAOGDAAPzABXDAAcDAAnDAGmTABrDAA7DChjDjnEWAwABYwAOcwAuUyYABsMAF8MIKQANUgC6wy4AA8MADqMq8wCyYgAcIwAB8wqpAAXOCx0V4wAHowBCwwEKAGnDAAuDAB3DAAjDCakABdIAbqcZ3QCZCCkABdIAAAFDAAfjAB2jCCkABqIACYMAGzMAbSMA5sOIAAhjAAhDABTDBAkpAAbSAOOTAAlDC6kOzPtnAAdDAG6kQFAATwAKwwwAA0MACbUDPwAHIwAZgwACE6cDAAojAApDAAoDp/MGwwAJIwADEwAQQwgAFEMAEXMAD5MADfMADcMAGRMOFiMAFUMAbqMWuwHDAMIAE0MLAGkzEgDhUwACQwAEWgAXgwUjAAbYABjDBSYBgzBaAEFNALcQBxUMegAwMngBrA0IZgJ0KxQHBREPd1N0ZzKRJwaIHAZqNT4DqQq8BwngAB4DAwt2AX56T1ocKQNXAh1GATQGC3tOxYNagkgAMQA5CQADAQEAWxLjAIOYNAEzAH7tFRk6TglSAF8NAAlYAQ+S1ACAQwQorQBiAN4dAJ1wPyeTANVzuQDX3AIeEMp9eyMgXiUAEdkBkJizKltbVVAaRMqRAAEAhyQ/SDEz6BmfVwB6ATEsOClKIRcDOF0E/832AFNt5AByAnkCRxGCOs94NjXdAwINGBonDBwPALW2AwICAgAAAAAAAAYDBQMDARrUAwAtAAAAAgEGBgYGBgYFBQUFBQUEBQYHCAkEBQUFBQQAAAICAAAAIgCNAJAAlT0A6gC7ANwApEQAwgCyAK0AqADuAKYA2gCjAOcBCAEDAMcAgQBiANIA1AEDAN4A8gCQAKkBMQDqAN8A3AsBCQ8yO9ra2tq8xuLT1tRJOB0BUgFcNU0BWgFpAWgBWwFMUUlLbhMBUxsNEAs6PhMOACcUKy0vMj5AQENDQ0RFFEYGJFdXV1dZWVhZL1pbXVxcI2NnZ2ZoZypsbnZ1eHh4eHh4enp6enp6enp6enp8fH18e2IARPIASQCaAHgAMgBm+ACOAFcAVwA3AnbvAIsABfj4AGQAk/IAnwBPAGIAZP//sACFAIUAaQBWALEAJAC2AIMCQAJDAPwA5wD+AP4A6AD/AOkA6QDoAOYALwJ7AVEBQAE+AVQBPgE+AT4BOQE4ATgBOAEcAVgXADEQCAEAUx8SHgsdHhYAjgCWAKYAUQBqIAIxAHYAbwCXAxUDJzIDIUlGTzEAkQJPAMcCVwKkAMAClgKWApYClgKWApYCiwKWApYClgKWApYClgKVApUCmAKgApcClgKWApQClAKUApQCkgKVAnUB1AKXAp8ClgKWApUeAIETBQD+DQOfAmECOh8BVBg9AuIZEjMbAU4/G1WZAXusRAFpYQEFA0FPAQYAmTEeIJdyADFoAHEANgCRA5zMk/C2jGINwjMWygIZCaXdfDILBCs5dAE7YnQBugDlhoiHhoiGiYqKhouOjIaNkI6Ij4qQipGGkoaThpSSlYaWhpeKmIaZhpqGm4aci52QnoqfhuIC4XTpAt90AIp0LHSoAIsAdHQEQwRABEIERQRDBEkERgRBBEcESQRIBEQERgRJAJ5udACrA490ALxuAQ10ANFZdHQA13QCFHQA/mJ0AP4BIQD+APwA/AD9APwDhGZ03ASMK23HAP4A/AD8AP0A/CR0dACRYnQA/gCRASEA/gCRAvQA/gCRA4RmdNwEjCttxyR0AP9idAEhAP4A/gD8APwA/QD8AP8A/AD8AP0A/AOEZnTcBIwrbcckdHQAkWJ0ASEA/gCRAP4AkQL0AP4AkQOEZnTcBIwrbcckdAJLAT50AlIBQXQCU8l0dAJfdHQDpgL0A6YDpgOnA6cDpwOnA4RmdNwEjCttxyR0dACRYnQBIQOmAJEDpgCRAvQDpgCRA4RmdNwEjCttxyR0BDh0AJEEOQCRDpU5dSgCADR03gV2CwArdAEFAM5iCnR0AF1iAAYcOgp0dACRCnQAXAEIwWZ0CnRmdHQAkWZ0CnRmdEXgAFF03gp0dEY0tlT2u3SOAQTwscwhjZZKrhYcBSfFp9XNbKiVDOD2b+cpe4/Z17mQnbtzzhaeQtE2GGj0IDNTjRUSyTxxw/RPHW/+vS7d1NfRt9z9QPZg4X7QFfhCnkvgNPIItOsC2eV6hPannZNHlZ9xrwZXIMOlu3jSoQSq78WEjwLjw1ELSlF1aBvfzwk5ZX7AUvQzjPQKbDuQ+sm4wNOp4A6AdVuRS0t1y/DZpg4R6m7FNjM9HgvW7Bi88zaMjOo6lM8wtBBdj8LP4ylv3zCXPhebMKJc066o9sF71oFW/8JXu86HJbwDID5lzw5GWLR/LhT0Qqnp2JQxNZNfcbLIzPy+YypqRm/lBmGmex+82+PisxUumSeJkALIT6rJezxMH+CTJmQtt5uwTVbL3ptmjDUQzlSIvWi8Tl7ng1NpuRn1Ng4n14Qc+3Iil7OwkvNWogLSPkn3pihIFytyIGmMhOe3n1tWsuMy9BdKyqF4Z3v2SgggTL9KVvMXPnCbRe+oOuFFP3HejBG/w9gvmfNYvg6JuWia2lcSSN1uIjBktzoIazOHPJZ7kKHPz8mRWVdW3lA8WGF9dQF6Bm673boov3BUWDU2JNcahR23GtfHKLOz/viZ+rYnZFaIznXO67CYEJ1fXuTRpZhYZkKe54xeoagkNGLs+NTZHE0rX45/XvQ2RGADX6vcAvdxIUBV27wxGm2zjZo4X3ILgAlrOFheuZ6wtsvaIj4yLY7qqawlliaIcrz2G+c3vscAnCkCuMzMmZvMfu9lLwTvfX+3cVSyPdN9ZwgDZhfjRgNJcLiJ67b9xx8JHswprbiE3v9UphotAPIgnXVIN5KmMc0piXhc6cChPnN+MRhG9adtdttQTTwSIpl8I4/j//d3sz1326qTBTpPRM/Hgh3kzqEXs8ZAk4ErQhNO8hzrQ0DLkWMA/N+91tn2MdOJnWC2FCZehkQrwzwbKOjhvZsbM95QoeL9skYyMf4srVPVJSgg7pOLUtr/n9eT99oe9nLtFRpjA9okV2Kj8h9k5HaC0oivRD8VyXkJ81tcd4fHNXPCfloIQasxsuO18/46dR2jgul/UIet2G0kRvnyONMKhHs6J26FEoqSqd+rfYjeEGwHWVDpX1fh1jBBcKGMqRepju9Y00mDVHC+Xdij/j44rKfvfjGinNs1jO/0F3jB83XCDINN/HB84axlP+3E/klktRo+vl3U/aiyMJbIodE1XSsDn6UAzIoMtUObY2+k/4gY/l+AkZJ5Sj2vQrkyLm3FoxjhDX+31UXBFf9XrAH31fFqoBmDEZvhvvpnZ87N+oZEu7U9O/nnk+QWj3x8uyoRbEnf+O5UMr9i0nHP38IF5AvzrBW8YWBUR0mIAzIvndQq9N3v/Jto3aPjPXUPl8ASdPPyAp7jENf8bk7VMM9ol9XGmlBmeDMuGqt+WzuL6CXAxXjIhCPM5vACchgMJ/8XBGLO/D1isVvGhwwHHr1DLaI5mn2Jr/b1pUD90uciDaS8cXNDzCWvNmT/PhQe5e8nTnnnkt8Ds/SIjibcum/fqDhKopxAY8AkSrPn+IGDEKOO+U3XOP6djFs2H5N9+orhOahiQk5KnEUWa+CzkVzhp8bMHRbg81qhjjXuIKbHjSLSIBKWqockGtKinY+z4/RdBUF6pcc3JmnlxVcNgrI4SEzKUZSwcD2QCyxzKve+gAmg6ZuSRkpPFa6mfThu7LJNu3H5K42uCpNvPAsoedolKV/LHe/eJ+BbaG5MG0NaSGVPRUmNFMFFSSpXEcXwbVh7UETOZZtoVNRGOIbbkig3McEtR68cG0RZAoJevWYo7Dg/lZ1CQzblWeUvVHmr8fY4Nqd9JJiH/zEX24mJviH60fAyFr0A3c4bC1j3yZU60VgJxXn8JgJXLUIsiBnmKmMYz+7yBQFBvqb2eYnuW59joZBf56/wXvWIR4R8wTmV80i1mZy+S4+BUES+hzjk0uXpC///z/IlqHZ1monzlXp8aCfhGKMti73FI1KbL1q6IKO4fuBuZ59gagjn5xU79muMpHXg6S+e+gDM/U9BKLHbl9l6o8czQKl4RUkJJiqftQG2i3BMg/TQlUYFkJDYBOOvAugYuzYSDnZbDDd/aSd9x0Oe6F+bJcHfl9+gp6L5/TgA+BdFFovbfCrQ40s5vMPw8866pNX8zyFGeFWdxIpPVp9Rg1UPOVFbFZrvaFq/YAzHQgqMWpahMYfqHpmwXfHL1/kpYmGuHFwT55mQu0dylfNuq2Oq0hTMCPwqfxnuBIPLXfci4Y1ANy+1CUipQxld/izVh16WyG2Q0CQQ9NqtAnx1HCHwDj7sYxOSB0wopZSnOzxQOcExmxrVTF2BkOthVpGfuhaGECfCJpJKpjnihY+xOT2QJxN61+9K6QSqtv2Shr82I3jgJrqBg0wELFZPjvHpvzTtaJnLK6Vb97Yn933koO/saN7fsjwNKzp4l2lJVx2orjCGzC/4ZL4zCver6aQYtC5sdoychuFE6ufOiog+VWi5UDkbmvmtah/3aArEBIi39s5ILUnlFLgilcGuz9CQshEY7fw2ouoILAYPVT/gyAIq3TFAIwVsl+ktkRz/qGfnCDGrm5gsl/l9QdvCWGsjPz3dU7XuqKfdUrr/6XIgjp4rey6AJBmCmUJMjITHVdFb5m1p+dLMCL8t55zD42cmftmLEJC0Da04YiRCVUBLLa8D071/N5UBNBXDh0LFsmhV/5B5ExOB4j3WVG/S3lfK5o+V6ELHvy6RR9n4ac+VsK4VE4yphPvV+kG9FegTBH4ZRXL2HytUHCduJazB/KykjfetYxOXTLws267aGOd+I+JhKP//+VnXmS90OD/jvLcVu0asyqcuYN1mSb6XTlCkqv1vigZPIYwNF/zpWcT1GR/6aEIRjkh0yhg4LXJfaGobYJTY4JI58KiAKgmmgAKWdl5nYCeLqavRJGQNuYuZtZFGx+IkI4w4NS2xwbetNMunOjBu/hmKCI/w7tfiiyUd//4rbTeWt4izBY8YvGIN6vyKYmP/8X8wHKCeN+WRcKM70+tXKNGyevU9H2Dg5BsljnTf8YbsJ1TmMs74Ce2XlHisleguhyeg44rQOHZuw/6HTkhnnurK2d62q6yS7210SsAIaR+jXMQA+svkrLpsUY+F30Uw89uOdGAR6vo4FIME0EfVVeHTu6eKicfhSqOeXJhbftcd08sWEnNUL1C9fnprTgd83IMut8onVUF0hvqzZfHduPjbjwEXIcoYmy+P6tcJZHmeOv6VrvEdkHDJecjHuHeWANe79VG662qTjA/HCvumVv3qL+LrOcpqGps2ZGwQdFJ7PU4iuyRlBrwfO+xnPyr47s2cXVbWzAyznDiBGjCM3ksxjjqM62GE9C8f5U38kB3VjtabKp/nRdvMESPGDG90bWRLAt1Qk5DyLuazRR1YzdC1c+hZXvAWV8xA72S4A8B67vjVhbba3MMop293FeEXpe7zItMWrJG/LOH9ByOXmYnNJfjmfuX9KbrpgLOba4nZ+fl8Gbdv/ihv+6wFGKHCYrVwmhFC0J3V2bn2tIB1wCc1CST3d3X2OyxhguXcs4sm679UngzofuSeBewMFJboIQHbUh/m2JhW2hG9DIvG2t7yZIzKBTz9wBtnNC+2pCRYhSIuQ1j8xsz5VvqnyUIthvuoyyu7fNIrg/KQUVmGQaqkqZk/Vx5b33/gsEs8yX7SC1J+NV4icz6bvIE7C5G6McBaI8rVg56q5QBJWxn/87Q1sPK4+sQa8fLU5gXo4paaq4cOcQ4wR0VBHPGjKh+UlPCbA1nLXyEUX45qZ8J7/Ln4FPJE2TdzD0Z8MLSNQiykMMmSyOCiFfy84Rq60emYB2vD09KjYwsoIpeDcBDTElBbXxND72yhd9pC/1CMid/5HUMvAL27OtcIJDzNKpRPNqPOpyt2aPGz9QWIs9hQ9LiX5s8m9hjTUu/f7MyIatjjd+tSfQ3ufZxPpmJhTaBtZtKLUcfOCUqADuO+QoH8B9v6U+P0HV1GLQmtoNFTb3s74ivZgjES0qfK+8RdGgBbcCMSy8eBvh98+et1KIFqSe1KQPyXULBMTsIYnysIwiZBJYdI20vseV+wuJkcqGemehKjaAb9L57xZm3g2zX0bZ2xk/fU+bCo7TlnbW7JuF1YdURo/2Gw7VclDG1W7LOtas2LX4upifZ/23rzpsnY/ALfRgrcWP5hYmV9VxVOQA1fZvp9F2UNU+7d7xRyVm5wiLp3/0dlV7vdw1PMiZrbDAYzIVqEjRY2YU03sJhPnlwIPcZUG5ltL6S8XCxU1eYS5cjr34veBmXAvy7yN4ZjArIG0dfD/5UpBNlX1ZPoxJOwyqRi3wQWtOzd4oNKh0LkoTm8cwqgIfKhqqGOhwo71I+zXnMemTv2B2AUzABWyFztGgGULjDDzWYwJUVBTjKCn5K2QGMK1CQT7SzziOjo+BhAmqBjzuc3xYym2eedGeOIRJVyTwDw37iCMe4g5Vbnsb5ZBdxOAnMT7HU4DHpxWGuQ7GeiY30Cpbvzss55+5Km1YsbD5ea3NI9QNYIXol5apgSu9dZ8f8xS5dtHpido5BclDuLWY4lhik0tbJa07yJhH0BOyEut/GRbYTS6RfiTYWGMCkNpfSHi7HvdiTglEVHKZXaVhezH4kkXiIvKopYAlPusftpE4a5IZwvw1x/eLvoDIh/zpo9FiQInsTb2SAkKHV42XYBjpJDg4374XiVb3ws4qM0s9eSQ5HzsMU4OZJKuopFjBM+dAZEl8RUMx5uU2N486Kr141tVsGQfGjORYMCJAMsxELeNT4RmWjRcpdTGBwcx6XN9drWqPmJzcrGrH4+DRc7+n1w3kPZwu0BkNr6hQrqgo7JTB9A5kdJ/H7P4cWBMwsmuixAzJB3yrQpnGIq90lxAXLzDCdn1LPibsRt7rHNjgQBklRgPZ8vTbjXdgXrTWQsK5MdrXXQVPp0Rinq3frzZKJ0qD6Qhc40VzAraUXlob1gvkhK3vpmHgI6FRlQZNx6eRqkp0zy4AQlX813fAPtL3jMRaitGFFjo0zmErloC+h+YYdVQ6k4F/epxAoF0BmqEoKNTt6j4vQZNQ2BoqF9Vj53TOIoNmDiu9Xp15RkIgQIGcoLpfoIbenzpGUAtqFJp5W+LLnx38jHeECTJ/navKY1NWfN0sY1T8/pB8kIH3DU3DX+u6W3YwpypBMYOhbSxGjq84RZ84fWJow8pyHqn4S/9J15EcCMsXqrfwyd9mhiu3+rEo9pPpoJkdZqHjra4NvzFwuThNKy6hao/SlLw3ZADUcUp3w3SRVfW2rhl80zOgTYnKE0Hs2qp1J6H3xqPqIkvUDRMFDYyRbsFI3M9MEyovPk8rlw7/0a81cDVLmBsR2ze2pBuKb23fbeZC0uXoIvDppfTwIDxk1Oq2dGesGc+oJXWJLGkOha3CX+DUnzgAp9HGH9RsPZN63Hn4RMA5eSVhPHO+9RcRb/IOgtW31V1Q5IPGtoxPjC+MEJbVlIMYADd9aHYWUIQKopuPOHmoqSkubnAKnzgKHqgIOfW5RdAgotN6BN+O2ZYHkuemLnvQ8U9THVrS1RtLmKbcC7PeeDsYznvqzeg6VCNwmr0Yyx1wnLjyT84BZz3EJyCptD3yeueAyDWIs0L2qs/VQ3HUyqfrja0V1LdDzqAikeWuV4sc7RLIB69jEIBjCkyZedoUHqCrOvShVzyd73OdrJW0hPOuQv2qOoHDc9xVb6Yu6uq3Xqp2ZaH46A7lzevbxQEmfrzvAYSJuZ4WDk1Hz3QX1LVdiUK0EvlAGAYlG3Md30r7dcPN63yqBCIj25prpvZP0nI4+EgWoFG95V596CurXpKRBGRjQlHCvy5Ib/iW8nZJWwrET3mgd6mEhfP4KCuaLjopWs7h+MdXFdIv8dHQJgg1xi1eYqB0uDYjxwVmri0Sv5XKut/onqapC+FQiC2C1lvYJ9MVco6yDYsS3AANUfMtvtbYI2hfwZatiSsnoUeMZd34GVjkMMKA+XnjJpXgRW2SHTZplVowPmJsvXy6w3cfO1AK2dvtZEKTkC/TY9LFiKHCG0DnrMQdGm2lzlBHM9iEYynH2UcVMhUEjsc0oDBTgo2ZSQ1gzkAHeWeBXYFjYLuuf8yzTCy7/RFR81WDjXMbq2BOH5dURnxo6oivmxL3cKzKInlZkD31nvpHB9Kk7GfcfE1t+1V64b9LtgeJGlpRFxQCAqWJ5DoY77ski8gsOEOr2uywZaoO/NGa0X0y1pNQHBi3b2SUGNpcZxDT7rLbBf1FSnQ8guxGW3W+36BW0gBje4DOz6Ba6SVk0xiKgt+q2JOFyr4SYfnu+Ic1QZYIuwHBrgzr6UvOcSCzPTOo7D6IC4ISeS7zkl4h+2VoeHpnG/uWR3+ysNgPcOIXQbv0n4mr3BwQcdKJxgPSeyuP/z1Jjg4e9nUvoXegqQVIE30EHx5GHv+FAVUNTowYDJgyFhf5IvlYmEqRif6+WN1MkEJmDcQITx9FX23a4mxy1AQRsOHO/+eImX9l8EMJI3oPWzVXxSOeHU1dUWYr2uAA7AMb+vAEZSbU3qob9ibCyXeypEMpZ6863o6QPqlqGHZkuWABSTVNd4cOh9hv3qEpSx2Zy/DJMP6cItEmiBJ5PFqQnDEIt3NrA3COlOSgz43D7gpNFNJ5MBh4oFzhDPiglC2ypsNU4ISywY2erkyb1NC3Qh/IfWj0eDgZI4/ln8WPfBsT3meTjq1Uqt1E7Zl/qftqkx6aM9KueMCekSnMrcHj1CqTWWzEzPsZGcDe3Ue4Ws+XFYVxNbOFF8ezkvQGR6ZOtOLU2lQEnMBStx47vE6Pb7AYMBRj2OOfZXfisjJnpTfSNjo6sZ6qSvNxZNmDeS7Gk3yYyCk1HtKN2UnhMIjOXUzAqDv90lx9O/q/AT1ZMnit5XQe9wmQxnE/WSH0CqZ9/2Hy+Sfmpeg8RwsHI5Z8kC8H293m/LHVVM/BA7HaTJYg5Enk7M/xWpq0192ACfBai2LA/qrCjCr6Dh1BIMzMXINBmX96MJ5Hn2nxln/RXPFhwHxUmSV0EV2V0jm86/dxxuYSU1W7sVkEbN9EzkG0QFwPhyHKyb3t+Fj5WoUUTErcazE/N6EW6Lvp0d//SDPj7EV9UdJN+Amnf3Wwk3A0SlJ9Z00yvXZ7n3z70G47Hfsow8Wq1JXcfwnA+Yxa5mFsgV464KKP4T31wqIgzFPd3eCe3j5ory5fBF2hgCFyVFrLzI9eetNXvM7oQqyFgDo4CTp/hDV9NMX9JDHQ/nyHTLvZLNLF6ftn2OxjGm8+PqOwhxnPHWipkE/8wbtyri80Sr7pMNkQGMfo4ZYK9OcCC4ESVFFbLMIvlxSoRqWie0wxqnLfcLSXMSpMMQEJYDVObYsXIQNv4TGNwjq1kvT1UOkicTrG3IaBZ3XdScS3u8sgeZPVpOLkbiF940FjbCeNRINNvDbd01EPBrTCPpm12m43ze1bBB59Ia6Ovhnur/Nvx3IxwSWol+3H2qfCJR8df6aQf4v6WiONxkK+IqT4pKQrZK/LplgDI/PJZbOep8dtbV7oCr6CgfpWa8NczOkPx81iSHbsNhVSJBOtrLIMrL31LK9TqHqAbAHe0RLmmV806kRLDLNEhUEJfm9u0sxpkL93Zgd6rw+tqBfTMi59xqXHLXSHwSbSBl0EK0+loECOPtrl+/nsaFe197di4yUgoe4jKoAJDXc6DGDjrQOoFDWZJ9HXwt8xDrQP+7aRwWKWI1GF8s8O4KzxWBBcwnl3vnl1Oez3oh6Ea1vjR7/z7DDTrFtqU2W/KAEzAuXDNZ7MY73MF216dzdSbWmUp4lcm7keJfWaMHgut9x5C9mj66Z0lJ+yhsjVvyiWrfk1lzPOTdhG15Y7gQlXtacvI7qv/XNSscDwqkgwHT/gUsD5yB7LdRRvJxQGYINn9hTpodKFVSTPrtGvyQw+HlRFXIkodErAGu9Iy1YpfSPc3jkFh5CX3lPxv7aqjE/JAfTIpEjGb/H7MO0e2vsViSW1qa/Lmi4/n4DEI3g7lYrcanspDfEpKkdV1OjSLOy0BCUqVoECaB55vs06rXl4jqmLsPsFM/7vYJ0vrBhDCm/00A/H81l1uekJ/6Lml3Hb9+NKiLqATJmDpyzfYZFHumEjC662L0Bwkxi7E9U4cQA0XMVDuMYAIeLMPgQaMVOd8fmt5SflFIfuBoszeAw7ow5gXPE2Y/yBc/7jExARUf/BxIHQBF5Sn3i61w4z5xJdCyO1F1X3+3ax+JSvMeZ7S6QSKp1Fp/sjYz6Z+VgCZzibGeEoujryfMulH7Rai5kAft9ebcW50DyJr2uo2z97mTWIu45YsSnNSMrrNUuG1XsYBtD9TDYzQffKB87vWbkM4EbPAFgoBV4GQS+vtFDUqOFAoi1nTtmIOvg38N4hT2Sn8r8clmBCXspBlMBYTnrqFJGBT3wZOzAyJDre9dHH7+x7qaaKDOB4UQALD5ecS0DE4obubQEiuJZ0EpBVpLuYcce8Aa4PYd/V4DLDAJBYKQPCWTcrEaZ5HYbJi11Gd6hjGom1ii18VHYnG28NKpkz2UKVPxlhYSp8uZr367iOmoy7zsxehW9wzcy2zG0a80PBMCRQMb32hnaHeOR8fnNDzZhaNYhkOdDsBUZ3loDMa1YP0uS0cjUP3b/6DBlqmZOeNABDsLl5BI5QJups8uxAuWJdkUB/pO6Zax6tsg7fN5mjjDgMGngO+DPcKqiHIDbFIGudxtPTIyDi9SFMKBDcfdGQRv41q1AqmxgkVfJMnP8w/Bc7N9/TR6C7mGObFqFkIEom8sKi2xYqJLTCHK7cxzaZvqODo22c3wisBCP4HeAgcRbNPAsBkNRhSmD48dHupdBRw4mIvtS5oeF6zeT1KMCyhMnmhpkFAGWnGscoNkwvQ8ZM5lE/vgTHFYL99OuNxdFBxTEDd5v2qLR8y9WkXsWgG6kZNndFG+pO/UAkOCipqIhL3hq7cRSdrCq7YhUsTocEcnaFa6nVkhnSeRYUA1YO0z5itF9Sly3VlxYDw239TJJH6f3EUfYO5lb7bcFcz8Bp7Oo8QmnsUHOz/fagVUBtKEw1iT88j+aKkv8cscKNkMxjYr8344D1kFoZ7/td1W6LCNYN594301tUGRmFjAzeRg5vyoM1F6+bJZ/Q54jN/k8SFd3DxPTYaAUsivsBfgTn7Mx8H2SpPt4GOdYRnEJOH6jHM2p6SgB0gzIRq6fHxGMmSmqaPCmlfwxiuloaVIitLGN8wie2CDWhkzLoCJcODh7KIOAqbHEvXdUxaS4TTTs07Clzj/6GmVs9kiZDerMxEnhUB6QQPlcfqkG9882RqHoLiHGBoHfQuXIsAG8GTAtao2KVwRnvvam8jo1e312GQAKWEa4sUVEAMG4G6ckcONDwRcg1e2D3+ohXgY4UAWF8wHKQMrSnzCgfFpsxh+aHXMGtPQroQasRY4U6UdG0rz1Vjbka0MekOGRZQEvqQFlxseFor8zWFgHek3v29+WqN6gaK5gZOTOMZzpQIC1201LkMCXild3vWXSc5UX9xcFYfbRPzGFa1FDcPfPB/jUEq/FeGt419CI3YmBlVoHsa4KdcwQP5ZSwHHhFJ7/Ph/Rap/4vmG91eDwPP0lDfCDRCLszTqfzM71xpmiKi2HwS4WlqvGNwtvwF5Dqpn6KTq8ax00UMPkxDcZrEEEsIvHiUXXEphdb4GB4FymlPwBz4Gperqq5pW7TQ6/yNRhW8VT5NhuP0udlxo4gILq5ZxAZk8ZGh3g4CqxJlPKY7AQxupfUcVpWT5VItp1+30UqoyP4wWsRo3olRRgkWZZ2ZN6VC3OZFeXB8NbnUrSdikNptD1QiGuKkr8EmSR/AK9Rw+FF3s5uwuPbvHGiPeFOViltMK7AUaOsq9+x9cndk3iJEE5LKZRlWJbKOZweROzmPNVPkjE3K/TyA57Rs68TkZ3MR8akKpm7cFjnjPd/DdkWjgYoKHSr5Wu5ssoBYU4acRs5g2DHxUmdq8VXOXRbunD8QN0LhgkssgahcdoYsNvuXGUK/KXD/7oFb+VGdhqIn02veuM5bLudJOc2Ky0GMaG4W/xWBxIJcL7yliJOXOpx0AkBqUgzlDczmLT4iILXDxxtRR1oZa2JWFgiAb43obrJnG/TZC2KSK2wqOzRZTXavZZFMb1f3bXvVaNaK828w9TO610gk8JNf3gMfETzXXsbcvRGCG9JWQZ6+cDPqc4466Yo2RcKH+PILeKOqtnlbInR3MmBeGG3FH10yzkybuqEC2HSQwpA0An7d9+73BkDUTm30bZmoP/RGbgFN+GrCOfADgqr0WbI1a1okpFms8iHYw9hm0zUvlEMivBRxModrbJJ+9/p3jUdQQ9BCtQdxnOGrT5dzRUmw0593/mbRSdBg0nRvRZM5/E16m7ZHmDEtWhwvfdZCZ8J8M12W0yRMszXamWfQTwIZ4ayYktrnscQuWr8idp3PjT2eF/jmtdhIfcpMnb+IfZY2FebW6UY/AK3jP4u3Tu4zE4qlnQgLFbM19EBIsNf7KhjdbqQ/D6yiDb+NlEi2SKD+ivXVUK8ib0oBo366gXkR8ZxGjpJIDcEgZPa9TcYe0TIbiPl/rPUQDu3XBJ9X/GNq3FAUsKsll57DzaGMrjcT+gctp+9MLYXCq+sqP81eVQ0r9lt+gcQfZbACRbEjvlMskztZG8gbC8Qn9tt26Q7y7nDrbZq/LEz7kR6Jc6pg3N9rVX8Y5MJrGlML9p9lU4jbTkKqCveeZUJjHB03m2KRKR2TytoFkTXOLg7keU1s1lrPMQJpoOKLuAAC+y1HlJucU6ysB5hsXhvSPPLq5J7JtnqHKZ4vYjC4Vy8153QY+6780xDuGARsGbOs1WqzH0QS765rnSKEbbKlkO8oI/VDwUd0is13tKpqILu1mDJFNy/iJAWcvDgjxvusIT+PGz3ST/J9r9Mtfd0jpaGeiLYIqXc7DiHSS8TcjFVksi66PEkxW1z6ujbLLUGNNYnzOWpH8BZGK4bCK7iR+MbIv8ncDAz1u4StN3vTTzewr9IQjk9wxFxn+6N1ddKs0vffJiS08N3a4G1SVrlZ97Q/M+8G9fe5AP6d9/Qq4WRnORVhofPIKEdCr3llspUfE0oKIIYoByBRPh+bX1HLS3JWGJRhIvE1aW4NTd8ePi4Z+kXb+Z8snYfSNcqijhAgVsx4RCM54cXUiYkjeBmmC4ajOHrChoELscJJC7+9jjMjw5BagZKlgRMiSNYz7h7vvZIoQqbtQmspc0cUk1G/73iXtSpROl5wtLgQi0mW2Ex8i3WULhcggx6E1LMVHUsdc9GHI1PH3U2Ko0PyGdn9KdVOLm7FPBui0i9a0HpA60MsewVE4z8CAt5d401Gv6zXlIT5Ybit1VIA0FCs7wtvYreru1fUyW3oLAZ/+aTnZrOcYRNVA8spoRtlRoWflsRClFcgzkqiHOrf0/SVw+EpVaFlJ0g4Kxq1MMOmiQdpMNpte8lMMQqm6cIFXlnGbfJllysKDi+0JJMotkqgIxOSQgU9dn/lWkeVf8nUm3iwX2Nl3WDw9i6AUK3vBAbZZrcJpDQ/N64AVwjT07Jef30GSSmtNu2WlW7YoyW2FlWfZFQUwk867EdLYKk9VG6JgEnBiBxkY7LMo4YLQJJlAo9l/oTvJkSARDF/XtyAzM8O2t3eT/iXa6wDN3WewNmQHdPfsxChU/KtLG2Mn8i4ZqKdSlIaBZadxJmRzVS/o4yA65RTSViq60oa395Lqw0pzY4SipwE0SXXsKV+GZraGSkr/RW08wPRvqvSUkYBMA9lPx4m24az+IHmCbXA+0faxTRE9wuGeO06DIXa6QlKJ3puIyiuAVfPr736vzo2pBirS+Vxel3TMm3JKhz9o2ZoRvaFVpIkykb0Hcm4oHFBMcNSNj7/4GJt43ogonY2Vg4nsDQIWxAcorpXACzgBqQPjYsE/VUpXpwNManEru4NwMCFPkXvMoqvoeLN3qyu/N1eWEHttMD65v19l/0kH2mR35iv/FI+yjoHJ9gPMz67af3Mq/BoWXqu3rphiWMXVkmnPSEkpGpUI2h1MThideGFEOK6YZHPwYzMBvpNC7+ZHxPb7epfefGyIB4JzO9DTNEYnDLVVHdQyvOEVefrk6Uv5kTQYVYWWdqrdcIl7yljwwIWdfQ/y+2QB3eR/qxYObuYyB4gTbo2in4PzarU1sO9nETkmj9/AoxDA+JM3GMqQtJR4jtduHtnoCLxd1gQUscHRB/MoRYIEsP2pDZ9KvHgtlk1iTbWWbHhohwFEYX7y51fUV2nuUmnoUcqnWIQAAgl9LTVX+Bc0QGNEhChxHR4YjfE51PUdGfsSFE6ck7BL3/hTf9jLq4G1IafINxOLKeAtO7quulYvH5YOBc+zX7CrMgWnW47/jfRsWnJjYYoE7xMfWV2HN2iyIqLI";const Dx=new Map([[8217,"apostrophe"],[8260,"fraction slash"],[12539,"middle dot"]]),Px=4;function _3(t){let e=0;function r(){return t[e++]<<8|t[e++]}let n=r(),a=1,i=[0,1];for(let N=1;N<n;N++)i.push(a+=r());let o=r(),l=e;e+=o;let c=0,d=0;function h(){return c==0&&(d=d<<8|t[e++],c=8),d>>--c&1}const u=31,f=2**u,g=f>>>1,b=g>>1,y=f-1;let k=0;for(let N=0;N<u;N++)k=k<<1|h();let m=[],x=0,p=f;for(;;){let N=Math.floor(((k-x+1)*a-1)/p),A=0,D=n;for(;D-A>1;){let C=A+D>>>1;N<i[C]?D=C:A=C}if(A==0)break;m.push(A);let E=x+Math.floor(p*i[A]/a),L=x+Math.floor(p*i[A+1]/a)-1;for(;!((E^L)&g);)k=k<<1&y|h(),E=E<<1&y,L=L<<1&y|1;for(;E&~L&b;)k=k&g|k<<1&y>>>1|h(),E=E<<1^g,L=(L^g)<<1|g|1;x=E,p=1+L-E}let v=n-4;return m.map(N=>{switch(N-v){case 3:return v+65792+(t[l++]<<16|t[l++]<<8|t[l++]);case 2:return v+256+(t[l++]<<8|t[l++]);case 1:return v+t[l++];default:return N-1}})}function B3(t){let e=0;return()=>t[e++]}function Gv(t){return B3(_3(R3(t)))}function R3(t){let e=[];[..."ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"].forEach((a,i)=>e[a.charCodeAt(0)]=i);let r=t.length,n=new Uint8Array(6*r>>3);for(let a=0,i=0,o=0,l=0;a<r;a++)l=l<<6|e[t.charCodeAt(a)],o+=6,o>=8&&(n[i++]=l>>(o-=8));return n}function O3(t){return t&1?~t>>1:t>>1}function M3(t,e){let r=Array(t);for(let n=0,a=0;n<t;n++)r[n]=a+=O3(e());return r}function oc(t,e=0){let r=[];for(;;){let n=t(),a=t();if(!a)break;e+=n;for(let i=0;i<a;i++)r.push(e+i);e+=a+1}return r}function $v(t){return lc(()=>{let e=oc(t);if(e.length)return e})}function Qv(t){let e=[];for(;;){let r=t();if(r==0)break;e.push(L3(r,t))}for(;;){let r=t()-1;if(r<0)break;e.push(F3(r,t))}return e.flat()}function lc(t){let e=[];for(;;){let r=t(e.length);if(!r)break;e.push(r)}return e}function Wv(t,e,r){let n=Array(t).fill().map(()=>[]);for(let a=0;a<e;a++)M3(t,r).forEach((i,o)=>n[o].push(i));return n}function L3(t,e){let r=1+e(),n=e(),a=lc(e);return Wv(a.length,1+t,e).flatMap((o,l)=>{let[c,...d]=o;return Array(a[l]).fill().map((h,u)=>{let f=u*n;return[c+u*r,d.map(g=>g+f)]})})}function F3(t,e){let r=1+e();return Wv(r,1+t,e).map(a=>[a[0],a.slice(1)])}function U3(t){let e=[],r=oc(t);return a(n([]),[]),e;function n(i){let o=t(),l=lc(()=>{let c=oc(t).map(d=>r[d]);if(c.length)return n(c)});return{S:o,B:l,Q:i}}function a({S:i,B:o},l,c){if(!(i&4&&c===l[l.length-1])){i&2&&(c=l[l.length-1]),i&1&&e.push(l);for(let d of o)for(let h of d.Q)a(d,[...l,h],c)}}}function z3(t){return t.toString(16).toUpperCase().padStart(2,"0")}function Kv(t){return`{${z3(t)}}`}function H3(t){let e=[];for(let r=0,n=t.length;r<n;){let a=t.codePointAt(r);r+=a<65536?1:2,e.push(a)}return e}function Uo(t){let r=t.length;if(r<4096)return String.fromCodePoint(...t);let n=[];for(let a=0;a<r;)n.push(String.fromCodePoint(...t.slice(a,a+=4096)));return n.join("")}function V3(t,e){let r=t.length,n=r-e.length;for(let a=0;n==0&&a<r;a++)n=t[a]-e[a];return n}var G3="AEUDTAHBCFQATQDRADAAcgAgADQAFAAsABQAHwAOACQADQARAAoAFwAHABIACAAPAAUACwAFAAwABAAQAAMABwAEAAoABQAIAAIACgABAAQAFAALAAIACwABAAIAAQAHAAMAAwAEAAsADAAMAAwACgANAA0AAwAKAAkABAAdAAYAZwDSAdsDJgC0CkMB8xhZAqfoC190UGcThgBurwf7PT09Pb09AjgJum8OjDllxHYUKXAPxzq6tABAxgK8ysUvWAgMPT09PT09PSs6LT2HcgWXWwFLoSMEEEl5RFVMKvO0XQ8ExDdJMnIgsj26PTQyy8FfEQ8AY8IPAGcEbwRwBHEEcgRzBHQEdQR2BHcEeAR6BHsEfAR+BIAEgfndBQoBYgULAWIFDAFiBNcE2ATZBRAFEQUvBdALFAsVDPcNBw13DYcOMA4xDjMB4BllHI0B2grbAMDpHLkQ7QHVAPRNQQFnGRUEg0yEB2uaJF8AJpIBpob5AERSMAKNoAXqaQLUBMCzEiACnwRZEkkVsS7tANAsBG0RuAQLEPABv9HICTUBXigPZwRBApMDOwAamhtaABqEAY8KvKx3LQ4ArAB8UhwEBAVSagD8AEFZADkBIadVj2UMUgx5Il4ANQC9AxIB1BlbEPMAs30CGxlXAhwZKQIECBc6EbsCoxngzv7UzRQA8M0BawL6ZwkN7wABAD33OQRcsgLJCjMCjqUChtw/km+NAsXPAoP2BT84PwURAK0RAvptb6cApQS/OMMey5HJS84UdxpxTPkCogVFITaTOwERAK5pAvkNBOVyA7q3BKlOJSALAgUIBRcEdASpBXqzABXFSWZOawLCOqw//AolCZdvv3dSBkEQGyelEPcMMwG1ATsN7UvYBPEGOwTJH30ZGQ/NlZwIpS3dDO0m4y6hgFoj9SqDBe1L9DzdC01RaA9ZC2UJ4zpjgU4DIQENIosK3Q05CG0Q8wrJaw3lEUUHOQPVSZoApQcBCxEdNRW1JhBirAsJOXcG+xr2C48mrxMpevwF0xohBk0BKRr/AM8u54WwWjFcHE9fBgMLJSPHFKhQIA0lQLd4SBobBxUlqQKRQ3BKh1E2HpMh9jw9DWYuE1F8B/U8BRlPC4E8nkarRQ4R0j6NPUgiSUwsBDV/LC8niwnPD4UMuXxyAVkJIQmxDHETMREXN8UIOQcZLZckJxUIIUaVYJoE958D8xPRAwsFPwlBBxMDtRwtEy4VKQUNgSTXAvM21S6zAo9WgAEXBcsPJR/fEFBH4A7pCJsCZQODJesALRUhABcimwhDYwBfj9hTBS7LCMdqbCN0A2cU52ERcweRDlcHpxwzFb8c4XDIXguGCCijrwlbAXUJmQFfBOMICTVbjKAgQWdTi1gYmyBhQT9d/AIxDGUVn0S9h3gCiw9rEhsBNQFzBzkNAQJ3Ee0RaxCVCOuGBDW1M/g6JQRPIYMgEQonA09szgsnJvkM+GkBoxJiAww0PXfuZ6tgtiQX/QcZMsVBYCHxC5JPzQycGsEYQlQuGeQHvwPzGvMn6kFXBf8DowMTOk0z7gS9C2kIiwk/AEkOoxcH1xhqCnGM0AExiwG3mQNXkYMCb48GNwcLAGcLhwV55QAdAqcIowAFAM8DVwA5Aq0HnQAZAIVBAT0DJy8BIeUCjwOTCDHLAZUvAfMpBBvDDBUA9zduSgLDsQKAamaiBd1YAo4CSTUBTSUEBU5HUQOvceEA2wBLBhPfRwEVq0rLGuNDAd9vKwDHAPsABTUHBUEBzQHzbQC3AV8LMQmis7UBTekpAIMAFWsB1wKJAN0ANQB/8QFTAE0FWfkF0wJPSQERMRgrV2EBuwMfATMBDQB5BsuNpckHHwRtB9MCEBsV4QLvLge1AQMi3xPNQsUCvd5VoWACZIECYkJbTa9bNyACofcCaJgCZgkCn4Q4GwsCZjsCZiYEbgR/A38TA36SOQY5dxc5gjojIwJsHQIyNjgKAm3HAm2u74ozZ0UrAWcA3gDhAEoFB5gMjQD+C8IADbUCdy8CdqI/AnlLQwJ4uh1c20WuRtcCfD8CesgCfQkCfPAFWQUgSABIfWMkAoFtAoAAAoAFAn+uSVhKWxUXSswC0QEC0MxLJwOITwOH5kTFkTIC8qFdAwMDrkvOTC0lA89NTE2vAos/AorYwRsHHUNnBbcCjjcCjlxAl4ECjtkCjlx4UbRTNQpS1FSFApP7ApMMAOkAHFUeVa9V0AYsGymVhjLheGZFOzkCl58C77JYIagAWSUClo8ClnycAKlZrFoJgU0AOwKWtQKWTlxEXNECmcsCmWRcyl0HGQKcmznCOp0CnBYCn5sCnriKAB0PMSoPAp3xAp6SALU9YTRh7wKe0wKgbgGpAp6fHwKeTqVjyGQnJSsCJ68CJn4CoPsCoEwCot0CocQCpi8Cpc4Cp/8AfQKn8mh8aLEAA0lqHGrRAqzjAqyuAq1nAq0CAlcdAlXcArHh1wMfTmyXArK9DQKy6Bds4G1jbUhfAyXNArZcOz9ukAMpRQK4XgK5RxUCuSp3cDZw4QK9GQK72nCWAzIRAr6IcgIDM3ECvhpzInNPAsPLAsMEc4J0SzVFdOADPKcDPJoDPb8CxXwCxkcCxhCJAshpUQLIRALJTwLJLgJknQLd0nh5YXiueSVL0AMYo2cCAmH0GfOVJHsLXpJeuxECz2sCz2wvS1PS8xOfAMatAs9zASnqA04SfksFAtwnAtuKAtJPA1JcA1NfAQEDVYyAiT8AyxbtYEWCHILTgs6DjQLaxwLZ3oQQhEmnPAOGpQAvA2QOhnFZ+QBVAt9lAt64c3cC4i/tFAHzMCcB9JsB8tKHAuvzAulweQLq+QLq5AD5RwG5Au6JAuuclqqXAwLuPwOF4Jh5cOBxoQLzAwBpA44WmZMC9xMDkW4DkocC95gC+dkC+GaaHJqruzebHgOdgwL++gEbADmfHJ+zAwWNA6ZqA6bZANHFAwZqoYiiBQkDDEkCwAA/AwDhQRdTARHzA2sHl2cFAJMtK7evvdsBiZkUfxEEOQH7KQUhDp0JnwCS/SlXxQL3AZ0AtwW5AG8LbUEuFCaNLgFDAYD8AbUmAHUDDgRtACwCFgyhAAAKAj0CagPdA34EkQEgRQUhfAoABQBEABMANhICdwEABdUDa+8KxQIA9wqfJ7+xt+UBkSFBQgHpFH8RNMCJAAQAGwBaAkUChIsABjpTOpSNbQC4Oo860ACNOME63AClAOgAywE6gTo7Ofw5+Tt2iTpbO56JOm85GAFWATMBbAUvNV01njWtNWY1dTW2NcU1gjWRNdI14TWeNa017jX9NbI1wTYCNhE1xjXVNhY2JzXeNe02LjY9Ni41LSE2OjY9Njw2yTcIBJA8VzY4Nt03IDcPNsogN4k3MAoEsDxnNiQ3GTdsOo03IULUQwdC4EMLHA8PCZsobShRVQYA6X8A6bABFCnXAukBowC9BbcAbwNzBL8MDAMMAQgDAAkKCwsLCQoGBAVVBI/DvwDz9b29kaUCb0QtsRTNLt4eGBcSHAMZFhYZEhYEARAEBUEcQRxBHEEcQRxBHEEaQRxBHEFCSTxBPElISUhBNkM2QTYbNklISVmBVIgBFLWZAu0BhQCjBcEAbykBvwGJAaQcEZ0ePCklMAAhMvAIMAL54gC7Bm8EescjzQMpARQpKgDUABavAj626xQAJP0A3etzuf4NNRA7efy2Z9NQrCnC0OSyANz5BBIbJ5IFDR6miIavYS6tprjjmuKebxm5C74Q225X1pkaYYPb6f1DK4k3xMEBb9S2WMjEibTNWhsRJIA+vwNVEiXTE5iXs/wezV66oFLfp9NZGYW+Gk19J2+bCT6Ye2w6LDYdgzKMUabk595eLBCXANz9HUpWbATq9vqXVx9XDg+Pc9Xp4+bsS005SVM/BJBM4687WUuf+Uj9dEi8aDNaPxtpbDxcG1THTImUMZq4UCaaNYpsVqraNyKLJXDYsFZ/5jl7bLRtO88t7P3xZaAxhb5OdPMXqsSkp1WCieG8jXm1U99+blvLlXzPCS+M93VnJCiK+09LfaSaBAVBomyDgJua8dfUzR7ga34IvR2Nvj+A9heJ6lsl1KG4NkI1032Cnff1m1wof2B9oHJK4bi6JkEdSqeNeiuo6QoZZincoc73/TH9SXF8sCE7XyuYyW8WSgbGFCjPV0ihLKhdPs08Tx82fYAkLLc4I2wdl4apY7GU5lHRFzRWJep7Ww3wbeA3qmd59/86P4xuNaqDpygXt6M85glSBHOCGgJDnt+pN9bK7HApMguX6+06RZNjzVmcZJ+wcUrJ9//bpRNxNuKpNl9uFds+S9tdx7LaM5ZkIrPj6nIU9mnbFtVbs9s/uLgl8MVczAwet+iOEzzBlYW7RCMgE6gyNLeq6+1tIx4dpgZnd0DksJS5f+JNDpwwcPNXaaVspq1fbQajOrJgK0ofKtJ1Ne90L6VO4MOl5S886p7u6xo7OLjG8TGL+HU1JXGJgppg4nNbNJ5nlzSpuPYy21JUEcUA94PoFiZfjZue+QnyQ80ekOuZVkxx4g+cvhJfHgNl4hy1/a6+RKcKlar/J29y//EztlbVPHVUeQ1zX86eQVAjR/M3dA9w4W8LfaXp4EgM85wOWasli837PzVMOnsLzR+k3o75/lRPAJSE1xAKQzEi5v10ke+VBvRt1cwQRMd+U5mLCTGVd6XiZtgBG5cDi0w22GKcVNvHiu5LQbZEDVtz0onn7k5+heuKXVsZtSzilkLRAUmjMXEMB3J9YC50XBxPiz53SC+EhnPl9WsKCv92SM/OFFIMJZYfl0WW8tIO3UxYcwdMAj7FSmgrsZ2aAZO03BOhP1bNNZItyXYQFTpC3SG1VuPDqH9GkiCDmE+JwxyIVSO5siDErAOpEXFgjy6PQtOVDj+s6e1r8heWVvmZnTciuf4EiNZzCAd7SOMhXERIOlsHIMG399i9aLTy3m2hRLZjJVDNLS53iGIK11dPqQt0zBDyg6qc7YqkDm2M5Ve6dCWCaCbTXX2rToaIgz6+zh4lYUi/+6nqcFMAkQJKHYLK0wYk5N9szV6xihDbDDFr45lN1K4aCXBq/FitPSud9gLt5ZVn+ZqGX7cwm2z5EGMgfFpIFyhGGuDPmso6TItTMwny+7uPnLCf4W6goFQFV0oQSsc9VfMmVLcLr6ZetDZbaSFTLqnSO/bIPjA3/zAUoqgGFAEQS4IhuMzEp2I3jJzbzkk/IEmyax+rhZTwd6f+CGtwPixu8IvzACquPWPREu9ZvGkUzpRwvRRuaNN6cr0W1wWits9ICdYJ7ltbgMiSL3sTPeufgNcVqMVWFkCPDH4jG2jA0XcVgQj62Cb29v9f/z/+2KbYvIv/zzjpQAPkliaVDzNrW57TZ/ZOyZD0nlfMmAIBIAGAI0D3k/mdN4xr9v85ZbZbbqfH2jGd5hUqNZWwl5SPfoGmfElmazUIeNL1j/mkF7VNAzTq4jNt8JoQ11NQOcmhprXoxSxfRGJ9LDEOAQ+dmxAQH90iti9e2u/MoeuaGcDTHoC+xsmEeWmxEKefQuIzHbpw5Tc5cEocboAD09oipWQhtTO1wivf/O+DRe2rpl/E9wlrzBorjJsOeG1B/XPW4EaJEFdNlECEZga5ZoGRHXgYouGRuVkm8tDESiEyFNo+3s5M5puSdTyUL2llnINVHEt91XUNW4ewdMgJ4boJfEyt/iY5WXqbA+A2Fkt5Z0lutiWhe9nZIyIUjyXDC3UsaG1t+eNx6z4W/OYoTB7A6x+dNSTOi9AInctbESqm5gvOLww7OWXPrmHwVZasrl4eD113pm+JtT7JVOvnCXqdzzdTRHgJ0PiGTFYW5Gvt9R9LD6Lzfs0v/TZZHSmyVNq7viIHE6DBK7Qp07Iz55EM8SYtQvZf/obBniTWi5C2/ovHfw4VndkE5XYdjOhCMRjDeOEfXeN/CwfGduiUIfsoFeUxXeQXba7c7972XNv8w+dTjjUM0QeNAReW+J014dKAD/McQYXT7c0GQPIkn3Ll6R7gGjuiQoZD0TEeEqQpKoZ15g/0OPQI17QiSv9AUROa/V/TQN3dvLArec3RrsYlvBm1b8LWzltdugsC50lNKYLEp2a+ZZYqPejULRlOJh5zj/LVMyTDvwKhMxxwuDkxJ1QpoNI0OTWLom4Z71SNzI9TV1iXJrIu9Wcnd+MCaAw8o1jSXd94YU/1gnkrC9BUEOtQvEIQ7g0i6h+KL2JKk8Ydl7HruvgWMSAmNe+LshGhV4qnWHhO9/RIPQzY1tHRj2VqOyNsDpK0cww+56AdDC4gsWwY0XxoucIWIqs/GcwnWqlaT0KPr8mbK5U94/301i1WLt4YINTVvCFBrFZbIbY8eycOdeJ2teD5IfPLCRg7jjcFTwlMFNl9zdh/o3E/hHPwj7BWg0MU09pPrBLbrCgm54A6H+I6v27+jL5gkjWg/iYdks9jbfVP5y/n0dlgWEMlKasl7JvFZd56LfybW1eeaVO0gxTfXZwD8G4SI116yx7UKVRgui6Ya1YpixqXeNLc8IxtAwCU5IhwQgn+NqHnRaDv61CxKhOq4pOX7M6pkA+Pmpd4j1vn6ACUALoLLc4vpXci8VidLxzm7qFBe7s+quuJs6ETYmnpgS3LwSZxPIltgBDXz8M1k/W2ySNv2f9/NPhxLGK2D21dkHeSGmenRT3Yqcdl0m/h3OYr8V+lXNYGf8aCCpd4bWjE4QIPj7vUKN4Nrfs7ML6Y2OyS830JCnofg/k7lpFpt4SqZc5HGg1HCOrHvOdC8bP6FGDbE/VV0mX4IakzbdS/op+Kt3G24/8QbBV7y86sGSQ/vZzU8FXs7u6jIvwchsEP2BpIhW3G8uWNwa3HmjfH/ZjhhCWvluAcF+nMf14ClKg5hGgtPLJ98ueNAkc5Hs2WZlk2QHvfreCK1CCGO6nMZVSb99VM/ajr8WHTte9JSmkXq/i/U943HEbdzW6Re/S88dKgg8pGOLlAeNiqrcLkUR3/aClFpMXcOUP3rmETcWSfMXZE3TUOi8i+fqRnTYLflVx/Vb/6GJ7eIRZUA6k3RYR3iFSK9c4iDdNwJuZL2FKz/IK5VimcNWEqdXjSoxSgmF0UPlDoUlNrPcM7ftmA8Y9gKiqKEHuWN+AZRIwtVSxye2Kf8rM3lhJ5XcBXU9n4v0Oy1RU2M+4qM8AQPVwse8ErNSob5oFPWxuqZnVzo1qB/IBxkM3EVUKFUUlO3e51259GgNcJbCmlvrdjtoTW7rChm1wyCKzpCTwozUUEOIcWLneRLgMXh+SjGSFkAllzbGS5HK7LlfCMRNRDSvbQPjcXaenNYxCvu2Qyznz6StuxVj66SgI0T8B6/sfHAJYZaZ78thjOSIFumNWLQbeZixDCCC+v0YBtkxiBB3jefHqZ/dFHU+crbj6OvS1x/JDD7vlm7zOVPwpUC01nhxZuY/63E7g";const cc=44032,xu=4352,yu=4449,wu=4519,Jv=19,Yv=21,zo=28,bu=Yv*zo,$3=Jv*bu,Q3=cc+$3,W3=xu+Jv,K3=yu+Yv,J3=wu+zo;function xl(t){return t>>24&255}function qv(t){return t&16777215}let A0,Ix,E0,_d;function Y3(){let t=Gv(G3);A0=new Map($v(t).flatMap((e,r)=>e.map(n=>[n,r+1<<24]))),Ix=new Set(oc(t)),E0=new Map,_d=new Map;for(let[e,r]of Qv(t)){if(!Ix.has(e)&&r.length==2){let[n,a]=r,i=_d.get(n);i||(i=new Map,_d.set(n,i)),i.set(a,e)}E0.set(e,r.reverse())}}function Zv(t){return t>=cc&&t<Q3}function q3(t,e){if(t>=xu&&t<W3&&e>=yu&&e<K3)return cc+(t-xu)*bu+(e-yu)*zo;if(Zv(t)&&e>wu&&e<J3&&(t-cc)%zo==0)return t+(e-wu);{let r=_d.get(t);return r&&(r=r.get(e),r)?r:-1}}function Xv(t){A0||Y3();let e=[],r=[],n=!1;function a(i){let o=A0.get(i);o&&(n=!0,i|=o),e.push(i)}for(let i of t)for(;;){if(i<128)e.push(i);else if(Zv(i)){let o=i-cc,l=o/bu|0,c=o%bu/zo|0,d=o%zo;a(xu+l),a(yu+c),d>0&&a(wu+d)}else{let o=E0.get(i);o?r.push(...o):a(i)}if(!r.length)break;i=r.pop()}if(n&&e.length>1){let i=xl(e[0]);for(let o=1;o<e.length;o++){let l=xl(e[o]);if(l==0||i<=l){i=l;continue}let c=o-1;for(;;){let d=e[c+1];if(e[c+1]=e[c],e[c]=d,!c||(i=xl(e[--c]),i<=l))break}i=xl(e[o])}}return e}function Z3(t){let e=[],r=[],n=-1,a=0;for(let i of t){let o=xl(i),l=qv(i);if(n==-1)o==0?n=l:e.push(l);else if(a>0&&a>=o)o==0?(e.push(n,...r),r.length=0,n=l):r.push(l),a=o;else{let c=q3(n,l);c>=0?n=c:a==0&&o==0?(e.push(n),n=l):(r.push(l),a=o)}}return n>=0&&e.push(n,...r),e}function e1(t){return Xv(t).map(qv)}function X3(t){return Z3(Xv(t))}const Tx=45,t1=".",r1=65039,n1=1,vu=t=>Array.from(t);function dc(t,e){return t.P.has(e)||t.Q.has(e)}class eE extends Array{get is_emoji(){return!0}}let S0,s1,wa,C0,a1,Oi,tf,li,da,_x,D0;function hg(){if(S0)return;let t=Gv(T3);const e=()=>oc(t),r=()=>new Set(e()),n=(h,u)=>u.forEach(f=>h.add(f));S0=new Map(Qv(t)),s1=r(),wa=e(),C0=new Set(e().map(h=>wa[h])),wa=new Set(wa),a1=r(),r();let a=$v(t),i=t();const o=()=>{let h=new Set;return e().forEach(u=>n(h,a[u])),n(h,e()),h};Oi=lc(h=>{let u=lc(t).map(f=>f+96);if(u.length){let f=h>=i;u[0]-=32,u=Uo(u),f&&(u=`Restricted[${u}]`);let g=o(),b=o(),y=!t();return{N:u,P:g,Q:b,M:y,R:f}}}),tf=r(),li=new Map;let l=e().concat(vu(tf)).sort((h,u)=>h-u);l.forEach((h,u)=>{let f=t(),g=l[u]=f?l[u-f]:{V:[],M:new Map};g.V.push(h),tf.has(h)||li.set(h,g)});for(let{V:h,M:u}of new Set(li.values())){let f=[];for(let b of h){let y=Oi.filter(m=>dc(m,b)),k=f.find(({G:m})=>y.some(x=>m.has(x)));k||(k={G:new Set,V:[]},f.push(k)),k.V.push(b),n(k.G,y)}let g=f.flatMap(b=>vu(b.G));for(let{G:b,V:y}of f){let k=new Set(g.filter(m=>!b.has(m)));for(let m of y)u.set(m,k)}}da=new Set;let c=new Set;const d=h=>da.has(h)?c.add(h):da.add(h);for(let h of Oi){for(let u of h.P)d(u);for(let u of h.Q)d(u)}for(let h of da)!li.has(h)&&!c.has(h)&&li.set(h,n1);n(da,e1(da)),_x=U3(t).map(h=>eE.from(h)).sort(V3),D0=new Map;for(let h of _x){let u=[D0];for(let f of h){let g=u.map(b=>{let y=b.get(f);return y||(y=new Map,b.set(f,y)),y});f===r1?u.push(...g):u=g}for(let f of u)f.V=h}}function fg(t){return(i1(t)?"":`${mg(ih([t]))} `)+Kv(t)}function mg(t){return`"${t}"`}function tE(t){if(t.length>=4&&t[2]==Tx&&t[3]==Tx)throw new Error(`invalid label extension: "${Uo(t.slice(0,4))}"`)}function rE(t){for(let r=t.lastIndexOf(95);r>0;)if(t[--r]!==95)throw new Error("underscore allowed only at start")}function nE(t){let e=t[0],r=Dx.get(e);if(r)throw Bl(`leading ${r}`);let n=t.length,a=-1;for(let i=1;i<n;i++){e=t[i];let o=Dx.get(e);if(o){if(a==i)throw Bl(`${r} + ${o}`);a=i+1,r=o}}if(a==n)throw Bl(`trailing ${r}`)}function ih(t,e=1/0,r=Kv){let n=[];sE(t[0])&&n.push(""),t.length>e&&(e>>=1,t=[...t.slice(0,e),8230,...t.slice(-e)]);let a=0,i=t.length;for(let o=0;o<i;o++){let l=t[o];i1(l)&&(n.push(Uo(t.slice(a,o))),n.push(r(l)),a=o+1)}return n.push(Uo(t.slice(a,i))),n.join("")}function sE(t){return hg(),wa.has(t)}function i1(t){return hg(),a1.has(t)}function aE(t){return cE(iE(t,X3,hE))}function iE(t,e,r){if(!t)return[];hg();let n=0;return t.split(t1).map(a=>{let i=H3(a),o={input:i,offset:n};n+=i.length+1;try{let l=o.tokens=uE(i,e,r),c=l.length,d;if(!c)throw new Error("empty label");let h=o.output=l.flat();if(rE(h),!(o.emoji=c>1||l[0].is_emoji)&&h.every(f=>f<128))tE(h),d="ASCII";else{let f=l.flatMap(g=>g.is_emoji?[]:g);if(!f.length)d="Emoji";else{if(wa.has(h[0]))throw Bl("leading combining mark");for(let y=1;y<c;y++){let k=l[y];if(!k.is_emoji&&wa.has(k[0]))throw Bl(`emoji + combining mark: "${Uo(l[y-1])} + ${ih([k[0]])}"`)}nE(h);let g=vu(new Set(f)),[b]=lE(g);dE(b,f),oE(b,g),d=b.N}}o.type=d}catch(l){o.error=l}return o})}function oE(t,e){let r,n=[];for(let a of e){let i=li.get(a);if(i===n1)return;if(i){let o=i.M.get(a);if(r=r?r.filter(l=>o.has(l)):vu(o),!r.length)return}else n.push(a)}if(r){for(let a of r)if(n.every(i=>dc(a,i)))throw new Error(`whole-script confusable: ${t.N}/${a.N}`)}}function lE(t){let e=Oi;for(let r of t){let n=e.filter(a=>dc(a,r));if(!n.length)throw Oi.some(a=>dc(a,r))?l1(e[0],r):o1(r);if(e=n,n.length==1)break}return e}function cE(t){return t.map(({input:e,error:r,output:n})=>{if(r){let a=r.message;throw new Error(t.length==1?a:`Invalid label ${mg(ih(e,63))}: ${a}`)}return Uo(n)}).join(t1)}function o1(t){return new Error(`disallowed character: ${fg(t)}`)}function l1(t,e){let r=fg(e),n=Oi.find(a=>a.P.has(e));return n&&(r=`${n.N} ${r}`),new Error(`illegal mixture: ${t.N} + ${r}`)}function Bl(t){return new Error(`illegal placement: ${t}`)}function dE(t,e){for(let r of e)if(!dc(t,r))throw l1(t,r);if(t.M){let r=e1(e);for(let n=1,a=r.length;n<a;n++)if(C0.has(r[n])){let i=n+1;for(let o;i<a&&C0.has(o=r[i]);i++)for(let l=n;l<i;l++)if(r[l]==o)throw new Error(`duplicate non-spacing marks: ${fg(o)}`);if(i-n>Px)throw new Error(`excessive non-spacing marks: ${mg(ih(r.slice(n-1,i)))} (${i-n}/${Px})`);n=i}}}function uE(t,e,r){let n=[],a=[];for(t=t.slice().reverse();t.length;){let i=fE(t);if(i)a.length&&(n.push(e(a)),a=[]),n.push(r(i));else{let o=t.pop();if(da.has(o))a.push(o);else{let l=S0.get(o);if(l)a.push(...l);else if(!s1.has(o))throw o1(o)}}}return a.length&&n.push(e(a)),n}function hE(t){return t.filter(e=>e!=r1)}function fE(t,e){let r=D0,n,a=t.length;for(;a&&(r=r.get(t[--a]),!!r);){let{V:i}=r;i&&(n=i,t.length=a)}return n}const c1=new Uint8Array(32);c1.fill(0);function Bx(t){return P(t.length!==0,"invalid ENS name; empty component","comp",t),t}function d1(t){const e=$n(mE(t)),r=[];if(t.length===0)return r;let n=0;for(let a=0;a<e.length;a++)e[a]===46&&(r.push(Bx(e.slice(n,a))),n=a+1);return P(n<e.length,"invalid ENS name; empty component","name",t),r.push(Bx(e.slice(n))),r}function mE(t){try{if(t.length===0)throw new Error("empty label");return aE(t)}catch(e){P(!1,`invalid ENS name (${e.message})`,"name",t)}}function P0(t){P(typeof t=="string","invalid ENS name; not a string","name",t),P(t.length,"invalid ENS name (empty label)","name",t);let e=c1;const r=d1(t);for(;r.length;)e=tt(He([e,tt(r.pop())]));return se(e)}function gE(t,e){const r=e;return P(r<=255,"DNS encoded label cannot exceed 255","length",r),se(He(d1(t).map(n=>{P(n.length<=r,`label ${JSON.stringify(t)} exceeds ${r} bytes`,"name",t);const a=new Uint8Array(n.length+1);return a.set(n,1),a[0]=a.length-1,a})))+"00"}const u1=new Uint8Array(32);u1.fill(0);const pE=BigInt(-1),h1=BigInt(0),f1=BigInt(1),xE=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function yE(t){const e=xe(t),r=e.length%32;return r?He([e,u1.slice(r)]):se(e)}const wE=Zs(f1,32),bE=Zs(h1,32),Rx={name:"string",version:"string",chainId:"uint256",verifyingContract:"address",salt:"bytes32"},rf=["name","version","chainId","verifyingContract","salt"];function Ox(t){return function(e){return P(typeof e=="string",`invalid domain value for ${JSON.stringify(t)}`,`domain.${t}`,e),e}}const vE={name:Ox("name"),version:Ox("version"),chainId:function(t){const e=de(t,"domain.chainId");return P(e>=0,"invalid chain ID","domain.chainId",t),Number.isSafeInteger(e)?Number(e):zr(e)},verifyingContract:function(t){try{return Ie(t).toLowerCase()}catch{}P(!1,'invalid domain value "verifyingContract"',"domain.verifyingContract",t)},salt:function(t){const e=xe(t,"domain.salt");return P(e.length===32,'invalid domain value "salt"',"domain.salt",t),se(e)}};function nf(t){{const e=t.match(/^(u?)int(\d+)$/);if(e){const r=e[1]==="",n=parseInt(e[2]);P(n%8===0&&n!==0&&n<=256&&e[2]===String(n),"invalid numeric width","type",t);const a=gl(xE,r?n-1:n),i=r?(a+f1)*pE:h1;return function(o){const l=de(o,"value");return P(l>=i&&l<=a,`value out-of-bounds for ${t}`,"value",l),Zs(r?Jb(l,256):l,32)}}}{const e=t.match(/^bytes(\d+)$/);if(e){const r=parseInt(e[1]);return P(r!==0&&r<=32&&e[1]===String(r),"invalid bytes width","type",t),function(n){const a=xe(n);return P(a.length===r,`invalid length for ${t}`,"value",n),yE(n)}}}switch(t){case"address":return function(e){return Xn(Ie(e),32)};case"bool":return function(e){return e?wE:bE};case"bytes":return function(e){return tt(e)};case"string":return function(e){return Ya(e)}}return null}function Mx(t,e){return`${t}(${e.map(({name:r,type:n})=>n+" "+r).join(",")})`}function fd(t){const e=t.match(/^([^\x5b]*)((\x5b\d*\x5d)*)(\x5b(\d*)\x5d)$/);return e?{base:e[1],index:e[2]+e[4],array:{base:e[1],prefix:e[1]+e[2],count:e[5]?parseInt(e[5]):-1}}:{base:t}}var bc,Tn,lo,Du,m1;const pr=class pr{constructor(e){U(this,Du);S(this,"primaryType");U(this,bc);U(this,Tn);U(this,lo);j(this,Tn,new Map),j(this,lo,new Map);const r=new Map,n=new Map,a=new Map,i={};Object.keys(e).forEach(c=>{i[c]=e[c].map(({name:d,type:h})=>{let{base:u,index:f}=fd(h);return u==="int"&&!e.int&&(u="int256"),u==="uint"&&!e.uint&&(u="uint256"),{name:d,type:u+(f||"")}}),r.set(c,new Set),n.set(c,[]),a.set(c,new Set)}),j(this,bc,JSON.stringify(i));for(const c in i){const d=new Set;for(const h of i[c]){P(!d.has(h.name),`duplicate variable name ${JSON.stringify(h.name)} in ${JSON.stringify(c)}`,"types",e),d.add(h.name);const u=fd(h.type).base;P(u!==c,`circular type reference to ${JSON.stringify(u)}`,"types",e),!nf(u)&&(P(n.has(u),`unknown type ${JSON.stringify(u)}`,"types",e),n.get(u).push(c),r.get(c).add(u))}}const o=Array.from(n.keys()).filter(c=>n.get(c).length===0);P(o.length!==0,"missing primary type","types",e),P(o.length===1,`ambiguous primary types or unused types: ${o.map(c=>JSON.stringify(c)).join(", ")}`,"types",e),me(this,{primaryType:o[0]});function l(c,d){P(!d.has(c),`circular type reference to ${JSON.stringify(c)}`,"types",e),d.add(c);for(const h of r.get(c))if(n.has(h)){l(h,d);for(const u of d)a.get(u).add(h)}d.delete(c)}l(this.primaryType,new Set);for(const[c,d]of a){const h=Array.from(d);h.sort(),w(this,Tn).set(c,Mx(c,i[c])+h.map(u=>Mx(u,i[u])).join(""))}}get types(){return JSON.parse(w(this,bc))}getEncoder(e){let r=w(this,lo).get(e);return r||(r=ne(this,Du,m1).call(this,e),w(this,lo).set(e,r)),r}encodeType(e){const r=w(this,Tn).get(e);return P(r,`unknown type: ${JSON.stringify(e)}`,"name",e),r}encodeData(e,r){return this.getEncoder(e)(r)}hashStruct(e,r){return tt(this.encodeData(e,r))}encode(e){return this.encodeData(this.primaryType,e)}hash(e){return this.hashStruct(this.primaryType,e)}_visit(e,r,n){if(nf(e))return n(e,r);const a=fd(e).array;if(a)return P(a.count===-1||a.count===r.length,`array length mismatch; expected length ${a.count}`,"value",r),r.map(o=>this._visit(a.prefix,o,n));const i=this.types[e];if(i)return i.reduce((o,{name:l,type:c})=>(o[l]=this._visit(c,r[l],n),o),{});P(!1,`unknown type: ${e}`,"type",e)}visit(e,r){return this._visit(this.primaryType,e,r)}static from(e){return new pr(e)}static getPrimaryType(e){return pr.from(e).primaryType}static hashStruct(e,r,n){return pr.from(r).hashStruct(e,n)}static hashDomain(e){const r=[];for(const n in e){if(e[n]==null)continue;const a=Rx[n];P(a,`invalid typed-data domain key: ${JSON.stringify(n)}`,"domain",e),r.push({name:n,type:a})}return r.sort((n,a)=>rf.indexOf(n.name)-rf.indexOf(a.name)),pr.hashStruct("EIP712Domain",{EIP712Domain:r},e)}static encode(e,r,n){return He(["0x1901",pr.hashDomain(e),pr.from(r).hash(n)])}static hash(e,r,n){return tt(pr.encode(e,r,n))}static async resolveNames(e,r,n,a){e=Object.assign({},e);for(const l in e)e[l]==null&&delete e[l];const i={};e.verifyingContract&&!Me(e.verifyingContract,20)&&(i[e.verifyingContract]="0x");const o=pr.from(r);o.visit(n,(l,c)=>(l==="address"&&!Me(c,20)&&(i[c]="0x"),c));for(const l in i)i[l]=await a(l);return e.verifyingContract&&i[e.verifyingContract]&&(e.verifyingContract=i[e.verifyingContract]),n=o.visit(n,(l,c)=>l==="address"&&i[c]?i[c]:c),{domain:e,value:n}}static getPayload(e,r,n){pr.hashDomain(e);const a={},i=[];rf.forEach(c=>{const d=e[c];d!=null&&(a[c]=vE[c](d),i.push({name:c,type:Rx[c]}))});const o=pr.from(r);r=o.types;const l=Object.assign({},r);return P(l.EIP712Domain==null,"types must not contain EIP712Domain type","types.EIP712Domain",r),l.EIP712Domain=i,o.encode(n),{types:l,domain:a,primaryType:o.primaryType,message:o.visit(n,(c,d)=>{if(c.match(/^bytes(\d*)/))return se(xe(d));if(c.match(/^u?int/))return de(d).toString();switch(c){case"address":return d.toLowerCase();case"bool":return!!d;case"string":return P(typeof d=="string","invalid string","value",d),d}P(!1,"unsupported type","type",c)})}}};bc=new WeakMap,Tn=new WeakMap,lo=new WeakMap,Du=new WeakSet,m1=function(e){{const a=nf(e);if(a)return a}const r=fd(e).array;if(r){const a=r.prefix,i=this.getEncoder(a);return o=>{P(r.count===-1||r.count===o.length,`array length mismatch; expected length ${r.count}`,"value",o);let l=o.map(i);return w(this,Tn).has(a)&&(l=l.map(tt)),tt(He(l))}}const n=this.types[e];if(n){const a=Ya(w(this,Tn).get(e));return i=>{const o=n.map(({name:l,type:c})=>{const d=this.getEncoder(c)(i[l]);return w(this,Tn).has(c)?tt(d):d});return o.unshift(a),He(o)}}P(!1,`unknown type: ${e}`,"type",e)};let Nu=pr;function Rt(t){const e=new Set;return t.forEach(r=>e.add(r)),Object.freeze(e)}const NE="external public payable override",kE=Rt(NE.split(" ")),g1="constant external internal payable private public pure view override",jE=Rt(g1.split(" ")),p1="constructor error event fallback function receive struct",x1=Rt(p1.split(" ")),y1="calldata memory storage payable indexed",AE=Rt(y1.split(" ")),EE="tuple returns",SE=[p1,y1,EE,g1].join(" "),CE=Rt(SE.split(" ")),DE={"(":"OPEN_PAREN",")":"CLOSE_PAREN","[":"OPEN_BRACKET","]":"CLOSE_BRACKET",",":"COMMA","@":"AT"},PE=new RegExp("^(\\s*)"),IE=new RegExp("^([0-9]+)"),TE=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)"),w1=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)$"),b1=new RegExp("^(address|bool|bytes([0-9]*)|string|u?int([0-9]*))$");var ut,Mr,vc,I0;const Pu=class Pu{constructor(e){U(this,vc);U(this,ut);U(this,Mr);j(this,ut,0),j(this,Mr,e.slice())}get offset(){return w(this,ut)}get length(){return w(this,Mr).length-w(this,ut)}clone(){return new Pu(w(this,Mr))}reset(){j(this,ut,0)}popKeyword(e){const r=this.peek();if(r.type!=="KEYWORD"||!e.has(r.text))throw new Error(`expected keyword ${r.text}`);return this.pop().text}popType(e){if(this.peek().type!==e){const r=this.peek();throw new Error(`expected ${e}; got ${r.type} ${JSON.stringify(r.text)}`)}return this.pop().text}popParen(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const r=ne(this,vc,I0).call(this,w(this,ut)+1,e.match+1);return j(this,ut,e.match+1),r}popParams(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const r=[];for(;w(this,ut)<e.match-1;){const n=this.peek().linkNext;r.push(ne(this,vc,I0).call(this,w(this,ut)+1,n)),j(this,ut,n)}return j(this,ut,e.match+1),r}peek(){if(w(this,ut)>=w(this,Mr).length)throw new Error("out-of-bounds");return w(this,Mr)[w(this,ut)]}peekKeyword(e){const r=this.peekType("KEYWORD");return r!=null&&e.has(r)?r:null}peekType(e){if(this.length===0)return null;const r=this.peek();return r.type===e?r.text:null}pop(){const e=this.peek();return el(this,ut)._++,e}toString(){const e=[];for(let r=w(this,ut);r<w(this,Mr).length;r++){const n=w(this,Mr)[r];e.push(`${n.type}:${n.text}`)}return`<TokenString ${e.join(" ")}>`}};ut=new WeakMap,Mr=new WeakMap,vc=new WeakSet,I0=function(e=0,r=0){return new Pu(w(this,Mr).slice(e,r).map(n=>Object.freeze(Object.assign({},n,{match:n.match-e,linkBack:n.linkBack-e,linkNext:n.linkNext-e}))))};let Jr=Pu;function na(t){const e=[],r=o=>{const l=i<t.length?JSON.stringify(t[i]):"$EOI";throw new Error(`invalid token ${l} at ${i}: ${o}`)};let n=[],a=[],i=0;for(;i<t.length;){let o=t.substring(i),l=o.match(PE);l&&(i+=l[1].length,o=t.substring(i));const c={depth:n.length,linkBack:-1,linkNext:-1,match:-1,type:"",text:"",offset:i,value:-1};e.push(c);let d=DE[o[0]]||"";if(d){if(c.type=d,c.text=o[0],i++,d==="OPEN_PAREN")n.push(e.length-1),a.push(e.length-1);else if(d=="CLOSE_PAREN")n.length===0&&r("no matching open bracket"),c.match=n.pop(),e[c.match].match=e.length-1,c.depth--,c.linkBack=a.pop(),e[c.linkBack].linkNext=e.length-1;else if(d==="COMMA")c.linkBack=a.pop(),e[c.linkBack].linkNext=e.length-1,a.push(e.length-1);else if(d==="OPEN_BRACKET")c.type="BRACKET";else if(d==="CLOSE_BRACKET"){let h=e.pop().text;if(e.length>0&&e[e.length-1].type==="NUMBER"){const u=e.pop().text;h=u+h,e[e.length-1].value=ye(u)}if(e.length===0||e[e.length-1].type!=="BRACKET")throw new Error("missing opening bracket");e[e.length-1].text+=h}continue}if(l=o.match(TE),l){if(c.text=l[1],i+=c.text.length,CE.has(c.text)){c.type="KEYWORD";continue}if(c.text.match(b1)){c.type="TYPE";continue}c.type="ID";continue}if(l=o.match(IE),l){c.text=l[1],c.type="NUMBER",i+=c.text.length;continue}throw new Error(`unexpected token ${JSON.stringify(o[0])} at position ${i}`)}return new Jr(e.map(o=>Object.freeze(o)))}function Lx(t,e){let r=[];for(const n in e.keys())t.has(n)&&r.push(n);if(r.length>1)throw new Error(`conflicting types: ${r.join(", ")}`)}function oh(t,e){if(e.peekKeyword(x1)){const r=e.pop().text;if(r!==t)throw new Error(`expected ${t}, got ${r}`)}return e.popType("ID")}function ts(t,e){const r=new Set;for(;;){const n=t.peekType("KEYWORD");if(n==null||e&&!e.has(n))break;if(t.pop(),r.has(n))throw new Error(`duplicate keywords: ${JSON.stringify(n)}`);r.add(n)}return Object.freeze(r)}function v1(t){let e=ts(t,jE);return Lx(e,Rt("constant payable nonpayable".split(" "))),Lx(e,Rt("pure view payable nonpayable".split(" "))),e.has("view")?"view":e.has("pure")?"pure":e.has("payable")?"payable":e.has("nonpayable")?"nonpayable":e.has("constant")?"view":"nonpayable"}function Wn(t,e){return t.popParams().map(r=>pt.from(r,e))}function N1(t){if(t.peekType("AT")){if(t.pop(),t.peekType("NUMBER"))return de(t.pop().text);throw new Error("invalid gas")}return null}function qa(t){if(t.length)throw new Error(`unexpected tokens at offset ${t.offset}: ${t.toString()}`)}const _E=new RegExp(/^(.*)\[([0-9]*)\]$/);function Fx(t){const e=t.match(b1);if(P(e,"invalid type","type",t),t==="uint")return"uint256";if(t==="int")return"int256";if(e[2]){const r=parseInt(e[2]);P(r!==0&&r<=32,"invalid bytes length","type",t)}else if(e[3]){const r=parseInt(e[3]);P(r!==0&&r<=256&&r%8===0,"invalid numeric width","type",t)}return t}const Qe={},Zt=Symbol.for("_ethers_internal"),Ux="_ParamTypeInternal",zx="_ErrorInternal",Hx="_EventInternal",Vx="_ConstructorInternal",Gx="_FallbackInternal",$x="_FunctionInternal",Qx="_StructInternal";var co,Bd;const xr=class xr{constructor(e,r,n,a,i,o,l,c){U(this,co);S(this,"name");S(this,"type");S(this,"baseType");S(this,"indexed");S(this,"components");S(this,"arrayLength");S(this,"arrayChildren");if(Xu(e,Qe,"ParamType"),Object.defineProperty(this,Zt,{value:Ux}),o&&(o=Object.freeze(o.slice())),a==="array"){if(l==null||c==null)throw new Error("")}else if(l!=null||c!=null)throw new Error("");if(a==="tuple"){if(o==null)throw new Error("")}else if(o!=null)throw new Error("");me(this,{name:r,type:n,baseType:a,indexed:i,components:o,arrayLength:l,arrayChildren:c})}format(e){if(e==null&&(e="sighash"),e==="json"){const n=this.name||"";if(this.isArray()){const i=JSON.parse(this.arrayChildren.format("json"));return i.name=n,i.type+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`,JSON.stringify(i)}const a={type:this.baseType==="tuple"?"tuple":this.type,name:n};return typeof this.indexed=="boolean"&&(a.indexed=this.indexed),this.isTuple()&&(a.components=this.components.map(i=>JSON.parse(i.format(e)))),JSON.stringify(a)}let r="";return this.isArray()?(r+=this.arrayChildren.format(e),r+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`):this.isTuple()?r+="("+this.components.map(n=>n.format(e)).join(e==="full"?", ":",")+")":r+=this.type,e!=="sighash"&&(this.indexed===!0&&(r+=" indexed"),e==="full"&&this.name&&(r+=" "+this.name)),r}isArray(){return this.baseType==="array"}isTuple(){return this.baseType==="tuple"}isIndexable(){return this.indexed!=null}walk(e,r){if(this.isArray()){if(!Array.isArray(e))throw new Error("invalid array value");if(this.arrayLength!==-1&&e.length!==this.arrayLength)throw new Error("array is wrong length");const n=this;return e.map(a=>n.arrayChildren.walk(a,r))}if(this.isTuple()){if(!Array.isArray(e))throw new Error("invalid tuple value");if(e.length!==this.components.length)throw new Error("array is wrong length");const n=this;return e.map((a,i)=>n.components[i].walk(a,r))}return r(this.type,e)}async walkAsync(e,r){const n=[],a=[e];return ne(this,co,Bd).call(this,n,e,r,i=>{a[0]=i}),n.length&&await Promise.all(n),a[0]}static from(e,r){if(xr.isParamType(e))return e;if(typeof e=="string")try{return xr.from(na(e),r)}catch{P(!1,"invalid param type","obj",e)}else if(e instanceof Jr){let l="",c="",d=null;ts(e,Rt(["tuple"])).has("tuple")||e.peekType("OPEN_PAREN")?(c="tuple",d=e.popParams().map(y=>xr.from(y)),l=`tuple(${d.map(y=>y.format()).join(",")})`):(l=Fx(e.popType("TYPE")),c=l);let h=null,u=null;for(;e.length&&e.peekType("BRACKET");){const y=e.pop();h=new xr(Qe,"",l,c,null,d,u,h),u=y.value,l+=y.text,c="array",d=null}let f=null;if(ts(e,AE).has("indexed")){if(!r)throw new Error("");f=!0}const b=e.peekType("ID")?e.pop().text:"";if(e.length)throw new Error("leftover tokens");return new xr(Qe,b,l,c,f,d,u,h)}const n=e.name;P(!n||typeof n=="string"&&n.match(w1),"invalid name","obj.name",n);let a=e.indexed;a!=null&&(P(r,"parameter cannot be indexed","obj.indexed",e.indexed),a=!!a);let i=e.type,o=i.match(_E);if(o){const l=parseInt(o[2]||"-1"),c=xr.from({type:o[1],components:e.components});return new xr(Qe,n||"",i,"array",a,null,l,c)}if(i==="tuple"||i.startsWith("tuple(")||i.startsWith("(")){const l=e.components!=null?e.components.map(d=>xr.from(d)):null;return new xr(Qe,n||"",i,"tuple",a,l,null,null)}return i=Fx(e.type),new xr(Qe,n||"",i,i,a,null,null,null)}static isParamType(e){return e&&e[Zt]===Ux}};co=new WeakSet,Bd=function(e,r,n,a){if(this.isArray()){if(!Array.isArray(r))throw new Error("invalid array value");if(this.arrayLength!==-1&&r.length!==this.arrayLength)throw new Error("array is wrong length");const o=this.arrayChildren,l=r.slice();l.forEach((c,d)=>{var h;ne(h=o,co,Bd).call(h,e,c,n,u=>{l[d]=u})}),a(l);return}if(this.isTuple()){const o=this.components;let l;if(Array.isArray(r))l=r.slice();else{if(r==null||typeof r!="object")throw new Error("invalid tuple value");l=o.map(c=>{if(!c.name)throw new Error("cannot use object value with unnamed components");if(!(c.name in r))throw new Error(`missing value for component ${c.name}`);return r[c.name]})}if(l.length!==this.components.length)throw new Error("array is wrong length");l.forEach((c,d)=>{var h;ne(h=o[d],co,Bd).call(h,e,c,n,u=>{l[d]=u})}),a(l);return}const i=n(this.type,r);i.then?e.push(async function(){a(await i)}()):a(i)};let pt=xr;class Za{constructor(e,r,n){S(this,"type");S(this,"inputs");Xu(e,Qe,"Fragment"),n=Object.freeze(n.slice()),me(this,{type:r,inputs:n})}static from(e){if(typeof e=="string"){try{Za.from(JSON.parse(e))}catch{}return Za.from(na(e))}if(e instanceof Jr)switch(e.peekKeyword(x1)){case"constructor":return Vn.from(e);case"error":return $t.from(e);case"event":return gn.from(e);case"fallback":case"receive":return Sn.from(e);case"function":return pn.from(e);case"struct":return Ga.from(e)}else if(typeof e=="object"){switch(e.type){case"constructor":return Vn.from(e);case"error":return $t.from(e);case"event":return gn.from(e);case"fallback":case"receive":return Sn.from(e);case"function":return pn.from(e);case"struct":return Ga.from(e)}J(!1,`unsupported type: ${e.type}`,"UNSUPPORTED_OPERATION",{operation:"Fragment.from"})}P(!1,"unsupported frgament object","obj",e)}static isConstructor(e){return Vn.isFragment(e)}static isError(e){return $t.isFragment(e)}static isEvent(e){return gn.isFragment(e)}static isFunction(e){return pn.isFragment(e)}static isStruct(e){return Ga.isFragment(e)}}class lh extends Za{constructor(r,n,a,i){super(r,n,i);S(this,"name");P(typeof a=="string"&&a.match(w1),"invalid identifier","name",a),i=Object.freeze(i.slice()),me(this,{name:a})}}function uc(t,e){return"("+e.map(r=>r.format(t)).join(t==="full"?", ":",")+")"}class $t extends lh{constructor(e,r,n){super(e,"error",r,n),Object.defineProperty(this,Zt,{value:zx})}get selector(){return Ya(this.format("sighash")).substring(0,10)}format(e){if(e==null&&(e="sighash"),e==="json")return JSON.stringify({type:"error",name:this.name,inputs:this.inputs.map(n=>JSON.parse(n.format(e)))});const r=[];return e!=="sighash"&&r.push("error"),r.push(this.name+uc(e,this.inputs)),r.join(" ")}static from(e){if($t.isFragment(e))return e;if(typeof e=="string")return $t.from(na(e));if(e instanceof Jr){const r=oh("error",e),n=Wn(e);return qa(e),new $t(Qe,r,n)}return new $t(Qe,e.name,e.inputs?e.inputs.map(pt.from):[])}static isFragment(e){return e&&e[Zt]===zx}}class gn extends lh{constructor(r,n,a,i){super(r,"event",n,a);S(this,"anonymous");Object.defineProperty(this,Zt,{value:Hx}),me(this,{anonymous:i})}get topicHash(){return Ya(this.format("sighash"))}format(r){if(r==null&&(r="sighash"),r==="json")return JSON.stringify({type:"event",anonymous:this.anonymous,name:this.name,inputs:this.inputs.map(a=>JSON.parse(a.format(r)))});const n=[];return r!=="sighash"&&n.push("event"),n.push(this.name+uc(r,this.inputs)),r!=="sighash"&&this.anonymous&&n.push("anonymous"),n.join(" ")}static getTopicHash(r,n){return n=(n||[]).map(i=>pt.from(i)),new gn(Qe,r,n,!1).topicHash}static from(r){if(gn.isFragment(r))return r;if(typeof r=="string")try{return gn.from(na(r))}catch{P(!1,"invalid event fragment","obj",r)}else if(r instanceof Jr){const n=oh("event",r),a=Wn(r,!0),i=!!ts(r,Rt(["anonymous"])).has("anonymous");return qa(r),new gn(Qe,n,a,i)}return new gn(Qe,r.name,r.inputs?r.inputs.map(n=>pt.from(n,!0)):[],!!r.anonymous)}static isFragment(r){return r&&r[Zt]===Hx}}class Vn extends Za{constructor(r,n,a,i,o){super(r,n,a);S(this,"payable");S(this,"gas");Object.defineProperty(this,Zt,{value:Vx}),me(this,{payable:i,gas:o})}format(r){if(J(r!=null&&r!=="sighash","cannot format a constructor for sighash","UNSUPPORTED_OPERATION",{operation:"format(sighash)"}),r==="json")return JSON.stringify({type:"constructor",stateMutability:this.payable?"payable":"undefined",payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(a=>JSON.parse(a.format(r)))});const n=[`constructor${uc(r,this.inputs)}`];return this.payable&&n.push("payable"),this.gas!=null&&n.push(`@${this.gas.toString()}`),n.join(" ")}static from(r){if(Vn.isFragment(r))return r;if(typeof r=="string")try{return Vn.from(na(r))}catch{P(!1,"invalid constuctor fragment","obj",r)}else if(r instanceof Jr){ts(r,Rt(["constructor"]));const n=Wn(r),a=!!ts(r,kE).has("payable"),i=N1(r);return qa(r),new Vn(Qe,"constructor",n,a,i)}return new Vn(Qe,"constructor",r.inputs?r.inputs.map(pt.from):[],!!r.payable,r.gas!=null?r.gas:null)}static isFragment(r){return r&&r[Zt]===Vx}}class Sn extends Za{constructor(r,n,a){super(r,"fallback",n);S(this,"payable");Object.defineProperty(this,Zt,{value:Gx}),me(this,{payable:a})}format(r){const n=this.inputs.length===0?"receive":"fallback";if(r==="json"){const a=this.payable?"payable":"nonpayable";return JSON.stringify({type:n,stateMutability:a})}return`${n}()${this.payable?" payable":""}`}static from(r){if(Sn.isFragment(r))return r;if(typeof r=="string")try{return Sn.from(na(r))}catch{P(!1,"invalid fallback fragment","obj",r)}else if(r instanceof Jr){const n=r.toString(),a=r.peekKeyword(Rt(["fallback","receive"]));if(P(a,"type must be fallback or receive","obj",n),r.popKeyword(Rt(["fallback","receive"]))==="receive"){const c=Wn(r);return P(c.length===0,"receive cannot have arguments","obj.inputs",c),ts(r,Rt(["payable"])),qa(r),new Sn(Qe,[],!0)}let o=Wn(r);o.length?P(o.length===1&&o[0].type==="bytes","invalid fallback inputs","obj.inputs",o.map(c=>c.format("minimal")).join(", ")):o=[pt.from("bytes")];const l=v1(r);if(P(l==="nonpayable"||l==="payable","fallback cannot be constants","obj.stateMutability",l),ts(r,Rt(["returns"])).has("returns")){const c=Wn(r);P(c.length===1&&c[0].type==="bytes","invalid fallback outputs","obj.outputs",c.map(d=>d.format("minimal")).join(", "))}return qa(r),new Sn(Qe,o,l==="payable")}if(r.type==="receive")return new Sn(Qe,[],!0);if(r.type==="fallback"){const n=[pt.from("bytes")],a=r.stateMutability==="payable";return new Sn(Qe,n,a)}P(!1,"invalid fallback description","obj",r)}static isFragment(r){return r&&r[Zt]===Gx}}class pn extends lh{constructor(r,n,a,i,o,l){super(r,"function",n,i);S(this,"constant");S(this,"outputs");S(this,"stateMutability");S(this,"payable");S(this,"gas");Object.defineProperty(this,Zt,{value:$x}),o=Object.freeze(o.slice()),me(this,{constant:a==="view"||a==="pure",gas:l,outputs:o,payable:a==="payable",stateMutability:a})}get selector(){return Ya(this.format("sighash")).substring(0,10)}format(r){if(r==null&&(r="sighash"),r==="json")return JSON.stringify({type:"function",name:this.name,constant:this.constant,stateMutability:this.stateMutability!=="nonpayable"?this.stateMutability:void 0,payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(a=>JSON.parse(a.format(r))),outputs:this.outputs.map(a=>JSON.parse(a.format(r)))});const n=[];return r!=="sighash"&&n.push("function"),n.push(this.name+uc(r,this.inputs)),r!=="sighash"&&(this.stateMutability!=="nonpayable"&&n.push(this.stateMutability),this.outputs&&this.outputs.length&&(n.push("returns"),n.push(uc(r,this.outputs))),this.gas!=null&&n.push(`@${this.gas.toString()}`)),n.join(" ")}static getSelector(r,n){return n=(n||[]).map(i=>pt.from(i)),new pn(Qe,r,"view",n,[],null).selector}static from(r){if(pn.isFragment(r))return r;if(typeof r=="string")try{return pn.from(na(r))}catch{P(!1,"invalid function fragment","obj",r)}else if(r instanceof Jr){const a=oh("function",r),i=Wn(r),o=v1(r);let l=[];ts(r,Rt(["returns"])).has("returns")&&(l=Wn(r));const c=N1(r);return qa(r),new pn(Qe,a,o,i,l,c)}let n=r.stateMutability;return n==null&&(n="payable",typeof r.constant=="boolean"?(n="view",r.constant||(n="payable",typeof r.payable=="boolean"&&!r.payable&&(n="nonpayable"))):typeof r.payable=="boolean"&&!r.payable&&(n="nonpayable")),new pn(Qe,r.name,n,r.inputs?r.inputs.map(pt.from):[],r.outputs?r.outputs.map(pt.from):[],r.gas!=null?r.gas:null)}static isFragment(r){return r&&r[Zt]===$x}}class Ga extends lh{constructor(e,r,n){super(e,"struct",r,n),Object.defineProperty(this,Zt,{value:Qx})}format(){throw new Error("@TODO")}static from(e){if(typeof e=="string")try{return Ga.from(na(e))}catch{P(!1,"invalid struct fragment","obj",e)}else if(e instanceof Jr){const r=oh("struct",e),n=Wn(e);return qa(e),new Ga(Qe,r,n)}return new Ga(Qe,e.name,e.inputs?e.inputs.map(pt.from):[])}static isFragment(e){return e&&e[Zt]===Qx}}const Yr=new Map;Yr.set(0,"GENERIC_PANIC");Yr.set(1,"ASSERT_FALSE");Yr.set(17,"OVERFLOW");Yr.set(18,"DIVIDE_BY_ZERO");Yr.set(33,"ENUM_RANGE_ERROR");Yr.set(34,"BAD_STORAGE_DATA");Yr.set(49,"STACK_UNDERFLOW");Yr.set(50,"ARRAY_RANGE_ERROR");Yr.set(65,"OUT_OF_MEMORY");Yr.set(81,"UNINITIALIZED_FUNCTION_CALL");const BE=new RegExp(/^bytes([0-9]*)$/),RE=new RegExp(/^(u?int)([0-9]*)$/);let sf=null,Wx=1024;function OE(t,e,r,n){let a="missing revert data",i=null;const o=null;let l=null;if(r){a="execution reverted";const d=xe(r);if(r=se(r),d.length===0)a+=" (no data present; likely require(false) occurred",i="require(false)";else if(d.length%32!==4)a+=" (could not decode reason; invalid data length)";else if(se(d.slice(0,4))==="0x08c379a0")try{i=n.decode(["string"],d.slice(4))[0],l={signature:"Error(string)",name:"Error",args:[i]},a+=`: ${JSON.stringify(i)}`}catch{a+=" (could not decode reason; invalid string data)"}else if(se(d.slice(0,4))==="0x4e487b71")try{const h=Number(n.decode(["uint256"],d.slice(4))[0]);l={signature:"Panic(uint256)",name:"Panic",args:[h]},i=`Panic due to ${Yr.get(h)||"UNKNOWN"}(${h})`,a+=`: ${i}`}catch{a+=" (could not decode panic code)"}else a+=" (unknown custom error)"}const c={to:e.to?Ie(e.to):null,data:e.data||"0x"};return e.from&&(c.from=Ie(e.from)),Ve(a,"CALL_EXCEPTION",{action:t,data:r,reason:i,transaction:c,invocation:o,revert:l})}var As,ci;const Iu=class Iu{constructor(){U(this,As)}getDefaultValue(e){const r=e.map(a=>ne(this,As,ci).call(this,pt.from(a)));return new hd(r,"_").defaultValue()}encode(e,r){Qb(r.length,e.length,"types/values length mismatch");const n=e.map(o=>ne(this,As,ci).call(this,pt.from(o))),a=new hd(n,"_"),i=new p0;return a.encode(i,r),i.data}decode(e,r,n){const a=e.map(o=>ne(this,As,ci).call(this,pt.from(o)));return new hd(a,"_").decode(new x0(r,n,Wx))}static _setDefaultMaxInflation(e){P(typeof e=="number"&&Number.isInteger(e),"invalid defaultMaxInflation factor","value",e),Wx=e}static defaultAbiCoder(){return sf==null&&(sf=new Iu),sf}static getBuiltinCallException(e,r,n){return OE(e,r,n,Iu.defaultAbiCoder())}};As=new WeakSet,ci=function(e){if(e.isArray())return new X4(ne(this,As,ci).call(this,e.arrayChildren),e.arrayLength,e.name);if(e.isTuple())return new hd(e.components.map(n=>ne(this,As,ci).call(this,n)),e.name);switch(e.baseType){case"address":return new q4(e.name);case"bool":return new e3(e.name);case"string":return new c3(e.name);case"bytes":return new t3(e.name);case"":return new s3(e.name)}let r=e.type.match(RE);if(r){let n=parseInt(r[2]||"256");return P(n!==0&&n<=256&&n%8===0,"invalid "+r[1]+" bit length","param",e),new l3(n/8,r[1]==="int",e.name)}if(r=e.type.match(BE),r){let n=parseInt(r[1]);return P(n!==0&&n<=32,"invalid bytes length","param",e),new r3(n,e.name)}P(!1,"invalid type","type",e.type)};let hc=Iu;class ME{constructor(e,r,n){S(this,"fragment");S(this,"name");S(this,"signature");S(this,"topic");S(this,"args");const a=e.name,i=e.format();me(this,{fragment:e,name:a,signature:i,topic:r,args:n})}}class LE{constructor(e,r,n,a){S(this,"fragment");S(this,"name");S(this,"args");S(this,"signature");S(this,"selector");S(this,"value");const i=e.name,o=e.format();me(this,{fragment:e,name:i,args:n,signature:o,selector:r,value:a})}}class FE{constructor(e,r,n){S(this,"fragment");S(this,"name");S(this,"args");S(this,"signature");S(this,"selector");const a=e.name,i=e.format();me(this,{fragment:e,name:a,args:n,signature:i,selector:r})}}class Kx{constructor(e){S(this,"hash");S(this,"_isIndexed");me(this,{hash:e,_isIndexed:!0})}static isIndexed(e){return!!(e&&e._isIndexed)}}const Jx={0:"generic panic",1:"assert(false)",17:"arithmetic overflow",18:"division or modulo by zero",33:"enum overflow",34:"invalid encoded storage byte array accessed",49:"out-of-bounds array access; popping on an empty array",50:"out-of-bounds access of an array or bytesN",65:"out of memory",81:"uninitialized function"},Yx={"0x08c379a0":{signature:"Error(string)",name:"Error",inputs:["string"],reason:t=>`reverted with reason string ${JSON.stringify(t)}`},"0x4e487b71":{signature:"Panic(uint256)",name:"Panic",inputs:["uint256"],reason:t=>{let e="unknown panic code";return t>=0&&t<=255&&Jx[t.toString()]&&(e=Jx[t.toString()]),`reverted with panic code 0x${t.toString(16)} (${e})`}}};var ln,cn,dn,vt,bn,Rd,Od;const ma=class ma{constructor(e){U(this,bn);S(this,"fragments");S(this,"deploy");S(this,"fallback");S(this,"receive");U(this,ln);U(this,cn);U(this,dn);U(this,vt);let r=[];typeof e=="string"?r=JSON.parse(e):r=e,j(this,dn,new Map),j(this,ln,new Map),j(this,cn,new Map);const n=[];for(const o of r)try{n.push(Za.from(o))}catch(l){console.log(`[Warning] Invalid Fragment ${JSON.stringify(o)}:`,l.message)}me(this,{fragments:Object.freeze(n)});let a=null,i=!1;j(this,vt,this.getAbiCoder()),this.fragments.forEach((o,l)=>{let c;switch(o.type){case"constructor":if(this.deploy){console.log("duplicate definition - constructor");return}me(this,{deploy:o});return;case"fallback":o.inputs.length===0?i=!0:(P(!a||o.payable!==a.payable,"conflicting fallback fragments",`fragments[${l}]`,o),a=o,i=a.payable);return;case"function":c=w(this,dn);break;case"event":c=w(this,cn);break;case"error":c=w(this,ln);break;default:return}const d=o.format();c.has(d)||c.set(d,o)}),this.deploy||me(this,{deploy:Vn.from("constructor()")}),me(this,{fallback:a,receive:i})}format(e){const r=e?"minimal":"full";return this.fragments.map(a=>a.format(r))}formatJson(){const e=this.fragments.map(r=>r.format("json"));return JSON.stringify(e.map(r=>JSON.parse(r)))}getAbiCoder(){return hc.defaultAbiCoder()}getFunctionName(e){const r=ne(this,bn,Rd).call(this,e,null,!1);return P(r,"no matching function","key",e),r.name}hasFunction(e){return!!ne(this,bn,Rd).call(this,e,null,!1)}getFunction(e,r){return ne(this,bn,Rd).call(this,e,r||null,!0)}forEachFunction(e){const r=Array.from(w(this,dn).keys());r.sort((n,a)=>n.localeCompare(a));for(let n=0;n<r.length;n++){const a=r[n];e(w(this,dn).get(a),n)}}getEventName(e){const r=ne(this,bn,Od).call(this,e,null,!1);return P(r,"no matching event","key",e),r.name}hasEvent(e){return!!ne(this,bn,Od).call(this,e,null,!1)}getEvent(e,r){return ne(this,bn,Od).call(this,e,r||null,!0)}forEachEvent(e){const r=Array.from(w(this,cn).keys());r.sort((n,a)=>n.localeCompare(a));for(let n=0;n<r.length;n++){const a=r[n];e(w(this,cn).get(a),n)}}getError(e,r){if(Me(e)){const a=e.toLowerCase();if(Yx[a])return $t.from(Yx[a].signature);for(const i of w(this,ln).values())if(a===i.selector)return i;return null}if(e.indexOf("(")===-1){const a=[];for(const[i,o]of w(this,ln))i.split("(")[0]===e&&a.push(o);if(a.length===0)return e==="Error"?$t.from("error Error(string)"):e==="Panic"?$t.from("error Panic(uint256)"):null;if(a.length>1){const i=a.map(o=>JSON.stringify(o.format())).join(", ");P(!1,`ambiguous error description (i.e. ${i})`,"name",e)}return a[0]}if(e=$t.from(e).format(),e==="Error(string)")return $t.from("error Error(string)");if(e==="Panic(uint256)")return $t.from("error Panic(uint256)");const n=w(this,ln).get(e);return n||null}forEachError(e){const r=Array.from(w(this,ln).keys());r.sort((n,a)=>n.localeCompare(a));for(let n=0;n<r.length;n++){const a=r[n];e(w(this,ln).get(a),n)}}_decodeParams(e,r){return w(this,vt).decode(e,r)}_encodeParams(e,r){return w(this,vt).encode(e,r)}encodeDeploy(e){return this._encodeParams(this.deploy.inputs,e||[])}decodeErrorResult(e,r){if(typeof e=="string"){const n=this.getError(e);P(n,"unknown error","fragment",e),e=n}return P(Je(r,0,4)===e.selector,`data signature does not match error ${e.name}.`,"data",r),this._decodeParams(e.inputs,Je(r,4))}encodeErrorResult(e,r){if(typeof e=="string"){const n=this.getError(e);P(n,"unknown error","fragment",e),e=n}return He([e.selector,this._encodeParams(e.inputs,r||[])])}decodeFunctionData(e,r){if(typeof e=="string"){const n=this.getFunction(e);P(n,"unknown function","fragment",e),e=n}return P(Je(r,0,4)===e.selector,`data signature does not match function ${e.name}.`,"data",r),this._decodeParams(e.inputs,Je(r,4))}encodeFunctionData(e,r){if(typeof e=="string"){const n=this.getFunction(e);P(n,"unknown function","fragment",e),e=n}return He([e.selector,this._encodeParams(e.inputs,r||[])])}decodeFunctionResult(e,r){if(typeof e=="string"){const i=this.getFunction(e);P(i,"unknown function","fragment",e),e=i}let n="invalid length for result data";const a=Tt(r);if(a.length%32===0)try{return w(this,vt).decode(e.outputs,a)}catch{n="could not decode result data"}J(!1,n,"BAD_DATA",{value:se(a),info:{method:e.name,signature:e.format()}})}makeError(e,r){const n=xe(e,"data"),a=hc.getBuiltinCallException("call",r,n);if(a.message.startsWith("execution reverted (unknown custom error)")){const l=se(n.slice(0,4)),c=this.getError(l);if(c)try{const d=w(this,vt).decode(c.inputs,n.slice(4));a.revert={name:c.name,signature:c.format(),args:d},a.reason=a.revert.signature,a.message=`execution reverted: ${a.reason}`}catch{a.message="execution reverted (coult not decode custom error)"}}const o=this.parseTransaction(r);return o&&(a.invocation={method:o.name,signature:o.signature,args:o.args}),a}encodeFunctionResult(e,r){if(typeof e=="string"){const n=this.getFunction(e);P(n,"unknown function","fragment",e),e=n}return se(w(this,vt).encode(e.outputs,r||[]))}encodeFilterTopics(e,r){if(typeof e=="string"){const i=this.getEvent(e);P(i,"unknown event","eventFragment",e),e=i}J(r.length<=e.inputs.length,`too many arguments for ${e.format()}`,"UNEXPECTED_ARGUMENT",{count:r.length,expectedCount:e.inputs.length});const n=[];e.anonymous||n.push(e.topicHash);const a=(i,o)=>i.type==="string"?Ya(o):i.type==="bytes"?tt(se(o)):(i.type==="bool"&&typeof o=="boolean"?o=o?"0x01":"0x00":i.type.match(/^u?int/)?o=Zs(o):i.type.match(/^bytes/)?o=Vj(o,32):i.type==="address"&&w(this,vt).encode(["address"],[o]),Xn(se(o),32));for(r.forEach((i,o)=>{const l=e.inputs[o];if(!l.indexed){P(i==null,"cannot filter non-indexed parameters; must be null","contract."+l.name,i);return}i==null?n.push(null):l.baseType==="array"||l.baseType==="tuple"?P(!1,"filtering with tuples or arrays not supported","contract."+l.name,i):Array.isArray(i)?n.push(i.map(c=>a(l,c))):n.push(a(l,i))});n.length&&n[n.length-1]===null;)n.pop();return n}encodeEventLog(e,r){if(typeof e=="string"){const o=this.getEvent(e);P(o,"unknown event","eventFragment",e),e=o}const n=[],a=[],i=[];return e.anonymous||n.push(e.topicHash),P(r.length===e.inputs.length,"event arguments/values mismatch","values",r),e.inputs.forEach((o,l)=>{const c=r[l];if(o.indexed)if(o.type==="string")n.push(Ya(c));else if(o.type==="bytes")n.push(tt(c));else{if(o.baseType==="tuple"||o.baseType==="array")throw new Error("not implemented");n.push(w(this,vt).encode([o.type],[c]))}else a.push(o),i.push(c)}),{data:w(this,vt).encode(a,i),topics:n}}decodeEventLog(e,r,n){if(typeof e=="string"){const g=this.getEvent(e);P(g,"unknown event","eventFragment",e),e=g}if(n!=null&&!e.anonymous){const g=e.topicHash;P(Me(n[0],32)&&n[0].toLowerCase()===g,"fragment/topic mismatch","topics[0]",n[0]),n=n.slice(1)}const a=[],i=[],o=[];e.inputs.forEach((g,b)=>{g.indexed?g.type==="string"||g.type==="bytes"||g.baseType==="tuple"||g.baseType==="array"?(a.push(pt.from({type:"bytes32",name:g.name})),o.push(!0)):(a.push(g),o.push(!1)):(i.push(g),o.push(!1))});const l=n!=null?w(this,vt).decode(a,He(n)):null,c=w(this,vt).decode(i,r,!0),d=[],h=[];let u=0,f=0;return e.inputs.forEach((g,b)=>{let y=null;if(g.indexed)if(l==null)y=new Kx(null);else if(o[b])y=new Kx(l[f++]);else try{y=l[f++]}catch(k){y=k}else try{y=c[u++]}catch(k){y=k}d.push(y),h.push(g.name||null)}),Oo.fromItems(d,h)}parseTransaction(e){const r=xe(e.data,"tx.data"),n=de(e.value!=null?e.value:0,"tx.value"),a=this.getFunction(se(r.slice(0,4)));if(!a)return null;const i=w(this,vt).decode(a.inputs,r.slice(4));return new LE(a,a.selector,i,n)}parseCallResult(e){throw new Error("@TODO")}parseLog(e){const r=this.getEvent(e.topics[0]);return!r||r.anonymous?null:new ME(r,r.topicHash,this.decodeEventLog(r,e.data,e.topics))}parseError(e){const r=se(e),n=this.getError(Je(r,0,4));if(!n)return null;const a=w(this,vt).decode(n.inputs,Je(r,4));return new FE(n,n.selector,a)}static from(e){return e instanceof ma?e:typeof e=="string"?new ma(JSON.parse(e)):typeof e.formatJson=="function"?new ma(e.formatJson()):typeof e.format=="function"?new ma(e.format("json")):new ma(e)}};ln=new WeakMap,cn=new WeakMap,dn=new WeakMap,vt=new WeakMap,bn=new WeakSet,Rd=function(e,r,n){if(Me(e)){const i=e.toLowerCase();for(const o of w(this,dn).values())if(i===o.selector)return o;return null}if(e.indexOf("(")===-1){const i=[];for(const[o,l]of w(this,dn))o.split("(")[0]===e&&i.push(l);if(r){const o=r.length>0?r[r.length-1]:null;let l=r.length,c=!0;At.isTyped(o)&&o.type==="overrides"&&(c=!1,l--);for(let d=i.length-1;d>=0;d--){const h=i[d].inputs.length;h!==l&&(!c||h!==l-1)&&i.splice(d,1)}for(let d=i.length-1;d>=0;d--){const h=i[d].inputs;for(let u=0;u<r.length;u++)if(At.isTyped(r[u])){if(u>=h.length){if(r[u].type==="overrides")continue;i.splice(d,1);break}if(r[u].type!==h[u].baseType){i.splice(d,1);break}}}}if(i.length===1&&r&&r.length!==i[0].inputs.length){const o=r[r.length-1];(o==null||Array.isArray(o)||typeof o!="object")&&i.splice(0,1)}if(i.length===0)return null;if(i.length>1&&n){const o=i.map(l=>JSON.stringify(l.format())).join(", ");P(!1,`ambiguous function description (i.e. matches ${o})`,"key",e)}return i[0]}const a=w(this,dn).get(pn.from(e).format());return a||null},Od=function(e,r,n){if(Me(e)){const i=e.toLowerCase();for(const o of w(this,cn).values())if(i===o.topicHash)return o;return null}if(e.indexOf("(")===-1){const i=[];for(const[o,l]of w(this,cn))o.split("(")[0]===e&&i.push(l);if(r){for(let o=i.length-1;o>=0;o--)i[o].inputs.length<r.length&&i.splice(o,1);for(let o=i.length-1;o>=0;o--){const l=i[o].inputs;for(let c=0;c<r.length;c++)if(At.isTyped(r[c])&&r[c].type!==l[c].baseType){i.splice(o,1);break}}}if(i.length===0)return null;if(i.length>1&&n){const o=i.map(l=>JSON.stringify(l.format())).join(", ");P(!1,`ambiguous event description (i.e. matches ${o})`,"key",e)}return i[0]}const a=w(this,cn).get(gn.from(e).format());return a||null};let T0=ma;const k1=BigInt(0);function Mi(t){return t??null}function qe(t){return t==null?null:t.toString()}class qx{constructor(e,r,n){S(this,"gasPrice");S(this,"maxFeePerGas");S(this,"maxPriorityFeePerGas");me(this,{gasPrice:Mi(e),maxFeePerGas:Mi(r),maxPriorityFeePerGas:Mi(n)})}toJSON(){const{gasPrice:e,maxFeePerGas:r,maxPriorityFeePerGas:n}=this;return{_type:"FeeData",gasPrice:qe(e),maxFeePerGas:qe(r),maxPriorityFeePerGas:qe(n)}}}function ku(t){const e={};t.to&&(e.to=t.to),t.from&&(e.from=t.from),t.data&&(e.data=se(t.data));const r="chainId,gasLimit,gasPrice,maxFeePerBlobGas,maxFeePerGas,maxPriorityFeePerGas,value".split(/,/);for(const a of r)!(a in t)||t[a]==null||(e[a]=de(t[a],`request.${a}`));const n="type,nonce".split(/,/);for(const a of n)!(a in t)||t[a]==null||(e[a]=ye(t[a],`request.${a}`));return t.accessList&&(e.accessList=ni(t.accessList)),t.authorizationList&&(e.authorizationList=t.authorizationList.slice()),"blockTag"in t&&(e.blockTag=t.blockTag),"enableCcipRead"in t&&(e.enableCcipRead=!!t.enableCcipRead),"customData"in t&&(e.customData=t.customData),"blobVersionedHashes"in t&&t.blobVersionedHashes&&(e.blobVersionedHashes=t.blobVersionedHashes.slice()),"kzg"in t&&(e.kzg=t.kzg),"blobWrapperVersion"in t&&(e.blobWrapperVersion=t.blobWrapperVersion),"blobs"in t&&t.blobs&&(e.blobs=t.blobs.map(a=>tg(a)?se(a):Object.assign({},a))),e}var _n;class UE{constructor(e,r){S(this,"provider");S(this,"number");S(this,"hash");S(this,"timestamp");S(this,"parentHash");S(this,"parentBeaconBlockRoot");S(this,"nonce");S(this,"difficulty");S(this,"gasLimit");S(this,"gasUsed");S(this,"stateRoot");S(this,"receiptsRoot");S(this,"blobGasUsed");S(this,"excessBlobGas");S(this,"miner");S(this,"prevRandao");S(this,"extraData");S(this,"baseFeePerGas");U(this,_n);j(this,_n,e.transactions.map(n=>typeof n!="string"?new fc(n,r):n)),me(this,{provider:r,hash:Mi(e.hash),number:e.number,timestamp:e.timestamp,parentHash:e.parentHash,parentBeaconBlockRoot:e.parentBeaconBlockRoot,nonce:e.nonce,difficulty:e.difficulty,gasLimit:e.gasLimit,gasUsed:e.gasUsed,blobGasUsed:e.blobGasUsed,excessBlobGas:e.excessBlobGas,miner:e.miner,prevRandao:Mi(e.prevRandao),extraData:e.extraData,baseFeePerGas:Mi(e.baseFeePerGas),stateRoot:e.stateRoot,receiptsRoot:e.receiptsRoot})}get transactions(){return w(this,_n).map(e=>typeof e=="string"?e:e.hash)}get prefetchedTransactions(){const e=w(this,_n).slice();return e.length===0?[]:(J(typeof e[0]=="object","transactions were not prefetched with block request","UNSUPPORTED_OPERATION",{operation:"transactionResponses()"}),e)}toJSON(){const{baseFeePerGas:e,difficulty:r,extraData:n,gasLimit:a,gasUsed:i,hash:o,miner:l,prevRandao:c,nonce:d,number:h,parentHash:u,parentBeaconBlockRoot:f,stateRoot:g,receiptsRoot:b,timestamp:y,transactions:k}=this;return{_type:"Block",baseFeePerGas:qe(e),difficulty:qe(r),extraData:n,gasLimit:qe(a),gasUsed:qe(i),blobGasUsed:qe(this.blobGasUsed),excessBlobGas:qe(this.excessBlobGas),hash:o,miner:l,prevRandao:c,nonce:d,number:h,parentHash:u,timestamp:y,parentBeaconBlockRoot:f,stateRoot:g,receiptsRoot:b,transactions:k}}[Symbol.iterator](){let e=0;const r=this.transactions;return{next:()=>e<this.length?{value:r[e++],done:!1}:{value:void 0,done:!0}}}get length(){return w(this,_n).length}get date(){return this.timestamp==null?null:new Date(this.timestamp*1e3)}async getTransaction(e){let r;if(typeof e=="number")r=w(this,_n)[e];else{const n=e.toLowerCase();for(const a of w(this,_n))if(typeof a=="string"){if(a!==n)continue;r=a;break}else{if(a.hash!==n)continue;r=a;break}}if(r==null)throw new Error("no such tx");return typeof r=="string"?await this.provider.getTransaction(r):r}getPrefetchedTransaction(e){const r=this.prefetchedTransactions;if(typeof e=="number")return r[e];e=e.toLowerCase();for(const n of r)if(n.hash===e)return n;P(!1,"no matching transaction","indexOrHash",e)}isMined(){return!!this.hash}isLondon(){return!!this.baseFeePerGas}orphanedEvent(){if(!this.isMined())throw new Error("");return zE(this)}}_n=new WeakMap;class Fc{constructor(e,r){S(this,"provider");S(this,"transactionHash");S(this,"blockHash");S(this,"blockNumber");S(this,"removed");S(this,"address");S(this,"data");S(this,"topics");S(this,"index");S(this,"transactionIndex");this.provider=r;const n=Object.freeze(e.topics.slice());me(this,{transactionHash:e.transactionHash,blockHash:e.blockHash,blockNumber:e.blockNumber,removed:e.removed,address:e.address,data:e.data,topics:n,index:e.index,transactionIndex:e.transactionIndex})}toJSON(){const{address:e,blockHash:r,blockNumber:n,data:a,index:i,removed:o,topics:l,transactionHash:c,transactionIndex:d}=this;return{_type:"log",address:e,blockHash:r,blockNumber:n,data:a,index:i,removed:o,topics:l,transactionHash:c,transactionIndex:d}}async getBlock(){const e=await this.provider.getBlock(this.blockHash);return J(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransaction(){const e=await this.provider.getTransaction(this.transactionHash);return J(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransactionReceipt(){const e=await this.provider.getTransactionReceipt(this.transactionHash);return J(!!e,"failed to find transaction receipt","UNKNOWN_ERROR",{}),e}removedEvent(){return HE(this)}}var Nc;class j1{constructor(e,r){S(this,"provider");S(this,"to");S(this,"from");S(this,"contractAddress");S(this,"hash");S(this,"index");S(this,"blockHash");S(this,"blockNumber");S(this,"logsBloom");S(this,"gasUsed");S(this,"blobGasUsed");S(this,"cumulativeGasUsed");S(this,"gasPrice");S(this,"blobGasPrice");S(this,"type");S(this,"status");S(this,"root");U(this,Nc);j(this,Nc,Object.freeze(e.logs.map(a=>new Fc(a,r))));let n=k1;e.effectiveGasPrice!=null?n=e.effectiveGasPrice:e.gasPrice!=null&&(n=e.gasPrice),me(this,{provider:r,to:e.to,from:e.from,contractAddress:e.contractAddress,hash:e.hash,index:e.index,blockHash:e.blockHash,blockNumber:e.blockNumber,logsBloom:e.logsBloom,gasUsed:e.gasUsed,cumulativeGasUsed:e.cumulativeGasUsed,blobGasUsed:e.blobGasUsed,gasPrice:n,blobGasPrice:e.blobGasPrice,type:e.type,status:e.status,root:e.root})}get logs(){return w(this,Nc)}toJSON(){const{to:e,from:r,contractAddress:n,hash:a,index:i,blockHash:o,blockNumber:l,logsBloom:c,logs:d,status:h,root:u}=this;return{_type:"TransactionReceipt",blockHash:o,blockNumber:l,contractAddress:n,cumulativeGasUsed:qe(this.cumulativeGasUsed),from:r,gasPrice:qe(this.gasPrice),blobGasUsed:qe(this.blobGasUsed),blobGasPrice:qe(this.blobGasPrice),gasUsed:qe(this.gasUsed),hash:a,index:i,logs:d,logsBloom:c,root:u,status:h,to:e}}get length(){return this.logs.length}[Symbol.iterator](){let e=0;return{next:()=>e<this.length?{value:this.logs[e++],done:!1}:{value:void 0,done:!0}}}get fee(){return this.gasUsed*this.gasPrice}async getBlock(){const e=await this.provider.getBlock(this.blockHash);if(e==null)throw new Error("TODO");return e}async getTransaction(){const e=await this.provider.getTransaction(this.hash);if(e==null)throw new Error("TODO");return e}async getResult(){return await this.provider.getTransactionResult(this.hash)}async confirmations(){return await this.provider.getBlockNumber()-this.blockNumber+1}removedEvent(){return E1(this)}reorderedEvent(e){return J(!e||e.isMined(),"unmined 'other' transction cannot be orphaned","UNSUPPORTED_OPERATION",{operation:"reorderedEvent(other)"}),A1(this,e)}}Nc=new WeakMap;var Es;const Pg=class Pg{constructor(e,r){S(this,"provider");S(this,"blockNumber");S(this,"blockHash");S(this,"index");S(this,"hash");S(this,"type");S(this,"to");S(this,"from");S(this,"nonce");S(this,"gasLimit");S(this,"gasPrice");S(this,"maxPriorityFeePerGas");S(this,"maxFeePerGas");S(this,"maxFeePerBlobGas");S(this,"data");S(this,"value");S(this,"chainId");S(this,"signature");S(this,"accessList");S(this,"blobVersionedHashes");S(this,"authorizationList");U(this,Es);this.provider=r,this.blockNumber=e.blockNumber!=null?e.blockNumber:null,this.blockHash=e.blockHash!=null?e.blockHash:null,this.hash=e.hash,this.index=e.index,this.type=e.type,this.from=e.from,this.to=e.to||null,this.gasLimit=e.gasLimit,this.nonce=e.nonce,this.data=e.data,this.value=e.value,this.gasPrice=e.gasPrice,this.maxPriorityFeePerGas=e.maxPriorityFeePerGas!=null?e.maxPriorityFeePerGas:null,this.maxFeePerGas=e.maxFeePerGas!=null?e.maxFeePerGas:null,this.maxFeePerBlobGas=e.maxFeePerBlobGas!=null?e.maxFeePerBlobGas:null,this.chainId=e.chainId,this.signature=e.signature,this.accessList=e.accessList!=null?e.accessList:null,this.blobVersionedHashes=e.blobVersionedHashes!=null?e.blobVersionedHashes:null,this.authorizationList=e.authorizationList!=null?e.authorizationList:null,j(this,Es,-1)}toJSON(){const{blockNumber:e,blockHash:r,index:n,hash:a,type:i,to:o,from:l,nonce:c,data:d,signature:h,accessList:u,blobVersionedHashes:f}=this;return{_type:"TransactionResponse",accessList:u,blockNumber:e,blockHash:r,blobVersionedHashes:f,chainId:qe(this.chainId),data:d,from:l,gasLimit:qe(this.gasLimit),gasPrice:qe(this.gasPrice),hash:a,maxFeePerGas:qe(this.maxFeePerGas),maxPriorityFeePerGas:qe(this.maxPriorityFeePerGas),maxFeePerBlobGas:qe(this.maxFeePerBlobGas),nonce:c,signature:h,to:o,index:n,type:i,value:qe(this.value)}}async getBlock(){let e=this.blockNumber;if(e==null){const n=await this.getTransaction();n&&(e=n.blockNumber)}if(e==null)return null;const r=this.provider.getBlock(e);if(r==null)throw new Error("TODO");return r}async getTransaction(){return this.provider.getTransaction(this.hash)}async confirmations(){if(this.blockNumber==null){const{tx:r,blockNumber:n}=await Dt({tx:this.getTransaction(),blockNumber:this.provider.getBlockNumber()});return r==null||r.blockNumber==null?0:n-r.blockNumber+1}return await this.provider.getBlockNumber()-this.blockNumber+1}async wait(e,r){const n=e??1,a=r??0;let i=w(this,Es),o=-1,l=i===-1;const c=async()=>{if(l)return null;const{blockNumber:f,nonce:g}=await Dt({blockNumber:this.provider.getBlockNumber(),nonce:this.provider.getTransactionCount(this.from)});if(g<this.nonce){i=f;return}if(l)return null;const b=await this.getTransaction();if(!(b&&b.blockNumber!=null))for(o===-1&&(o=i-3,o<w(this,Es)&&(o=w(this,Es)));o<=f;){if(l)return null;const y=await this.provider.getBlock(o,!0);if(y==null)return;for(const k of y)if(k===this.hash)return;for(let k=0;k<y.length;k++){const m=await y.getTransaction(k);if(m.from===this.from&&m.nonce===this.nonce){if(l)return null;const x=await this.provider.getTransactionReceipt(m.hash);if(x==null||f-x.blockNumber+1<n)return;let p="replaced";m.data===this.data&&m.to===this.to&&m.value===this.value?p="repriced":m.data==="0x"&&m.from===m.to&&m.value===k1&&(p="cancelled"),J(!1,"transaction was replaced","TRANSACTION_REPLACED",{cancelled:p==="replaced"||p==="cancelled",reason:p,replacement:m.replaceableTransaction(i),hash:m.hash,receipt:x})}}o++}},d=f=>{if(f==null||f.status!==0)return f;J(!1,"transaction execution reverted","CALL_EXCEPTION",{action:"sendTransaction",data:null,reason:null,invocation:null,revert:null,transaction:{to:f.to,from:f.from,data:""},receipt:f})},h=await this.provider.getTransactionReceipt(this.hash);if(n===0)return d(h);if(h){if(n===1||await h.confirmations()>=n)return d(h)}else if(await c(),n===0)return null;return await new Promise((f,g)=>{const b=[],y=()=>{b.forEach(m=>m())};if(b.push(()=>{l=!0}),a>0){const m=setTimeout(()=>{y(),g(Ve("wait for transaction timeout","TIMEOUT"))},a);b.push(()=>{clearTimeout(m)})}const k=async m=>{if(await m.confirmations()>=n){y();try{f(d(m))}catch(x){g(x)}}};if(b.push(()=>{this.provider.off(this.hash,k)}),this.provider.on(this.hash,k),i>=0){const m=async()=>{try{await c()}catch(x){if(mt(x,"TRANSACTION_REPLACED")){y(),g(x);return}}l||this.provider.once("block",m)};b.push(()=>{this.provider.off("block",m)}),this.provider.once("block",m)}})}isMined(){return this.blockHash!=null}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}removedEvent(){return J(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),E1(this)}reorderedEvent(e){return J(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),J(!e||e.isMined(),"unmined 'other' transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),A1(this,e)}replaceableTransaction(e){P(Number.isInteger(e)&&e>=0,"invalid startBlock","startBlock",e);const r=new Pg(this,this.provider);return j(r,Es,e),r}};Es=new WeakMap;let fc=Pg;function zE(t){return{orphan:"drop-block",hash:t.hash,number:t.number}}function A1(t,e){return{orphan:"reorder-transaction",tx:t,other:e}}function E1(t){return{orphan:"drop-transaction",tx:t}}function HE(t){return{orphan:"drop-log",log:{transactionHash:t.transactionHash,blockHash:t.blockHash,blockNumber:t.blockNumber,address:t.address,data:t.data,topics:Object.freeze(t.topics.slice()),index:t.index}}}class gg extends Fc{constructor(r,n,a){super(r,r.provider);S(this,"interface");S(this,"fragment");S(this,"args");const i=n.decodeEventLog(a,r.data,r.topics);me(this,{args:i,fragment:a,interface:n})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}class S1 extends Fc{constructor(r,n){super(r,r.provider);S(this,"error");me(this,{error:n})}}var uo;class VE extends j1{constructor(r,n,a){super(a,n);U(this,uo);j(this,uo,r)}get logs(){return super.logs.map(r=>{const n=r.topics.length?w(this,uo).getEvent(r.topics[0]):null;if(n)try{return new gg(r,w(this,uo),n)}catch(a){return new S1(r,a)}return r})}}uo=new WeakMap;var kc;class pg extends fc{constructor(r,n,a){super(a,n);U(this,kc);j(this,kc,r)}async wait(r,n){const a=await super.wait(r,n);return a==null?null:new VE(w(this,kc),this.provider,a)}}kc=new WeakMap;class C1 extends Yb{constructor(r,n,a,i){super(r,n,a);S(this,"log");me(this,{log:i})}async getBlock(){return await this.log.getBlock()}async getTransaction(){return await this.log.getTransaction()}async getTransactionReceipt(){return await this.log.getTransactionReceipt()}}class GE extends C1{constructor(e,r,n,a,i){super(e,r,n,new gg(i,e.interface,a));const o=e.interface.decodeEventLog(a,this.log.data,this.log.topics);me(this,{args:o,fragment:a})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}const Zx=BigInt(0);function D1(t){return t&&typeof t.call=="function"}function P1(t){return t&&typeof t.estimateGas=="function"}function ch(t){return t&&typeof t.resolveName=="function"}function I1(t){return t&&typeof t.sendTransaction=="function"}function T1(t){if(t!=null){if(ch(t))return t;if(t.provider)return t.provider}}var jc;class $E{constructor(e,r,n){U(this,jc);S(this,"fragment");if(me(this,{fragment:r}),r.inputs.length<n.length)throw new Error("too many arguments");const a=Xa(e.runner,"resolveName"),i=ch(a)?a:null;j(this,jc,async function(){const o=await Promise.all(r.inputs.map((l,c)=>n[c]==null?null:l.walkAsync(n[c],(h,u)=>h==="address"?Array.isArray(u)?Promise.all(u.map(f=>Bt(f,i))):Bt(u,i):u)));return e.interface.encodeFilterTopics(r,o)}())}getTopicFilter(){return w(this,jc)}}jc=new WeakMap;function Xa(t,e){return t==null?null:typeof t[e]=="function"?t:t.provider&&typeof t.provider[e]=="function"?t.provider:null}function ba(t){return t==null?null:t.provider||null}async function _1(t,e){const r=At.dereference(t,"overrides");P(typeof r=="object","invalid overrides parameter","overrides",t);const n=ku(r);return P(n.to==null||(e||[]).indexOf("to")>=0,"cannot override to","overrides.to",n.to),P(n.data==null||(e||[]).indexOf("data")>=0,"cannot override data","overrides.data",n.data),n.from&&(n.from=n.from),n}async function QE(t,e,r){const n=Xa(t,"resolveName"),a=ch(n)?n:null;return await Promise.all(e.map((i,o)=>i.walkAsync(r[o],(l,c)=>(c=At.dereference(c,l),l==="address"?Bt(c,a):c))))}function WE(t){const e=async function(o){const l=await _1(o,["data"]);l.to=await t.getAddress(),l.from&&(l.from=await Bt(l.from,T1(t.runner)));const c=t.interface,d=de(l.value||Zx,"overrides.value")===Zx,h=(l.data||"0x")==="0x";c.fallback&&!c.fallback.payable&&c.receive&&!h&&!d&&P(!1,"cannot send data to receive or send value to non-payable fallback","overrides",o),P(c.fallback||h,"cannot send data to receive-only contract","overrides.data",l.data);const u=c.receive||c.fallback&&c.fallback.payable;return P(u||d,"cannot send value to non-payable fallback","overrides.value",l.value),P(c.fallback||h,"cannot send data to receive-only contract","overrides.data",l.data),l},r=async function(o){const l=Xa(t.runner,"call");J(D1(l),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const c=await e(o);try{return await l.call(c)}catch(d){throw eg(d)&&d.data?t.interface.makeError(d.data,c):d}},n=async function(o){const l=t.runner;J(I1(l),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const c=await l.sendTransaction(await e(o)),d=ba(t.runner);return new pg(t.interface,d,c)},a=async function(o){const l=Xa(t.runner,"estimateGas");return J(P1(l),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await l.estimateGas(await e(o))},i=async o=>await n(o);return me(i,{_contract:t,estimateGas:a,populateTransaction:e,send:n,staticCall:r}),i}function KE(t,e){const r=function(...d){const h=t.interface.getFunction(e,d);return J(h,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:d}}),h},n=async function(...d){const h=r(...d);let u={};if(h.inputs.length+1===d.length&&(u=await _1(d.pop()),u.from&&(u.from=await Bt(u.from,T1(t.runner)))),h.inputs.length!==d.length)throw new Error("internal error: fragment inputs doesn't match arguments; should not happen");const f=await QE(t.runner,h.inputs,d);return Object.assign({},u,await Dt({to:t.getAddress(),data:t.interface.encodeFunctionData(h,f)}))},a=async function(...d){const h=await l(...d);return h.length===1?h[0]:h},i=async function(...d){const h=t.runner;J(I1(h),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const u=await h.sendTransaction(await n(...d)),f=ba(t.runner);return new pg(t.interface,f,u)},o=async function(...d){const h=Xa(t.runner,"estimateGas");return J(P1(h),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await h.estimateGas(await n(...d))},l=async function(...d){const h=Xa(t.runner,"call");J(D1(h),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const u=await n(...d);let f="0x";try{f=await h.call(u)}catch(b){throw eg(b)&&b.data?t.interface.makeError(b.data,u):b}const g=r(...d);return t.interface.decodeFunctionResult(g,f)},c=async(...d)=>r(...d).constant?await a(...d):await i(...d);return me(c,{name:t.interface.getFunctionName(e),_contract:t,_key:e,getFragment:r,estimateGas:o,populateTransaction:n,send:i,staticCall:a,staticCallResult:l}),Object.defineProperty(c,"fragment",{configurable:!1,enumerable:!0,get:()=>{const d=t.interface.getFunction(e);return J(d,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),d}}),c}function JE(t,e){const r=function(...a){const i=t.interface.getEvent(e,a);return J(i,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:a}}),i},n=function(...a){return new $E(t,r(...a),a)};return me(n,{name:t.interface.getEventName(e),_contract:t,_key:e,getFragment:r}),Object.defineProperty(n,"fragment",{configurable:!1,enumerable:!0,get:()=>{const a=t.interface.getEvent(e);return J(a,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),a}}),n}const ju=Symbol.for("_ethersInternal_contract"),B1=new WeakMap;function YE(t,e){B1.set(t[ju],e)}function tr(t){return B1.get(t[ju])}function qE(t){return t&&typeof t=="object"&&"getTopicFilter"in t&&typeof t.getTopicFilter=="function"&&t.fragment}async function xg(t,e){let r,n=null;if(Array.isArray(e)){const i=function(o){if(Me(o,32))return o;const l=t.interface.getEvent(o);return P(l,"unknown fragment","name",o),l.topicHash};r=e.map(o=>o==null?null:Array.isArray(o)?o.map(i):i(o))}else e==="*"?r=[null]:typeof e=="string"?Me(e,32)?r=[e]:(n=t.interface.getEvent(e),P(n,"unknown fragment","event",e),r=[n.topicHash]):qE(e)?r=await e.getTopicFilter():"fragment"in e?(n=e.fragment,r=[n.topicHash]):P(!1,"unknown event name","event",e);r=r.map(i=>{if(i==null)return null;if(Array.isArray(i)){const o=Array.from(new Set(i.map(l=>l.toLowerCase())).values());return o.length===1?o[0]:(o.sort(),o)}return i.toLowerCase()});const a=r.map(i=>i==null?"null":Array.isArray(i)?i.join("|"):i).join("&");return{fragment:n,tag:a,topics:r}}async function yl(t,e){const{subs:r}=tr(t);return r.get((await xg(t,e)).tag)||null}async function Xx(t,e,r){const n=ba(t.runner);J(n,"contract runner does not support subscribing","UNSUPPORTED_OPERATION",{operation:e});const{fragment:a,tag:i,topics:o}=await xg(t,r),{addr:l,subs:c}=tr(t);let d=c.get(i);if(!d){const u={address:l||t,topics:o},f=k=>{let m=a;if(m==null)try{m=t.interface.getEvent(k.topics[0])}catch{}if(m){const x=m,p=a?t.interface.decodeEventLog(a,k.data,k.topics):[];B0(t,r,p,v=>new GE(t,v,r,x,k))}else B0(t,r,[],x=>new C1(t,x,r,k))};let g=[];d={tag:i,listeners:[],start:()=>{g.length||g.push(n.on(u,f))},stop:async()=>{if(g.length==0)return;let k=g;g=[],await Promise.all(k),n.off(u,f)}},c.set(i,d)}return d}let _0=Promise.resolve();async function ZE(t,e,r,n){await _0;const a=await yl(t,e);if(!a)return!1;const i=a.listeners.length;return a.listeners=a.listeners.filter(({listener:o,once:l})=>{const c=Array.from(r);n&&c.push(n(l?null:o));try{o.call(t,...c)}catch{}return!l}),a.listeners.length===0&&(a.stop(),tr(t).subs.delete(a.tag)),i>0}async function B0(t,e,r,n){try{await _0}catch{}const a=ZE(t,e,r,n);return _0=a,await a}const md=["then"];var wy;wy=ju;const Ml=class Ml{constructor(e,r,n,a){S(this,"target");S(this,"interface");S(this,"runner");S(this,"filters");S(this,wy);S(this,"fallback");P(typeof e=="string"||Fv(e),"invalid value for Contract target","target",e),n==null&&(n=null);const i=T0.from(r);me(this,{target:e,runner:n,interface:i}),Object.defineProperty(this,ju,{value:{}});let o,l=null,c=null;if(a){const u=ba(n);c=new pg(this.interface,u,a)}let d=new Map;if(typeof e=="string")if(Me(e))l=e,o=Promise.resolve(e);else{const u=Xa(n,"resolveName");if(!ch(u))throw Ve("contract runner does not support name resolution","UNSUPPORTED_OPERATION",{operation:"resolveName"});o=u.resolveName(e).then(f=>{if(f==null)throw Ve("an ENS name used for a contract target must be correctly configured","UNCONFIGURED_NAME",{value:e});return tr(this).addr=f,f})}else o=e.getAddress().then(u=>{if(u==null)throw new Error("TODO");return tr(this).addr=u,u});YE(this,{addrPromise:o,addr:l,deployTx:c,subs:d});const h=new Proxy({},{get:(u,f,g)=>{if(typeof f=="symbol"||md.indexOf(f)>=0)return Reflect.get(u,f,g);try{return this.getEvent(f)}catch(b){if(!mt(b,"INVALID_ARGUMENT")||b.argument!=="key")throw b}},has:(u,f)=>md.indexOf(f)>=0?Reflect.has(u,f):Reflect.has(u,f)||this.interface.hasEvent(String(f))});return me(this,{filters:h}),me(this,{fallback:i.receive||i.fallback?WE(this):null}),new Proxy(this,{get:(u,f,g)=>{if(typeof f=="symbol"||f in u||md.indexOf(f)>=0)return Reflect.get(u,f,g);try{return u.getFunction(f)}catch(b){if(!mt(b,"INVALID_ARGUMENT")||b.argument!=="key")throw b}},has:(u,f)=>typeof f=="symbol"||f in u||md.indexOf(f)>=0?Reflect.has(u,f):u.interface.hasFunction(f)})}connect(e){return new Ml(this.target,this.interface,e)}attach(e){return new Ml(e,this.interface,this.runner)}async getAddress(){return await tr(this).addrPromise}async getDeployedCode(){const e=ba(this.runner);J(e,"runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"getDeployedCode"});const r=await e.getCode(await this.getAddress());return r==="0x"?null:r}async waitForDeployment(){const e=this.deploymentTransaction();if(e)return await e.wait(),this;if(await this.getDeployedCode()!=null)return this;const n=ba(this.runner);return J(n!=null,"contract runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"waitForDeployment"}),new Promise((a,i)=>{const o=async()=>{try{if(await this.getDeployedCode()!=null)return a(this);n.once("block",o)}catch(l){i(l)}};o()})}deploymentTransaction(){return tr(this).deployTx}getFunction(e){return typeof e!="string"&&(e=e.format()),KE(this,e)}getEvent(e){return typeof e!="string"&&(e=e.format()),JE(this,e)}async queryTransaction(e){throw new Error("@TODO")}async queryFilter(e,r,n){r==null&&(r=0),n==null&&(n="latest");const{addr:a,addrPromise:i}=tr(this),o=a||await i,{fragment:l,topics:c}=await xg(this,e),d={address:o,topics:c,fromBlock:r,toBlock:n},h=ba(this.runner);return J(h,"contract runner does not have a provider","UNSUPPORTED_OPERATION",{operation:"queryFilter"}),(await h.getLogs(d)).map(u=>{let f=l;if(f==null)try{f=this.interface.getEvent(u.topics[0])}catch{}if(f)try{return new gg(u,this.interface,f)}catch(g){return new S1(u,g)}return new Fc(u,h)})}async on(e,r){const n=await Xx(this,"on",e);return n.listeners.push({listener:r,once:!1}),n.start(),this}async once(e,r){const n=await Xx(this,"once",e);return n.listeners.push({listener:r,once:!0}),n.start(),this}async emit(e,...r){return await B0(this,e,r,null)}async listenerCount(e){if(e){const a=await yl(this,e);return a?a.listeners.length:0}const{subs:r}=tr(this);let n=0;for(const{listeners:a}of r.values())n+=a.length;return n}async listeners(e){if(e){const a=await yl(this,e);return a?a.listeners.map(({listener:i})=>i):[]}const{subs:r}=tr(this);let n=[];for(const{listeners:a}of r.values())n=n.concat(a.map(({listener:i})=>i));return n}async off(e,r){const n=await yl(this,e);if(!n)return this;if(r){const a=n.listeners.map(({listener:i})=>i).indexOf(r);a>=0&&n.listeners.splice(a,1)}return(r==null||n.listeners.length===0)&&(n.stop(),tr(this).subs.delete(n.tag)),this}async removeAllListeners(e){if(e){const r=await yl(this,e);if(!r)return this;r.stop(),tr(this).subs.delete(r.tag)}else{const{subs:r}=tr(this);for(const{tag:n,stop:a}of r.values())a(),r.delete(n)}return this}async addListener(e,r){return await this.on(e,r)}async removeListener(e,r){return await this.off(e,r)}static buildClass(e){class r extends Ml{constructor(a,i=null){super(a,e,i)}}return r}static from(e,r,n){return n==null&&(n=null),new this(e,r,n)}};let R0=Ml;function XE(){return R0}class Rl extends XE(){}function af(t){return t.match(/^ipfs:\/\/ipfs\//i)?t=t.substring(12):t.match(/^ipfs:\/\//i)?t=t.substring(7):P(!1,"unsupported IPFS format","link",t),`https://gateway.ipfs.io/ipfs/${t}`}class eS{constructor(e){S(this,"name");me(this,{name:e})}connect(e){return this}supportsCoinType(e){return!1}async encodeAddress(e,r){throw new Error("unsupported coin")}async decodeAddress(e,r){throw new Error("unsupported coin")}}const R1=new RegExp("^(ipfs)://(.*)$","i"),ey=[new RegExp("^(https)://(.*)$","i"),new RegExp("^(data):(.*)$","i"),R1,new RegExp("^eip155:[0-9]+/(erc[0-9]+):(.*)$","i")];var Ss,Ta,Cs,di,Tu,O1;const Ei=class Ei{constructor(e,r,n){U(this,Cs);S(this,"provider");S(this,"address");S(this,"name");U(this,Ss);U(this,Ta);me(this,{provider:e,address:r,name:n}),j(this,Ss,null),j(this,Ta,new Rl(r,["function supportsInterface(bytes4) view returns (bool)","function resolve(bytes, bytes) view returns (bytes)","function addr(bytes32) view returns (address)","function addr(bytes32, uint) view returns (bytes)","function text(bytes32, string) view returns (string)","function contenthash(bytes32) view returns (bytes)"],e))}async supportsWildcard(){return w(this,Ss)==null&&j(this,Ss,(async()=>{try{return await w(this,Ta).supportsInterface("0x9061b923")}catch(e){if(mt(e,"CALL_EXCEPTION"))return!1;throw j(this,Ss,null),e}})()),await w(this,Ss)}async getAddress(e){if(e==null&&(e=60),e===60)try{const i=await ne(this,Cs,di).call(this,"addr(bytes32)");return i==null||i===ac?null:i}catch(i){if(mt(i,"CALL_EXCEPTION"))return null;throw i}if(e>=0&&e<2147483648){let i=e+2147483648;const o=await ne(this,Cs,di).call(this,"addr(bytes32,uint)",[i]);if(Me(o,20))return Ie(o)}let r=null;for(const i of this.provider.plugins)if(i instanceof eS&&i.supportsCoinType(e)){r=i;break}if(r==null)return null;const n=await ne(this,Cs,di).call(this,"addr(bytes32,uint)",[e]);if(n==null||n==="0x")return null;const a=await r.decodeAddress(e,n);if(a!=null)return a;J(!1,"invalid coin data","UNSUPPORTED_OPERATION",{operation:`getAddress(${e})`,info:{coinType:e,data:n}})}async getText(e){const r=await ne(this,Cs,di).call(this,"text(bytes32,string)",[e]);return r==null||r==="0x"?null:r}async getContentHash(){const e=await ne(this,Cs,di).call(this,"contenthash(bytes32)");if(e==null||e==="0x")return null;const r=e.match(/^0x(e3010170|e5010172)(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/);if(r){const a=r[1]==="e3010170"?"ipfs":"ipns",i=parseInt(r[4],16);if(r[5].length===i*2)return`${a}://${Qj("0x"+r[2])}`}const n=e.match(/^0xe40101fa011b20([0-9a-f]*)$/);if(n&&n[1].length===64)return`bzz://${n[1]}`;J(!1,"invalid or unsupported content hash data","UNSUPPORTED_OPERATION",{operation:"getContentHash()",info:{data:e}})}async getAvatar(){return(await this._getAvatar()).url}async _getAvatar(){const e=[{type:"name",value:this.name}];try{const r=await this.getText("avatar");if(r==null)return e.push({type:"!avatar",value:""}),{url:null,linkage:e};e.push({type:"avatar",value:r});for(let n=0;n<ey.length;n++){const a=r.match(ey[n]);if(a==null)continue;const i=a[1].toLowerCase();switch(i){case"https":case"data":return e.push({type:"url",value:r}),{linkage:e,url:r};case"ipfs":{const o=af(r);return e.push({type:"ipfs",value:r}),e.push({type:"url",value:o}),{linkage:e,url:o}}case"erc721":case"erc1155":{const o=i==="erc721"?"tokenURI(uint256)":"uri(uint256)";e.push({type:i,value:r});const l=await this.getAddress();if(l==null)return e.push({type:"!owner",value:""}),{url:null,linkage:e};const c=(a[2]||"").split("/");if(c.length!==2)return e.push({type:`!${i}caip`,value:a[2]||""}),{url:null,linkage:e};const d=c[1],h=new Rl(c[0],["function tokenURI(uint) view returns (string)","function ownerOf(uint) view returns (address)","function uri(uint) view returns (string)","function balanceOf(address, uint256) view returns (uint)"],this.provider);if(i==="erc721"){const y=await h.ownerOf(d);if(l!==y)return e.push({type:"!owner",value:y}),{url:null,linkage:e};e.push({type:"owner",value:y})}else if(i==="erc1155"){const y=await h.balanceOf(l,d);if(!y)return e.push({type:"!balance",value:"0"}),{url:null,linkage:e};e.push({type:"balance",value:y.toString()})}let u=await h[o](d);if(u==null||u==="0x")return e.push({type:"!metadata-url",value:""}),{url:null,linkage:e};e.push({type:"metadata-url-base",value:u}),i==="erc1155"&&(u=u.replace("{id}",Zs(d,32).substring(2)),e.push({type:"metadata-url-expanded",value:u})),u.match(/^ipfs:/i)&&(u=af(u)),e.push({type:"metadata-url",value:u});let f={};const g=await new es(u).send();g.assertOk();try{f=g.bodyJson}catch{try{e.push({type:"!metadata",value:g.bodyText})}catch{const m=g.body;return m&&e.push({type:"!metadata",value:se(m)}),{url:null,linkage:e}}return{url:null,linkage:e}}if(!f)return e.push({type:"!metadata",value:""}),{url:null,linkage:e};e.push({type:"metadata",value:JSON.stringify(f)});let b=f.image;if(typeof b!="string")return e.push({type:"!imageUrl",value:""}),{url:null,linkage:e};if(!b.match(/^(https:\/\/|data:)/i)){if(b.match(R1)==null)return e.push({type:"!imageUrl-ipfs",value:b}),{url:null,linkage:e};e.push({type:"imageUrl-ipfs",value:b}),b=af(b)}return e.push({type:"url",value:b}),{linkage:e,url:b}}}}}catch{}return{linkage:e,url:null}}static async getEnsAddress(e){const r=await e.getNetwork(),n=r.getPlugin("org.ethers.plugins.network.Ens");return J(n,"network does not support ENS","UNSUPPORTED_OPERATION",{operation:"getEnsAddress",info:{network:r}}),n.address}static async fromName(e,r){var a;let n=r;for(;;){if(n===""||n==="."||r!=="eth"&&n==="eth")return null;const i=await ne(a=Ei,Tu,O1).call(a,e,n);if(i!=null){const o=new Ei(e,i,r);return n!==r&&!await o.supportsWildcard()?null:o}n=n.split(".").slice(1).join(".")}}};Ss=new WeakMap,Ta=new WeakMap,Cs=new WeakSet,di=async function(e,r){r=(r||[]).slice();const n=w(this,Ta).interface;r.unshift(P0(this.name));let a=null;await this.supportsWildcard()&&(a=n.getFunction(e),J(a,"missing fragment","UNKNOWN_ERROR",{info:{funcName:e}}),r=[gE(this.name,255),n.encodeFunctionData(a,r)],e="resolve(bytes,bytes)"),r.push({enableCcipRead:!0});try{const i=await w(this,Ta)[e](...r);return a?n.decodeFunctionResult(a,i)[0]:i}catch(i){if(!mt(i,"CALL_EXCEPTION"))throw i}return null},Tu=new WeakSet,O1=async function(e,r){const n=await Ei.getEnsAddress(e);try{const i=await new Rl(n,["function resolver(bytes32) view returns (address)"],e).resolver(P0(r),{enableCcipRead:!0});return i===ac?null:i}catch(a){throw a}return null},U(Ei,Tu);let Au=Ei;const ty=BigInt(0);function Ne(t,e){return function(r){return r==null?e:t(r)}}function mc(t,e){return r=>{if(e&&r==null)return null;if(!Array.isArray(r))throw new Error("not an array");return r.map(n=>t(n))}}function Uc(t,e){return r=>{const n={};for(const a in t){let i=a;if(e&&a in e&&!(i in r)){for(const o of e[a])if(o in r){i=o;break}}try{const o=t[a](r[i]);o!==void 0&&(n[a]=o)}catch(o){const l=o instanceof Error?o.message:"not-an-error";J(!1,`invalid value for value.${a} (${l})`,"BAD_DATA",{value:r})}}return n}}function tS(t){switch(t){case!0:case"true":return!0;case!1:case"false":return!1}P(!1,`invalid boolean; ${JSON.stringify(t)}`,"value",t)}function Ho(t){return P(Me(t,!0),"invalid data","value",t),t}function ft(t){return P(Me(t,32),"invalid hash","value",t),t}const rS=Uc({address:Ie,blockHash:ft,blockNumber:ye,data:Ho,index:ye,removed:Ne(tS,!1),topics:mc(ft),transactionHash:ft,transactionIndex:ye},{index:["logIndex"]});function nS(t){return rS(t)}const sS=Uc({hash:Ne(ft),parentHash:ft,parentBeaconBlockRoot:Ne(ft,null),number:ye,timestamp:ye,nonce:Ne(Ho),difficulty:de,gasLimit:de,gasUsed:de,stateRoot:Ne(ft,null),receiptsRoot:Ne(ft,null),blobGasUsed:Ne(de,null),excessBlobGas:Ne(de,null),miner:Ne(Ie),prevRandao:Ne(ft,null),extraData:Ho,baseFeePerGas:Ne(de)},{prevRandao:["mixHash"]});function aS(t){const e=sS(t);return e.transactions=t.transactions.map(r=>typeof r=="string"?r:M1(r)),e}const iS=Uc({transactionIndex:ye,blockNumber:ye,transactionHash:ft,address:Ie,topics:mc(ft),data:Ho,index:ye,blockHash:ft},{index:["logIndex"]});function oS(t){return iS(t)}const lS=Uc({to:Ne(Ie,null),from:Ne(Ie,null),contractAddress:Ne(Ie,null),index:ye,root:Ne(se),gasUsed:de,blobGasUsed:Ne(de,null),logsBloom:Ne(Ho),blockHash:ft,hash:ft,logs:mc(oS),blockNumber:ye,cumulativeGasUsed:de,effectiveGasPrice:Ne(de),blobGasPrice:Ne(de,null),status:Ne(ye),type:Ne(ye,0)},{effectiveGasPrice:["gasPrice"],hash:["transactionHash"],index:["transactionIndex"]});function cS(t){return lS(t)}function M1(t){t.to&&de(t.to)===ty&&(t.to="0x0000000000000000000000000000000000000000");const e=Uc({hash:ft,index:Ne(ye,void 0),type:r=>r==="0x"||r==null?0:ye(r),accessList:Ne(ni,null),blobVersionedHashes:Ne(mc(ft,!0),null),authorizationList:Ne(mc(r=>{let n;if(r.signature)n=r.signature;else{let a=r.yParity;a==="0x1b"?a=0:a==="0x1c"&&(a=1),n=Object.assign({},r,{yParity:a})}return{address:Ie(r.address),chainId:de(r.chainId),nonce:de(r.nonce),signature:qt.from(n)}},!1),null),blockHash:Ne(ft,null),blockNumber:Ne(ye,null),transactionIndex:Ne(ye,null),from:Ie,gasPrice:Ne(de),maxPriorityFeePerGas:Ne(de),maxFeePerGas:Ne(de),maxFeePerBlobGas:Ne(de,null),gasLimit:de,to:Ne(Ie,null),value:de,nonce:ye,data:Ho,creates:Ne(Ie,null),chainId:Ne(de,null)},{data:["input"],gasLimit:["gas"],index:["transactionIndex"]})(t);if(e.to==null&&e.creates==null&&(e.creates=Y4(e)),(t.type===1||t.type===2)&&t.accessList==null&&(e.accessList=[]),t.signature?e.signature=qt.from(t.signature):e.signature=qt.from(t),e.chainId==null){const r=e.signature.legacyChainId;r!=null&&(e.chainId=r)}return e.blockHash&&de(e.blockHash)===ty&&(e.blockHash=null),e}const dS="0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e";class zc{constructor(e){S(this,"name");me(this,{name:e})}clone(){return new zc(this.name)}}class dh extends zc{constructor(r,n){r==null&&(r=0);super(`org.ethers.network.plugins.GasCost#${r||0}`);S(this,"effectiveBlock");S(this,"txBase");S(this,"txCreate");S(this,"txDataZero");S(this,"txDataNonzero");S(this,"txAccessListStorageKey");S(this,"txAccessListAddress");const a={effectiveBlock:r};function i(o,l){let c=(n||{})[o];c==null&&(c=l),P(typeof c=="number",`invalud value for ${o}`,"costs",n),a[o]=c}i("txBase",21e3),i("txCreate",32e3),i("txDataZero",4),i("txDataNonzero",16),i("txAccessListStorageKey",1900),i("txAccessListAddress",2400),me(this,a)}clone(){return new dh(this.effectiveBlock,this)}}class uh extends zc{constructor(r,n){super("org.ethers.plugins.network.Ens");S(this,"address");S(this,"targetNetwork");me(this,{address:r||dS,targetNetwork:n??1})}clone(){return new uh(this.address,this.targetNetwork)}}var Ac,Ec;class uS extends zc{constructor(r,n){super("org.ethers.plugins.network.FetchUrlFeeDataPlugin");U(this,Ac);U(this,Ec);j(this,Ac,r),j(this,Ec,n)}get url(){return w(this,Ac)}get processFunc(){return w(this,Ec)}clone(){return this}}Ac=new WeakMap,Ec=new WeakMap;const of=new Map;var ho,fo,Ds;const Si=class Si{constructor(e,r){U(this,ho);U(this,fo);U(this,Ds);j(this,ho,e),j(this,fo,de(r)),j(this,Ds,new Map)}toJSON(){return{name:this.name,chainId:String(this.chainId)}}get name(){return w(this,ho)}set name(e){j(this,ho,e)}get chainId(){return w(this,fo)}set chainId(e){j(this,fo,de(e,"chainId"))}matches(e){if(e==null)return!1;if(typeof e=="string"){try{return this.chainId===de(e)}catch{}return this.name===e}if(typeof e=="number"||typeof e=="bigint"){try{return this.chainId===de(e)}catch{}return!1}if(typeof e=="object"){if(e.chainId!=null){try{return this.chainId===de(e.chainId)}catch{}return!1}return e.name!=null?this.name===e.name:!1}return!1}get plugins(){return Array.from(w(this,Ds).values())}attachPlugin(e){if(w(this,Ds).get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return w(this,Ds).set(e.name,e.clone()),this}getPlugin(e){return w(this,Ds).get(e)||null}getPlugins(e){return this.plugins.filter(r=>r.name.split("#")[0]===e)}clone(){const e=new Si(this.name,this.chainId);return this.plugins.forEach(r=>{e.attachPlugin(r.clone())}),e}computeIntrinsicGas(e){const r=this.getPlugin("org.ethers.plugins.network.GasCost")||new dh;let n=r.txBase;if(e.to==null&&(n+=r.txCreate),e.data)for(let a=2;a<e.data.length;a+=2)e.data.substring(a,a+2)==="00"?n+=r.txDataZero:n+=r.txDataNonzero;if(e.accessList){const a=ni(e.accessList);for(const i in a)n+=r.txAccessListAddress+r.txAccessListStorageKey*a[i].storageKeys.length}return n}static from(e){if(hS(),e==null)return Si.from("mainnet");if(typeof e=="number"&&(e=BigInt(e)),typeof e=="string"||typeof e=="bigint"){const r=of.get(e);if(r)return r();if(typeof e=="bigint")return new Si("unknown",e);P(!1,"unknown network","network",e)}if(typeof e.clone=="function")return e.clone();if(typeof e=="object"){P(typeof e.name=="string"&&typeof e.chainId=="number","invalid network object name or chainId","network",e);const r=new Si(e.name,e.chainId);return(e.ensAddress||e.ensNetwork!=null)&&r.attachPlugin(new uh(e.ensAddress,e.ensNetwork)),r}P(!1,"invalid network","network",e)}static register(e,r){typeof e=="number"&&(e=BigInt(e));const n=of.get(e);n&&P(!1,`conflicting network for ${JSON.stringify(n.name)}`,"nameOrChainId",e),of.set(e,r)}};ho=new WeakMap,fo=new WeakMap,Ds=new WeakMap;let xn=Si;function ry(t,e){const r=String(t);if(!r.match(/^[0-9.]+$/))throw new Error(`invalid gwei value: ${t}`);const n=r.split(".");if(n.length===1&&n.push(""),n.length!==2)throw new Error(`invalid gwei value: ${t}`);for(;n[1].length<e;)n[1]+="0";if(n[1].length>9){let a=BigInt(n[1].substring(0,9));n[1].substring(9).match(/^0+$/)||a++,n[1]=a.toString()}return BigInt(n[0]+n[1])}function ny(t){return new uS(t,async(e,r,n)=>{n.setHeader("User-Agent","ethers");let a;try{const[i,o]=await Promise.all([n.send(),e()]);a=i;const l=a.bodyJson.standard;return{gasPrice:o.gasPrice,maxFeePerGas:ry(l.maxFee,9),maxPriorityFeePerGas:ry(l.maxPriorityFee,9)}}catch(i){J(!1,`error encountered with polygon gas station (${JSON.stringify(n.url)})`,"SERVER_ERROR",{request:n,response:a,error:i})}})}let sy=!1;function hS(){if(sy)return;sy=!0;function t(e,r,n){const a=function(){const i=new xn(e,r);return n.ensNetwork!=null&&i.attachPlugin(new uh(null,n.ensNetwork)),i.attachPlugin(new dh),(n.plugins||[]).forEach(o=>{i.attachPlugin(o)}),i};xn.register(e,a),xn.register(r,a),n.altNames&&n.altNames.forEach(i=>{xn.register(i,a)})}t("mainnet",1,{ensNetwork:1,altNames:["homestead"]}),t("ropsten",3,{ensNetwork:3}),t("rinkeby",4,{ensNetwork:4}),t("goerli",5,{ensNetwork:5}),t("kovan",42,{ensNetwork:42}),t("sepolia",11155111,{ensNetwork:11155111}),t("holesky",17e3,{ensNetwork:17e3}),t("classic",61,{}),t("classicKotti",6,{}),t("arbitrum",42161,{ensNetwork:1}),t("arbitrum-goerli",421613,{}),t("arbitrum-sepolia",421614,{}),t("base",8453,{ensNetwork:1}),t("base-goerli",84531,{}),t("base-sepolia",84532,{}),t("bnb",56,{ensNetwork:1}),t("bnbt",97,{}),t("filecoin",314,{}),t("filecoin-calibration",314159,{}),t("linea",59144,{ensNetwork:1}),t("linea-goerli",59140,{}),t("linea-sepolia",59141,{}),t("matic",137,{ensNetwork:1,plugins:[ny("https://gasstation.polygon.technology/v2")]}),t("matic-amoy",80002,{}),t("matic-mumbai",80001,{altNames:["maticMumbai","maticmum"],plugins:[ny("https://gasstation-testnet.polygon.technology/v2")]}),t("optimism",10,{ensNetwork:1,plugins:[]}),t("optimism-goerli",420,{}),t("optimism-sepolia",11155420,{}),t("xdai",100,{ensNetwork:1})}function O0(t){return JSON.parse(JSON.stringify(t))}var Bn,yr,Ps,un,mo,Md;class fS{constructor(e){U(this,mo);U(this,Bn);U(this,yr);U(this,Ps);U(this,un);j(this,Bn,e),j(this,yr,null),j(this,Ps,4e3),j(this,un,-2)}get pollingInterval(){return w(this,Ps)}set pollingInterval(e){j(this,Ps,e)}start(){w(this,yr)||(j(this,yr,w(this,Bn)._setTimeout(ne(this,mo,Md).bind(this),w(this,Ps))),ne(this,mo,Md).call(this))}stop(){w(this,yr)&&(w(this,Bn)._clearTimeout(w(this,yr)),j(this,yr,null))}pause(e){this.stop(),e&&j(this,un,-2)}resume(){this.start()}}Bn=new WeakMap,yr=new WeakMap,Ps=new WeakMap,un=new WeakMap,mo=new WeakSet,Md=async function(){try{const e=await w(this,Bn).getBlockNumber();if(w(this,un)===-2){j(this,un,e);return}if(e!==w(this,un)){for(let r=w(this,un)+1;r<=e;r++){if(w(this,yr)==null)return;await w(this,Bn).emit("block",r)}j(this,un,e)}}catch{}w(this,yr)!=null&&j(this,yr,w(this,Bn)._setTimeout(ne(this,mo,Md).bind(this),w(this,Ps)))};var _a,Ba,Is;class yg{constructor(e){U(this,_a);U(this,Ba);U(this,Is);j(this,_a,e),j(this,Is,!1),j(this,Ba,r=>{this._poll(r,w(this,_a))})}async _poll(e,r){throw new Error("sub-classes must override this")}start(){w(this,Is)||(j(this,Is,!0),w(this,Ba).call(this,-2),w(this,_a).on("block",w(this,Ba)))}stop(){w(this,Is)&&(j(this,Is,!1),w(this,_a).off("block",w(this,Ba)))}pause(e){this.stop()}resume(){this.start()}}_a=new WeakMap,Ba=new WeakMap,Is=new WeakMap;var go,Rn;class mS extends yg{constructor(r,n){super(r);U(this,go);U(this,Rn);j(this,go,n),j(this,Rn,-2)}pause(r){r&&j(this,Rn,-2),super.pause(r)}async _poll(r,n){const a=await n.getBlock(w(this,go));a!=null&&(w(this,Rn)===-2?j(this,Rn,a.number):a.number>w(this,Rn)&&(n.emit(w(this,go),a.number),j(this,Rn,a.number)))}}go=new WeakMap,Rn=new WeakMap;var _u;class gS extends yg{constructor(r,n){super(r);U(this,_u);j(this,_u,O0(n))}async _poll(r,n){throw new Error("@TODO")}}_u=new WeakMap;var po;class pS extends yg{constructor(r,n){super(r);U(this,po);j(this,po,n)}async _poll(r,n){const a=await n.getTransactionReceipt(w(this,po));a&&n.emit(w(this,po),a)}}po=new WeakMap;var On,xo,yo,Ts,wr,Bu,L1;class wg{constructor(e,r){U(this,Bu);U(this,On);U(this,xo);U(this,yo);U(this,Ts);U(this,wr);j(this,On,e),j(this,xo,O0(r)),j(this,yo,ne(this,Bu,L1).bind(this)),j(this,Ts,!1),j(this,wr,-2)}start(){w(this,Ts)||(j(this,Ts,!0),w(this,wr)===-2&&w(this,On).getBlockNumber().then(e=>{j(this,wr,e)}),w(this,On).on("block",w(this,yo)))}stop(){w(this,Ts)&&(j(this,Ts,!1),w(this,On).off("block",w(this,yo)))}pause(e){this.stop(),e&&j(this,wr,-2)}resume(){this.start()}}On=new WeakMap,xo=new WeakMap,yo=new WeakMap,Ts=new WeakMap,wr=new WeakMap,Bu=new WeakSet,L1=async function(e){if(w(this,wr)===-2)return;const r=O0(w(this,xo));r.fromBlock=w(this,wr)+1,r.toBlock=e;const n=await w(this,On).getLogs(r);if(n.length===0){w(this,wr)<e-60&&j(this,wr,e-60);return}for(const a of n)w(this,On).emit(w(this,xo),a),j(this,wr,a.blockNumber)};const xS=BigInt(2),yS=10;function gd(t){return t&&typeof t.then=="function"}function Ld(t,e){return t+":"+JSON.stringify(e,(r,n)=>{if(n==null)return"null";if(typeof n=="bigint")return`bigint:${n.toString()}`;if(typeof n=="string")return n.toLowerCase();if(typeof n=="object"&&!Array.isArray(n)){const a=Object.keys(n);return a.sort(),a.reduce((i,o)=>(i[o]=n[o],i),{})}return n})}class F1{constructor(e){S(this,"name");me(this,{name:e})}start(){}stop(){}pause(e){}resume(){}}function wS(t){return JSON.parse(JSON.stringify(t))}function M0(t){return t=Array.from(new Set(t).values()),t.sort(),t}async function lf(t,e){if(t==null)throw new Error("invalid event");if(Array.isArray(t)&&(t={topics:t}),typeof t=="string")switch(t){case"block":case"debug":case"error":case"finalized":case"network":case"pending":case"safe":return{type:t,tag:t}}if(Me(t,32)){const r=t.toLowerCase();return{type:"transaction",tag:Ld("tx",{hash:r}),hash:r}}if(t.orphan){const r=t;return{type:"orphan",tag:Ld("orphan",r),filter:wS(r)}}if(t.address||t.topics){const r=t,n={topics:(r.topics||[]).map(a=>a==null?null:Array.isArray(a)?M0(a.map(i=>i.toLowerCase())):a.toLowerCase())};if(r.address){const a=[],i=[],o=l=>{Me(l)?a.push(l):i.push((async()=>{a.push(await Bt(l,e))})())};Array.isArray(r.address)?r.address.forEach(o):o(r.address),i.length&&await Promise.all(i),n.address=M0(a.map(l=>l.toLowerCase()))}return{filter:n,tag:Ld("event",n),type:"event"}}P(!1,"unknown ProviderEvent","event",t)}function cf(){return new Date().getTime()}const bS={cacheTimeout:250,pollingInterval:4e3};var Nt,_s,kt,wo,ar,Ra,Bs,Mn,Sc,br,bo,vo,we,er,L0,F0,wl,U0,bl,Fd;class vS{constructor(e,r){U(this,we);U(this,Nt);U(this,_s);U(this,kt);U(this,wo);U(this,ar);U(this,Ra);U(this,Bs);U(this,Mn);U(this,Sc);U(this,br);U(this,bo);U(this,vo);if(j(this,vo,Object.assign({},bS,r||{})),e==="any")j(this,Ra,!0),j(this,ar,null);else if(e){const n=xn.from(e);j(this,Ra,!1),j(this,ar,Promise.resolve(n)),setTimeout(()=>{this.emit("network",n,null)},0)}else j(this,Ra,!1),j(this,ar,null);j(this,Mn,-1),j(this,Bs,new Map),j(this,Nt,new Map),j(this,_s,new Map),j(this,kt,null),j(this,wo,!1),j(this,Sc,1),j(this,br,new Map),j(this,bo,!1)}get pollingInterval(){return w(this,vo).pollingInterval}get provider(){return this}get plugins(){return Array.from(w(this,_s).values())}attachPlugin(e){if(w(this,_s).get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return w(this,_s).set(e.name,e.connect(this)),this}getPlugin(e){return w(this,_s).get(e)||null}get disableCcipRead(){return w(this,bo)}set disableCcipRead(e){j(this,bo,!!e)}async ccipReadFetch(e,r,n){if(this.disableCcipRead||n.length===0||e.to==null)return null;const a=e.to.toLowerCase(),i=r.toLowerCase(),o=[];for(let l=0;l<n.length;l++){const c=n[l],d=c.replace("{sender}",a).replace("{data}",i),h=new es(d);c.indexOf("{data}")===-1&&(h.body={data:i,sender:a}),this.emit("debug",{action:"sendCcipReadFetchRequest",request:h,index:l,urls:n});let u="unknown error",f;try{f=await h.send()}catch(g){o.push(g.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:h,result:{error:g}});continue}try{const g=f.bodyJson;if(g.data)return this.emit("debug",{action:"receiveCcipReadFetchResult",request:h,result:g}),g.data;g.message&&(u=g.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:h,result:g})}catch{}J(f.statusCode<400||f.statusCode>=500,`response not found during CCIP fetch: ${u}`,"OFFCHAIN_FAULT",{reason:"404_MISSING_RESOURCE",transaction:e,info:{url:c,errorMessage:u}}),o.push(u)}J(!1,`error encountered during CCIP fetch: ${o.map(l=>JSON.stringify(l)).join(", ")}`,"OFFCHAIN_FAULT",{reason:"500_SERVER_ERROR",transaction:e,info:{urls:n,errorMessages:o}})}_wrapBlock(e,r){return new UE(aS(e),this)}_wrapLog(e,r){return new Fc(nS(e),this)}_wrapTransactionReceipt(e,r){return new j1(cS(e),this)}_wrapTransactionResponse(e,r){return new fc(M1(e),this)}_detectNetwork(){J(!1,"sub-classes must implement this","UNSUPPORTED_OPERATION",{operation:"_detectNetwork"})}async _perform(e){J(!1,`unsupported method: ${e.method}`,"UNSUPPORTED_OPERATION",{operation:e.method,info:e})}async getBlockNumber(){const e=ye(await ne(this,we,er).call(this,{method:"getBlockNumber"}),"%response");return w(this,Mn)>=0&&j(this,Mn,e),e}_getAddress(e){return Bt(e,this)}_getBlockTag(e){if(e==null)return"latest";switch(e){case"earliest":return"0x0";case"finalized":case"latest":case"pending":case"safe":return e}if(Me(e))return Me(e,32)?e:zr(e);if(typeof e=="bigint"&&(e=ye(e,"blockTag")),typeof e=="number")return e>=0?zr(e):w(this,Mn)>=0?zr(w(this,Mn)+e):this.getBlockNumber().then(r=>zr(r+e));P(!1,"invalid blockTag","blockTag",e)}_getFilter(e){const r=(e.topics||[]).map(c=>c==null?null:Array.isArray(c)?M0(c.map(d=>d.toLowerCase())):c.toLowerCase()),n="blockHash"in e?e.blockHash:void 0,a=(c,d,h)=>{let u;switch(c.length){case 0:break;case 1:u=c[0];break;default:c.sort(),u=c}if(n&&(d!=null||h!=null))throw new Error("invalid filter");const f={};return u&&(f.address=u),r.length&&(f.topics=r),d&&(f.fromBlock=d),h&&(f.toBlock=h),n&&(f.blockHash=n),f};let i=[];if(e.address)if(Array.isArray(e.address))for(const c of e.address)i.push(this._getAddress(c));else i.push(this._getAddress(e.address));let o;"fromBlock"in e&&(o=this._getBlockTag(e.fromBlock));let l;return"toBlock"in e&&(l=this._getBlockTag(e.toBlock)),i.filter(c=>typeof c!="string").length||o!=null&&typeof o!="string"||l!=null&&typeof l!="string"?Promise.all([Promise.all(i),o,l]).then(c=>a(c[0],c[1],c[2])):a(i,o,l)}_getTransactionRequest(e){const r=ku(e),n=[];if(["to","from"].forEach(a=>{if(r[a]==null)return;const i=Bt(r[a],this);gd(i)?n.push(async function(){r[a]=await i}()):r[a]=i}),r.blockTag!=null){const a=this._getBlockTag(r.blockTag);gd(a)?n.push(async function(){r.blockTag=await a}()):r.blockTag=a}return n.length?async function(){return await Promise.all(n),r}():r}async getNetwork(){if(w(this,ar)==null){const a=(async()=>{try{const i=await this._detectNetwork();return this.emit("network",i,null),i}catch(i){throw w(this,ar)===a&&j(this,ar,null),i}})();return j(this,ar,a),(await a).clone()}const e=w(this,ar),[r,n]=await Promise.all([e,this._detectNetwork()]);return r.chainId!==n.chainId&&(w(this,Ra)?(this.emit("network",n,r),w(this,ar)===e&&j(this,ar,Promise.resolve(n))):J(!1,`network changed: ${r.chainId} => ${n.chainId} `,"NETWORK_ERROR",{event:"changed"})),r.clone()}async getFeeData(){const e=await this.getNetwork(),r=async()=>{const{_block:a,gasPrice:i,priorityFee:o}=await Dt({_block:ne(this,we,U0).call(this,"latest",!1),gasPrice:(async()=>{try{const h=await ne(this,we,er).call(this,{method:"getGasPrice"});return de(h,"%response")}catch{}return null})(),priorityFee:(async()=>{try{const h=await ne(this,we,er).call(this,{method:"getPriorityFee"});return de(h,"%response")}catch{}return null})()});let l=null,c=null;const d=this._wrapBlock(a,e);return d&&d.baseFeePerGas&&(c=o??BigInt("1000000000"),l=d.baseFeePerGas*xS+c),new qx(i,l,c)},n=e.getPlugin("org.ethers.plugins.network.FetchUrlFeeDataPlugin");if(n){const a=new es(n.url),i=await n.processFunc(r,this,a);return new qx(i.gasPrice,i.maxFeePerGas,i.maxPriorityFeePerGas)}return await r()}async estimateGas(e){let r=this._getTransactionRequest(e);return gd(r)&&(r=await r),de(await ne(this,we,er).call(this,{method:"estimateGas",transaction:r}),"%response")}async call(e){const{tx:r,blockTag:n}=await Dt({tx:this._getTransactionRequest(e),blockTag:this._getBlockTag(e.blockTag)});return await ne(this,we,F0).call(this,ne(this,we,L0).call(this,r,n,e.enableCcipRead?0:-1))}async getBalance(e,r){return de(await ne(this,we,wl).call(this,{method:"getBalance"},e,r),"%response")}async getTransactionCount(e,r){return ye(await ne(this,we,wl).call(this,{method:"getTransactionCount"},e,r),"%response")}async getCode(e,r){return se(await ne(this,we,wl).call(this,{method:"getCode"},e,r))}async getStorage(e,r,n){const a=de(r,"position");return se(await ne(this,we,wl).call(this,{method:"getStorage",position:a},e,n))}async broadcastTransaction(e){const{blockNumber:r,hash:n,network:a}=await Dt({blockNumber:this.getBlockNumber(),hash:this._perform({method:"broadcastTransaction",signedTransaction:e}),network:this.getNetwork()}),i=pu.from(e);if(i.hash!==n)throw new Error("@TODO: the returned hash did not match");return this._wrapTransactionResponse(i,a).replaceableTransaction(r)}async getBlock(e,r){const{network:n,params:a}=await Dt({network:this.getNetwork(),params:ne(this,we,U0).call(this,e,!!r)});return a==null?null:this._wrapBlock(a,n)}async getTransaction(e){const{network:r,params:n}=await Dt({network:this.getNetwork(),params:ne(this,we,er).call(this,{method:"getTransaction",hash:e})});return n==null?null:this._wrapTransactionResponse(n,r)}async getTransactionReceipt(e){const{network:r,params:n}=await Dt({network:this.getNetwork(),params:ne(this,we,er).call(this,{method:"getTransactionReceipt",hash:e})});if(n==null)return null;if(n.gasPrice==null&&n.effectiveGasPrice==null){const a=await ne(this,we,er).call(this,{method:"getTransaction",hash:e});if(a==null)throw new Error("report this; could not find tx or effectiveGasPrice");n.effectiveGasPrice=a.gasPrice}return this._wrapTransactionReceipt(n,r)}async getTransactionResult(e){const{result:r}=await Dt({network:this.getNetwork(),result:ne(this,we,er).call(this,{method:"getTransactionResult",hash:e})});return r==null?null:se(r)}async getLogs(e){let r=this._getFilter(e);gd(r)&&(r=await r);const{network:n,params:a}=await Dt({network:this.getNetwork(),params:ne(this,we,er).call(this,{method:"getLogs",filter:r})});return a.map(i=>this._wrapLog(i,n))}_getProvider(e){J(!1,"provider cannot connect to target network","UNSUPPORTED_OPERATION",{operation:"_getProvider()"})}async getResolver(e){return await Au.fromName(this,e)}async getAvatar(e){const r=await this.getResolver(e);return r?await r.getAvatar():null}async resolveName(e){const r=await this.getResolver(e);return r?await r.getAddress():null}async lookupAddress(e){e=Ie(e);const r=P0(e.substring(2).toLowerCase()+".addr.reverse");try{const n=await Au.getEnsAddress(this),i=await new Rl(n,["function resolver(bytes32) view returns (address)"],this).resolver(r);if(i==null||i===ac)return null;const l=await new Rl(i,["function name(bytes32) view returns (string)"],this).name(r);return await this.resolveName(l)!==e?null:l}catch(n){if(mt(n,"BAD_DATA")&&n.value==="0x"||mt(n,"CALL_EXCEPTION"))return null;throw n}return null}async waitForTransaction(e,r,n){const a=r??1;return a===0?this.getTransactionReceipt(e):new Promise(async(i,o)=>{let l=null;const c=async d=>{try{const h=await this.getTransactionReceipt(e);if(h!=null&&d-h.blockNumber+1>=a){i(h),l&&(clearTimeout(l),l=null);return}}catch(h){console.log("EEE",h)}this.once("block",c)};n!=null&&(l=setTimeout(()=>{l!=null&&(l=null,this.off("block",c),o(Ve("timeout","TIMEOUT",{reason:"timeout"})))},n)),c(await this.getBlockNumber())})}async waitForBlock(e){J(!1,"not implemented yet","NOT_IMPLEMENTED",{operation:"waitForBlock"})}_clearTimeout(e){const r=w(this,br).get(e);r&&(r.timer&&clearTimeout(r.timer),w(this,br).delete(e))}_setTimeout(e,r){r==null&&(r=0);const n=el(this,Sc)._++,a=()=>{w(this,br).delete(n),e()};if(this.paused)w(this,br).set(n,{timer:null,func:a,time:r});else{const i=setTimeout(a,r);w(this,br).set(n,{timer:i,func:a,time:cf()})}return n}_forEachSubscriber(e){for(const r of w(this,Nt).values())e(r.subscriber)}_getSubscriber(e){switch(e.type){case"debug":case"error":case"network":return new F1(e.type);case"block":{const r=new fS(this);return r.pollingInterval=this.pollingInterval,r}case"safe":case"finalized":return new mS(this,e.type);case"event":return new wg(this,e.filter);case"transaction":return new pS(this,e.hash);case"orphan":return new gS(this,e.filter)}throw new Error(`unsupported event: ${e.type}`)}_recoverSubscriber(e,r){for(const n of w(this,Nt).values())if(n.subscriber===e){n.started&&n.subscriber.stop(),n.subscriber=r,n.started&&r.start(),w(this,kt)!=null&&r.pause(w(this,kt));break}}async on(e,r){const n=await ne(this,we,Fd).call(this,e);return n.listeners.push({listener:r,once:!1}),n.started||(n.subscriber.start(),n.started=!0,w(this,kt)!=null&&n.subscriber.pause(w(this,kt))),this}async once(e,r){const n=await ne(this,we,Fd).call(this,e);return n.listeners.push({listener:r,once:!0}),n.started||(n.subscriber.start(),n.started=!0,w(this,kt)!=null&&n.subscriber.pause(w(this,kt))),this}async emit(e,...r){const n=await ne(this,we,bl).call(this,e,r);if(!n||n.listeners.length===0)return!1;const a=n.listeners.length;return n.listeners=n.listeners.filter(({listener:i,once:o})=>{const l=new Yb(this,o?null:i,e);try{i.call(this,...r,l)}catch{}return!o}),n.listeners.length===0&&(n.started&&n.subscriber.stop(),w(this,Nt).delete(n.tag)),a>0}async listenerCount(e){if(e){const n=await ne(this,we,bl).call(this,e);return n?n.listeners.length:0}let r=0;for(const{listeners:n}of w(this,Nt).values())r+=n.length;return r}async listeners(e){if(e){const n=await ne(this,we,bl).call(this,e);return n?n.listeners.map(({listener:a})=>a):[]}let r=[];for(const{listeners:n}of w(this,Nt).values())r=r.concat(n.map(({listener:a})=>a));return r}async off(e,r){const n=await ne(this,we,bl).call(this,e);if(!n)return this;if(r){const a=n.listeners.map(({listener:i})=>i).indexOf(r);a>=0&&n.listeners.splice(a,1)}return(!r||n.listeners.length===0)&&(n.started&&n.subscriber.stop(),w(this,Nt).delete(n.tag)),this}async removeAllListeners(e){if(e){const{tag:r,started:n,subscriber:a}=await ne(this,we,Fd).call(this,e);n&&a.stop(),w(this,Nt).delete(r)}else for(const[r,{started:n,subscriber:a}]of w(this,Nt))n&&a.stop(),w(this,Nt).delete(r);return this}async addListener(e,r){return await this.on(e,r)}async removeListener(e,r){return this.off(e,r)}get destroyed(){return w(this,wo)}destroy(){this.removeAllListeners();for(const e of w(this,br).keys())this._clearTimeout(e);j(this,wo,!0)}get paused(){return w(this,kt)!=null}set paused(e){!!e!==this.paused&&(this.paused?this.resume():this.pause(!1))}pause(e){if(j(this,Mn,-1),w(this,kt)!=null){if(w(this,kt)==!!e)return;J(!1,"cannot change pause type; resume first","UNSUPPORTED_OPERATION",{operation:"pause"})}this._forEachSubscriber(r=>r.pause(e)),j(this,kt,!!e);for(const r of w(this,br).values())r.timer&&clearTimeout(r.timer),r.time=cf()-r.time}resume(){if(w(this,kt)!=null){this._forEachSubscriber(e=>e.resume()),j(this,kt,null);for(const e of w(this,br).values()){let r=e.time;r<0&&(r=0),e.time=cf(),setTimeout(e.func,r)}}}}Nt=new WeakMap,_s=new WeakMap,kt=new WeakMap,wo=new WeakMap,ar=new WeakMap,Ra=new WeakMap,Bs=new WeakMap,Mn=new WeakMap,Sc=new WeakMap,br=new WeakMap,bo=new WeakMap,vo=new WeakMap,we=new WeakSet,er=async function(e){const r=w(this,vo).cacheTimeout;if(r<0)return await this._perform(e);const n=Ld(e.method,e);let a=w(this,Bs).get(n);return a||(a=this._perform(e),w(this,Bs).set(n,a),setTimeout(()=>{w(this,Bs).get(n)===a&&w(this,Bs).delete(n)},r)),await a},L0=async function(e,r,n){J(n<yS,"CCIP read exceeded maximum redirections","OFFCHAIN_FAULT",{reason:"TOO_MANY_REDIRECTS",transaction:Object.assign({},e,{blockTag:r,enableCcipRead:!0})});const a=ku(e);try{return se(await this._perform({method:"call",transaction:a,blockTag:r}))}catch(i){if(!this.disableCcipRead&&eg(i)&&i.data&&n>=0&&r==="latest"&&a.to!=null&&Je(i.data,0,4)==="0x556f1830"){const o=i.data,l=await Bt(a.to,this);let c;try{c=ES(Je(i.data,4))}catch(u){J(!1,u.message,"OFFCHAIN_FAULT",{reason:"BAD_DATA",transaction:a,info:{data:o}})}J(c.sender.toLowerCase()===l.toLowerCase(),"CCIP Read sender mismatch","CALL_EXCEPTION",{action:"call",data:o,reason:"OffchainLookup",transaction:a,invocation:null,revert:{signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",name:"OffchainLookup",args:c.errorArgs}});const d=await this.ccipReadFetch(a,c.calldata,c.urls);J(d!=null,"CCIP Read failed to fetch data","OFFCHAIN_FAULT",{reason:"FETCH_FAILED",transaction:a,info:{data:i.data,errorArgs:c.errorArgs}});const h={to:l,data:He([c.selector,AS([d,c.extraData])])};this.emit("debug",{action:"sendCcipReadCall",transaction:h});try{const u=await ne(this,we,L0).call(this,h,r,n+1);return this.emit("debug",{action:"receiveCcipReadCallResult",transaction:Object.assign({},h),result:u}),u}catch(u){throw this.emit("debug",{action:"receiveCcipReadCallError",transaction:Object.assign({},h),error:u}),u}}throw i}},F0=async function(e){const{value:r}=await Dt({network:this.getNetwork(),value:e});return r},wl=async function(e,r,n){let a=this._getAddress(r),i=this._getBlockTag(n);return(typeof a!="string"||typeof i!="string")&&([a,i]=await Promise.all([a,i])),await ne(this,we,F0).call(this,ne(this,we,er).call(this,Object.assign(e,{address:a,blockTag:i})))},U0=async function(e,r){if(Me(e,32))return await ne(this,we,er).call(this,{method:"getBlock",blockHash:e,includeTransactions:r});let n=this._getBlockTag(e);return typeof n!="string"&&(n=await n),await ne(this,we,er).call(this,{method:"getBlock",blockTag:n,includeTransactions:r})},bl=async function(e,r){let n=await lf(e,this);return n.type==="event"&&r&&r.length>0&&r[0].removed===!0&&(n=await lf({orphan:"drop-log",log:r[0]},this)),w(this,Nt).get(n.tag)||null},Fd=async function(e){const r=await lf(e,this),n=r.tag;let a=w(this,Nt).get(n);return a||(a={subscriber:this._getSubscriber(r),tag:n,addressableMap:new WeakMap,nameMap:new Map,started:!1,listeners:[]},w(this,Nt).set(n,a)),a};function NS(t,e){try{const r=z0(t,e);if(r)return fu(r)}catch{}return null}function z0(t,e){if(t==="0x")return null;try{const r=ye(Je(t,e,e+32)),n=ye(Je(t,r,r+32));return Je(t,r+32,r+32+n)}catch{}return null}function ay(t){const e=rt(t);if(e.length>32)throw new Error("internal; should not happen");const r=new Uint8Array(32);return r.set(e,32-e.length),r}function kS(t){if(t.length%32===0)return t;const e=new Uint8Array(Math.ceil(t.length/32)*32);return e.set(t),e}const jS=new Uint8Array([]);function AS(t){const e=[];let r=0;for(let n=0;n<t.length;n++)e.push(jS),r+=32;for(let n=0;n<t.length;n++){const a=xe(t[n]);e[n]=ay(r),e.push(ay(a.length)),e.push(kS(a)),r+=32+Math.ceil(a.length/32)*32}return He(e)}const iy="0x0000000000000000000000000000000000000000000000000000000000000000";function ES(t){const e={sender:"",urls:[],calldata:"",selector:"",extraData:"",errorArgs:[]};J(Ri(t)>=5*32,"insufficient OffchainLookup data","OFFCHAIN_FAULT",{reason:"insufficient OffchainLookup data"});const r=Je(t,0,32);J(Je(r,0,12)===Je(iy,0,12),"corrupt OffchainLookup sender","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup sender"}),e.sender=Je(r,12);try{const n=[],a=ye(Je(t,32,64)),i=ye(Je(t,a,a+32)),o=Je(t,a+32);for(let l=0;l<i;l++){const c=NS(o,l*32);if(c==null)throw new Error("abort");n.push(c)}e.urls=n}catch{J(!1,"corrupt OffchainLookup urls","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup urls"})}try{const n=z0(t,64);if(n==null)throw new Error("abort");e.calldata=n}catch{J(!1,"corrupt OffchainLookup calldata","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup calldata"})}J(Je(t,100,128)===Je(iy,0,28),"corrupt OffchainLookup callbaackSelector","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup callbaackSelector"}),e.selector=Je(t,96,100);try{const n=z0(t,128);if(n==null)throw new Error("abort");e.extraData=n}catch{J(!1,"corrupt OffchainLookup extraData","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup extraData"})}return e.errorArgs="sender,urls,calldata,selector,extraData".split(/,/).map(n=>e[n]),e}function oa(t,e){if(t.provider)return t.provider;J(!1,"missing provider","UNSUPPORTED_OPERATION",{operation:e})}async function oy(t,e){let r=ku(e);if(r.to!=null&&(r.to=Bt(r.to,t)),r.from!=null){const n=r.from;r.from=Promise.all([t.getAddress(),Bt(n,t)]).then(([a,i])=>(P(a.toLowerCase()===i.toLowerCase(),"transaction from mismatch","tx.from",i),a))}else r.from=t.getAddress();return await Dt(r)}class SS{constructor(e){S(this,"provider");me(this,{provider:e||null})}async getNonce(e){return oa(this,"getTransactionCount").getTransactionCount(await this.getAddress(),e)}async populateCall(e){return await oy(this,e)}async populateTransaction(e){const r=oa(this,"populateTransaction"),n=await oy(this,e);n.nonce==null&&(n.nonce=await this.getNonce("pending")),n.gasLimit==null&&(n.gasLimit=await this.estimateGas(n));const a=await this.provider.getNetwork();if(n.chainId!=null){const o=de(n.chainId);P(o===a.chainId,"transaction chainId mismatch","tx.chainId",e.chainId)}else n.chainId=a.chainId;const i=n.maxFeePerGas!=null||n.maxPriorityFeePerGas!=null;if(n.gasPrice!=null&&(n.type===2||i)?P(!1,"eip-1559 transaction do not support gasPrice","tx",e):(n.type===0||n.type===1)&&i&&P(!1,"pre-eip-1559 transaction do not support maxFeePerGas/maxPriorityFeePerGas","tx",e),(n.type===2||n.type==null)&&n.maxFeePerGas!=null&&n.maxPriorityFeePerGas!=null)n.type=2;else if(n.type===0||n.type===1){const o=await r.getFeeData();J(o.gasPrice!=null,"network does not support gasPrice","UNSUPPORTED_OPERATION",{operation:"getGasPrice"}),n.gasPrice==null&&(n.gasPrice=o.gasPrice)}else{const o=await r.getFeeData();if(n.type==null)if(o.maxFeePerGas!=null&&o.maxPriorityFeePerGas!=null)if(n.authorizationList&&n.authorizationList.length?n.type=4:n.type=2,n.gasPrice!=null){const l=n.gasPrice;delete n.gasPrice,n.maxFeePerGas=l,n.maxPriorityFeePerGas=l}else n.maxFeePerGas==null&&(n.maxFeePerGas=o.maxFeePerGas),n.maxPriorityFeePerGas==null&&(n.maxPriorityFeePerGas=o.maxPriorityFeePerGas);else o.gasPrice!=null?(J(!i,"network does not support EIP-1559","UNSUPPORTED_OPERATION",{operation:"populateTransaction"}),n.gasPrice==null&&(n.gasPrice=o.gasPrice),n.type=0):J(!1,"failed to get consistent fee data","UNSUPPORTED_OPERATION",{operation:"signer.getFeeData"});else(n.type===2||n.type===3||n.type===4)&&(n.maxFeePerGas==null&&(n.maxFeePerGas=o.maxFeePerGas),n.maxPriorityFeePerGas==null&&(n.maxPriorityFeePerGas=o.maxPriorityFeePerGas))}return await Dt(n)}async populateAuthorization(e){const r=Object.assign({},e);return r.chainId==null&&(r.chainId=(await oa(this,"getNetwork").getNetwork()).chainId),r.nonce==null&&(r.nonce=await this.getNonce()),r}async estimateGas(e){return oa(this,"estimateGas").estimateGas(await this.populateCall(e))}async call(e){return oa(this,"call").call(await this.populateCall(e))}async resolveName(e){return await oa(this,"resolveName").resolveName(e)}async sendTransaction(e){const r=oa(this,"sendTransaction"),n=await this.populateTransaction(e);delete n.from;const a=pu.from(n);return await r.broadcastTransaction(await this.signTransaction(a))}authorize(e){J(!1,"authorization not implemented for this signer","UNSUPPORTED_OPERATION",{operation:"authorize"})}}function CS(t){return JSON.parse(JSON.stringify(t))}var St,hn,Oa,Rs,Ma,No,Xs,H0,V0;class U1{constructor(e){U(this,Xs);U(this,St);U(this,hn);U(this,Oa);U(this,Rs);U(this,Ma);U(this,No);j(this,St,e),j(this,hn,null),j(this,Oa,ne(this,Xs,H0).bind(this)),j(this,Rs,!1),j(this,Ma,null),j(this,No,!1)}_subscribe(e){throw new Error("subclasses must override this")}_emitResults(e,r){throw new Error("subclasses must override this")}_recover(e){throw new Error("subclasses must override this")}start(){w(this,Rs)||(j(this,Rs,!0),ne(this,Xs,H0).call(this,-2))}stop(){w(this,Rs)&&(j(this,Rs,!1),j(this,No,!0),ne(this,Xs,V0).call(this),w(this,St).off("block",w(this,Oa)))}pause(e){e&&ne(this,Xs,V0).call(this),w(this,St).off("block",w(this,Oa))}resume(){this.start()}}St=new WeakMap,hn=new WeakMap,Oa=new WeakMap,Rs=new WeakMap,Ma=new WeakMap,No=new WeakMap,Xs=new WeakSet,H0=async function(e){try{w(this,hn)==null&&j(this,hn,this._subscribe(w(this,St)));let r=null;try{r=await w(this,hn)}catch(i){if(!mt(i,"UNSUPPORTED_OPERATION")||i.operation!=="eth_newFilter")throw i}if(r==null){j(this,hn,null),w(this,St)._recoverSubscriber(this,this._recover(w(this,St)));return}const n=await w(this,St).getNetwork();if(w(this,Ma)||j(this,Ma,n),w(this,Ma).chainId!==n.chainId)throw new Error("chaid changed");if(w(this,No))return;const a=await w(this,St).send("eth_getFilterChanges",[r]);await this._emitResults(w(this,St),a)}catch(r){console.log("@TODO",r)}w(this,St).once("block",w(this,Oa))},V0=function(){const e=w(this,hn);e&&(j(this,hn,null),e.then(r=>{w(this,St).destroyed||w(this,St).send("eth_uninstallFilter",[r])}))};var La;class DS extends U1{constructor(r,n){super(r);U(this,La);j(this,La,CS(n))}_recover(r){return new wg(r,w(this,La))}async _subscribe(r){return await r.send("eth_newFilter",[w(this,La)])}async _emitResults(r,n){for(const a of n)r.emit(w(this,La),r._wrapLog(a,r._network))}}La=new WeakMap;class PS extends U1{async _subscribe(e){return await e.send("eth_newPendingTransactionFilter",[])}async _emitResults(e,r){for(const n of r)e.emit("pending",n)}}const IS="bigint,boolean,function,number,string,symbol".split(/,/g);function Ud(t){if(t==null||IS.indexOf(typeof t)>=0||typeof t.getAddress=="function")return t;if(Array.isArray(t))return t.map(Ud);if(typeof t=="object")return Object.keys(t).reduce((e,r)=>(e[r]=t[r],e),{});throw new Error(`should not happen: ${t} (${typeof t})`)}function TS(t){return new Promise(e=>{setTimeout(e,t)})}function ii(t){return t&&t.toLowerCase()}function ly(t){return t&&typeof t.pollingInterval=="number"}const z1={polling:!1,staticNetwork:null,batchStallTime:10,batchMaxSize:1<<20,batchMaxCount:100,cacheTimeout:250,pollingInterval:4e3};class df extends SS{constructor(r,n){super(r);S(this,"address");n=Ie(n),me(this,{address:n})}connect(r){J(!1,"cannot reconnect JsonRpcSigner","UNSUPPORTED_OPERATION",{operation:"signer.connect"})}async getAddress(){return this.address}async populateTransaction(r){return await this.populateCall(r)}async sendUncheckedTransaction(r){const n=Ud(r),a=[];if(n.from){const o=n.from;a.push((async()=>{const l=await Bt(o,this.provider);P(l!=null&&l.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",r),n.from=l})())}else n.from=this.address;if(n.gasLimit==null&&a.push((async()=>{n.gasLimit=await this.provider.estimateGas({...n,from:this.address})})()),n.to!=null){const o=n.to;a.push((async()=>{n.to=await Bt(o,this.provider)})())}a.length&&await Promise.all(a);const i=this.provider.getRpcTransaction(n);return this.provider.send("eth_sendTransaction",[i])}async sendTransaction(r){const n=await this.provider.getBlockNumber(),a=await this.sendUncheckedTransaction(r);return await new Promise((i,o)=>{const l=[1e3,100];let c=0;const d=async()=>{try{const h=await this.provider.getTransaction(a);if(h!=null){i(h.replaceableTransaction(n));return}}catch(h){if(mt(h,"CANCELLED")||mt(h,"BAD_DATA")||mt(h,"NETWORK_ERROR")||mt(h,"UNSUPPORTED_OPERATION")){h.info==null&&(h.info={}),h.info.sendTransactionHash=a,o(h);return}if(mt(h,"INVALID_ARGUMENT")&&(c++,h.info==null&&(h.info={}),h.info.sendTransactionHash=a,c>10)){o(h);return}this.provider.emit("error",Ve("failed to fetch transation after sending (will try again)","UNKNOWN_ERROR",{error:h}))}this.provider._setTimeout(()=>{d()},l.pop()||4e3)};d()})}async signTransaction(r){const n=Ud(r);if(n.from){const i=await Bt(n.from,this.provider);P(i!=null&&i.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",r),n.from=i}else n.from=this.address;const a=this.provider.getRpcTransaction(n);return await this.provider.send("eth_signTransaction",[a])}async signMessage(r){const n=typeof r=="string"?$n(r):r;return await this.provider.send("personal_sign",[se(n),this.address.toLowerCase()])}async signTypedData(r,n,a){const i=Ud(a),o=await Nu.resolveNames(r,n,i,async l=>{const c=await Bt(l);return P(c!=null,"TypedData does not support null address","value",l),c});return await this.provider.send("eth_signTypedData_v4",[this.address.toLowerCase(),JSON.stringify(Nu.getPayload(o.domain,n,o.value))])}async unlock(r){return this.provider.send("personal_unlockAccount",[this.address.toLowerCase(),r,null])}async _legacySignMessage(r){const n=typeof r=="string"?$n(r):r;return await this.provider.send("eth_sign",[this.address.toLowerCase(),se(n)])}}var Fa,ko,Ln,fn,Lr,vr,Ht,Cc,G0;class _S extends vS{constructor(r,n){super(r,n);U(this,Cc);U(this,Fa);U(this,ko);U(this,Ln);U(this,fn);U(this,Lr);U(this,vr);U(this,Ht);j(this,ko,1),j(this,Fa,Object.assign({},z1,n||{})),j(this,Ln,[]),j(this,fn,null),j(this,vr,null),j(this,Ht,null);{let i=null;const o=new Promise(l=>{i=l});j(this,Lr,{promise:o,resolve:i})}const a=this._getOption("staticNetwork");typeof a=="boolean"?(P(!a||r!=="any","staticNetwork cannot be used on special network 'any'","options",n),a&&r!=null&&j(this,vr,xn.from(r))):a&&(P(r==null||a.matches(r),"staticNetwork MUST match network object","options",n),j(this,vr,a))}_getOption(r){return w(this,Fa)[r]}get _network(){return J(w(this,vr),"network is not available yet","NETWORK_ERROR"),w(this,vr)}async _perform(r){if(r.method==="call"||r.method==="estimateGas"){let a=r.transaction;if(a&&a.type!=null&&de(a.type)&&a.maxFeePerGas==null&&a.maxPriorityFeePerGas==null){const i=await this.getFeeData();i.maxFeePerGas==null&&i.maxPriorityFeePerGas==null&&(r=Object.assign({},r,{transaction:Object.assign({},a,{type:void 0})}))}}const n=this.getRpcRequest(r);return n!=null?await this.send(n.method,n.args):super._perform(r)}async _detectNetwork(){const r=this._getOption("staticNetwork");if(r)if(r===!0){if(w(this,vr))return w(this,vr)}else return r;return w(this,Ht)?await w(this,Ht):this.ready?(j(this,Ht,(async()=>{try{const n=xn.from(de(await this.send("eth_chainId",[])));return j(this,Ht,null),n}catch(n){throw j(this,Ht,null),n}})()),await w(this,Ht)):(j(this,Ht,(async()=>{const n={id:el(this,ko)._++,method:"eth_chainId",params:[],jsonrpc:"2.0"};this.emit("debug",{action:"sendRpcPayload",payload:n});let a;try{a=(await this._send(n))[0],j(this,Ht,null)}catch(i){throw j(this,Ht,null),this.emit("debug",{action:"receiveRpcError",error:i}),i}if(this.emit("debug",{action:"receiveRpcResult",result:a}),"result"in a)return xn.from(de(a.result));throw this.getRpcError(n,a)})()),await w(this,Ht))}_start(){w(this,Lr)==null||w(this,Lr).resolve==null||(w(this,Lr).resolve(),j(this,Lr,null),(async()=>{for(;w(this,vr)==null&&!this.destroyed;)try{j(this,vr,await this._detectNetwork())}catch(r){if(this.destroyed)break;console.log("JsonRpcProvider failed to detect network and cannot start up; retry in 1s (perhaps the URL is wrong or the node is not started)"),this.emit("error",Ve("failed to bootstrap network detection","NETWORK_ERROR",{event:"initial-network-discovery",info:{error:r}})),await TS(1e3)}ne(this,Cc,G0).call(this)})())}async _waitUntilReady(){if(w(this,Lr)!=null)return await w(this,Lr).promise}_getSubscriber(r){return r.type==="pending"?new PS(this):r.type==="event"?this._getOption("polling")?new wg(this,r.filter):new DS(this,r.filter):r.type==="orphan"&&r.filter.orphan==="drop-log"?new F1("orphan"):super._getSubscriber(r)}get ready(){return w(this,Lr)==null}getRpcTransaction(r){const n={};return["chainId","gasLimit","gasPrice","type","maxFeePerGas","maxPriorityFeePerGas","nonce","value"].forEach(a=>{if(r[a]==null)return;let i=a;a==="gasLimit"&&(i="gas"),n[i]=zr(de(r[a],`tx.${a}`))}),["from","to","data"].forEach(a=>{r[a]!=null&&(n[a]=se(r[a]))}),r.accessList&&(n.accessList=ni(r.accessList)),r.blobVersionedHashes&&(n.blobVersionedHashes=r.blobVersionedHashes.map(a=>a.toLowerCase())),r.authorizationList&&(n.authorizationList=r.authorizationList.map(a=>{const i=Vv(a);return{address:i.address,nonce:zr(i.nonce),chainId:zr(i.chainId),yParity:zr(i.signature.yParity),r:zr(i.signature.r),s:zr(i.signature.s)}})),n}getRpcRequest(r){switch(r.method){case"chainId":return{method:"eth_chainId",args:[]};case"getBlockNumber":return{method:"eth_blockNumber",args:[]};case"getGasPrice":return{method:"eth_gasPrice",args:[]};case"getPriorityFee":return{method:"eth_maxPriorityFeePerGas",args:[]};case"getBalance":return{method:"eth_getBalance",args:[ii(r.address),r.blockTag]};case"getTransactionCount":return{method:"eth_getTransactionCount",args:[ii(r.address),r.blockTag]};case"getCode":return{method:"eth_getCode",args:[ii(r.address),r.blockTag]};case"getStorage":return{method:"eth_getStorageAt",args:[ii(r.address),"0x"+r.position.toString(16),r.blockTag]};case"broadcastTransaction":return{method:"eth_sendRawTransaction",args:[r.signedTransaction]};case"getBlock":if("blockTag"in r)return{method:"eth_getBlockByNumber",args:[r.blockTag,!!r.includeTransactions]};if("blockHash"in r)return{method:"eth_getBlockByHash",args:[r.blockHash,!!r.includeTransactions]};break;case"getTransaction":return{method:"eth_getTransactionByHash",args:[r.hash]};case"getTransactionReceipt":return{method:"eth_getTransactionReceipt",args:[r.hash]};case"call":return{method:"eth_call",args:[this.getRpcTransaction(r.transaction),r.blockTag]};case"estimateGas":return{method:"eth_estimateGas",args:[this.getRpcTransaction(r.transaction)]};case"getLogs":return r.filter&&r.filter.address!=null&&(Array.isArray(r.filter.address)?r.filter.address=r.filter.address.map(ii):r.filter.address=ii(r.filter.address)),{method:"eth_getLogs",args:[r.filter]}}return null}getRpcError(r,n){const{method:a}=r,{error:i}=n;if(a==="eth_estimateGas"&&i.message){const c=i.message;if(!c.match(/revert/i)&&c.match(/insufficient funds/i))return Ve("insufficient funds","INSUFFICIENT_FUNDS",{transaction:r.params[0],info:{payload:r,error:i}});if(c.match(/nonce/i)&&c.match(/too low/i))return Ve("nonce has already been used","NONCE_EXPIRED",{transaction:r.params[0],info:{payload:r,error:i}})}if(a==="eth_call"||a==="eth_estimateGas"){const c=$0(i),d=hc.getBuiltinCallException(a==="eth_call"?"call":"estimateGas",r.params[0],c?c.data:null);return d.info={error:i,payload:r},d}const o=JSON.stringify(OS(i));if(typeof i.message=="string"&&i.message.match(/user denied|ethers-user-denied/i))return Ve("user rejected action","ACTION_REJECTED",{action:{eth_sign:"signMessage",personal_sign:"signMessage",eth_signTypedData_v4:"signTypedData",eth_signTransaction:"signTransaction",eth_sendTransaction:"sendTransaction",eth_requestAccounts:"requestAccess",wallet_requestAccounts:"requestAccess"}[a]||"unknown",reason:"rejected",info:{payload:r,error:i}});if(a==="eth_sendRawTransaction"||a==="eth_sendTransaction"){const c=r.params[0];if(o.match(/insufficient funds|base fee exceeds gas limit/i))return Ve("insufficient funds for intrinsic transaction cost","INSUFFICIENT_FUNDS",{transaction:c,info:{error:i}});if(o.match(/nonce/i)&&o.match(/too low/i))return Ve("nonce has already been used","NONCE_EXPIRED",{transaction:c,info:{error:i}});if(o.match(/replacement transaction/i)&&o.match(/underpriced/i))return Ve("replacement fee too low","REPLACEMENT_UNDERPRICED",{transaction:c,info:{error:i}});if(o.match(/only replay-protected/i))return Ve("legacy pre-eip-155 transactions not supported","UNSUPPORTED_OPERATION",{operation:a,info:{transaction:c,info:{error:i}}})}let l=!!o.match(/the method .* does not exist/i);return l||i&&i.details&&i.details.startsWith("Unauthorized method:")&&(l=!0),l?Ve("unsupported operation","UNSUPPORTED_OPERATION",{operation:r.method,info:{error:i,payload:r}}):Ve("could not coalesce error","UNKNOWN_ERROR",{error:i,payload:r})}send(r,n){if(this.destroyed)return Promise.reject(Ve("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:r}));const a=el(this,ko)._++,i=new Promise((o,l)=>{w(this,Ln).push({resolve:o,reject:l,payload:{method:r,params:n,id:a,jsonrpc:"2.0"}})});return ne(this,Cc,G0).call(this),i}async getSigner(r){r==null&&(r=0);const n=this.send("eth_accounts",[]);if(typeof r=="number"){const i=await n;if(r>=i.length)throw new Error("no such account");return new df(this,i[r])}const{accounts:a}=await Dt({network:this.getNetwork(),accounts:n});r=Ie(r);for(const i of a)if(Ie(i)===r)return new df(this,r);throw new Error("invalid account")}async listAccounts(){return(await this.send("eth_accounts",[])).map(n=>new df(this,n))}destroy(){w(this,fn)&&(clearTimeout(w(this,fn)),j(this,fn,null));for(const{payload:r,reject:n}of w(this,Ln))n(Ve("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:r.method}));j(this,Ln,[]),super.destroy()}}Fa=new WeakMap,ko=new WeakMap,Ln=new WeakMap,fn=new WeakMap,Lr=new WeakMap,vr=new WeakMap,Ht=new WeakMap,Cc=new WeakSet,G0=function(){if(w(this,fn))return;const r=this._getOption("batchMaxCount")===1?0:this._getOption("batchStallTime");j(this,fn,setTimeout(()=>{j(this,fn,null);const n=w(this,Ln);for(j(this,Ln,[]);n.length;){const a=[n.shift()];for(;n.length&&a.length!==w(this,Fa).batchMaxCount;)if(a.push(n.shift()),JSON.stringify(a.map(o=>o.payload)).length>w(this,Fa).batchMaxSize){n.unshift(a.pop());break}(async()=>{const i=a.length===1?a[0].payload:a.map(o=>o.payload);this.emit("debug",{action:"sendRpcPayload",payload:i});try{const o=await this._send(i);this.emit("debug",{action:"receiveRpcResult",result:o});for(const{resolve:l,reject:c,payload:d}of a){if(this.destroyed){c(Ve("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:d.method}));continue}const h=o.filter(u=>u.id===d.id)[0];if(h==null){const u=Ve("missing response for request","BAD_DATA",{value:o,info:{payload:d}});this.emit("error",u),c(u);continue}if("error"in h){c(this.getRpcError(d,h));continue}l(h.result)}}catch(o){this.emit("debug",{action:"receiveRpcError",error:o});for(const{reject:l}of a)l(o)}})()}},r))};var Os;class BS extends _S{constructor(r,n){super(r,n);U(this,Os);let a=this._getOption("pollingInterval");a==null&&(a=z1.pollingInterval),j(this,Os,a)}_getSubscriber(r){const n=super._getSubscriber(r);return ly(n)&&(n.pollingInterval=w(this,Os)),n}get pollingInterval(){return w(this,Os)}set pollingInterval(r){if(!Number.isInteger(r)||r<0)throw new Error("invalid interval");j(this,Os,r),this._forEachSubscriber(n=>{ly(n)&&(n.pollingInterval=w(this,Os))})}}Os=new WeakMap;var jo;class RS extends BS{constructor(r,n,a){r==null&&(r="http://localhost:8545");super(n,a);U(this,jo);typeof r=="string"?j(this,jo,new es(r)):j(this,jo,r.clone())}_getConnection(){return w(this,jo).clone()}async send(r,n){return await this._start(),await super.send(r,n)}async _send(r){const n=this._getConnection();n.body=JSON.stringify(r),n.setHeader("content-type","application/json");const a=await n.send();a.assertOk();let i=a.bodyJson;return Array.isArray(i)||(i=[i]),i}}jo=new WeakMap;function $0(t){if(t==null)return null;if(typeof t.message=="string"&&t.message.match(/revert/i)&&Me(t.data))return{message:t.message,data:t.data};if(typeof t=="object"){for(const e in t){const r=$0(t[e]);if(r)return r}return null}if(typeof t=="string")try{return $0(JSON.parse(t))}catch{}return null}function Q0(t,e){if(t!=null){if(typeof t.message=="string"&&e.push(t.message),typeof t=="object")for(const r in t)Q0(t[r],e);if(typeof t=="string")try{return Q0(JSON.parse(t),e)}catch{}}}function OS(t){const e=[];return Q0(t,e),e}let uf=null;function MS(){return uf||(uf=new RS(It.BLOCKCHAIN.RPC_URL)),uf}function hh(){throw new Error("Contract address not configured. Set VITE_CONTRACT_ADDRESS.")}async function H1(){const e=await hh().batchCount();return Number(e)}async function V1(t){const e=hh(),[r,n,a]=await e.getBatch(t);return{batchId:t,merkleRoot:r,timestamp:Number(n),blockNumber:Number(a),etherscanBlockUrl:Zu(Number(a))}}async function LS(t,e){const r=hh(),[n,a,i]=await r.getBatch(t);return{verified:await r.verify(t,e),batchId:t,onChainRoot:n,expectedRoot:e,blockNumber:Number(i),timestamp:new Date(Number(a)*1e3),etherscanBlockUrl:Zu(Number(i))}}async function FS(t=10){const e=await H1(),r=[],n=Math.max(0,e-t);for(let a=e-1;a>=n;a--)try{const i=await V1(a);r.push(i)}catch(i){console.error(`Failed to fetch batch ${a}:`,i)}return r}async function US(t=0){const e=hh(),r=e.filters.Anchored();return(await e.queryFilter(r,t)).map(a=>{const i=a;return{batchId:Number(i.args[0]),root:i.args[1],timestamp:Number(i.args[2]),blockNumber:Number(i.args[3]),transactionHash:i.transactionHash,etherscanTxUrl:$b(i.transactionHash)}})}async function zS(){try{const t=MS(),[e,r]=await Promise.all([t.getBlockNumber(),t.getNetwork()]);return{connected:!0,blockNumber:e,chainId:Number(r.chainId)}}catch(t){return{connected:!1,blockNumber:null,chainId:null,error:t.message}}}const W0={getBatchCount:H1,getBatch:V1,verifyOnChain:LS,getRecentBatches:FS,getAnchoredEvents:US,checkBlockchainHealth:zS};class HS{constructor(){S(this,"dpps",new Map);S(this,"didDocuments",new Map);S(this,"relationships",new Map);S(this,"anchoringEvents",new Map);S(this,"credentials",new Map);S(this,"watchers",new Map);S(this,"alerts",new Map);S(this,"attestations",new Map);S(this,"specifications",new Map)}async insertDPP(e){const r=this.generateId(),n=new Date().toISOString(),a={...e,id:r,created_at:n,updated_at:n};return this.dpps.set(r,a),a}async getDPPs(e){const r=Array.from(this.dpps.values());return e?r.slice(0,e):r}async getDPPByDID(e){return Array.from(this.dpps.values()).find(r=>r.did===e)||null}async updateDPP(e,r){const n=this.dpps.get(e);if(!n)return null;const a={...n,...r,metadata:r.metadata?{...n.metadata,...r.metadata}:n.metadata,updated_at:new Date().toISOString()};return this.dpps.set(e,a),a}async insertDIDDocument(e){const r=this.generateId(),n=new Date().toISOString(),a={...e,id:r,created_at:n,updated_at:n};return this.didDocuments.set(r,a),a}async getDIDDocumentByDID(e){return Array.from(this.didDocuments.values()).find(r=>r.did===e)||null}async insertRelationship(e){const r=this.generateId(),n=new Date().toISOString(),a={...e,id:r,created_at:n,updated_at:n};return this.relationships.set(r,a),a}async getRelationshipsByParent(e){return Array.from(this.relationships.values()).filter(r=>r.parent_did===e)}async getRelationshipsByChild(e){return Array.from(this.relationships.values()).filter(r=>r.child_did===e)}async insertAnchoringEvent(e){const r=this.generateId(),n=new Date().toISOString(),a={...e,id:r,timestamp:n};return this.anchoringEvents.set(r,a),a}async getAnchoringEventsByDID(e){return Array.from(this.anchoringEvents.values()).filter(r=>r.did===e)}async insertCredential(e){const r=this.generateId(),n=new Date().toISOString(),a={...e,id:r,created_at:n};return this.credentials.set(r,a),a}async getCredentialsByDPP(e){return Array.from(this.credentials.values()).filter(r=>r.dpp_id===e)}async insertWatcher(e){const r=this.generateId(),n=new Date().toISOString(),a={...e,id:r,created_at:n};return this.watchers.set(r,a),a}async getWatchers(){return Array.from(this.watchers.values())}async insertAlert(e){const r=this.generateId(),n=new Date().toISOString(),a={...e,id:r,created_at:n};return this.alerts.set(r,a),a}async getAlerts(){return Array.from(this.alerts.values()).sort((e,r)=>new Date(r.created_at).getTime()-new Date(e.created_at).getTime())}async updateAlert(e,r){const n=this.alerts.get(e);if(!n)return null;const a={...n,...r};return this.alerts.set(e,a),a}async insertAttestation(e){const r=this.generateId(),n=new Date().toISOString(),a={...e,id:r,created_at:n,timestamp:n};return this.attestations.set(r,a),a}async updateAttestation(e,r){const n=this.attestations.get(e);if(!n)return null;const a={...n,...r};return this.attestations.set(e,a),a}async getAttestationsByDID(e){return Array.from(this.attestations.values()).filter(r=>r.did===e)}async insertSpecification(e){const r=this.generateId(),n=new Date().toISOString(),a={...e,id:r,created_at:n,updated_at:n};return this.specifications.set(r,a),a}async getSpecificationsByDPP(e){return Array.from(this.specifications.values()).filter(r=>r.dpp_id===e)}generateId(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}clear(){this.dpps.clear(),this.didDocuments.clear(),this.relationships.clear(),this.anchoringEvents.clear(),this.credentials.clear(),this.watchers.clear(),this.alerts.clear(),this.attestations.clear(),this.specifications.clear()}}const Pe=new HS;let qr=!0,Wt=!1,cy=0;const VS=3e4;async function GS(){const t=Date.now();if(t-cy<VS)return Wt;try{Wt=(await fetch("/api/health",{method:"GET"})).ok}catch{Wt=!1}return cy=t,Wt}function G1(t){qr=t}function $1(){return{useBackend:qr,backendAvailable:Wt}}async function Q1(){if(qr)try{if(await GS(),Wt)return(await ns.identity.listIdentities()).map(lN)}catch(t){console.warn("Backend unavailable, using local data:",t)}return Pe.getDPPs()}async function W1(t){if(qr&&Wt)try{const e=QS(t);if(e){const r=await ns.identity.getIdentity(e);return lN(r)}}catch(e){console.warn("Backend fetch failed, using local:",e)}return Pe.getDPPByDID(t)}async function K1(t){if(qr&&Wt)try{const r=await ns.identity.createProduct(t);return{did:r.did,scid:r.scid}}catch(r){console.warn("Backend create failed, using local:",r)}const e=await Pe.insertDPP({did:`did:webvh:z${$S()}:demo.local`,type:"main",model:t.model,parent_did:null,lifecycle_status:"created",owner:"demo-owner",custodian:null,metadata:t.metadata||{},version:1,previous_version_id:null});return{did:e.did,scid:e.did.split(":")[2]}}async function J1(t){if(qr&&Wt)try{return(await ns.identity.getEvents(t)).filter(r=>{var n;return((n=r.witness_proofs)==null?void 0:n.batchId)!==void 0}).map(WS)}catch(e){console.warn("Backend fetch failed, using local:",e)}return Pe.getAnchoringEventsByDID(t)}async function Y1(){if(qr&&Wt)try{return await ns.witness.getBatches()}catch(t){console.warn("Backend fetch failed:",t)}return[]}async function bg(t,e){try{const r=await W0.verifyOnChain(t,e);return{verified:r.verified,onChainRoot:r.onChainRoot,blockNumber:r.blockNumber,etherscanUrl:r.etherscanBlockUrl}}catch(r){return console.warn("Blockchain verification failed:",r),null}}async function vg(t=10){try{return(await W0.getAnchoredEvents(0)).slice(0,t).map(r=>({batchId:r.batchId,merkleRoot:r.root,blockNumber:r.blockNumber,timestamp:new Date(r.timestamp*1e3),txHash:r.transactionHash,etherscanTxUrl:r.etherscanTxUrl,etherscanBlockUrl:Zu(r.blockNumber)}))}catch(e){console.warn("Failed to get blockchain anchors:",e);try{return(await W0.getRecentBatches(t)).map(n=>({batchId:n.batchId,merkleRoot:n.merkleRoot,blockNumber:n.blockNumber,timestamp:new Date(n.timestamp*1e3),etherscanBlockUrl:n.etherscanBlockUrl}))}catch{return[]}}}async function q1(t){var e;if(qr&&Wt)try{const r=await ns.identity.getEvents(t),n=[];for(const a of r)if((e=a.witness_proofs)!=null&&e.witnesses)for(const i of a.witness_proofs.witnesses)n.push({id:`${a.id}-${i.witnessDid}`,dpp_id:"",did:a.did,witness_did:i.witnessDid,attestation_type:a.event_type,attestation_data:a.payload,signature:i.signature,timestamp:i.timestamp,created_at:a.created_at});return n}catch(r){console.warn("Backend fetch failed, using local:",r)}return Pe.getAttestationsByDID(t)}async function Z1(t){if(qr&&Wt)try{return await ns.watcher.getAudits(t)}catch(e){console.warn("Backend fetch failed:",e)}return[]}async function X1(){if(qr&&Wt)try{return await ns.watcher.getStatus()}catch(e){console.warn("Backend fetch failed:",e)}const t=await Pe.getWatchers();return{healthy:!0,lastCheck:new Date().toISOString(),activeWatchers:t.filter(e=>e.active).length}}async function eN(){return Pe.getAlerts()}async function tN(t,e){return Pe.updateAlert(t,e)}async function rN(t){const{enhancedDB:e}=await Bi(async()=>{const{enhancedDB:r}=await Promise.resolve().then(()=>Xm);return{enhancedDB:r}},void 0);return e.getDIDDocumentByDID(t)}async function nN(t){if(qr&&Wt)try{const e=await ns.identity.createProduct({type:t.type,model:t.model,metadata:t.metadata});return{...t,id:e.scid,did:e.did,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}}catch(e){console.warn("Backend insert failed, using local:",e)}return Pe.insertDPP(t)}async function sN(t){const{enhancedDB:e}=await Bi(async()=>{const{enhancedDB:r}=await Promise.resolve().then(()=>Xm);return{enhancedDB:r}},void 0);return e.insertRelationship({...t,position:t.position??0,metadata:t.metadata??{}})}async function aN(t){const{enhancedDB:e}=await Bi(async()=>{const{enhancedDB:r}=await Promise.resolve().then(()=>Xm);return{enhancedDB:r}},void 0);return e.insertDIDDocument(t)}async function iN(t){return Pe.insertAttestation(t)}async function oN(t){return Pe.insertAnchoringEvent(t)}function $S(){return Math.random().toString(36).substring(2,15)}function QS(t){const e=t.split(":");return e.length>=3?e[2]:null}function lN(t){return{id:t.scid,did:t.did,type:"main",model:"Unknown",parent_did:null,lifecycle_status:t.status,owner:"Unknown",custodian:null,metadata:{},version:1,previous_version_id:null,created_at:t.created_at,updated_at:t.updated_at}}function WS(t){var r;const e=(r=t.witness_proofs)==null?void 0:r.batchId;return{id:String(t.id),dpp_id:"",did:t.did,transaction_hash:"",block_number:0,merkle_root:null,component_hashes:null,anchor_type:t.event_type,timestamp:new Date(t.timestamp).toISOString(),metadata:{batchId:e,versionId:t.version_id}}}const _e={setUseBackendApi:G1,getDataStoreMode:$1,getAllDPPs:Q1,getDPPByDID:W1,createProduct:K1,insertDPP:nN,getAnchoringEventsByDID:J1,getAllBatches:Y1,getBlockchainVerification:bg,getRecentBlockchainAnchors:vg,insertAnchoringEvent:oN,getAttestationsByDID:q1,insertAttestation:iN,getAuditsByDID:Z1,getWatcherStatus:X1,getAllAlerts:eN,updateAlert:tN,getDIDDocumentByDID:rN,insertDIDDocument:aN,insertRelationship:sN},dy=Object.freeze(Object.defineProperty({__proto__:null,createProduct:K1,getAllAlerts:eN,getAllBatches:Y1,getAllDPPs:Q1,getAnchoringEventsByDID:J1,getAttestationsByDID:q1,getAuditsByDID:Z1,getBlockchainVerification:bg,getDIDDocumentByDID:rN,getDPPByDID:W1,getDataStoreMode:$1,getRecentBlockchainAnchors:vg,getWatcherStatus:X1,hybridDataStore:_e,insertAnchoringEvent:oN,insertAttestation:iN,insertDIDDocument:aN,insertDPP:nN,insertRelationship:sN,setUseBackendApi:G1,updateAlert:tN},Symbol.toStringTag,{value:"Module"}));async function Js(t,e,r){const n=[{did:"did:webvh:example.com:witnesses:did-validator-1",name:"DID Validator Node 1",org:"Decentralized Identity Network"},{did:"did:webvh:example.com:witnesses:did-validator-2",name:"DID Validator Node 2",org:"Identity Trust Consortium"},{did:"did:webvh:example.com:witnesses:did-validator-3",name:"DID Validator Node 3",org:"Blockchain Verification Service"}],a=Date.now(),i=[];i.push({dpp_id:t,did:e,witness_did:n[0].did,attestation_type:"did_creation",attestation_data:{timestamp:new Date(a-7*24*60*60*1e3).toISOString(),witness:n[0].name,organization:n[0].org,eventType:"DID Creation",method:"did:webvh",controller:e,notes:"DID document created and registered on decentralized network",verificationMethodsCount:1,initialProofType:"Ed25519Signature2020"},signature:`witness-sig-${Math.random().toString(16).substring(2,18)}`,approval_status:"approved"}),Math.random()>.3&&i.push({dpp_id:t,did:e,witness_did:n[1].did,attestation_type:"key_rotation",attestation_data:{timestamp:new Date(a-4*24*60*60*1e3).toISOString(),witness:n[1].name,organization:n[1].org,eventType:"Key Rotation",oldKeyId:`${e}#key-1`,newKeyId:`${e}#key-2`,rotationReason:"Scheduled security rotation",previousKeyRevoked:!0,newKeyType:"Ed25519VerificationKey2020"},signature:`witness-sig-${Math.random().toString(16).substring(2,18)}`,approval_status:"approved"}),(r==="component"||Math.random()>.6)&&i.push({dpp_id:t,did:e,witness_did:n[2].did,attestation_type:"ownership_change",attestation_data:{timestamp:new Date(a-2*24*60*60*1e3).toISOString(),witness:n[2].name,organization:n[2].org,eventType:"Ownership Transfer",previousOwner:"did:webvh:example.com:organizations:original-owner",newOwner:"did:webvh:example.com:organizations:current-owner",transferMethod:"Smart Contract",blockchainTxHash:`0x${Math.random().toString(16).substring(2,66)}`,transferApproved:!0},signature:`witness-sig-${Math.random().toString(16).substring(2,18)}`,approval_status:"approved"}),Math.random()>.4&&i.push({dpp_id:t,did:e,witness_did:n[0].did,attestation_type:"did_update",attestation_data:{timestamp:new Date(a-1*24*60*60*1e3).toISOString(),witness:n[0].name,organization:n[0].org,eventType:"DID Document Update",updateType:"Service Endpoint Addition",changeDescription:"Added new service endpoint for data access",versionNumber:2,previousHash:`0x${Math.random().toString(16).substring(2,66)}`,newHash:`0x${Math.random().toString(16).substring(2,66)}`},signature:`witness-sig-${Math.random().toString(16).substring(2,18)}`,approval_status:"approved"});for(const o of i)await _e.insertAttestation(o),await _e.insertAttestation(o);return i.length}async function K0(t,e,r=[]){const n=Date.now(),a=185e5+Math.floor(Math.random()*1e5),i={dpp_id:t,did:e,transaction_hash:`0x${Math.random().toString(16).substring(2)}${Math.random().toString(16).substring(2)}`,block_number:a,merkle_root:`0x${Math.random().toString(16).substring(2,66)}`,component_hashes:r.map(o=>({did:o,hash:`0x${Math.random().toString(16).substring(2,66)}`})),anchor_type:"creation",metadata:{network:"ethereum",chainId:1,gasUsed:Math.floor(15e4+Math.random()*5e4),blockExplorer:`https://etherscan.io/tx/0x${Math.random().toString(16).substring(2,20)}`,createdAt:new Date(n-7*24*60*60*1e3).toISOString()}};if(await _e.insertAnchoringEvent(i),await _e.insertAnchoringEvent(i),Math.random()>.4){const o={dpp_id:t,did:e,transaction_hash:`0x${Math.random().toString(16).substring(2)}${Math.random().toString(16).substring(2)}`,block_number:a+Math.floor(Math.random()*1e3)+500,merkle_root:`0x${Math.random().toString(16).substring(2,66)}`,component_hashes:[],anchor_type:"verification",metadata:{network:"ethereum",chainId:1,gasUsed:Math.floor(8e4+Math.random()*3e4),verifier:"did:webvh:example.com:validators:node-1",verifiedAt:new Date(n-432e6).toISOString()}};await _e.insertAnchoringEvent(o),await _e.insertAnchoringEvent(o)}}async function KS(t,e,r,n){const a={dpp_id:t,did:e,witness_did:"did:webvh:example.com:witnesses:lifecycle-system",attestation_type:r,attestation_data:{timestamp:new Date().toISOString(),eventType:r,...n},signature:`0x${Math.random().toString(16).substring(2,66)}`};if(await _e.insertAttestation(a),await _e.insertAttestation(a),r==="installation"||r==="disposal"){const i={dpp_id:t,did:e,transaction_hash:`0x${Math.random().toString(16).substring(2)}${Math.random().toString(16).substring(2)}`,block_number:185e5+Math.floor(Math.random()*2e5),merkle_root:`0x${Math.random().toString(16).substring(2,66)}`,component_hashes:[],anchor_type:`lifecycle_${r}`,metadata:{network:"ethereum",chainId:1,eventType:r,gasUsed:Math.floor(1e5+Math.random()*5e4),eventTimestamp:new Date().toISOString()}};await _e.insertAnchoringEvent(i),await _e.insertAnchoringEvent(i)}}async function uy(t,e,r,n=0){const a=Date.now(),i=[];i.push({dpp_id:t,did:e,witness_did:"did:webvh:example.com:witnesses:manufacturing-system",attestation_type:"manufacturing",attestation_data:{timestamp:new Date(a-10*24*60*60*1e3).toISOString(),eventType:"manufacturing",description:r==="main"?"Product manufactured and quality tested":"Component manufactured according to specifications",performedBy:"Manufacturing Operator",location:"Factory Floor A",batchNumber:`BATCH-${Math.floor(Math.random()*1e4)}`,qualityCheck:"passed"},signature:`0x${Math.random().toString(16).substring(2,66)}`}),r==="main"&&n>0&&i.push({dpp_id:t,did:e,witness_did:"did:webvh:example.com:witnesses:assembly-line",attestation_type:"assembly",attestation_data:{timestamp:new Date(a-7*24*60*60*1e3).toISOString(),eventType:"assembly",description:`Product assembled from ${n} components`,performedBy:"Assembly Technician",location:"Assembly Line B",componentsAssembled:n,assemblyTime:Math.floor(30+Math.random()*60)},signature:`0x${Math.random().toString(16).substring(2,66)}`}),Math.random()>.5&&r==="main"&&i.push({dpp_id:t,did:e,witness_did:"did:webvh:example.com:witnesses:installation-service",attestation_type:"installation",attestation_data:{timestamp:new Date(a-3*24*60*60*1e3).toISOString(),eventType:"installation",description:"Product installed at customer location",performedBy:"Installation Technician",location:"Customer Site - Building A",customerReference:`CUST-${Math.floor(Math.random()*1e4)}`,installationConditions:"Standard installation, no issues"},signature:`0x${Math.random().toString(16).substring(2,66)}`}),Math.random()>.7&&r==="main"&&i.push({dpp_id:t,did:e,witness_did:"did:webvh:example.com:witnesses:maintenance-service",attestation_type:"maintenance",attestation_data:{timestamp:new Date(a-1*24*60*60*1e3).toISOString(),eventType:"maintenance",description:"Routine maintenance inspection performed",performedBy:"Maintenance Engineer",location:"Customer Site",findings:"All components in good condition",nextMaintenanceDue:new Date(a+180*24*60*60*1e3).toISOString()},signature:`0x${Math.random().toString(16).substring(2,66)}`});for(const o of i)await _e.insertAttestation(o),await _e.insertAttestation(o);return console.log(`Generated ${i.length} default lifecycle events for ${e}`),i.length}async function JS(t){var a,i,o,l,c;const e=nc[t.productType];if(!e)throw new Error(`Unknown product type: ${t.productType}`);const r=Date.now(),n=[{name:"Manufacturer A",did:"did:webvh:glass-solutions.com:organizations:manufacturer",domain:"glass-solutions.com"},{name:"Manufacturer B",did:"did:webvh:frame-masters.com:organizations:manufacturer",domain:"frame-masters.com"}];for(let d=0;d<t.count;d++){const h=`${r+d}-${Math.random().toString(36).substr(2,9)}`,u=n[d%n.length],f=`did:webvh:${u.domain}:products:${t.productType}-${h}`,g={productType:t.productType,...t.customMetadata},b="/Enabling-trust-with-DLT-technologies/";t.productType==="window"?g.image_url=`${b}images/window.png`:t.productType==="glass"?g.image_url=`${b}images/glass.png`:t.productType==="frame"&&(g.image_url=`${b}images/frame.png`);for(const m of e.properties)if(!(m.key in g))switch(m.type){case"string":(a=m.validation)!=null&&a.enum?g[m.key]=m.validation.enum[d%m.validation.enum.length]:g[m.key]=`${m.label}-${d+1}`;break;case"number":g[m.key]=(((i=m.validation)==null?void 0:i.min)||10)+d%100;break;case"boolean":g[m.key]=d%2===0;break;case"date":g[m.key]=new Date(Date.now()-d*864e5).toISOString();break;case"object":m.key==="dimensions"?g[m.key]={width:1e3+d*100,height:1200+d*100,unit:"mm"}:g[m.key]={};break}const y=[];if(e.componentSlots.length>0)for(const m of e.componentSlots){if(!m.required&&Math.random()>.7)continue;const x=(o=m.allowedTypes)==null?void 0:o[0];if(!x)continue;const p=nc[x];if(p)for(let v=0;v<m.minQuantity;v++){const N=`did:webvh:${u.domain}:products:${x}-${h}-${v}`,A={productType:x},D="/Enabling-trust-with-DLT-technologies/";x==="glass"?A.image_url=`${D}images/glass.png`:x==="frame"&&(A.image_url=`${D}images/frame.png`);for(const L of p.properties)switch(L.type){case"string":(l=L.validation)!=null&&l.enum?A[L.key]=L.validation.enum[v%L.validation.enum.length]:A[L.key]=`${L.label}-${d}-${v}`;break;case"number":A[L.key]=(((c=L.validation)==null?void 0:c.min)||5)+v%50;break;case"boolean":A[L.key]=v%2===0;break;case"date":A[L.key]=new Date(Date.now()-(d+v)*864e5).toISOString();break}const E=await te.insertDPP({did:N,type:"component",model:`${p.name}-${d+1}-${v+1}`,parent_did:f,lifecycle_status:"active",owner:`did:webvh:${u.domain}:organizations:${x}-supplier`,custodian:u.did,metadata:A,version:1,previous_version_id:null});y.push(N),await te.insertDIDDocument({dpp_id:E.id,did:N,controller:E.owner,verification_method:[{id:`${N}#key-1`,type:"Ed25519VerificationKey2020",controller:E.owner,publicKeyMultibase:`z6Mk${Math.random().toString(36).substring(2,15)}`}],service_endpoints:[{id:`${N}#dpp-service`,type:"DPPService",serviceEndpoint:`https://${u.domain}/dpp/${N.split(":").pop()}`}],proof:{type:"Ed25519Signature2020",created:new Date(Date.now()-d*864e5).toISOString()},document_metadata:{bulk:!0,productType:x}}),await te.insertRelationship({parent_did:f,child_did:N,relationship_type:"component",position:v+1,metadata:{role:m.type,quantity:1}}),await Js(E.id,N,"component"),await uy(E.id,N,"component",0),await K0(E.id,N)}}const k=await te.insertDPP({did:f,type:e.category==="main"?"main":"component",model:`${e.name}-${d+1}`,parent_did:null,lifecycle_status:"active",owner:u.did,custodian:null,metadata:g,version:1,previous_version_id:null});await te.insertDIDDocument({dpp_id:k.id,did:f,controller:k.owner,verification_method:[{id:`${f}#key-1`,type:"Ed25519VerificationKey2020",controller:k.owner,publicKeyMultibase:`z6Mk${Math.random().toString(36).substring(2,15)}`}],service_endpoints:[{id:`${f}#dpp-service`,type:"DPPService",serviceEndpoint:`https://${u.domain}/dpp/${f.split(":").pop()}`}],proof:{type:"Ed25519Signature2020",created:new Date().toISOString()},document_metadata:{bulk:!0,productType:t.productType}}),await Js(k.id,f,k.type),await K0(k.id,f,y),await uy(k.id,f,k.type,y.length);for(const m of e.credentials.filter(x=>x.required)){const x={};for(const p of m.properties.filter(v=>v.required))switch(p.type){case"string":x[p.key]=`${p.label}-${d}`;break;case"number":x[p.key]=10+d%90;break;case"object":x[p.key]={value:10+d,unit:"standard"};break}await te.insertCredential({dpp_id:k.id,credential_id:`urn:uuid:${h}-${m.type}`,issuer:`did:webvh:${u.domain}:organizations:${m.issuerTypes[0]}`,credential_type:m.type,credential_data:x,issued_date:new Date(Date.now()-d*864e5).toISOString(),expiry_date:m.expiryDays?new Date(Date.now()+m.expiryDays*864e5).toISOString():null,verification_status:"valid"})}}}async function cN(){console.log("Generating mixed test data..."),await JS({productType:"window",count:50}),console.log("Mixed test data generated! (150 DPPs: 50 windows + 50 glass + 50 frames)")}function hy({onNavigate:t,onCreateDPP:e}){const[r,n]=_.useState([]),[a,i]=_.useState(null),[o,l]=_.useState(!0),[c,d]=_.useState("grid"),[h,u]=_.useState(1),[f,g]=_.useState(0),b=20;_.useEffect(()=>{y()},[]);const y=async()=>{l(!0);const v=await te.getAllDPPs(),N=await te.getStats(),A=[...v].sort((D,E)=>D.type==="main"&&E.type!=="main"?-1:D.type!=="main"&&E.type==="main"?1:0);n(A),i(N),g(A.length),l(!1)},k=_.useCallback(async v=>{l(!0);const N={};v.text&&(N.text=v.text),v.type!=="all"&&(N.type=v.type),v.productType&&(N.productType=v.productType),v.componentSubType&&(N.componentSubType=v.componentSubType),v.status&&(N.status=v.status),v.owner&&(N.owner=v.owner),N.limit=b,N.offset=(h-1)*b;const A=await te.searchDPPs(N),D=[...A.dpps].sort((E,L)=>E.type==="main"&&L.type!=="main"?-1:E.type!=="main"&&L.type==="main"?1:0);n(D),g(A.total),l(!1)},[h]),m=async()=>{if(confirm("This will generate 90 test products. Continue?")){l(!0);try{await cN(),await y(),alert("Test data generated successfully!")}catch(v){alert("Error generating data: "+v)}l(!1)}},x=async()=>{confirm("DELETE ALL data? This cannot be undone!")&&(await te.clearAll(),await y())},p=Math.ceil(f/b);return s.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 pt-20 transition-colors",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 shadow-sm transition-colors",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("div",{children:s.jsxs("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white flex items-center gap-3",children:[s.jsx(Re,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"}),"Product DPP Dashboard"]})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("button",{onClick:()=>d(c==="grid"?"list":"grid"),className:"px-3 py-2 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-900 dark:text-white rounded-lg flex items-center gap-2 transition-colors",children:[c==="grid"?s.jsx(xj,{className:"w-4 h-4"}):s.jsx(hj,{className:"w-4 h-4"}),c==="grid"?"List":"Grid"]}),e&&s.jsxs("button",{onClick:e,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg flex items-center gap-2",children:[s.jsx(Re,{className:"w-4 h-4"}),"Create DPP"]}),s.jsxs("button",{onClick:m,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg flex items-center gap-2",children:[s.jsx(uu,{className:"w-4 h-4"}),"Test Data"]})]})]}),a&&s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/30 rounded-lg p-4 transition-colors",children:[s.jsx("p",{className:"text-sm text-blue-600 dark:text-blue-400 font-medium",children:"Total DPPs"}),s.jsx("p",{className:"text-2xl font-bold text-blue-900 dark:text-blue-200",children:a.totalDPPs})]}),s.jsxs("div",{className:"bg-green-50 dark:bg-green-900/30 rounded-lg p-4 transition-colors",children:[s.jsx("p",{className:"text-sm text-green-600 dark:text-green-400 font-medium",children:"Main Products"}),s.jsx("p",{className:"text-2xl font-bold text-green-900 dark:text-green-200",children:a.mainProducts})]}),s.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/30 rounded-lg p-4 transition-colors",children:[s.jsx("p",{className:"text-sm text-purple-600 dark:text-purple-400 font-medium",children:"Components"}),s.jsx("p",{className:"text-2xl font-bold text-purple-900 dark:text-purple-200",children:a.components})]}),s.jsxs("div",{className:"bg-orange-50 dark:bg-orange-900/30 rounded-lg p-4 transition-colors",children:[s.jsx("p",{className:"text-sm text-orange-600 dark:text-orange-400 font-medium",children:"Product Types"}),s.jsx("p",{className:"text-2xl font-bold text-orange-900 dark:text-orange-200",children:Object.keys(a.byProductType).length})]})]})]})}),s.jsx("div",{className:"max-w-7xl mx-auto px-4 py-6",children:s.jsx(Ij,{onFilterChange:k,stats:a})}),s.jsxs("div",{className:"max-w-7xl mx-auto px-4 pb-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[f," results found",f!==(a==null?void 0:a.totalDPPs)&&` (filtered from ${a==null?void 0:a.totalDPPs})`]}),p>1&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>u(v=>Math.max(1,v-1)),disabled:h===1,className:"px-3 py-1 border border-gray-300 dark:border-gray-600 rounded hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-900 dark:text-white disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Previous"}),s.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Page ",h," of ",p]}),s.jsx("button",{onClick:()=>u(v=>Math.min(p,v+1)),disabled:h===p,className:"px-3 py-1 border border-gray-300 dark:border-gray-600 rounded hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-900 dark:text-white disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Next"})]})]}),o?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 dark:border-blue-400"})}):r.length===0?s.jsxs("div",{className:"text-center py-12 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 transition-colors",children:[s.jsx(Re,{className:"w-16 h-16 mx-auto text-gray-400 dark:text-gray-600 mb-4"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"No DPPs found"}),s.jsx("button",{onClick:m,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg",children:"Generate test data"})]}):s.jsx("div",{className:c==="grid"?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4":"space-y-2",children:r.map(v=>s.jsx(Gb,{dpp:v,onClick:()=>t(v.did),viewMode:c},v.id))})]}),s.jsx("div",{className:"max-w-7xl mx-auto px-4 pb-6",children:s.jsx("button",{onClick:x,className:"text-sm text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300 underline",children:"Clear all data (debug)"})})]})}async function dN(t){console.log("getDPPWithRelations called for:",t);const e=await te.getDPPByDID(t);if(!e)return console.error("DPP not found:",t),null;console.log("Found DPP:",e);const r=await te.getDIDDocumentByDID(t),n=await te.getRelationshipsByParent(t),a=await te.getCredentialsByDPPId(e.id),i=await te.getAttestationsByDID(t),o=await te.getAnchoringEventsByDID(t),l=await te.getSpecificationsByDPPId(e.id);console.log("Specifications found:",l);let c=null;if(e.type==="component"){const h=await te.getRelationshipsByChild(t);if(h.length>0){const u=await te.getDPPByDID(h[0].parent_did);u&&(c={did:u.did,model:u.model})}}const d=[];for(const h of n){const u=await te.getDPPByDID(h.child_did);if(u){const f=await te.getDIDDocumentByDID(h.child_did);d.push({dpp:u,didDocument:f,relationship:h})}}return{dpp:e,didDocument:r,parent:c,relationships:n,children:d,credentials:a,attestations:i,anchoringEvents:o,specifications:l,events:i}}async function YS(t,e){return te.updateDPP(t,e)}async function uN(t){var u,f;const e=await te.getDPPById(t);if(!e)return null;const r=await te.getRelationshipsByParent(e.did),n=await te.getCredentialsByDPPId(t),a=await te.getAttestationsByDID(e.did),i=await te.getAnchoringEventsByDID(e.did),o=await te.getSpecificationsByDPPId(t);let l=0,c=0,d=0,h=0;for(const g of o)if(g.spec_type==="sustainability"&&g.spec_data){const b=g.spec_data;(u=b.carbonFootprint)!=null&&u.total&&(l+=parseFloat(b.carbonFootprint.total)||0),b.recycledContent&&(c+=parseFloat(b.recycledContent)||0),b.recyclability&&(d+=parseFloat(b.recyclability)||0),h++}for(const g of r){const b=await te.getDPPByDID(g.child_did);if(b){const y=await te.getSpecificationsByDPPId(b.id);for(const k of y)if(k.spec_type==="sustainability"&&k.spec_data){const m=k.spec_data;(f=m.carbonFootprint)!=null&&f.total&&(l+=parseFloat(m.carbonFootprint.total)||0),m.recycledContent&&(c+=parseFloat(m.recycledContent)||0),m.recyclability&&(d+=parseFloat(m.recyclability)||0),h++}}}return{componentCount:r.length,credentialCount:n.length,attestationCount:a.length,anchoringCount:i.length,verifiedCredentials:n.filter(g=>g.verification_status==="valid").length,aggregatedSustainability:{totalCO2Footprint:l,avgRecycledContent:h>0?c/h:0,avgRecyclability:h>0?d/h:0}}}const qS=Object.freeze(Object.defineProperty({__proto__:null,getAggregatedMetrics:uN,getDPPWithRelations:dN,updateDPP:YS},Symbol.toStringTag,{value:"Module"}));async function ZS(t){const e=[],r=await Pe.getDPPByDID(t);if(!r)return{valid:!1,issues:["Main DPP not found"]};r.type!=="main"&&e.push("DPP is not a main type");const n=await Pe.getRelationshipsByParent(t);for(const a of n){const i=await Pe.getDPPByDID(a.child_did);i?i.type!=="component"&&e.push(`Child ${a.child_did} is not a component type`):e.push(`Child DPP ${a.child_did} not found`)}return{valid:e.length===0,issues:e}}async function XS(t){let e=0,r=0,n=0,a=0,i=await te.getDPPById(t);if(i||(i=(await Pe.getDPPs()).find(f=>f.id===t)),!i)return{score:0,breakdown:{}};let o=await te.getDIDDocumentByDID(i.did);o||(o=await Pe.getDIDDocumentByDID(i.did)),o&&o.verification_method&&Array.isArray(o.verification_method)&&o.verification_method.length>0&&(e=25);let l=await te.getAnchoringEventsByDID(i.did);(!l||l.length===0)&&(l=await Pe.getAnchoringEventsByDID(i.did)),l&&l.length>0&&(r=25);let c=await te.getCredentialsByDPPId(t);(!c||c.length===0)&&(c=await Pe.getCredentialsByDPP(t));const d=c.filter(u=>u.verification_status==="valid");if(d&&d.length>0&&(n=Math.min(25,d.length*8)),i.type==="main"){const u=await ZS(i.did);u.valid?a=25:a=Math.max(0,25-u.issues.length*5)}else a=i.parent_did?25:0;return{score:e+r+n+a,breakdown:{didResolution:e,anchoring:r,credentials:n,hierarchy:a}}}function e6(t){var a,i,o,l,c;const e=((a=t.metadata)==null?void 0:a.batch)||"B2024-001",r=((o=(i=t.metadata)==null?void 0:i.dimensions)==null?void 0:o.width)||1200,n=((c=(l=t.metadata)==null?void 0:l.dimensions)==null?void 0:c.height)||1400;return{dopNumber:`DoP-WIN-${Date.now().toString().slice(-8)}`,issueDate:new Date(t.created_at).toISOString().split("T")[0],manufacturer:{name:"Advanced Window Systems B.V.",address:"123 Industry Street, 1234 AB Amsterdam, Netherlands",contactInfo:"info@advancedwindows.nl | +31 20 1234567"},productType:"Aluminium-frame insulated window with double glazing",productIdentification:{productCode:t.model,batchNumber:e,serialNumber:`${e}-${Math.floor(Math.random()*1e4)}`},intendedUse:"External window for residential and commercial buildings",harmonizedStandard:"EN 14351-1:2006+A2:2016",notifiedBody:{name:"European Testing Institute",number:"0123",certification:"System 3"},declaredPerformance:[{characteristic:"Fire Resistance",performance:"E 30",harmonizedStandard:"EN 13501-2",classification:"Class E",testMethod:"EN 1634-1"},{characteristic:"Thermal Transmittance (U-value)",performance:"1.2",unit:"W/(mK)",harmonizedStandard:"EN ISO 10077-1",testMethod:"EN 12412-2"},{characteristic:"Sound Reduction Index",performance:"34",unit:"dB (Rw)",harmonizedStandard:"EN ISO 717-1",classification:"Class 3",testMethod:"EN ISO 10140-2"},{characteristic:"Water Tightness",performance:"9A",harmonizedStandard:"EN 12208",classification:"Class 9A",testMethod:"EN 1027"},{characteristic:"Air Permeability",performance:"4",unit:"m/(hm) at 100 Pa",harmonizedStandard:"EN 12207",classification:"Class 4",testMethod:"EN 1026"},{characteristic:"Wind Load Resistance",performance:"C4",harmonizedStandard:"EN 12210",classification:"Class C4",testMethod:"EN 12211"},{characteristic:"Operating Force",performance:"< 65 N",unit:"N (Newton)",harmonizedStandard:"EN 13115",testMethod:"EN 12046-2"},{characteristic:"Mechanical Strength",performance:"Passed",harmonizedStandard:"EN 14351-1",testMethod:"EN 107, EN 948, EN 949"},{characteristic:"Load-bearing Capacity",performance:`${Math.floor(r*n/1e3)} kg`,harmonizedStandard:"EN 14351-1"},{characteristic:"Resistance to Repeated Opening/Closing",performance:"20,000 cycles",harmonizedStandard:"EN 14351-1",testMethod:"EN 1191"}],ceMarking:{issued:!0,year:new Date(t.created_at).getFullYear()},signature:{signedBy:"Jan Jansen",position:"Quality Manager",date:new Date(t.created_at).toISOString().split("T")[0]}}}function t6(t){var n,a;const e=((n=t.metadata)==null?void 0:n.batch)||"G2024-001",r=((a=t.metadata)==null?void 0:a.thickness)||24;return{dopNumber:`DoP-GLS-${Date.now().toString().slice(-8)}`,issueDate:new Date(t.created_at).toISOString().split("T")[0],manufacturer:{name:"Premium Glass Manufacturing B.V.",address:"456 Glass Avenue, 5678 CD Rotterdam, Netherlands",contactInfo:"info@premiumglass.nl | +31 10 9876543"},productType:"Double glazed insulating glass unit",productIdentification:{productCode:t.model,batchNumber:e,serialNumber:`${e}-${Math.floor(Math.random()*1e4)}`},intendedUse:"Insulating glass unit for windows and facades",harmonizedStandard:"EN 1279-5:2018",notifiedBody:{name:"Glass Testing Laboratory Europe",number:"0456",certification:"System 1"},declaredPerformance:[{characteristic:"Fire Resistance",performance:"E 30",harmonizedStandard:"EN 13501-2",classification:"Class E",testMethod:"EN 1364-1"},{characteristic:"Thermal Transmittance (Ug-value)",performance:"1.1",unit:"W/(mK)",harmonizedStandard:"EN 673",testMethod:"EN 674"},{characteristic:"Light Transmittance",performance:"78",unit:"%",harmonizedStandard:"EN 410"},{characteristic:"Solar Factor (g-value)",performance:"0.58",harmonizedStandard:"EN 410"},{characteristic:"Sound Reduction Index",performance:"32",unit:"dB (Rw)",harmonizedStandard:"EN ISO 717-1",classification:"Class 3",testMethod:"EN ISO 10140-2"},{characteristic:"Impact Resistance",performance:"1B1",harmonizedStandard:"EN 356",classification:"Class 1B1",testMethod:"EN 356"},{characteristic:"Gas Fill",performance:"90% Argon",harmonizedStandard:"EN 1279-3"},{characteristic:"Spacer Type",performance:"Thermally improved",harmonizedStandard:"EN 1279-2"},{characteristic:"Edge Seal Durability",performance:"Passed",harmonizedStandard:"EN 1279-2",testMethod:"EN 1279-2 (Climate cycling)"},{characteristic:"Thickness",performance:`${r}`,unit:"mm",harmonizedStandard:"EN 1279-1"}],ceMarking:{issued:!0,year:new Date(t.created_at).getFullYear()},signature:{signedBy:"Maria van den Berg",position:"Technical Director",date:new Date(t.created_at).toISOString().split("T")[0]}}}function r6(t){var n,a;const e=((n=t.metadata)==null?void 0:n.batch)||"F2024-001",r=((a=t.metadata)==null?void 0:a.material)||"Aluminum";return{dopNumber:`DoP-FRM-${Date.now().toString().slice(-8)}`,issueDate:new Date(t.created_at).toISOString().split("T")[0],manufacturer:{name:"Precision Frame Systems B.V.",address:"789 Metal Street, 9012 EF Utrecht, Netherlands",contactInfo:"info@precisionframes.nl | +31 30 5551234"},productType:`${r} window frame profile system`,productIdentification:{productCode:t.model,batchNumber:e,serialNumber:`${e}-${Math.floor(Math.random()*1e4)}`},intendedUse:"Window frame for external windows in residential and commercial buildings",harmonizedStandard:"EN 14351-1:2006+A2:2016",notifiedBody:{name:"Metal Testing Institute Europe",number:"0789",certification:"System 3"},declaredPerformance:[{characteristic:"Fire Resistance",performance:"A2-s1, d0",harmonizedStandard:"EN 13501-1",classification:"Class A2",testMethod:"EN 13823"},{characteristic:"Thermal Transmittance (Uf-value)",performance:"1.4",unit:"W/(mK)",harmonizedStandard:"EN ISO 10077-2",testMethod:"EN ISO 12412-2"},{characteristic:"Corrosion Resistance",performance:"Class 5",harmonizedStandard:"EN 12373-1",classification:"Class 5 (Very high)",testMethod:"EN 12373-1"},{characteristic:"Surface Quality",performance:"Class 1",harmonizedStandard:"EN 12373-1",classification:"Class 1 (High quality)"},{characteristic:"Mechanical Strength",performance:"Passed",harmonizedStandard:"EN 14351-1",testMethod:"EN 107, EN 948"},{characteristic:"Profile Wall Thickness",performance:"1.8",unit:"mm",harmonizedStandard:"EN 755-9"},{characteristic:"Thermal Break",performance:"Polyamide PA 6.6",harmonizedStandard:"EN 14024"},{characteristic:"Water Drainage",performance:"Multi-chamber system",harmonizedStandard:"EN 14351-1"},{characteristic:"Chemical Resistance",performance:"Passed",harmonizedStandard:"EN 12373-1",testMethod:"EN 1670"},{characteristic:"UV Resistance",performance:"No degradation after 2000h",harmonizedStandard:"EN 12373-1",testMethod:"EN ISO 4892-2"}],ceMarking:{issued:!0,year:new Date(t.created_at).getFullYear()},signature:{signedBy:"Peter de Vries",position:"Production Manager",date:new Date(t.created_at).toISOString().split("T")[0]}}}function fy(t){var e;return(e=t.metadata)!=null&&e.declarationOfPerformance?t.metadata.declarationOfPerformance:n6(t)}function n6(t){const e=t.model.toLowerCase();return t.type==="main"||e.includes("window")?e6(t):e.includes("glass")?t6(t):e.includes("frame")?r6(t):null}var Hc={},s6=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},hN={},hr={};let Ng;const a6=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];hr.getSymbolSize=function(e){if(!e)throw new Error('"version" cannot be null or undefined');if(e<1||e>40)throw new Error('"version" should be in range from 1 to 40');return e*4+17};hr.getSymbolTotalCodewords=function(e){return a6[e]};hr.getBCHDigit=function(t){let e=0;for(;t!==0;)e++,t>>>=1;return e};hr.setToSJISFunction=function(e){if(typeof e!="function")throw new Error('"toSJISFunc" is not a valid function.');Ng=e};hr.isKanjiModeEnabled=function(){return typeof Ng<"u"};hr.toSJIS=function(e){return Ng(e)};var fh={};(function(t){t.L={bit:1},t.M={bit:0},t.Q={bit:3},t.H={bit:2};function e(r){if(typeof r!="string")throw new Error("Param is not a string");switch(r.toLowerCase()){case"l":case"low":return t.L;case"m":case"medium":return t.M;case"q":case"quartile":return t.Q;case"h":case"high":return t.H;default:throw new Error("Unknown EC Level: "+r)}}t.isValid=function(n){return n&&typeof n.bit<"u"&&n.bit>=0&&n.bit<4},t.from=function(n,a){if(t.isValid(n))return n;try{return e(n)}catch{return a}}})(fh);function fN(){this.buffer=[],this.length=0}fN.prototype={get:function(t){const e=Math.floor(t/8);return(this.buffer[e]>>>7-t%8&1)===1},put:function(t,e){for(let r=0;r<e;r++)this.putBit((t>>>e-r-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(t){const e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}};var i6=fN;function Vc(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new Uint8Array(t*t),this.reservedBit=new Uint8Array(t*t)}Vc.prototype.set=function(t,e,r,n){const a=t*this.size+e;this.data[a]=r,n&&(this.reservedBit[a]=!0)};Vc.prototype.get=function(t,e){return this.data[t*this.size+e]};Vc.prototype.xor=function(t,e,r){this.data[t*this.size+e]^=r};Vc.prototype.isReserved=function(t,e){return this.reservedBit[t*this.size+e]};var o6=Vc,mN={};(function(t){const e=hr.getSymbolSize;t.getRowColCoords=function(n){if(n===1)return[];const a=Math.floor(n/7)+2,i=e(n),o=i===145?26:Math.ceil((i-13)/(2*a-2))*2,l=[i-7];for(let c=1;c<a-1;c++)l[c]=l[c-1]-o;return l.push(6),l.reverse()},t.getPositions=function(n){const a=[],i=t.getRowColCoords(n),o=i.length;for(let l=0;l<o;l++)for(let c=0;c<o;c++)l===0&&c===0||l===0&&c===o-1||l===o-1&&c===0||a.push([i[l],i[c]]);return a}})(mN);var gN={};const l6=hr.getSymbolSize,my=7;gN.getPositions=function(e){const r=l6(e);return[[0,0],[r-my,0],[0,r-my]]};var pN={};(function(t){t.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const e={N1:3,N2:3,N3:40,N4:10};t.isValid=function(a){return a!=null&&a!==""&&!isNaN(a)&&a>=0&&a<=7},t.from=function(a){return t.isValid(a)?parseInt(a,10):void 0},t.getPenaltyN1=function(a){const i=a.size;let o=0,l=0,c=0,d=null,h=null;for(let u=0;u<i;u++){l=c=0,d=h=null;for(let f=0;f<i;f++){let g=a.get(u,f);g===d?l++:(l>=5&&(o+=e.N1+(l-5)),d=g,l=1),g=a.get(f,u),g===h?c++:(c>=5&&(o+=e.N1+(c-5)),h=g,c=1)}l>=5&&(o+=e.N1+(l-5)),c>=5&&(o+=e.N1+(c-5))}return o},t.getPenaltyN2=function(a){const i=a.size;let o=0;for(let l=0;l<i-1;l++)for(let c=0;c<i-1;c++){const d=a.get(l,c)+a.get(l,c+1)+a.get(l+1,c)+a.get(l+1,c+1);(d===4||d===0)&&o++}return o*e.N2},t.getPenaltyN3=function(a){const i=a.size;let o=0,l=0,c=0;for(let d=0;d<i;d++){l=c=0;for(let h=0;h<i;h++)l=l<<1&2047|a.get(d,h),h>=10&&(l===1488||l===93)&&o++,c=c<<1&2047|a.get(h,d),h>=10&&(c===1488||c===93)&&o++}return o*e.N3},t.getPenaltyN4=function(a){let i=0;const o=a.data.length;for(let c=0;c<o;c++)i+=a.data[c];return Math.abs(Math.ceil(i*100/o/5)-10)*e.N4};function r(n,a,i){switch(n){case t.Patterns.PATTERN000:return(a+i)%2===0;case t.Patterns.PATTERN001:return a%2===0;case t.Patterns.PATTERN010:return i%3===0;case t.Patterns.PATTERN011:return(a+i)%3===0;case t.Patterns.PATTERN100:return(Math.floor(a/2)+Math.floor(i/3))%2===0;case t.Patterns.PATTERN101:return a*i%2+a*i%3===0;case t.Patterns.PATTERN110:return(a*i%2+a*i%3)%2===0;case t.Patterns.PATTERN111:return(a*i%3+(a+i)%2)%2===0;default:throw new Error("bad maskPattern:"+n)}}t.applyMask=function(a,i){const o=i.size;for(let l=0;l<o;l++)for(let c=0;c<o;c++)i.isReserved(c,l)||i.xor(c,l,r(a,c,l))},t.getBestMask=function(a,i){const o=Object.keys(t.Patterns).length;let l=0,c=1/0;for(let d=0;d<o;d++){i(d),t.applyMask(d,a);const h=t.getPenaltyN1(a)+t.getPenaltyN2(a)+t.getPenaltyN3(a)+t.getPenaltyN4(a);t.applyMask(d,a),h<c&&(c=h,l=d)}return l}})(pN);var mh={};const Fs=fh,pd=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],xd=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];mh.getBlocksCount=function(e,r){switch(r){case Fs.L:return pd[(e-1)*4+0];case Fs.M:return pd[(e-1)*4+1];case Fs.Q:return pd[(e-1)*4+2];case Fs.H:return pd[(e-1)*4+3];default:return}};mh.getTotalCodewordsCount=function(e,r){switch(r){case Fs.L:return xd[(e-1)*4+0];case Fs.M:return xd[(e-1)*4+1];case Fs.Q:return xd[(e-1)*4+2];case Fs.H:return xd[(e-1)*4+3];default:return}};var xN={},gh={};const Ol=new Uint8Array(512),Eu=new Uint8Array(256);(function(){let e=1;for(let r=0;r<255;r++)Ol[r]=e,Eu[e]=r,e<<=1,e&256&&(e^=285);for(let r=255;r<512;r++)Ol[r]=Ol[r-255]})();gh.log=function(e){if(e<1)throw new Error("log("+e+")");return Eu[e]};gh.exp=function(e){return Ol[e]};gh.mul=function(e,r){return e===0||r===0?0:Ol[Eu[e]+Eu[r]]};(function(t){const e=gh;t.mul=function(n,a){const i=new Uint8Array(n.length+a.length-1);for(let o=0;o<n.length;o++)for(let l=0;l<a.length;l++)i[o+l]^=e.mul(n[o],a[l]);return i},t.mod=function(n,a){let i=new Uint8Array(n);for(;i.length-a.length>=0;){const o=i[0];for(let c=0;c<a.length;c++)i[c]^=e.mul(a[c],o);let l=0;for(;l<i.length&&i[l]===0;)l++;i=i.slice(l)}return i},t.generateECPolynomial=function(n){let a=new Uint8Array([1]);for(let i=0;i<n;i++)a=t.mul(a,new Uint8Array([1,e.exp(i)]));return a}})(xN);const yN=xN;function kg(t){this.genPoly=void 0,this.degree=t,this.degree&&this.initialize(this.degree)}kg.prototype.initialize=function(e){this.degree=e,this.genPoly=yN.generateECPolynomial(this.degree)};kg.prototype.encode=function(e){if(!this.genPoly)throw new Error("Encoder not initialized");const r=new Uint8Array(e.length+this.degree);r.set(e);const n=yN.mod(r,this.genPoly),a=this.degree-n.length;if(a>0){const i=new Uint8Array(this.degree);return i.set(n,a),i}return n};var c6=kg,wN={},sa={},jg={};jg.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40};var vn={};const bN="[0-9]+",d6="[A-Z $%*+\\-./:]+";let gc="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";gc=gc.replace(/u/g,"\\u");const u6="(?:(?![A-Z0-9 $%*+\\-./:]|"+gc+`)(?:.|[\r
]))+`;vn.KANJI=new RegExp(gc,"g");vn.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");vn.BYTE=new RegExp(u6,"g");vn.NUMERIC=new RegExp(bN,"g");vn.ALPHANUMERIC=new RegExp(d6,"g");const h6=new RegExp("^"+gc+"$"),f6=new RegExp("^"+bN+"$"),m6=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");vn.testKanji=function(e){return h6.test(e)};vn.testNumeric=function(e){return f6.test(e)};vn.testAlphanumeric=function(e){return m6.test(e)};(function(t){const e=jg,r=vn;t.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},t.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},t.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},t.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},t.MIXED={bit:-1},t.getCharCountIndicator=function(i,o){if(!i.ccBits)throw new Error("Invalid mode: "+i);if(!e.isValid(o))throw new Error("Invalid version: "+o);return o>=1&&o<10?i.ccBits[0]:o<27?i.ccBits[1]:i.ccBits[2]},t.getBestModeForData=function(i){return r.testNumeric(i)?t.NUMERIC:r.testAlphanumeric(i)?t.ALPHANUMERIC:r.testKanji(i)?t.KANJI:t.BYTE},t.toString=function(i){if(i&&i.id)return i.id;throw new Error("Invalid mode")},t.isValid=function(i){return i&&i.bit&&i.ccBits};function n(a){if(typeof a!="string")throw new Error("Param is not a string");switch(a.toLowerCase()){case"numeric":return t.NUMERIC;case"alphanumeric":return t.ALPHANUMERIC;case"kanji":return t.KANJI;case"byte":return t.BYTE;default:throw new Error("Unknown mode: "+a)}}t.from=function(i,o){if(t.isValid(i))return i;try{return n(i)}catch{return o}}})(sa);(function(t){const e=hr,r=mh,n=fh,a=sa,i=jg,o=7973,l=e.getBCHDigit(o);function c(f,g,b){for(let y=1;y<=40;y++)if(g<=t.getCapacity(y,b,f))return y}function d(f,g){return a.getCharCountIndicator(f,g)+4}function h(f,g){let b=0;return f.forEach(function(y){const k=d(y.mode,g);b+=k+y.getBitsLength()}),b}function u(f,g){for(let b=1;b<=40;b++)if(h(f,b)<=t.getCapacity(b,g,a.MIXED))return b}t.from=function(g,b){return i.isValid(g)?parseInt(g,10):b},t.getCapacity=function(g,b,y){if(!i.isValid(g))throw new Error("Invalid QR Code version");typeof y>"u"&&(y=a.BYTE);const k=e.getSymbolTotalCodewords(g),m=r.getTotalCodewordsCount(g,b),x=(k-m)*8;if(y===a.MIXED)return x;const p=x-d(y,g);switch(y){case a.NUMERIC:return Math.floor(p/10*3);case a.ALPHANUMERIC:return Math.floor(p/11*2);case a.KANJI:return Math.floor(p/13);case a.BYTE:default:return Math.floor(p/8)}},t.getBestVersionForData=function(g,b){let y;const k=n.from(b,n.M);if(Array.isArray(g)){if(g.length>1)return u(g,k);if(g.length===0)return 1;y=g[0]}else y=g;return c(y.mode,y.getLength(),k)},t.getEncodedBits=function(g){if(!i.isValid(g)||g<7)throw new Error("Invalid QR Code version");let b=g<<12;for(;e.getBCHDigit(b)-l>=0;)b^=o<<e.getBCHDigit(b)-l;return g<<12|b}})(wN);var vN={};const J0=hr,NN=1335,g6=21522,gy=J0.getBCHDigit(NN);vN.getEncodedBits=function(e,r){const n=e.bit<<3|r;let a=n<<10;for(;J0.getBCHDigit(a)-gy>=0;)a^=NN<<J0.getBCHDigit(a)-gy;return(n<<10|a)^g6};var kN={};const p6=sa;function Vo(t){this.mode=p6.NUMERIC,this.data=t.toString()}Vo.getBitsLength=function(e){return 10*Math.floor(e/3)+(e%3?e%3*3+1:0)};Vo.prototype.getLength=function(){return this.data.length};Vo.prototype.getBitsLength=function(){return Vo.getBitsLength(this.data.length)};Vo.prototype.write=function(e){let r,n,a;for(r=0;r+3<=this.data.length;r+=3)n=this.data.substr(r,3),a=parseInt(n,10),e.put(a,10);const i=this.data.length-r;i>0&&(n=this.data.substr(r),a=parseInt(n,10),e.put(a,i*3+1))};var x6=Vo;const y6=sa,hf=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function Go(t){this.mode=y6.ALPHANUMERIC,this.data=t}Go.getBitsLength=function(e){return 11*Math.floor(e/2)+6*(e%2)};Go.prototype.getLength=function(){return this.data.length};Go.prototype.getBitsLength=function(){return Go.getBitsLength(this.data.length)};Go.prototype.write=function(e){let r;for(r=0;r+2<=this.data.length;r+=2){let n=hf.indexOf(this.data[r])*45;n+=hf.indexOf(this.data[r+1]),e.put(n,11)}this.data.length%2&&e.put(hf.indexOf(this.data[r]),6)};var w6=Go;const b6=sa;function $o(t){this.mode=b6.BYTE,typeof t=="string"?this.data=new TextEncoder().encode(t):this.data=new Uint8Array(t)}$o.getBitsLength=function(e){return e*8};$o.prototype.getLength=function(){return this.data.length};$o.prototype.getBitsLength=function(){return $o.getBitsLength(this.data.length)};$o.prototype.write=function(t){for(let e=0,r=this.data.length;e<r;e++)t.put(this.data[e],8)};var v6=$o;const N6=sa,k6=hr;function Qo(t){this.mode=N6.KANJI,this.data=t}Qo.getBitsLength=function(e){return e*13};Qo.prototype.getLength=function(){return this.data.length};Qo.prototype.getBitsLength=function(){return Qo.getBitsLength(this.data.length)};Qo.prototype.write=function(t){let e;for(e=0;e<this.data.length;e++){let r=k6.toSJIS(this.data[e]);if(r>=33088&&r<=40956)r-=33088;else if(r>=57408&&r<=60351)r-=49472;else throw new Error("Invalid SJIS character: "+this.data[e]+`
Make sure your charset is UTF-8`);r=(r>>>8&255)*192+(r&255),t.put(r,13)}};var j6=Qo,jN={exports:{}};(function(t){var e={single_source_shortest_paths:function(r,n,a){var i={},o={};o[n]=0;var l=e.PriorityQueue.make();l.push(n,0);for(var c,d,h,u,f,g,b,y,k;!l.empty();){c=l.pop(),d=c.value,u=c.cost,f=r[d]||{};for(h in f)f.hasOwnProperty(h)&&(g=f[h],b=u+g,y=o[h],k=typeof o[h]>"u",(k||y>b)&&(o[h]=b,l.push(h,b),i[h]=d))}if(typeof a<"u"&&typeof o[a]>"u"){var m=["Could not find a path from ",n," to ",a,"."].join("");throw new Error(m)}return i},extract_shortest_path_from_predecessor_list:function(r,n){for(var a=[],i=n;i;)a.push(i),r[i],i=r[i];return a.reverse(),a},find_path:function(r,n,a){var i=e.single_source_shortest_paths(r,n,a);return e.extract_shortest_path_from_predecessor_list(i,a)},PriorityQueue:{make:function(r){var n=e.PriorityQueue,a={},i;r=r||{};for(i in n)n.hasOwnProperty(i)&&(a[i]=n[i]);return a.queue=[],a.sorter=r.sorter||n.default_sorter,a},default_sorter:function(r,n){return r.cost-n.cost},push:function(r,n){var a={value:r,cost:n};this.queue.push(a),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};t.exports=e})(jN);var A6=jN.exports;(function(t){const e=sa,r=x6,n=w6,a=v6,i=j6,o=vn,l=hr,c=A6;function d(m){return unescape(encodeURIComponent(m)).length}function h(m,x,p){const v=[];let N;for(;(N=m.exec(p))!==null;)v.push({data:N[0],index:N.index,mode:x,length:N[0].length});return v}function u(m){const x=h(o.NUMERIC,e.NUMERIC,m),p=h(o.ALPHANUMERIC,e.ALPHANUMERIC,m);let v,N;return l.isKanjiModeEnabled()?(v=h(o.BYTE,e.BYTE,m),N=h(o.KANJI,e.KANJI,m)):(v=h(o.BYTE_KANJI,e.BYTE,m),N=[]),x.concat(p,v,N).sort(function(D,E){return D.index-E.index}).map(function(D){return{data:D.data,mode:D.mode,length:D.length}})}function f(m,x){switch(x){case e.NUMERIC:return r.getBitsLength(m);case e.ALPHANUMERIC:return n.getBitsLength(m);case e.KANJI:return i.getBitsLength(m);case e.BYTE:return a.getBitsLength(m)}}function g(m){return m.reduce(function(x,p){const v=x.length-1>=0?x[x.length-1]:null;return v&&v.mode===p.mode?(x[x.length-1].data+=p.data,x):(x.push(p),x)},[])}function b(m){const x=[];for(let p=0;p<m.length;p++){const v=m[p];switch(v.mode){case e.NUMERIC:x.push([v,{data:v.data,mode:e.ALPHANUMERIC,length:v.length},{data:v.data,mode:e.BYTE,length:v.length}]);break;case e.ALPHANUMERIC:x.push([v,{data:v.data,mode:e.BYTE,length:v.length}]);break;case e.KANJI:x.push([v,{data:v.data,mode:e.BYTE,length:d(v.data)}]);break;case e.BYTE:x.push([{data:v.data,mode:e.BYTE,length:d(v.data)}])}}return x}function y(m,x){const p={},v={start:{}};let N=["start"];for(let A=0;A<m.length;A++){const D=m[A],E=[];for(let L=0;L<D.length;L++){const C=D[L],O=""+A+L;E.push(O),p[O]={node:C,lastCount:0},v[O]={};for(let V=0;V<N.length;V++){const M=N[V];p[M]&&p[M].node.mode===C.mode?(v[M][O]=f(p[M].lastCount+C.length,C.mode)-f(p[M].lastCount,C.mode),p[M].lastCount+=C.length):(p[M]&&(p[M].lastCount=C.length),v[M][O]=f(C.length,C.mode)+4+e.getCharCountIndicator(C.mode,x))}}N=E}for(let A=0;A<N.length;A++)v[N[A]].end=0;return{map:v,table:p}}function k(m,x){let p;const v=e.getBestModeForData(m);if(p=e.from(x,v),p!==e.BYTE&&p.bit<v.bit)throw new Error('"'+m+'" cannot be encoded with mode '+e.toString(p)+`.
 Suggested mode is: `+e.toString(v));switch(p===e.KANJI&&!l.isKanjiModeEnabled()&&(p=e.BYTE),p){case e.NUMERIC:return new r(m);case e.ALPHANUMERIC:return new n(m);case e.KANJI:return new i(m);case e.BYTE:return new a(m)}}t.fromArray=function(x){return x.reduce(function(p,v){return typeof v=="string"?p.push(k(v,null)):v.data&&p.push(k(v.data,v.mode)),p},[])},t.fromString=function(x,p){const v=u(x,l.isKanjiModeEnabled()),N=b(v),A=y(N,p),D=c.find_path(A.map,"start","end"),E=[];for(let L=1;L<D.length-1;L++)E.push(A.table[D[L]].node);return t.fromArray(g(E))},t.rawSplit=function(x){return t.fromArray(u(x,l.isKanjiModeEnabled()))}})(kN);const ph=hr,ff=fh,E6=i6,S6=o6,C6=mN,D6=gN,Y0=pN,q0=mh,P6=c6,Su=wN,I6=vN,T6=sa,mf=kN;function _6(t,e){const r=t.size,n=D6.getPositions(e);for(let a=0;a<n.length;a++){const i=n[a][0],o=n[a][1];for(let l=-1;l<=7;l++)if(!(i+l<=-1||r<=i+l))for(let c=-1;c<=7;c++)o+c<=-1||r<=o+c||(l>=0&&l<=6&&(c===0||c===6)||c>=0&&c<=6&&(l===0||l===6)||l>=2&&l<=4&&c>=2&&c<=4?t.set(i+l,o+c,!0,!0):t.set(i+l,o+c,!1,!0))}}function B6(t){const e=t.size;for(let r=8;r<e-8;r++){const n=r%2===0;t.set(r,6,n,!0),t.set(6,r,n,!0)}}function R6(t,e){const r=C6.getPositions(e);for(let n=0;n<r.length;n++){const a=r[n][0],i=r[n][1];for(let o=-2;o<=2;o++)for(let l=-2;l<=2;l++)o===-2||o===2||l===-2||l===2||o===0&&l===0?t.set(a+o,i+l,!0,!0):t.set(a+o,i+l,!1,!0)}}function O6(t,e){const r=t.size,n=Su.getEncodedBits(e);let a,i,o;for(let l=0;l<18;l++)a=Math.floor(l/3),i=l%3+r-8-3,o=(n>>l&1)===1,t.set(a,i,o,!0),t.set(i,a,o,!0)}function gf(t,e,r){const n=t.size,a=I6.getEncodedBits(e,r);let i,o;for(i=0;i<15;i++)o=(a>>i&1)===1,i<6?t.set(i,8,o,!0):i<8?t.set(i+1,8,o,!0):t.set(n-15+i,8,o,!0),i<8?t.set(8,n-i-1,o,!0):i<9?t.set(8,15-i-1+1,o,!0):t.set(8,15-i-1,o,!0);t.set(n-8,8,1,!0)}function M6(t,e){const r=t.size;let n=-1,a=r-1,i=7,o=0;for(let l=r-1;l>0;l-=2)for(l===6&&l--;;){for(let c=0;c<2;c++)if(!t.isReserved(a,l-c)){let d=!1;o<e.length&&(d=(e[o]>>>i&1)===1),t.set(a,l-c,d),i--,i===-1&&(o++,i=7)}if(a+=n,a<0||r<=a){a-=n,n=-n;break}}}function L6(t,e,r){const n=new E6;r.forEach(function(c){n.put(c.mode.bit,4),n.put(c.getLength(),T6.getCharCountIndicator(c.mode,t)),c.write(n)});const a=ph.getSymbolTotalCodewords(t),i=q0.getTotalCodewordsCount(t,e),o=(a-i)*8;for(n.getLengthInBits()+4<=o&&n.put(0,4);n.getLengthInBits()%8!==0;)n.putBit(0);const l=(o-n.getLengthInBits())/8;for(let c=0;c<l;c++)n.put(c%2?17:236,8);return F6(n,t,e)}function F6(t,e,r){const n=ph.getSymbolTotalCodewords(e),a=q0.getTotalCodewordsCount(e,r),i=n-a,o=q0.getBlocksCount(e,r),l=n%o,c=o-l,d=Math.floor(n/o),h=Math.floor(i/o),u=h+1,f=d-h,g=new P6(f);let b=0;const y=new Array(o),k=new Array(o);let m=0;const x=new Uint8Array(t.buffer);for(let D=0;D<o;D++){const E=D<c?h:u;y[D]=x.slice(b,b+E),k[D]=g.encode(y[D]),b+=E,m=Math.max(m,E)}const p=new Uint8Array(n);let v=0,N,A;for(N=0;N<m;N++)for(A=0;A<o;A++)N<y[A].length&&(p[v++]=y[A][N]);for(N=0;N<f;N++)for(A=0;A<o;A++)p[v++]=k[A][N];return p}function U6(t,e,r,n){let a;if(Array.isArray(t))a=mf.fromArray(t);else if(typeof t=="string"){let d=e;if(!d){const h=mf.rawSplit(t);d=Su.getBestVersionForData(h,r)}a=mf.fromString(t,d||40)}else throw new Error("Invalid data");const i=Su.getBestVersionForData(a,r);if(!i)throw new Error("The amount of data is too big to be stored in a QR Code");if(!e)e=i;else if(e<i)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+i+`.
`);const o=L6(e,r,a),l=ph.getSymbolSize(e),c=new S6(l);return _6(c,e),B6(c),R6(c,e),gf(c,r,0),e>=7&&O6(c,e),M6(c,o),isNaN(n)&&(n=Y0.getBestMask(c,gf.bind(null,c,r))),Y0.applyMask(n,c),gf(c,r,n),{modules:c,version:e,errorCorrectionLevel:r,maskPattern:n,segments:a}}hN.create=function(e,r){if(typeof e>"u"||e==="")throw new Error("No input text");let n=ff.M,a,i;return typeof r<"u"&&(n=ff.from(r.errorCorrectionLevel,ff.M),a=Su.from(r.version),i=Y0.from(r.maskPattern),r.toSJISFunc&&ph.setToSJISFunction(r.toSJISFunc)),U6(e,a,n,i)};var AN={},Ag={};(function(t){function e(r){if(typeof r=="number"&&(r=r.toString()),typeof r!="string")throw new Error("Color should be defined as hex string");let n=r.slice().replace("#","").split("");if(n.length<3||n.length===5||n.length>8)throw new Error("Invalid hex color: "+r);(n.length===3||n.length===4)&&(n=Array.prototype.concat.apply([],n.map(function(i){return[i,i]}))),n.length===6&&n.push("F","F");const a=parseInt(n.join(""),16);return{r:a>>24&255,g:a>>16&255,b:a>>8&255,a:a&255,hex:"#"+n.slice(0,6).join("")}}t.getOptions=function(n){n||(n={}),n.color||(n.color={});const a=typeof n.margin>"u"||n.margin===null||n.margin<0?4:n.margin,i=n.width&&n.width>=21?n.width:void 0,o=n.scale||4;return{width:i,scale:i?4:o,margin:a,color:{dark:e(n.color.dark||"#000000ff"),light:e(n.color.light||"#ffffffff")},type:n.type,rendererOpts:n.rendererOpts||{}}},t.getScale=function(n,a){return a.width&&a.width>=n+a.margin*2?a.width/(n+a.margin*2):a.scale},t.getImageWidth=function(n,a){const i=t.getScale(n,a);return Math.floor((n+a.margin*2)*i)},t.qrToImageData=function(n,a,i){const o=a.modules.size,l=a.modules.data,c=t.getScale(o,i),d=Math.floor((o+i.margin*2)*c),h=i.margin*c,u=[i.color.light,i.color.dark];for(let f=0;f<d;f++)for(let g=0;g<d;g++){let b=(f*d+g)*4,y=i.color.light;if(f>=h&&g>=h&&f<d-h&&g<d-h){const k=Math.floor((f-h)/c),m=Math.floor((g-h)/c);y=u[l[k*o+m]?1:0]}n[b++]=y.r,n[b++]=y.g,n[b++]=y.b,n[b]=y.a}}})(Ag);(function(t){const e=Ag;function r(a,i,o){a.clearRect(0,0,i.width,i.height),i.style||(i.style={}),i.height=o,i.width=o,i.style.height=o+"px",i.style.width=o+"px"}function n(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}t.render=function(i,o,l){let c=l,d=o;typeof c>"u"&&(!o||!o.getContext)&&(c=o,o=void 0),o||(d=n()),c=e.getOptions(c);const h=e.getImageWidth(i.modules.size,c),u=d.getContext("2d"),f=u.createImageData(h,h);return e.qrToImageData(f.data,i,c),r(u,d,h),u.putImageData(f,0,0),d},t.renderToDataURL=function(i,o,l){let c=l;typeof c>"u"&&(!o||!o.getContext)&&(c=o,o=void 0),c||(c={});const d=t.render(i,o,c),h=c.type||"image/png",u=c.rendererOpts||{};return d.toDataURL(h,u.quality)}})(AN);var EN={};const z6=Ag;function py(t,e){const r=t.a/255,n=e+'="'+t.hex+'"';return r<1?n+" "+e+'-opacity="'+r.toFixed(2).slice(1)+'"':n}function pf(t,e,r){let n=t+e;return typeof r<"u"&&(n+=" "+r),n}function H6(t,e,r){let n="",a=0,i=!1,o=0;for(let l=0;l<t.length;l++){const c=Math.floor(l%e),d=Math.floor(l/e);!c&&!i&&(i=!0),t[l]?(o++,l>0&&c>0&&t[l-1]||(n+=i?pf("M",c+r,.5+d+r):pf("m",a,0),a=0,i=!1),c+1<e&&t[l+1]||(n+=pf("h",o),o=0)):a++}return n}EN.render=function(e,r,n){const a=z6.getOptions(r),i=e.modules.size,o=e.modules.data,l=i+a.margin*2,c=a.color.light.a?"<path "+py(a.color.light,"fill")+' d="M0 0h'+l+"v"+l+'H0z"/>':"",d="<path "+py(a.color.dark,"stroke")+' d="'+H6(o,i,a.margin)+'"/>',h='viewBox="0 0 '+l+" "+l+'"',f='<svg xmlns="http://www.w3.org/2000/svg" '+(a.width?'width="'+a.width+'" height="'+a.width+'" ':"")+h+' shape-rendering="crispEdges">'+c+d+`</svg>
`;return typeof n=="function"&&n(null,f),f};const V6=s6,Z0=hN,SN=AN,G6=EN;function Eg(t,e,r,n,a){const i=[].slice.call(arguments,1),o=i.length,l=typeof i[o-1]=="function";if(!l&&!V6())throw new Error("Callback required as last argument");if(l){if(o<2)throw new Error("Too few arguments provided");o===2?(a=r,r=e,e=n=void 0):o===3&&(e.getContext&&typeof a>"u"?(a=n,n=void 0):(a=n,n=r,r=e,e=void 0))}else{if(o<1)throw new Error("Too few arguments provided");return o===1?(r=e,e=n=void 0):o===2&&!e.getContext&&(n=r,r=e,e=void 0),new Promise(function(c,d){try{const h=Z0.create(r,n);c(t(h,e,n))}catch(h){d(h)}})}try{const c=Z0.create(r,n);a(null,t(c,e,n))}catch(c){a(c)}}Hc.create=Z0.create;Hc.toCanvas=Eg.bind(null,SN.render);Hc.toDataURL=Eg.bind(null,SN.renderToDataURL);Hc.toString=Eg.bind(null,function(t,e,r){return G6.render(t,r)});function $6(t){return{did:t,url:`https://example.com/dpp/${encodeURIComponent(t)}`,type:"DPP"}}function Q6({did:t,onClose:e}){const r=_.useRef(null);_.useEffect(()=>{n()},[t]);async function n(){if(!r.current)return;const a=$6(t),i=JSON.stringify(a);try{await Hc.toCanvas(r.current,i,{width:300,margin:2,color:{dark:"#000000",light:"#ffffff"}})}catch(o){console.error("Error generating QR code:",o)}}return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"QR Code"}),s.jsx("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(Pr,{className:"w-5 h-5"})})]}),s.jsx("div",{className:"flex justify-center mb-4",children:s.jsx("canvas",{ref:r,className:"border border-gray-200 rounded-lg"})}),s.jsxs("div",{className:"text-sm text-gray-600",children:[s.jsx("p",{className:"font-medium mb-2",children:"DID:"}),s.jsx("p",{className:"font-mono text-xs break-all bg-gray-50 p-2 rounded",children:t})]})]})})}function W6({did:t,openEventId:e}){const[r,n]=_.useState([]),[a,i]=_.useState(!0),[o,l]=_.useState(null),[c,d]=_.useState(""),[h,u]=_.useState("all");_.useEffect(()=>{console.log("DIDEventsLog: useEffect triggered, loading events..."),f()},[t]),_.useEffect(()=>{e&&(console.log("DIDEventsLog: openEventId received:",e),l(e),setTimeout(()=>{const y=document.getElementById(`event-${e}`);y&&y.scrollIntoView({behavior:"smooth",block:"center"})},100))},[e]);async function f(){console.log("DIDEventsLog: Loading events for DID:",t),i(!0);const y=[],k=await _e.getDPPByDID(t);if(console.log("DIDEventsLog: DPP found:",k),!k){console.warn("DIDEventsLog: No DPP found for DID:",t),i(!1);return}y.push({id:`creation-${k.id}`,timestamp:k.created_at,type:"creation",did:k.did,description:"DPP Created",details:{type:k.type,model:k.model,owner:k.owner},icon:qo,color:"blue"});const m=await _e.getAnchoringEventsByDID(t);console.log("DIDEventsLog: Anchoring events found:",m.length),m.forEach(v=>{var N;y.push({id:`anchor-${v.id}`,timestamp:v.timestamp,type:"anchoring",did:v.did,description:`Anchored to DLT (${v.anchor_type})`,details:{transactionHash:v.transaction_hash,blockNumber:v.block_number,merkleRoot:v.merkle_root,network:((N=v.metadata)==null?void 0:N.network)||"ethereum"},icon:Jm,color:"purple"})});const x=await _e.getAttestationsByDID(t);console.log("DIDEventsLog: Attestations found:",x.length,x),x.forEach(v=>{var M,ie;const A=["did_creation","key_rotation","ownership_change","did_update","did_lifecycle_update"].includes(v.attestation_type);if(A&&v.approval_status==="pending"||A&&v.approval_status==="rejected")return;const E=["assembly","installation","maintenance","disposal","manufacturing"].includes(v.attestation_type),L=((M=v.attestation_data)==null?void 0:M.timestamp)||v.timestamp;let C="",O="attestation",V="green";A?(C={did_creation:"DID Created & Registered",key_rotation:"Cryptographic Key Rotated",ownership_change:"Ownership Transferred",did_update:"DID Document Updated",did_lifecycle_update:"DID Lifecycle Stage Change"}[v.attestation_type]||v.attestation_type,V="green"):E?(C=`Product Lifecycle: ${v.attestation_type.charAt(0).toUpperCase()+v.attestation_type.slice(1)}`,O="update",V="blue"):C=`Event: ${v.attestation_type.replace(/_/g," ")}`,y.push({id:`attestation-${v.id}`,timestamp:L,type:O,did:v.did,description:C,details:{witness:v.witness_did,eventType:((ie=v.attestation_data)==null?void 0:ie.eventType)||v.attestation_type,data:v.attestation_data,signature:v.signature,isDIDEvent:A,isLifecycleEvent:E},icon:Mt,color:V})});const p=await enhancedDB.getDIDDocumentByDID(t);p&&y.push({id:`verification-${p.id}`,timestamp:p.created_at,type:"verification",did:p.did,description:"DID Document Verified",details:{controller:p.controller,verificationMethods:p.verification_method.length,proof:p.proof},icon:Il,color:"emerald"}),console.log("DIDEventsLog: Total events collected:",y.length),y.sort((v,N)=>new Date(v.timestamp).getTime()-new Date(N.timestamp).getTime()),n(y),i(!1)}const b=r.filter(y=>{const k=c===""||y.description.toLowerCase().includes(c.toLowerCase())||y.did.toLowerCase().includes(c.toLowerCase()),m=h==="all"||y.type===h;return k&&m});return a?s.jsx("div",{className:"flex items-center justify-center p-8",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6 transition-colors",children:[s.jsx("div",{className:"flex items-center justify-between mb-4",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Wr,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Event Timeline"}),s.jsxs("span",{className:"ml-2 text-sm text-gray-500 dark:text-gray-400",children:[b.length," events"]})]})}),s.jsxs("div",{className:"flex gap-3 mb-4",children:[s.jsxs("div",{className:"flex-1 relative",children:[s.jsx(Sr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Search events...",value:c,onChange:y=>d(y.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),s.jsxs("div",{className:"relative",children:[s.jsx(Bc,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsxs("select",{value:h,onChange:y=>u(y.target.value),className:"pl-10 pr-8 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 appearance-none bg-white dark:bg-gray-700 cursor-pointer text-gray-900 dark:text-white",children:[s.jsx("option",{value:"all",children:"All Types"}),s.jsx("option",{value:"creation",children:"Creation"}),s.jsx("option",{value:"update",children:"Updates"}),s.jsx("option",{value:"attestation",children:"Attestations"}),s.jsx("option",{value:"anchoring",children:"Anchoring"}),s.jsx("option",{value:"verification",children:"Verification"})]})]})]}),s.jsx("div",{className:"space-y-4",children:b.length===0?s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(Gr,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),"No events found for this DID"]}):s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2 h-full w-1 bg-gradient-to-b from-blue-200 via-purple-200 to-green-200"}),s.jsx("div",{className:"space-y-8",children:b.map((y,k)=>{const m=y.icon,x={blue:"bg-blue-500 border-blue-200",purple:"bg-purple-500 border-purple-200",green:"bg-green-500 border-green-200",emerald:"bg-emerald-500 border-emerald-200"}[y.color],p=k%2===0;return s.jsxs("div",{id:`event-${y.id}`,className:`flex items-center ${p?"flex-row":"flex-row-reverse"}`,children:[s.jsx("div",{className:`w-5/12 ${p?"pr-8 text-right":"pl-8 text-left"}`,children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md border-2 border-gray-200 dark:border-gray-700 p-4 hover:shadow-lg transition-all cursor-pointer",onClick:()=>l(o===y.id?null:y.id),children:[s.jsxs("div",{className:`flex items-start gap-3 ${p?"flex-row-reverse":"flex-row"}`,children:[s.jsx("div",{className:`flex-shrink-0 w-10 h-10 rounded-full ${x} flex items-center justify-center shadow-md border-4 border-white`,children:s.jsx(m,{className:"w-5 h-5 text-white"})}),s.jsxs("div",{className:"flex-grow min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white text-sm mb-1",children:y.description.trim()}),o===y.id?s.jsx(Pt,{className:"w-4 h-4 text-gray-400"}):s.jsx(lt,{className:"w-4 h-4 text-gray-400"})]}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-2",children:new Date(y.timestamp).toLocaleString()}),s.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 font-mono break-all",children:y.did})]})]}),o!==y.id&&s.jsxs("div",{className:"mt-3 text-xs text-gray-700 dark:text-gray-300",children:[y.type==="creation"&&s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Type:"})," ",y.details.type,"  ",s.jsx("span",{className:"font-medium",children:"Model:"})," ",y.details.model]}),y.type==="anchoring"&&s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Network:"})," ",y.details.network,"  ",s.jsx("span",{className:"font-medium",children:"Block:"})," ",y.details.blockNumber]}),y.type==="attestation"&&s.jsxs("div",{children:[s.jsxs("p",{className:"mb-1",children:[s.jsx("span",{className:"font-medium",children:"Witness Node:"})," ",y.details.witness.split(":").pop()]}),y.details.isDIDEvent&&s.jsx("div",{className:"mt-2 px-2 py-1 bg-green-50 border border-green-200 rounded text-green-800 font-medium",children:" DID Event - Monitored by Witnesses"})]}),y.type==="update"&&y.details.isLifecycleEvent&&s.jsx("div",{children:s.jsx("div",{className:"mt-2 px-2 py-1 bg-blue-50 border border-blue-200 rounded text-blue-800 text-xs",children:"Product Lifecycle Event (not a DID event)"})}),y.type==="verification"&&s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Verification Methods:"})," ",y.details.verificationMethods]})]}),o===y.id&&s.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[s.jsx("div",{className:"text-xs font-semibold text-gray-600 dark:text-gray-400 mb-2",children:"Full Event Details:"}),s.jsx("div",{className:"space-y-2 text-xs",children:Object.entries(y.details).filter(([v])=>y.type==="update"&&y.details.isLifecycleEvent?!["witness","isDIDEvent","isLifecycleEvent","signature"].includes(v):!["isDIDEvent","isLifecycleEvent"].includes(v)).map(([v,N])=>s.jsxs("div",{className:"flex justify-between items-start gap-2",children:[s.jsxs("span",{className:"text-gray-600 dark:text-gray-400 font-medium capitalize min-w-fit",children:[v.replace(/([A-Z])/g," $1").trim(),":"]}),s.jsx("span",{className:"text-gray-900 dark:text-white font-mono break-all text-right",children:typeof N=="object"?JSON.stringify(N,null,2):String(N)})]},v))}),s.jsx("div",{className:"mt-3 pt-3 border-t border-gray-100",children:s.jsx("p",{className:"text-xs text-gray-500 italic",children:"Click to collapse details"})})]})]})}),s.jsx("div",{className:"w-2/12 flex justify-center relative z-10",children:s.jsx("div",{className:`w-6 h-6 rounded-full ${x} border-4 border-white shadow-lg`})}),s.jsx("div",{className:"w-5/12"})]},y.id)})})]})})]})}function oi({field:t,label:e,value:r,children:n}){const{canSeeField:a}=Xt();return a(t)?n?s.jsx(s.Fragment,{children:n}):s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-gray-600",children:e}),s.jsx("div",{className:"text-sm text-gray-900",children:r})]}):s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-gray-600",children:e}),s.jsxs("div",{className:"text-sm text-gray-400 flex items-center gap-1",children:[s.jsx(Mb,{className:"w-3 h-3"}),s.jsx("span",{className:"italic",children:"Hidden - Insufficient permissions"})]})]})}function K6({metadata:t,fieldMapping:e={}}){const{canSeeField:r,currentRole:n}=Xt(),a={description:"basic",dimensions:"basic",width:"basic",height:"basic",unit:"basic",weight:"materials",thickness:"materials",uValue:"operations",material:"materials",finish:"manufacturing",productionDate:"operations",batch:"manufacturing",...e},i=Object.entries(t).filter(([o])=>o!=="image_url");return s.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Metadata"}),s.jsxs("div",{className:"text-xs px-2 py-1 bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded",children:["Viewing as: ",n]})]}),s.jsx("div",{className:"text-sm text-gray-900 dark:text-white space-y-1",children:i.map(([o,l])=>{const c=a[o]||"basic",d=r(c);let h;if(typeof l=="object"&&l!==null)if(o==="dimensions"&&"width"in l&&"height"in l){const u=l.unit||"mm";h=`${l.width} ${u} x ${l.height} ${u}`}else"width"in l&&"height"in l&&"unit"in l?h=`${l.width} ${l.unit} x ${l.height} ${l.unit}`:h=JSON.stringify(l);else h=String(l);return s.jsxs("div",{className:"flex justify-between",children:[s.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[o,":"]}),d?s.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:h}):s.jsxs("span",{className:"text-gray-400 flex items-center gap-1 italic",children:[s.jsx(Mb,{className:"w-3 h-3"}),"Hidden"]})]},o)})})]})}function J6({dpp:t,events:e}){var g,b,y,k,m,x,p,v,N,A,D,E,L;const[r,n]=_.useState(null),a=t.lifecycle_status==="disposed"||t.lifecycle_status==="end_of_life",i=()=>{if(a)return 5;let C=0;return t.created_at&&C++,e.some(O=>O.event_type==="assembly")&&C++,e.some(O=>O.event_type==="installation")&&C++,e.some(O=>O.event_type==="maintenance")&&C++,C},l=a?"end-of-life":e.some(C=>C.event_type==="maintenance")?"maintenance":e.some(C=>C.event_type==="installation")?"installation":e.some(C=>C.event_type==="assembly")?"assembly":"manufacturing",c=[{id:"manufacturing",title:"Manufacturing",description:"Components produced and DID created",status:"completed",icon:Re,didEvents:["DID Created","DID Document Registered","Components Linked"],timestamp:t.created_at,owner:t.owner,custodian:void 0,details:{manufacturer:t.owner,productionDate:(g=t.metadata)==null?void 0:g.productionDate,batch:(b=t.metadata)==null?void 0:b.batch,model:t.model,owner:t.owner}},{id:"assembly",title:"Assembly",description:"Window assembled from components",status:a?"completed":l==="manufacturing"?"current":"completed",icon:hu,didEvents:["Assembly Verified","Quality Check","Witness Attestation"],timestamp:((y=e.find(C=>C.event_type==="assembly"))==null?void 0:y.timestamp)||t.created_at,owner:t.owner,custodian:void 0,details:{assembledBy:t.owner,dimensions:(k=t.metadata)==null?void 0:k.dimensions,weight:(m=t.metadata)==null?void 0:m.weight,owner:t.owner}},{id:"installation",title:"Installation",description:"Window installed at location",status:a?"completed":l==="manufacturing"||l==="assembly"?"future":l==="installation"?"current":"completed",icon:mj,didEvents:["Location Updated","Custodian Changed","Installation Verified"],timestamp:(x=e.find(C=>C.event_type==="installation"))==null?void 0:x.timestamp,owner:t.owner,custodian:t.custodian||"Building Owner",details:e.find(C=>C.event_type==="installation")?{location:"Building Site",installer:t.custodian||t.owner,installDate:(p=e.find(C=>C.event_type==="installation"))==null?void 0:p.timestamp,owner:t.owner,custodian:t.custodian||"Building Owner",ownershipNote:"Ownership remains with manufacturer, custody transfers to building"}:void 0},{id:"maintenance",title:"Operation & Maintenance",description:"Active use with maintenance tracking",status:a?"completed":l==="maintenance"?"current":l==="installation"||l==="manufacturing"||l==="assembly"?"future":"current",icon:hu,didEvents:["Maintenance Logged","Performance Monitored","Updates Recorded"],timestamp:(v=e.find(C=>C.event_type==="maintenance"))==null?void 0:v.timestamp,owner:t.owner,custodian:t.custodian||"Building Owner",details:{maintenanceCount:e.filter(C=>C.event_type==="maintenance").length,lastCheck:(N=e.filter(C=>C.event_type==="maintenance").slice(-1)[0])==null?void 0:N.timestamp,status:t.lifecycle_status,owner:t.owner,custodian:t.custodian||"Building Owner"}},{id:"end-of-life",title:"End of Life & Recycling",description:"Decommissioning and material recovery",status:a?"completed":"future",icon:rc,didEvents:["Decommission Recorded","Materials Catalogued","Recycling Verified"],timestamp:a?t.updated_at:void 0,owner:t.owner,custodian:"Recycling Facility",details:a?{decommissionDate:t.updated_at,materials:{glass:((D=(A=t.metadata)==null?void 0:A.glass)==null?void 0:D.material)||"Glass",frame:((L=(E=t.metadata)==null?void 0:E.frame)==null?void 0:L.material)||"Aluminum"},recyclability:"95%",owner:t.owner,finalCustodian:"Recycling Facility"}:void 0}],d=(C,O)=>{switch(C){case"completed":return s.jsx(fe,{className:"w-6 h-6 text-green-600"});case"current":return s.jsxs("div",{className:"relative",children:[s.jsx(O,{className:"w-6 h-6 text-blue-600"}),s.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-blue-600 rounded-full animate-pulse"})]});default:return s.jsx(lj,{className:"w-6 h-6 text-gray-300"})}},h=i(),u=5,f=h/u*100;return s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6 transition-colors",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[s.jsx(Re,{className:"w-5 h-5 text-blue-600"}),"Window Lifecycle & DID Integration"]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:[h," of ",u," phases completed"]}),s.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:[f.toFixed(0),"% Complete"]})]})]}),s.jsx("div",{className:"mb-6",children:s.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3 overflow-hidden",children:s.jsx("div",{className:"h-full bg-gradient-to-r from-green-500 to-blue-600 transition-all duration-500 rounded-full",style:{width:`${f}%`}})})}),s.jsx("div",{className:"space-y-4",children:c.map((C,O)=>{var V;return s.jsxs("div",{className:"relative",children:[O<c.length-1&&s.jsx("div",{className:`absolute left-3 top-12 bottom-0 w-0.5 ${C.status==="completed"?"bg-green-600":C.status==="current"?"bg-blue-600":"bg-gray-200"}`}),s.jsxs("div",{className:`relative flex items-start gap-4 p-4 rounded-lg cursor-pointer transition-colors ${r===C.id?"bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-700":C.status==="current"?"bg-blue-50 dark:bg-blue-900/30":C.status==="future"?"opacity-60 hover:opacity-80":"hover:bg-gray-50 dark:hover:bg-gray-700/30"} ${C.status==="future"?"border border-dashed border-gray-300 dark:border-gray-600":""}`,onClick:()=>n(r===C.id?null:C.id),children:[s.jsx("div",{className:"relative z-10 bg-white dark:bg-gray-800 rounded-full p-1",children:d(C.status,C.icon)}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:C.title}),C.status==="current"&&s.jsx("span",{className:"px-2 py-0.5 bg-blue-600 text-white text-xs rounded-full",children:"Current"}),C.status==="future"&&s.jsx("span",{className:"px-2 py-0.5 bg-gray-300 text-gray-600 text-xs rounded-full",children:"Upcoming"}),C.status==="completed"&&s.jsx("span",{className:"px-2 py-0.5 bg-green-100 text-green-700 text-xs rounded-full",children:" Completed"})]}),C.timestamp&&s.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:new Date(C.timestamp).toLocaleDateString()})]}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:C.description}),C.owner&&s.jsxs("div",{className:"mt-3 flex items-center gap-4 text-xs",children:[s.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-blue-50 dark:bg-blue-900/30 rounded border border-blue-200 dark:border-blue-700",children:[s.jsx(Qp,{className:"w-3 h-3 text-blue-600 dark:text-blue-400"}),s.jsx("span",{className:"text-blue-700 dark:text-blue-400 font-medium",children:"Owner:"}),s.jsx("span",{className:"text-blue-900 dark:text-blue-300 font-mono",children:C.owner.split(":").pop()})]}),C.custodian&&s.jsxs(s.Fragment,{children:[s.jsx(_b,{className:"w-3 h-3 text-gray-400"}),s.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-green-50 dark:bg-green-900/30 rounded border border-green-200 dark:border-green-700",children:[s.jsx(Qp,{className:"w-3 h-3 text-green-600 dark:text-green-400"}),s.jsx("span",{className:"text-green-700 dark:text-green-400 font-medium",children:"Custodian:"}),s.jsx("span",{className:"text-green-900 dark:text-green-300 font-mono",children:C.custodian.split(":").pop()})]})]})]}),s.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:(V=C.didEvents)==null?void 0:V.map(M=>s.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${C.status==="completed"?"bg-green-50 text-green-700":C.status==="current"?"bg-blue-50 text-blue-700":"bg-gray-50 text-gray-500"}`,children:M},M))}),r===C.id&&C.details&&s.jsxs("div",{className:"mt-4 p-3 bg-white dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600",children:[s.jsx("div",{className:"text-xs font-semibold text-gray-600 dark:text-gray-400 mb-2",children:"Stage Details:"}),s.jsx("div",{className:"space-y-1",children:Object.entries(C.details).map(([M,ie])=>s.jsxs("div",{className:"flex justify-between text-xs",children:[s.jsxs("span",{className:"text-gray-600 dark:text-gray-400 capitalize",children:[M.replace(/([A-Z])/g," $1").trim(),":"]}),s.jsx("span",{className:"font-mono text-gray-900 dark:text-white ml-2 break-all max-w-xs text-right",children:typeof ie=="object"?JSON.stringify(ie):String(ie)})]},M))})]})]}),s.jsx(Zn,{className:`w-4 h-4 text-gray-400 transition-transform ${r===C.id?"rotate-90":""}`})]})]},C.id)})}),s.jsx("div",{className:"mt-6 p-4 bg-gradient-to-r from-blue-50 to-green-50 dark:from-blue-900/30 dark:to-green-900/30 rounded-lg border border-blue-200 dark:border-blue-700",children:s.jsxs("p",{className:"text-sm text-gray-800 dark:text-gray-200 space-y-2",children:[s.jsxs("span",{className:"block",children:[s.jsx("strong",{children:"Lifecycle Status:"})," ",t.lifecycle_status.toUpperCase()]}),s.jsxs("span",{className:"block",children:[s.jsx("strong",{children:"Current Owner:"})," ",s.jsx("span",{className:"font-mono text-blue-700 dark:text-blue-400",children:t.owner.split(":").pop()}),t.custodian&&s.jsxs(s.Fragment,{children:["  ",s.jsx("strong",{children:"Custodian:"})," ",s.jsx("span",{className:"font-mono text-green-700 dark:text-green-400",children:t.custodian.split(":").pop()})]})]}),s.jsxs("span",{className:"block text-xs text-gray-600 dark:text-gray-400 mt-2",children:[s.jsx("strong",{children:"DID Integration:"})," Each lifecycle stage is tracked and verified through the DID system. Ownership and custody transfers are recorded as immutable events on the blockchain."]})]})})]})}function Y6({dppId:t,did:e,onEventCreated:r}){const[n,a]=_.useState(!1),[i,o]=_.useState("maintenance"),[l,c]=_.useState(""),[d,h]=_.useState(!1),u=async()=>{if(!l.trim()){alert("Please enter event details");return}h(!0);try{console.log("LifecycleControls: Creating event...",{dppId:t,did:e,eventType:i,eventDetails:l}),await KS(t,e,i,{description:l,performedBy:"Current User",location:"On-site"}),console.log("LifecycleControls: Event created successfully, calling onEventCreated callback"),alert("Event added successfully!"),c(""),a(!1),r==null||r(),console.log("LifecycleControls: onEventCreated callback completed")}catch(f){console.error("Failed to create event:",f),alert("Error adding event")}finally{h(!1)}};return s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 mb-4 transition-colors",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("h4",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Add New Event"}),s.jsx("button",{onClick:()=>a(!n),className:"px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 text-sm",disabled:d,children:n?"Cancel":"+ Add Event"})]}),n&&s.jsxs("div",{className:"space-y-3 bg-gray-50 dark:bg-gray-700 p-4 rounded mt-3 transition-colors",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Event Type"}),s.jsxs("select",{value:i,onChange:f=>o(f.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-600 text-gray-900 dark:text-white",children:[s.jsx("option",{value:"assembly",children:"Assembly"}),s.jsx("option",{value:"installation",children:"Installation"}),s.jsx("option",{value:"maintenance",children:"Maintenance"}),s.jsx("option",{value:"disposal",children:"Disposal"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Details"}),s.jsx("textarea",{value:l,onChange:f=>c(f.target.value),placeholder:"Describe what happened...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-600 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-400",rows:3})]}),s.jsx("button",{onClick:u,disabled:d||!l.trim(),className:"w-full px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:bg-gray-400 dark:disabled:bg-gray-600 disabled:cursor-not-allowed",children:d?"Adding...":"Add Event"})]})]})}async function q6(t,e,r){try{const n=await te.getDPPById(t);if(!n)return{success:!1,message:"DPP not found"};if(n.owner!==e)return{success:!1,message:"Only the current owner can transfer ownership"};const a=await te.updateDPP(t,{metadata:{...n.metadata,pendingOwnershipTransfer:{from:e,to:r,requestedAt:new Date().toISOString()}}});await Pe.updateDPP(t,{metadata:{...n.metadata,pendingOwnershipTransfer:{from:e,to:r,requestedAt:new Date().toISOString()}}});const i={dpp_id:t,did:n.did,witness_did:"did:webvh:example.com:witnesses:did-validator-1",attestation_type:"ownership_change",attestation_data:{timestamp:new Date().toISOString(),witness:"DID Validator Node 1",organization:"Decentralized Identity Network",eventType:"Ownership Transfer",previousOwner:e,newOwner:r,transferMethod:"Direct Transfer",transferApproved:!0},signature:`pending-${Date.now()}`,approval_status:"pending"};return await te.insertAttestation(i),await Pe.insertAttestation(i),{success:!0,message:"Ownership transfer request submitted. Awaiting witness approval.",dpp:a}}catch(n){return console.error("Error transferring ownership:",n),{success:!1,message:"Failed to transfer ownership"}}}async function Z6(t,e){try{const r=await te.getDPPById(t);if(!r)return{success:!1,message:"DPP not found"};if(r.owner!==e)return{success:!1,message:"Only the owner can rotate keys"};const n=await te.getDIDDocumentByDID(r.did);if(!n)return{success:!1,message:"DID document not found"};const a=n.verification_method.length,i=`${r.did}#key-${a+1}`,o=`${r.did}#key-${a}`,l={dpp_id:t,did:r.did,witness_did:"did:webvh:example.com:witnesses:did-validator-2",attestation_type:"key_rotation",attestation_data:{timestamp:new Date().toISOString(),witness:"DID Validator Node 2",organization:"Identity Trust Consortium",eventType:"Key Rotation",oldKeyId:o,newKeyId:i,rotationReason:"Manual key rotation by owner",previousKeyRevoked:!0,newKeyType:"Ed25519VerificationKey2020"},signature:`pending-${Date.now()}`,approval_status:"pending"};return await te.insertAttestation(l),await Pe.insertAttestation(l),{success:!0,message:"Key rotation request submitted. Awaiting witness approval.",newKeyId:i}}catch(r){return console.error("Error rotating key:",r),{success:!1,message:"Failed to rotate key"}}}async function pc(t){try{const e=await te.getDPPById(t);if(!e)return{success:!1,message:"DPP not found",operations:[]};const r=await te.getAttestationsByDID(e.did);console.log("getDIDOperationsHistory: raw attestations count",r.length),console.log("getDIDOperationsHistory: attestations preview",r.map(a=>({id:a.id,type:a.attestation_type,approval_status:a.approval_status,signature:a.signature,timestamp:a.timestamp})));const n=r.filter(a=>{const i=["ownership_change","key_rotation","did_update","did_creation"].includes(a.attestation_type);if(a.approval_status==="rejected")return!1;const o=a.approval_status==="approved"||!a.approval_status&&a.signature&&!a.signature.startsWith("pending-")&&!a.signature.startsWith("witness-reject-");return i&&o});return n.sort((a,i)=>new Date(i.timestamp).getTime()-new Date(a.timestamp).getTime()),console.log("getDIDOperationsHistory: filtered DID operations count",n.length),console.log("getDIDOperationsHistory: operations preview",n.map(a=>({id:a.id,type:a.attestation_type,approval_status:a.approval_status,timestamp:a.timestamp}))),{success:!0,operations:n}}catch(e){return console.error("Error getting DID operations history:",e),{success:!1,message:"Failed to get DID operations history",operations:[]}}}async function X6(t){try{const e=await te.getDPPByDID(t);if(!e)return{pending:[],rejected:[]};const r=await te.getAttestationsByDID(e.did),n=r.filter(i=>i.approval_status==="pending"),a=r.filter(i=>i.approval_status==="rejected");return console.log("getPendingAndRejectedOperations:",{did:e.did,pending:n,rejected:a}),{pending:n,rejected:a}}catch(e){return console.error("Error getting pending/rejected operations:",e),{pending:[],rejected:[]}}}function e5({dpp:t,onUpdate:e}){const{currentRoleDID:r}=Xt(),[n,a]=_.useState([]),[i,o]=_.useState(()=>{const O=localStorage.getItem(`pending_op_${t.did}`);return O?JSON.parse(O):null}),[l,c]=_.useState(()=>{const O=localStorage.getItem(`approved_op_${t.did}`);return O?JSON.parse(O):null}),[d,h]=_.useState(()=>{const O=localStorage.getItem(`rejected_op_${t.did}`);return O?JSON.parse(O):null}),[u,f]=_.useState(!0),[g,b]=_.useState(!1),[y,k]=_.useState(""),[m,x]=_.useState(null),[p,v]=_.useState(new Set),N=r===t.owner;_.useEffect(()=>{i?localStorage.setItem(`pending_op_${t.did}`,JSON.stringify(i)):localStorage.removeItem(`pending_op_${t.did}`)},[i,t.did]),_.useEffect(()=>{l?localStorage.setItem(`approved_op_${t.did}`,JSON.stringify(l)):localStorage.removeItem(`approved_op_${t.did}`)},[l,t.did]),_.useEffect(()=>{d?localStorage.setItem(`rejected_op_${t.did}`,JSON.stringify(d)):localStorage.removeItem(`rejected_op_${t.did}`)},[d,t.did]),_.useEffect(()=>{(async()=>{f(!0);const V=await pc(t.id);V.success&&a(V.operations),f(!1)})()},[t.id]),_.useEffect(()=>{if(!i)return;const O=setInterval(async()=>{const V=await X6(t.did);if(console.log(" Polling status:",{dppDid:t.did,currentPendingType:i.type,rejectedCount:V.rejected.length,rejectedItems:V.rejected.map(M=>({type:M.attestation_type,approval_status:M.approval_status,id:M.id})),pendingCount:V.pending.length}),V.rejected.length>0)if(V.rejected.find(ie=>{const z=ie.attestation_type,Y=z===i.type;return console.log(" Checking rejection match:",{attestationType:z,currentPendingType:i.type,matches:Y}),Y})){console.log(" Operation rejected, switching to red"),localStorage.removeItem(`pending_op_${t.did}`),localStorage.setItem(`rejected_op_${t.did}`,JSON.stringify(i)),o(null),h(i),e();return}else console.log(" No matching rejected operation found");if(V.pending.length===0&&V.rejected.length===0){const M=await pc(t.id);M.success&&M.operations.some(z=>{const Y=z.attestation_type;return(Y===i.type||Y==="ownership_change"&&i.type==="ownership_change"||Y==="key_rotation"&&i.type==="key_rotation")&&z.approval_status==="approved"})&&(console.log("Operation approved, switching to green"),localStorage.removeItem(`pending_op_${t.did}`),localStorage.setItem(`approved_op_${t.did}`,JSON.stringify(i)),o(null),c(i),a(M.operations),e())}},2e3);return()=>clearInterval(O)},[i,t.id,e]);const A=async()=>{if(!y.trim()){x({type:"error",text:"Please enter a valid DID"});return}const O=await q6(t.id,r,y);if(O.success){x(null),k(""),b(!1),localStorage.removeItem(`approved_op_${t.did}`),localStorage.removeItem(`rejected_op_${t.did}`),c(null),h(null);const V={type:"ownership_change",details:{from:r,to:y,timestamp:new Date().toISOString()}};localStorage.setItem(`pending_op_${t.did}`,JSON.stringify(V)),o(V)}else x({type:"error",text:O.message})},D=async()=>{if(!confirm("Are you sure you want to rotate the cryptographic key? This will invalidate the previous key."))return;const O=await Z6(t.id,r);if(O.success){x(null),localStorage.removeItem(`approved_op_${t.did}`),localStorage.removeItem(`rejected_op_${t.did}`),c(null),h(null);const V={type:"key_rotation",details:{owner:r,timestamp:new Date().toISOString()}};localStorage.setItem(`pending_op_${t.did}`,JSON.stringify(V)),o(V)}else x({type:"error",text:O.message})},E=O=>{const V=new Set(p);V.has(O)?V.delete(O):V.add(O),v(V)},L=O=>({label:{did_creation:"DID Creation",key_rotation:"Key Rotation",ownership_change:"Ownership Transfer",did_update:"DID Update"}[O.attestation_type]||O.attestation_type,icon:O.attestation_type==="did_creation"?"":O.attestation_type==="key_rotation"?"":O.attestation_type==="ownership_change"?"":""}),C=O=>{const V=O.attestation_data,M=[];return O.attestation_type==="ownership_change"?(V.newOwner&&M.push({label:"New Owner",value:V.newOwner}),V.previousOwner&&M.push({label:"Previous Owner",value:V.previousOwner})):O.attestation_type==="key_rotation"?(V.newKeyId&&M.push({label:"New Key",value:V.newKeyId}),V.oldKeyId&&M.push({label:"Old Key",value:V.oldKeyId}),V.rotationReason&&M.push({label:"Reason",value:V.rotationReason})):O.attestation_type==="did_update"?(V.updateType&&M.push({label:"Update Type",value:V.updateType}),V.updatedFields&&M.push({label:"Fields",value:V.updatedFields.join(", ")})):O.attestation_type==="did_creation"&&(V.controller&&M.push({label:"Controller",value:V.controller}),V.initialOwner&&M.push({label:"Initial Owner",value:V.initialOwner})),V.witness&&M.push({label:"Witness",value:V.witness}),V.organization&&M.push({label:"Organization",value:V.organization}),M};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow border border-gray-200 dark:border-gray-700 p-6 transition-colors",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-800 dark:text-white mb-4",children:"DID Information"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"DID:"}),s.jsx("p",{className:"text-sm font-mono bg-gray-50 dark:bg-gray-700 px-3 py-2 rounded mt-1 break-all text-gray-900 dark:text-white",children:t.did})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Current Owner:"}),s.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[s.jsx("p",{className:"text-sm font-mono bg-gray-50 dark:bg-gray-700 px-3 py-2 rounded flex-1 break-all text-gray-900 dark:text-white",children:t.owner}),N&&s.jsx("span",{className:"text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full font-semibold whitespace-nowrap",children:"You"})]})]})]}),N&&s.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3",children:"Owner Actions"}),s.jsxs("div",{className:"flex gap-3",children:[s.jsxs("button",{onClick:D,className:"flex items-center gap-2 px-4 py-2 bg-orange-600 text-white rounded-md hover:bg-orange-700 transition-colors font-medium",children:[s.jsx(h0,{size:18}),"Rotate Key"]}),s.jsxs("button",{onClick:()=>b(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors font-medium",children:[s.jsx(_b,{size:18}),"Transfer Ownership"]})]})]})]}),m&&s.jsx("div",{className:`p-3 rounded ${m.type==="success"?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"}`,children:m.text}),s.jsxs("div",{className:"space-y-4",children:[l&&s.jsx("div",{className:"bg-green-50 border-2 border-green-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(fe,{className:"w-6 h-6 text-green-600 flex-shrink-0 mt-0.5"}),s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-bold text-green-900 mb-1",children:"Operation Approved by Witness"}),s.jsx("p",{className:"text-sm text-green-700 mb-2",children:l.type==="ownership_change"?`Ownership successfully transferred to: ${l.details.to}`:"Key rotation completed successfully"}),s.jsx("p",{className:"text-xs text-gray-600",children:"Added to DID Operations History"})]}),s.jsx("button",{onClick:()=>c(null),className:"p-1 text-green-400 hover:text-green-600 hover:bg-green-100 rounded transition-opacity",title:"Dismiss",children:s.jsx(Ge,{size:20})})]})})]})}),d&&s.jsx("div",{className:"bg-red-50 border-2 border-red-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Ge,{className:"w-6 h-6 text-red-600 flex-shrink-0 mt-0.5"}),s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-bold text-red-900 mb-1",children:"Operation Rejected by Witness"}),s.jsx("p",{className:"text-sm text-red-700 mb-2",children:d.type==="ownership_change"?`Ownership transfer to ${d.details.to} was denied`:"Key rotation request was denied"}),s.jsx("p",{className:"text-xs text-gray-600",children:"Not added to DID Operations History"})]}),s.jsx("button",{onClick:()=>h(null),className:"p-1 text-red-400 hover:text-red-600 hover:bg-red-100 rounded transition-opacity",title:"Dismiss",children:s.jsx(Ge,{size:20})})]})})]})}),i&&s.jsx("div",{className:"bg-orange-50 border-2 border-orange-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Wr,{className:"w-6 h-6 text-orange-600 flex-shrink-0 mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-bold text-orange-900 mb-1",children:"Operation Pending Witness Approval"}),s.jsx("p",{className:"text-sm text-orange-700 mb-2",children:i.type==="ownership_change"?`Awaiting witness approval for ownership transfer to: ${i.details.to}`:"Awaiting witness approval for key rotation"}),s.jsxs("p",{className:"text-xs text-gray-600",children:["Submitted: ",new Date(i.details.timestamp).toLocaleString()]})]})]})})]}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow border border-gray-200 dark:border-gray-700 p-6 transition-colors",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-800 dark:text-white mb-4",children:"DID Operations History"}),u?s.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-center py-8",children:"Loading..."}):n.length===0?s.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-center py-8",children:"No DID operations yet"}):s.jsx("div",{className:"space-y-3",children:n.map((O,V)=>{const M=L(O),ie=C(O),z=p.has(V);return s.jsx("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:bg-gray-50 dark:hover:bg-gray-700/30 transition-colors",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[s.jsx("span",{className:"text-2xl",children:M.icon}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h4",{className:"font-semibold text-gray-800 dark:text-white",children:M.label}),ie.length>0&&s.jsx("div",{className:"mt-2 space-y-1",children:ie.map((Y,T)=>s.jsxs("div",{className:"text-sm",children:[s.jsxs("span",{className:"text-gray-600 dark:text-gray-400 font-medium",children:[Y.label,":"]})," ",s.jsx("span",{className:"text-gray-800 dark:text-gray-200 font-mono text-xs break-all",children:Y.value.length>60?`${Y.value.substring(0,60)}...`:Y.value})]},T))}),s.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2 break-all",children:["Witness: ",s.jsx("span",{className:"font-mono",children:O.witness_did})]}),O.attestation_data&&Object.keys(O.attestation_data).length>0&&s.jsxs("div",{className:"mt-3",children:[s.jsx("button",{onClick:()=>E(V),className:"flex items-center gap-1 text-xs text-blue-600 hover:text-blue-800 font-medium",children:z?s.jsxs(s.Fragment,{children:[s.jsx(Pt,{size:14}),"Hide full data"]}):s.jsxs(s.Fragment,{children:[s.jsx(lt,{size:14}),"Show full data"]})}),z&&s.jsx("div",{className:"text-xs text-gray-700 dark:text-gray-300 mt-2 bg-gray-50 dark:bg-gray-700 p-3 rounded border border-gray-200 dark:border-gray-600",children:s.jsx("pre",{className:"whitespace-pre-wrap break-all overflow-x-auto",children:JSON.stringify(O.attestation_data,null,2)})})]})]})]}),s.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 whitespace-nowrap ml-4",children:new Date(O.timestamp).toLocaleString()})]})},V)})})]}),g&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[s.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"Transfer Ownership"}),s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Enter the DID of the new owner. They will have full control over this DPP's DID document."}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New Owner DID"}),s.jsx("input",{type:"text",value:y,onChange:O=>k(O.target.value),placeholder:"did:webvh:example.com:...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{className:"flex gap-3 justify-end",children:[s.jsx("button",{onClick:()=>{b(!1),k("")},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors",children:"Cancel"}),s.jsx("button",{onClick:A,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors font-medium",children:"Transfer"})]})]})})]})}/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function t5(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Sg(t,e,r=""){const n=t5(t),a=t==null?void 0:t.length;if(!n||e!==void 0){const o=r&&`"${r}" `,l="",c=n?`length=${a}`:`type=${typeof t}`;throw new Error(o+"expected Uint8Array"+l+", got "+c)}return t}function xy(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function r5(t,e){Sg(t,void 0,"digestInto() output");const r=e.outputLen;if(t.length<r)throw new Error('"digestInto() output" expected to be of length >='+r)}function X0(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function xf(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function tn(t,e){return t<<32-e|t>>>e}const n5=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",s5=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function a5(t){if(Sg(t),n5)return t.toHex();let e="";for(let r=0;r<t.length;r++)e+=s5[t[r]];return e}function i5(t,e={}){const r=(a,i)=>t(i).update(a).digest(),n=t(void 0);return r.outputLen=n.outputLen,r.blockLen=n.blockLen,r.create=a=>t(a),Object.assign(r,e),Object.freeze(r)}const o5=t=>({oid:Uint8Array.from([6,9,96,134,72,1,101,3,4,2,t])});function l5(t,e,r){return t&e^~t&r}function c5(t,e,r){return t&e^t&r^e&r}class d5{constructor(e,r,n,a){S(this,"blockLen");S(this,"outputLen");S(this,"padOffset");S(this,"isLE");S(this,"buffer");S(this,"view");S(this,"finished",!1);S(this,"length",0);S(this,"pos",0);S(this,"destroyed",!1);this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=a,this.buffer=new Uint8Array(e),this.view=xf(this.buffer)}update(e){xy(this),Sg(e);const{view:r,buffer:n,blockLen:a}=this,i=e.length;for(let o=0;o<i;){const l=Math.min(a-this.pos,i-o);if(l===a){const c=xf(e);for(;a<=i-o;o+=a)this.process(c,o);continue}n.set(e.subarray(o,o+l),this.pos),this.pos+=l,o+=l,this.pos===a&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){xy(this),r5(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:a,isLE:i}=this;let{pos:o}=this;r[o++]=128,X0(this.buffer.subarray(o)),this.padOffset>a-o&&(this.process(n,0),o=0);for(let u=o;u<a;u++)r[u]=0;n.setBigUint64(a-8,BigInt(this.length*8),i),this.process(n,0);const l=xf(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen must be aligned to 32bit");const d=c/4,h=this.get();if(d>h.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<d;u++)l.setUint32(4*u,h[u],i)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:a,finished:i,destroyed:o,pos:l}=this;return e.destroyed=o,e.finished=i,e.length=a,e.pos=l,a%r&&e.buffer.set(n),e}clone(){return this._cloneInto()}}const hs=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),u5=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),fs=new Uint32Array(64);class h5 extends d5{constructor(e){super(64,e,8,!1)}get(){const{A:e,B:r,C:n,D:a,E:i,F:o,G:l,H:c}=this;return[e,r,n,a,i,o,l,c]}set(e,r,n,a,i,o,l,c){this.A=e|0,this.B=r|0,this.C=n|0,this.D=a|0,this.E=i|0,this.F=o|0,this.G=l|0,this.H=c|0}process(e,r){for(let u=0;u<16;u++,r+=4)fs[u]=e.getUint32(r,!1);for(let u=16;u<64;u++){const f=fs[u-15],g=fs[u-2],b=tn(f,7)^tn(f,18)^f>>>3,y=tn(g,17)^tn(g,19)^g>>>10;fs[u]=y+fs[u-7]+b+fs[u-16]|0}let{A:n,B:a,C:i,D:o,E:l,F:c,G:d,H:h}=this;for(let u=0;u<64;u++){const f=tn(l,6)^tn(l,11)^tn(l,25),g=h+f+l5(l,c,d)+u5[u]+fs[u]|0,y=(tn(n,2)^tn(n,13)^tn(n,22))+c5(n,a,i)|0;h=d,d=c,c=l,l=o+g|0,o=i,i=a,a=n,n=g+y|0}n=n+this.A|0,a=a+this.B|0,i=i+this.C|0,o=o+this.D|0,l=l+this.E|0,c=c+this.F|0,d=d+this.G|0,h=h+this.H|0,this.set(n,a,i,o,l,c,d,h)}roundClean(){X0(fs)}destroy(){this.set(0,0,0,0,0,0,0,0),X0(this.buffer)}}class f5 extends h5{constructor(){super(32);S(this,"A",hs[0]|0);S(this,"B",hs[1]|0);S(this,"C",hs[2]|0);S(this,"D",hs[3]|0);S(this,"E",hs[4]|0);S(this,"F",hs[5]|0);S(this,"G",hs[6]|0);S(this,"H",hs[7]|0)}}const m5=i5(()=>new f5,o5(1));function g5(t){const e=typeof t=="string"?t:JSON.stringify(t),n=new TextEncoder().encode(e),a=m5(n);return"0x"+a5(a)}function p5(t){const e=[];if(t.length===0)return{valid:!0,brokenLinks:[]};for(let r=1;r<t.length;r++){const n=t[r],a=t[r-1],i=a.logEntryHash||g5(a),o=n.backlink;o&&i.toLowerCase()!==o.toLowerCase()&&e.push({versionId:n.versionId,expected:i,actual:o})}return{valid:e.length===0,brokenLinks:e}}function yf({label:t,status:e,details:r}){const n=()=>{switch(e){case"checking":return s.jsx(yj,{className:"w-5 h-5 text-blue-500 animate-spin"});case"valid":return s.jsx(Il,{className:"w-5 h-5 text-green-500"});case"invalid":return s.jsx(Ge,{className:"w-5 h-5 text-red-500"});case"pending":return s.jsx(Wr,{className:"w-5 h-5 text-yellow-500"})}},a=()=>{switch(e){case"checking":return"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-700";case"valid":return"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-700";case"invalid":return"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-700";case"pending":return"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-700"}},i=()=>{switch(e){case"checking":return"Verifying...";case"valid":return"Verified";case"invalid":return"Failed";case"pending":return"Pending"}};return s.jsx("div",{className:`p-3 rounded-lg border ${a()} transition-all`,children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[n(),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900 dark:text-white text-sm",children:t}),r&&s.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:r})]})]}),s.jsx("span",{className:`text-xs font-semibold px-2 py-1 rounded ${e==="valid"?"bg-green-100 text-green-800 dark:bg-green-800 dark:text-green-100":e==="invalid"?"bg-red-100 text-red-800 dark:bg-red-800 dark:text-red-100":e==="pending"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-800 dark:text-yellow-100":"bg-blue-100 text-blue-800 dark:bg-blue-800 dark:text-blue-100"}`,children:i()})]})})}function x5({did:t}){var D;const{currentRole:e}=Xt(),[r,n]=_.useState([]),[a,i]=_.useState([]),[o,l]=_.useState([]),[c,d]=_.useState("verification"),[h,u]=_.useState(null),[f,g]=_.useState({hashChain:"checking",witnesses:"checking",blockchain:"checking",trustScore:0,details:{hashChainErrors:[],witnessCount:0,witnessThreshold:1,blockNumber:null,txHash:null,etherscanTxUrl:null,etherscanBlockUrl:null,onChainVerified:null}}),[b,y]=_.useState([]),k=e==="Supervisor";_.useEffect(()=>{m();const E=setInterval(m,5e3);return()=>clearInterval(E)},[t]),_.useEffect(()=>{x()},[t,r,o]);async function m(){const[E,L,C]=await Promise.all([_e.getAttestationsByDID(t),_e.getAllAlerts(),_e.getAnchoringEventsByDID(t)]),O=["did_creation","key_rotation","ownership_change","did_update","did_lifecycle_update"],V=E.filter(z=>O.includes(z.attestation_type));n(V);const M=await _e.getDPPByDID(t),ie=M?L.filter(z=>z.dpp_id===M.id):[];i(ie),l(C);try{const z=await vg(10);y(z)}catch(z){console.warn("Could not load blockchain anchors:",z)}}async function x(){g(R=>({...R,hashChain:"checking",witnesses:"checking",blockchain:"checking"})),await new Promise(R=>setTimeout(R,300));const E=r.map((R,G)=>({versionId:G+1,logEntryHash:`0x${R.id.replace(/-/g,"").padEnd(64,"0")}`,backlink:G>0?`0x${r[G-1].id.replace(/-/g,"").padEnd(64,"0")}`:void 0,type:R.attestation_type,timestamp:R.timestamp})),L=p5(E);g(R=>({...R,hashChain:E.length===0?"pending":L.valid?"valid":"invalid",details:{...R.details,hashChainErrors:L.brokenLinks.map(G=>`Version ${G.versionId}: expected ${G.expected.slice(0,10)}... got ${G.actual.slice(0,10)}...`)}})),await new Promise(R=>setTimeout(R,200));const C=new Set(r.map(R=>R.witness_did)).size,O=1,V=C>=O;g(R=>({...R,witnesses:V?"valid":C>0?"pending":"invalid",details:{...R.details,witnessCount:C,witnessThreshold:O}})),await new Promise(R=>setTimeout(R,200));let M=!1,ie=null,z=null,Y=null,T=null;if(b.length>0){const R=b[0];if(M=!0,ie=R.blockNumber,z=R.txHash||null,Y=R.etherscanTxUrl||null,T=R.etherscanBlockUrl,R.merkleRoot&&o.length>0)try{const G=await bg(R.batchId,R.merkleRoot);G&&(M=G.verified)}catch(G){console.warn("On-chain verification failed:",G)}}else if(o.length>0){const R=o[0];ie=R.block_number,z=R.transaction_hash,z&&z.startsWith("0x")&&(Y=$b(z)),ie&&(T=Zu(ie)),M=!0}g(R=>({...R,blockchain:M?"valid":(o.length>0||b.length>0,"pending"),details:{...R.details,blockNumber:ie,txHash:z,etherscanTxUrl:Y,etherscanBlockUrl:T,onChainVerified:M}}));let B=0;(L.valid||E.length===0)&&(B+=35),V&&(B+=35),M&&(B+=30),g(R=>({...R,trustScore:B}))}const p=E=>{d(c===E?null:E)},v=Array.from(new Set(r.map(E=>E.witness_did))),N=3,A=o.length;return s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 transition-colors",children:s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Trust & Validation Network"}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Three-layer validation: Witnesses cryptographically attest operations  Watchers monitor integrity  DLT anchors to blockchain"})]}),s.jsxs("div",{className:`flex flex-col items-center p-3 rounded-lg ${f.trustScore>=90?"bg-green-100 dark:bg-green-900/30":f.trustScore>=60?"bg-yellow-100 dark:bg-yellow-900/30":"bg-red-100 dark:bg-red-900/30"}`,children:[s.jsxs("span",{className:`text-3xl font-bold ${f.trustScore>=90?"text-green-600 dark:text-green-400":f.trustScore>=60?"text-yellow-600 dark:text-yellow-400":"text-red-600 dark:text-red-400"}`,children:[f.trustScore,"%"]}),s.jsx("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:"Trust Score"})]})]})}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden transition-colors",children:[s.jsxs("button",{onClick:()=>p("verification"),className:"w-full flex items-center justify-between p-4 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Tl,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),s.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Cryptographic Verification"}),s.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Real-time integrity checks"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[f.hashChain==="valid"&&f.witnesses==="valid"&&f.blockchain==="valid"?s.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 dark:bg-green-800 dark:text-green-100 text-xs font-semibold rounded",children:"ALL VERIFIED"}):f.hashChain==="checking"||f.witnesses==="checking"||f.blockchain==="checking"?s.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 dark:bg-blue-800 dark:text-blue-100 text-xs font-semibold rounded",children:"VERIFYING..."}):s.jsx("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 dark:bg-yellow-800 dark:text-yellow-100 text-xs font-semibold rounded",children:"PARTIAL"}),c==="verification"?s.jsx(Pt,{className:"w-5 h-5"}):s.jsx(lt,{className:"w-5 h-5"})]})]}),c==="verification"&&s.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 p-4 space-y-3",children:[s.jsx(yf,{label:"Hash Chain Integrity",status:f.hashChain,details:f.hashChain==="valid"?"All log entries correctly linked":f.details.hashChainErrors.length>0?f.details.hashChainErrors[0]:void 0}),s.jsx(yf,{label:"Witness Attestations",status:f.witnesses,details:`${f.details.witnessCount} independent witness${f.details.witnessCount!==1?"es":""} (threshold: ${f.details.witnessThreshold})`}),s.jsx(yf,{label:"Blockchain Anchor",status:f.blockchain,details:f.details.blockNumber?`Block #${f.details.blockNumber}`:"Pending next batch anchor"}),(f.details.etherscanTxUrl||f.details.etherscanBlockUrl)&&s.jsxs("div",{className:"mt-4 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg space-y-2",children:[f.details.etherscanTxUrl&&s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(pj,{className:"w-4 h-4 text-purple-600"}),s.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Transaction:"}),s.jsxs("a",{href:f.details.etherscanTxUrl,target:"_blank",rel:"noopener noreferrer",className:"font-mono text-xs text-purple-600 hover:text-purple-800 dark:text-purple-400 dark:hover:text-purple-300 truncate max-w-xs inline-flex items-center gap-1",children:[(D=f.details.txHash)==null?void 0:D.slice(0,20),"...",s.jsx(_o,{className:"w-3 h-3"})]})]}),f.details.etherscanBlockUrl&&f.details.blockNumber&&s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(Tl,{className:"w-4 h-4 text-purple-600"}),s.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Block:"}),s.jsxs("a",{href:f.details.etherscanBlockUrl,target:"_blank",rel:"noopener noreferrer",className:"font-mono text-xs text-purple-600 hover:text-purple-800 dark:text-purple-400 dark:hover:text-purple-300 inline-flex items-center gap-1",children:["#",f.details.blockNumber,s.jsx(_o,{className:"w-3 h-3"})]})]}),f.details.onChainVerified!==null&&s.jsx("div",{className:"flex items-center gap-2 text-sm pt-1 border-t border-gray-200 dark:border-gray-600",children:f.details.onChainVerified?s.jsxs(s.Fragment,{children:[s.jsx(Il,{className:"w-4 h-4 text-green-600"}),s.jsx("span",{className:"text-green-600 dark:text-green-400 font-medium",children:"On-chain verification passed"})]}):s.jsxs(s.Fragment,{children:[s.jsx(Ge,{className:"w-4 h-4 text-red-600"}),s.jsx("span",{className:"text-red-600 dark:text-red-400 font-medium",children:"On-chain verification failed"})]})})]})]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border-2 border-green-200 dark:border-green-700/50 p-4 transition-colors",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx(Mt,{className:"w-8 h-8 text-green-600"}),s.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs font-semibold rounded",children:"ACTIVE"})]}),s.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:v.length}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Active Witnesses"})]}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border-2 border-orange-200 dark:border-orange-700/50 p-4 transition-colors",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx(Ha,{className:"w-8 h-8 text-orange-600"}),s.jsx("span",{className:"px-2 py-1 bg-orange-100 text-orange-800 text-xs font-semibold rounded",children:"MONITORING"})]}),s.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:N}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Active Watchers"})]}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border-2 border-purple-200 dark:border-purple-700/50 p-4 transition-colors",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx(Gh,{className:"w-8 h-8 text-purple-600"}),s.jsx("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 text-xs font-semibold rounded",children:"ANCHORED"})]}),s.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:A}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Blockchain Anchors"})]})]}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden transition-colors",children:[s.jsxs("button",{onClick:()=>p("witnesses"),className:"w-full flex items-center justify-between p-4 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Mt,{className:"w-5 h-5 text-green-600 dark:text-green-400"}),s.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Witness Validators"}),s.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Cryptographically attest each DID operation"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:[v.length," witnesses"]}),c==="witnesses"?s.jsx(Pt,{className:"w-5 h-5"}):s.jsx(lt,{className:"w-5 h-5"})]})]}),c==="witnesses"&&s.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700",children:[k&&s.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-700 border-b border-gray-200 dark:border-gray-600 flex gap-2",children:[s.jsx("button",{className:"px-3 py-1.5 bg-green-600 text-white text-sm rounded hover:bg-green-700 transition-colors",children:"+ Add Witness"}),s.jsx("button",{className:"px-3 py-1.5 bg-red-600 text-white text-sm rounded hover:bg-red-700 transition-colors",children:"Remove Witness"})]}),s.jsx("div",{className:"p-4",children:v.length===0?s.jsx("p",{className:"text-gray-500 text-center py-4 text-sm",children:"No witnesses found"}):s.jsx("div",{className:"space-y-2",children:v.map((E,L)=>{var M;const C=r.filter(ie=>ie.witness_did===E),O=C[0],V=((M=E.split(":").pop())==null?void 0:M.substring(0,20))||"Unknown";return s.jsxs("div",{className:"border border-gray-200 dark:border-gray-600 rounded overflow-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600 cursor-pointer",onClick:()=>u(h===E?null:E),children:[s.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[s.jsx(Il,{className:"w-5 h-5 text-green-600 flex-shrink-0"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-medium text-sm text-gray-900 dark:text-white truncate",children:V}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 font-mono truncate",children:E})]})]}),s.jsxs("div",{className:"flex items-center gap-4 flex-shrink-0 ml-4",children:[s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Last Validation"}),s.jsx("p",{className:"text-xs font-medium text-gray-700 dark:text-gray-300",children:O?new Date(O.timestamp).toLocaleString():"N/A"})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Total Events"}),s.jsx("p",{className:"text-xs font-bold text-blue-600 dark:text-blue-400",children:C.length})]}),h===E?s.jsx(Pt,{className:"w-4 h-4"}):s.jsx(lt,{className:"w-4 h-4"})]})]}),h===E&&s.jsxs("div",{className:"p-3 bg-white dark:bg-gray-700 border-t border-gray-200 dark:border-gray-600",children:[s.jsx("h4",{className:"text-xs font-semibold text-gray-700 dark:text-gray-300 mb-2 uppercase",children:"Recent Attestations"}),s.jsx("div",{className:"space-y-1.5 max-h-40 overflow-y-auto",children:C.slice(0,5).map((ie,z)=>s.jsxs("div",{className:"flex items-center justify-between text-xs p-2 bg-gray-50 dark:bg-gray-600 rounded",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(To,{className:"w-3 h-3 text-green-600"}),s.jsx("span",{className:"font-medium capitalize text-gray-900 dark:text-white",children:ie.attestation_type.replace(/_/g," ")})]}),s.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:new Date(ie.timestamp).toLocaleString()})]},z))})]})]},L)})})})]})]}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden transition-colors",children:[s.jsxs("button",{onClick:()=>p("watchers"),className:"w-full flex items-center justify-between p-4 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Ha,{className:"w-5 h-5 text-orange-600 dark:text-orange-400"}),s.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Watcher Monitoring"}),s.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Monitor integrity, detect anomalies"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:[N," watchers"]}),c==="watchers"?s.jsx(Pt,{className:"w-5 h-5"}):s.jsx(lt,{className:"w-5 h-5"})]})]}),c==="watchers"&&s.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700",children:s.jsxs("div",{className:"p-4",children:[s.jsx("div",{className:"grid grid-cols-3 gap-3 mb-4",children:["Integrity Watcher","Anomaly Detector","Compliance Monitor"].map((E,L)=>s.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx(To,{className:"w-4 h-4 text-orange-600"}),s.jsx("span",{className:"px-2 py-0.5 bg-green-100 text-green-800 text-xs font-semibold rounded",children:"HEALTHY"})]}),s.jsx("p",{className:"text-xs font-medium text-gray-900 dark:text-white mb-1",children:E}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400",children:[s.jsx(Wr,{className:"w-3 h-3"}),s.jsx("span",{children:"Last scan: 2m ago"})]})]},L))}),s.jsx("div",{className:"mb-3",children:s.jsxs("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-2",children:["Alert Feed (",a.filter(E=>!E.resolved).length," active)"]})}),a.length===0?s.jsxs("div",{className:"p-4 bg-green-50 dark:bg-green-900/30 border border-green-200 dark:border-green-700 rounded text-center",children:[s.jsx(Il,{className:"w-6 h-6 text-green-600 mx-auto mb-1"}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"No alerts - system healthy"})]}):s.jsx("div",{className:"space-y-1.5",children:a.slice(0,5).map((E,L)=>s.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600 text-xs",children:[s.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[s.jsx(Hn,{className:`w-4 h-4 flex-shrink-0 ${E.severity==="critical"?"text-red-600":E.severity==="warning"?"text-orange-600":"text-yellow-600"}`}),s.jsx("span",{className:"font-medium text-gray-900 dark:text-white truncate",children:E.alert_type}),E.resolved&&s.jsx("span",{className:"px-1.5 py-0.5 bg-green-100 text-green-800 font-semibold rounded",children:"OK"})]}),s.jsx("span",{className:"text-gray-500 ml-2 whitespace-nowrap",children:new Date(E.created_at).toLocaleTimeString()})]},L))})]})})]}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden transition-colors",children:[s.jsxs("button",{onClick:()=>p("anchoring"),className:"w-full flex items-center justify-between p-4 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Gh,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"}),s.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"DLT Anchoring"}),s.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Anchor events to blockchain for immutability"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:[A," anchors"]}),c==="anchoring"?s.jsx(Pt,{className:"w-5 h-5"}):s.jsx(lt,{className:"w-5 h-5"})]})]}),c==="anchoring"&&s.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700",children:s.jsxs("div",{className:"p-4",children:[o.length>0&&s.jsxs("div",{className:"p-4 bg-purple-50 dark:bg-purple-900/30 rounded border border-purple-200 dark:border-purple-700 mb-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-xs font-semibold text-gray-700",children:"LATEST ANCHOR"}),s.jsx("span",{className:"px-2 py-0.5 bg-purple-600 text-white text-xs font-semibold rounded",children:"CONFIRMED"})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Tl,{className:"w-4 h-4 text-purple-600"}),s.jsx("span",{className:"text-xs font-mono text-gray-700 dark:text-gray-300 truncate",children:o[0].transaction_hash})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Wr,{className:"w-4 h-4 text-purple-600 dark:text-purple-400"}),s.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:new Date(o[0].timestamp).toLocaleString()})]})]})]}),o.length===0?s.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center py-4 text-sm",children:"No anchors found"}):s.jsxs("div",{className:"space-y-1.5",children:[o.slice(0,8).map((E,L)=>s.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600",children:[s.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[s.jsx(Gh,{className:"w-4 h-4 text-purple-600 flex-shrink-0"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("p",{className:"text-xs font-semibold text-gray-900 dark:text-white",children:["Block #",E.block_number]}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 font-mono truncate",children:E.transaction_hash})]})]}),s.jsx("div",{className:"text-right ml-4",children:s.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:new Date(E.timestamp).toLocaleDateString()})})]},L)),o.length>8&&s.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 text-center pt-2",children:["+",o.length-8," more anchors"]})]})]})})]})]})}function y5({dop:t,onEdit:e}){return s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-blue-800 text-white rounded-lg p-6",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx(Mt,{className:"w-8 h-8"}),s.jsx("h2",{className:"text-2xl font-bold",children:"Declaration of Performance"})]}),s.jsx("p",{className:"text-blue-100",children:"According to EU Construction Products Regulation (CPR) 305/2011"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[e&&s.jsxs("button",{onClick:e,className:"bg-white text-blue-900 px-4 py-2 rounded-lg hover:bg-blue-50 flex items-center gap-2 font-medium",children:[s.jsx(Ub,{className:"w-4 h-4"}),"Edit DoP"]}),t.ceMarking.issued&&s.jsxs("div",{className:"bg-white text-blue-900 px-4 py-2 rounded-lg font-bold text-center",children:[s.jsx("div",{className:"text-2xl",children:"CE"}),s.jsx("div",{className:"text-xs",children:t.ceMarking.year})]})]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4 transition-colors",children:[s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"DoP Number"}),s.jsx("div",{className:"font-mono font-bold text-lg text-blue-600 dark:text-blue-400",children:t.dopNumber})]}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4 transition-colors",children:[s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Issue Date"}),s.jsx("div",{className:"font-semibold text-lg text-gray-900 dark:text-white",children:t.issueDate})]})]}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-6 transition-colors",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[s.jsx(qo,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),"Manufacturer Information"]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Name: "}),s.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:t.manufacturer.name})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Address: "}),s.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:t.manufacturer.address})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Contact: "}),s.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:t.manufacturer.contactInfo})]})]})]}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-6 transition-colors",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[s.jsx(Pl,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),"Product Information"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Product Type"}),s.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:t.productType})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Intended Use"}),s.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:t.intendedUse})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Product Code"}),s.jsx("div",{className:"font-mono text-gray-900 dark:text-white",children:t.productIdentification.productCode})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Batch Number"}),s.jsx("div",{className:"font-mono text-gray-900 dark:text-white",children:t.productIdentification.batchNumber})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Serial Number"}),s.jsx("div",{className:"font-mono text-gray-900 dark:text-white",children:t.productIdentification.serialNumber})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Harmonized Standard"}),s.jsx("div",{className:"font-mono text-sm text-gray-900 dark:text-white",children:t.harmonizedStandard})]})]})]}),t.notifiedBody&&s.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-700 rounded-lg p-6 transition-colors",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Notified Body"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Name"}),s.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:t.notifiedBody.name})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Number"}),s.jsx("div",{className:"font-mono font-semibold text-gray-900 dark:text-white",children:t.notifiedBody.number})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Certification System"}),s.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:t.notifiedBody.certification})]})]})]}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-6 transition-colors",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[s.jsx(fe,{className:"w-5 h-5 text-green-600 dark:text-green-400"}),"Declared Performance Characteristics"]}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700/50 border-b border-gray-200 dark:border-gray-600",children:s.jsxs("tr",{children:[s.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Characteristic"}),s.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Performance"}),s.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Classification"}),s.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Standard"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:t.declaredPerformance.map((r,n)=>s.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/30",children:[s.jsxs("td",{className:"py-3 px-4",children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:r.characteristic}),r.testMethod&&s.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Test: ",r.testMethod]})]}),s.jsx("td",{className:"py-3 px-4",children:s.jsxs("div",{className:"flex items-baseline gap-1",children:[s.jsx("span",{className:"font-semibold text-blue-600 dark:text-blue-400",children:r.performance}),r.unit&&s.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:r.unit})]})}),s.jsx("td",{className:"py-3 px-4",children:r.classification?s.jsx("span",{className:"px-2 py-1 bg-green-100 dark:bg-green-900/50 text-green-800 dark:text-green-300 rounded text-sm font-medium",children:r.classification}):s.jsx("span",{className:"text-gray-400",children:""})}),s.jsx("td",{className:"py-3 px-4",children:s.jsx("span",{className:"font-mono text-xs text-gray-600 dark:text-gray-400",children:r.harmonizedStandard})})]},n))})]})})]}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:t.declaredPerformance.slice(0,4).map((r,n)=>s.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-white dark:from-blue-900/30 dark:to-gray-800 border border-blue-200 dark:border-blue-700 rounded-lg p-4 text-center transition-colors",children:[s.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:r.characteristic}),s.jsx("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:r.performance}),r.unit&&s.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:r.unit}),r.classification&&s.jsx("div",{className:"mt-2 px-2 py-1 bg-green-100 dark:bg-green-900/50 text-green-800 dark:text-green-300 rounded text-xs font-medium inline-block",children:r.classification})]},n))}),s.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg p-6 transition-colors",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Declaration"}),s.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 mb-4",children:"The performance of the product identified above is in conformity with the set of declared performance characteristics. This declaration of performance is issued, in accordance with Regulation (EU) No 305/2011, under the sole responsibility of the manufacturer identified above."}),s.jsxs("div",{className:"flex items-end justify-between mt-6 pt-4 border-t border-gray-300 dark:border-gray-600",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Signed by"}),s.jsx("div",{className:"font-semibold text-lg text-gray-900 dark:text-white",children:t.signature.signedBy}),s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:t.signature.position})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Date"}),s.jsx("div",{className:"font-semibold text-gray-900 dark:text-white",children:t.signature.date})]})]})]})]})}function w5({initialData:t,productType:e,onSave:r,onCancel:n}){const[a,i]=_.useState(t||b5(e)),o=()=>{i({...a,declaredPerformance:[...a.declaredPerformance,{characteristic:"",performance:"",harmonizedStandard:"",classification:"",unit:"",testMethod:""}]})},l=h=>{const u=[...a.declaredPerformance];u.splice(h,1),i({...a,declaredPerformance:u})},c=(h,u,f)=>{const g=[...a.declaredPerformance];g[h]={...g[h],[u]:f},i({...a,declaredPerformance:g})},d=h=>{h.preventDefault(),r(a)};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 overflow-y-auto",children:s.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full my-8",children:s.jsxs("form",{onSubmit:d,children:[s.jsxs("div",{className:"bg-blue-600 text-white px-6 py-4 rounded-t-lg flex items-center justify-between",children:[s.jsx("h2",{className:"text-xl font-bold",children:"Edit Declaration of Performance"}),s.jsx("button",{type:"button",onClick:n,className:"text-white hover:text-gray-200",children:s.jsx(Pr,{className:"w-6 h-6"})})]}),s.jsxs("div",{className:"p-6 space-y-6 max-h-[70vh] overflow-y-auto",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"font-semibold text-lg",children:"Basic Information"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"DoP Number"}),s.jsx("input",{type:"text",value:a.dopNumber,onChange:h=>i({...a,dopNumber:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Issue Date"}),s.jsx("input",{type:"date",value:a.issueDate,onChange:h=>i({...a,issueDate:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Product Type"}),s.jsx("input",{type:"text",value:a.productType,onChange:h=>i({...a,productType:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Intended Use"}),s.jsx("input",{type:"text",value:a.intendedUse,onChange:h=>i({...a,intendedUse:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Harmonized Standard"}),s.jsx("input",{type:"text",value:a.harmonizedStandard,onChange:h=>i({...a,harmonizedStandard:h.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"e.g., EN 14351-1:2006+A2:2016",required:!0})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"font-semibold text-lg",children:"Manufacturer"}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),s.jsx("input",{type:"text",value:a.manufacturer.name,onChange:h=>i({...a,manufacturer:{...a.manufacturer,name:h.target.value}}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),s.jsx("input",{type:"text",value:a.manufacturer.address,onChange:h=>i({...a,manufacturer:{...a.manufacturer,address:h.target.value}}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Info"}),s.jsx("input",{type:"text",value:a.manufacturer.contactInfo,onChange:h=>i({...a,manufacturer:{...a.manufacturer,contactInfo:h.target.value}}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"font-semibold text-lg",children:"Performance Characteristics"}),s.jsxs("button",{type:"button",onClick:o,className:"flex items-center gap-2 px-3 py-1.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[s.jsx(Ym,{className:"w-4 h-4"}),"Add Characteristic"]})]}),s.jsx("div",{className:"space-y-4",children:a.declaredPerformance.map((h,u)=>s.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Characteristic #",u+1]}),s.jsx("button",{type:"button",onClick:()=>l(u),className:"text-red-600 hover:text-red-700",children:s.jsx(qm,{className:"w-4 h-4"})})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Characteristic"}),s.jsx("input",{type:"text",value:h.characteristic,onChange:f=>c(u,"characteristic",f.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded",placeholder:"e.g., Fire Resistance",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Performance"}),s.jsx("input",{type:"text",value:h.performance,onChange:f=>c(u,"performance",f.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded",placeholder:"e.g., E 30",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Unit (optional)"}),s.jsx("input",{type:"text",value:h.unit||"",onChange:f=>c(u,"unit",f.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded",placeholder:"e.g., W/(mK)"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Classification (optional)"}),s.jsx("input",{type:"text",value:h.classification||"",onChange:f=>c(u,"classification",f.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded",placeholder:"e.g., Class E"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Harmonized Standard"}),s.jsx("input",{type:"text",value:h.harmonizedStandard,onChange:f=>c(u,"harmonizedStandard",f.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded",placeholder:"e.g., EN 13501-2",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Test Method (optional)"}),s.jsx("input",{type:"text",value:h.testMethod||"",onChange:f=>c(u,"testMethod",f.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded",placeholder:"e.g., EN 1634-1"})]})]})]},u))})]})]}),s.jsxs("div",{className:"border-t border-gray-200 px-6 py-4 flex justify-end gap-3",children:[s.jsx("button",{type:"button",onClick:n,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsxs("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[s.jsx(vj,{className:"w-4 h-4"}),"Save DoP"]})]})]})})})}function b5(t){const e=new Date().toISOString().split("T")[0];return{dopNumber:`DoP-${t==="main"?"WIN":"CMP"}-${Date.now().toString().slice(-8)}`,issueDate:e,manufacturer:{name:"",address:"",contactInfo:""},productType:t==="main"?"Window product":"Component",productIdentification:{productCode:"",batchNumber:"",serialNumber:""},intendedUse:"",harmonizedStandard:"",notifiedBody:{name:"",number:"",certification:""},declaredPerformance:[],ceMarking:{issued:!0,year:new Date().getFullYear()},signature:{signedBy:"",position:"",date:e}}}function v5({attestation:t,onClose:e}){const r=t.attestation_data,n=(r==null?void 0:r.evidence)||(r==null?void 0:r.proofDocument)||(r==null?void 0:r.verificationDetails);return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-blue-800 text-white px-6 py-4 rounded-t-lg flex items-center justify-between sticky top-0 z-10",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Bo,{className:"w-6 h-6"}),s.jsx("h2",{className:"text-xl font-bold",children:"Attestation Details"})]}),s.jsx("button",{onClick:e,className:"text-white hover:text-gray-200 transition-colors",children:s.jsx(Pr,{className:"w-6 h-6"})})]}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Attestation Type"}),s.jsx("div",{className:"font-semibold text-lg text-blue-900 capitalize",children:t.attestation_type.replace(/_/g," ")})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Timestamp"}),s.jsxs("div",{className:"flex items-center gap-2 text-gray-900",children:[s.jsx(Km,{className:"w-4 h-4 text-gray-500"}),s.jsx("span",{className:"font-medium",children:new Date(t.timestamp).toLocaleString()})]})]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(_l,{className:"w-4 h-4 text-blue-600"}),s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Witness DID"})]}),s.jsx("div",{className:"font-mono text-xs text-gray-900 break-all bg-gray-50 p-2 rounded",children:t.witness_did})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Tl,{className:"w-4 h-4 text-blue-600"}),s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Product DID"})]}),s.jsx("div",{className:"font-mono text-xs text-gray-900 break-all bg-gray-50 p-2 rounded",children:t.did})]})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(fe,{className:"w-4 h-4 text-green-600"}),s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Digital Signature"})]}),s.jsx("div",{className:"font-mono text-xs text-gray-700 break-all bg-gray-50 p-3 rounded",children:t.signature}),s.jsxs("div",{className:"mt-2 flex items-center gap-2 text-xs text-green-700",children:[s.jsx(fe,{className:"w-3 h-3"}),s.jsx("span",{children:"Signature verified"})]})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Attestation Data"}),s.jsx("div",{className:"space-y-3",children:Object.entries(r).map(([a,i])=>a==="evidence"||a==="proofDocument"||a==="verificationDetails"?null:s.jsxs("div",{className:"flex items-start gap-3 pb-2 border-b border-gray-100 last:border-0",children:[s.jsxs("span",{className:"text-sm font-medium text-gray-600 capitalize min-w-[120px]",children:[a.replace(/([A-Z])/g," $1").trim(),":"]}),s.jsx("span",{className:"text-sm text-gray-900 flex-1",children:typeof i=="object"?JSON.stringify(i,null,2):String(i)})]},a))})]}),n?s.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx(Bo,{className:"w-5 h-5 text-green-600"}),s.jsx("h3",{className:"font-semibold text-green-900",children:"Evidence & Proof"})]}),r.evidence&&s.jsxs("div",{className:"mb-3",children:[s.jsx("div",{className:"text-sm font-medium text-gray-700 mb-1",children:"Evidence"}),s.jsx("div",{className:"bg-white p-3 rounded text-sm text-gray-900",children:typeof r.evidence=="object"?JSON.stringify(r.evidence,null,2):r.evidence})]}),r.proofDocument&&s.jsxs("div",{className:"mb-3",children:[s.jsx("div",{className:"text-sm font-medium text-gray-700 mb-1",children:"Proof Document"}),s.jsx("div",{className:"bg-white p-3 rounded",children:typeof r.proofDocument=="string"&&r.proofDocument.startsWith("http")?s.jsxs("a",{href:r.proofDocument,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-blue-600 hover:text-blue-700 text-sm",children:[s.jsx(_o,{className:"w-4 h-4"}),"View Document"]}):s.jsx("div",{className:"text-sm text-gray-900",children:typeof r.proofDocument=="object"?JSON.stringify(r.proofDocument,null,2):r.proofDocument})})]}),r.verificationDetails&&s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium text-gray-700 mb-1",children:"Verification Details"}),s.jsx("div",{className:"bg-white p-3 rounded text-sm text-gray-900",children:typeof r.verificationDetails=="object"?Object.entries(r.verificationDetails).map(([a,i])=>s.jsxs("div",{className:"flex gap-2 mb-1",children:[s.jsxs("span",{className:"font-medium",children:[a,":"]}),s.jsx("span",{children:String(i)})]},a)):r.verificationDetails})]})]}):s.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Gr,{className:"w-5 h-5 text-yellow-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-yellow-900 mb-1",children:"No Detailed Evidence Available"}),s.jsx("p",{className:"text-sm text-yellow-800 mb-3",children:"This attestation has been recorded but does not include additional evidence documents or verification details."}),s.jsxs("div",{className:"text-xs text-yellow-700 bg-yellow-100 p-3 rounded",children:[s.jsx("strong",{children:"What this means:"})," The attestation has been cryptographically signed and recorded on the blockchain, but supporting documents (such as inspection reports, test results, or photos) were not attached at the time of creation."]})]})]})}),s.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Blockchain Record"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-gray-600",children:"Status:"}),s.jsx("span",{className:"px-2 py-0.5 bg-green-100 text-green-800 rounded font-medium",children:"Immutably Recorded"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-gray-600",children:"Record ID:"}),s.jsx("span",{className:"font-mono text-xs text-gray-900",children:t.id})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-gray-600",children:"Created:"}),s.jsx("span",{className:"text-gray-900",children:new Date(t.created_at).toLocaleString()})]})]})]})]}),s.jsx("div",{className:"border-t border-gray-200 px-6 py-4 bg-gray-50 rounded-b-lg",children:s.jsx("button",{onClick:e,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Close"})})]})})}function N5({data:t,onClose:e}){const[r,n]=_.useState(!1),a=()=>{const o=JSON.stringify(t,null,2);navigator.clipboard.writeText(o),n(!0),setTimeout(()=>n(!1),2e3)},i=JSON.stringify(t,null,2);return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-5xl w-full max-h-[90vh] overflow-hidden flex flex-col transition-colors",children:[s.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-purple-800 text-white px-6 py-4 rounded-t-lg flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(u0,{className:"w-6 h-6"}),s.jsx("h2",{className:"text-xl font-bold",children:"Raw DPP Data"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:a,className:"flex items-center gap-2 px-3 py-1.5 bg-white dark:bg-gray-700 bg-opacity-20 dark:bg-opacity-100 hover:bg-opacity-30 dark:hover:bg-gray-600 rounded-lg transition-colors text-sm font-medium",children:r?s.jsxs(s.Fragment,{children:[s.jsx(fe,{className:"w-4 h-4"}),"Copied!"]}):s.jsxs(s.Fragment,{children:[s.jsx(Rb,{className:"w-4 h-4"}),"Copy"]})}),s.jsx("button",{onClick:e,className:"text-white hover:text-gray-200 transition-colors p-1",children:s.jsx(Pr,{className:"w-6 h-6"})})]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-6 bg-gray-50 dark:bg-gray-900 transition-colors",children:[s.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4 transition-colors",children:[s.jsxs("div",{className:"mb-3 flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400 border-b border-gray-200 dark:border-gray-700 pb-2",children:[s.jsx(u0,{className:"w-4 h-4"}),s.jsx("span",{className:"font-medium",children:"Complete Digital Product Passport Data Structure"})]}),s.jsx("pre",{className:"text-xs font-mono text-gray-800 dark:text-gray-200 overflow-x-auto",children:s.jsx("code",{className:"language-json",children:i})})]}),s.jsxs("div",{className:"mt-4 bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-700 rounded-lg p-4 transition-colors",children:[s.jsx("h3",{className:"text-sm font-semibold text-blue-900 dark:text-blue-300 mb-2",children:"About This Data"}),s.jsx("p",{className:"text-xs text-blue-800 dark:text-blue-200 leading-relaxed",children:"This is the complete, unprocessed data structure of the Digital Product Passport. It includes all metadata, relationships, and verification information stored on the distributed ledger. Use this view to verify data integrity and trace the complete product history."})]})]}),s.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 px-6 py-4 bg-gray-50 dark:bg-gray-800 transition-colors",children:s.jsx("button",{onClick:e,className:"w-full px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors font-medium",children:"Close"})})]})})}function k5({did:t}){const{currentRole:e}=Xt(),r=e==="Supervisor",[n,a]=_.useState(!1);return s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border-2 border-purple-200 dark:border-purple-700 shadow-sm mb-6 transition-colors",children:[s.jsxs("button",{onClick:()=>a(!n),className:"w-full px-6 py-4 flex items-center justify-between hover:bg-purple-50 dark:hover:bg-gray-700 transition-colors rounded-t-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-3 bg-gradient-to-br from-purple-500 to-purple-700 rounded-lg shadow-lg",children:s.jsx(Kp,{className:"w-6 h-6 text-white"})}),s.jsxs("div",{className:"text-left",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"DID:webvh Technology"}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Understanding the Verification Mechanism"})]})]}),s.jsx("div",{className:"ml-4",children:n?s.jsx(Pt,{className:"w-6 h-6 text-gray-600"}):s.jsx(lt,{className:"w-6 h-6 text-gray-600"})})]}),n&&s.jsxs("div",{className:"px-6 pb-6 pt-2",children:[s.jsxs("div",{className:"bg-gradient-to-r from-purple-50 via-blue-50 to-purple-50 border-2 border-purple-300 rounded-lg p-4 mb-6",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Jm,{className:"w-5 h-5 text-purple-600"}),s.jsx("span",{className:"text-sm font-bold text-purple-900 uppercase tracking-wide",children:"Decentralized Identifier"})]}),s.jsx("p",{className:"text-base text-gray-900 font-mono break-all leading-relaxed bg-white p-3 rounded border border-purple-200",children:t}),s.jsx("p",{className:"text-xs text-gray-600 mt-2",children:"This unique identifier is cryptographically verifiable and permanently recorded on the blockchain."})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[s.jsx(tc,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"}),"How It Works"]}),s.jsxs("div",{className:"flex items-center gap-4 bg-gray-50 dark:bg-gray-700 p-6 rounded-lg border border-gray-200 dark:border-gray-600",children:[s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"bg-blue-100 dark:bg-blue-900/50 border-2 border-blue-400 dark:border-blue-600 rounded-lg p-4 text-center",children:[s.jsx(Nj,{className:"w-8 h-8 text-blue-600 dark:text-blue-400 mx-auto mb-2"}),s.jsx("div",{className:"font-semibold text-blue-900 dark:text-blue-300 text-sm mb-1",children:"Hash-Chained Log"}),s.jsx("div",{className:"text-xs text-blue-700 dark:text-blue-400",children:"Web Server Storage"})]})}),s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("div",{className:"text-gray-400 font-bold text-2xl",children:""}),s.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Anchored"})]}),s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"bg-purple-100 dark:bg-purple-900/50 border-2 border-purple-400 dark:border-purple-600 rounded-lg p-4 text-center",children:[s.jsx(Kp,{className:"w-8 h-8 text-purple-600 dark:text-purple-400 mx-auto mb-2"}),s.jsx("div",{className:"font-semibold text-purple-900 dark:text-purple-300 text-sm mb-1",children:"Ethereum Blockchain"}),s.jsx("div",{className:"text-xs text-purple-700 dark:text-purple-400",children:"Immutable Record"})]})})]}),s.jsx("div",{className:"mt-3 bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-700 rounded-lg p-3",children:s.jsxs("p",{className:"text-sm text-blue-900 dark:text-blue-300 leading-relaxed",children:[s.jsx("strong",{children:"The Mechanism:"})," DID:webvh creates a cryptographic hash chain of all changes, stored on a web server for efficiency. Critical checkpoints are anchored to Ethereum, ensuring tamper-proof verification without blockchain overhead for every update."]})})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3 flex items-center gap-2",children:[s.jsx(Ro,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"}),"Current Implementation Status"]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"bg-yellow-50 border-2 border-yellow-400 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Gr,{className:"w-5 h-5 text-yellow-600"}),s.jsx("span",{className:"font-semibold text-yellow-900",children:"Current Mode"})]}),s.jsx("div",{className:"text-2xl font-bold text-yellow-700 mb-1",children:"Simulation"}),s.jsx("p",{className:"text-xs text-yellow-700",children:"Running in development with simulated blockchain anchoring"})]}),s.jsxs("div",{className:"bg-green-50 border-2 border-green-400 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(fe,{className:"w-5 h-5 text-green-600"}),s.jsx("span",{className:"font-semibold text-green-900",children:"Target Mode"})]}),s.jsx("div",{className:"text-2xl font-bold text-green-700 mb-1",children:"Production"}),s.jsx("p",{className:"text-xs text-green-700",children:"Full integration with Ethereum mainnet for live anchoring"})]})]})]}),r&&s.jsx("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border-2 border-green-300 rounded-lg p-5",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(fe,{className:"w-6 h-6 text-green-600 flex-shrink-0 mt-0.5"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-bold text-green-900 text-lg mb-2",children:"Regulatory Compliance"}),s.jsxs("p",{className:"text-sm text-green-800 leading-relaxed mb-3",children:["This DID:webvh implementation adheres to the ",s.jsx("strong",{children:"EU Digital Product Passport Regulation"}),"and the ",s.jsx("strong",{children:"eIDAS 2.0 framework"})," for digital identity verification. The system ensures:"]}),s.jsxs("ul",{className:"space-y-2 text-sm text-green-800",children:[s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx(fe,{className:"w-4 h-4 text-green-600 flex-shrink-0 mt-0.5"}),s.jsx("span",{children:"Cryptographic verifiability of all product data"})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx(fe,{className:"w-4 h-4 text-green-600 flex-shrink-0 mt-0.5"}),s.jsx("span",{children:"Immutable audit trail for lifecycle events"})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx(fe,{className:"w-4 h-4 text-green-600 flex-shrink-0 mt-0.5"}),s.jsx("span",{children:"Compliance with EU Construction Products Regulation (CPR 305/2011)"})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx(fe,{className:"w-4 h-4 text-green-600 flex-shrink-0 mt-0.5"}),s.jsx("span",{children:"Support for cross-border product traceability"})]})]})]})]})}),!r&&s.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[s.jsx("h4",{className:"font-semibold text-purple-900 mb-2 text-sm",children:"Why This Matters for Manufacturers"}),s.jsxs("p",{className:"text-xs text-purple-800 leading-relaxed",children:["DID:webvh provides you with a ",s.jsx("strong",{children:"verifiable digital identity"})," for every product. This builds trust with buyers, enables instant proof of authenticity, and creates a permanent record that protects against counterfeiting and fraud. Your products gain a digital certificate that travels with them throughout their entire lifecycle."]})]})]})]})}function yy({did:t,onBack:e,onNavigate:r,backLabel:n}){var ue,oe,ve,X,ge,Ee;const{currentRole:a}=Xt(),[i,o]=_.useState(null),[l,c]=_.useState(null),[d,h]=_.useState(null),[u,f]=_.useState(!0),[g,b]=_.useState(!1),[y,k]=_.useState(!1),[m,x]=_.useState("overview"),[p,v]=_.useState(0),[N,A]=_.useState(!1),[D,E]=_.useState(null),[L,C]=_.useState(!1),[O,V]=_.useState(!1),[M,ie]=_.useState([]),[z,Y]=_.useState([]),[T,B]=_.useState(null),R=K=>{const ee=K.toLowerCase();return ee.includes("glass")||ee.includes("glazing")?{from:"from-sky-400",to:"to-sky-600"}:ee.includes("frame")?{from:"from-purple-500",to:"to-purple-700"}:{from:"from-blue-500",to:"to-blue-700"}},G=K=>{const ee=K.toLowerCase();return ee.includes("glass")||ee.includes("glazing")?tc:ee.includes("frame")?Rc:Bb},F=K=>{var he,je,Se,Le,yt,Ce,Ut,fr,aa,Nn,Ig,Tg,_g;const ee=[];return K.type==="Window"||K.type==="window"?((he=K.metadata)!=null&&he.glazing_type||(Se=(je=K.metadata)==null?void 0:je.glass)!=null&&Se.glazing_type?ee.push(`${((Le=K.metadata)==null?void 0:Le.glazing_type)||((Ce=(yt=K.metadata)==null?void 0:yt.glass)==null?void 0:Ce.glazing_type)} for maximum insulation`):ee.push("Triple glazing for maximum insulation"),(Ut=K.metadata)!=null&&Ut.u_value||(aa=(fr=K.metadata)==null?void 0:fr.glass)!=null&&aa.u_value?ee.push(`U-value ${((Nn=K.metadata)==null?void 0:Nn.u_value)||((Tg=(Ig=K.metadata)==null?void 0:Ig.glass)==null?void 0:Tg.u_value)} W/mK - Excellent thermal performance`):ee.push("U-value 0.8 W/mK - Excellent thermal performance"),ee.push("Suitable for residential and commercial buildings"),ee.push("10-year manufacturer warranty"),(_g=K.metadata)!=null&&_g.energy_rating?ee.push(`Energy rating: ${K.metadata.energy_rating}`):ee.push("Energy rating: A+++")):(ee.push("High-quality building component"),ee.push("Comprehensive digital product passport"),ee.push("Full lifecycle traceability"),ee.push("Verified by independent witnesses"),ee.push("Blockchain-anchored authenticity")),ee},H=K=>{const ee=[],he=K.metadata||{};return he.glazing_type&&ee.push(he.glazing_type),he.u_value&&ee.push(`U-value ${he.u_value}`),he.thickness&&ee.push(`${he.thickness}mm`),he.material&&ee.push(he.material),he.thermal_break!==void 0&&ee.push(he.thermal_break?"Thermal break":"No thermal break"),he.dimensions&&ee.push(`${he.dimensions.width}${he.dimensions.height}mm`),he.weight&&ee.push(`${he.weight}kg`),ee.slice(0,3)};_.useEffect(()=>{console.log("MainDPPView mounted with DID:",t),$()},[t]);async function $(){console.log("MainDPPView loading data for:",t),f(!0);try{const K=await dN(t);console.log("MainDPPView data loaded:",K),o(K);try{const{hybridDataStore:ee}=await Bi(async()=>{const{hybridDataStore:Ce}=await Promise.resolve().then(()=>dy);return{hybridDataStore:Ce}},void 0),he=[];K.dpp&&he.push({id:`creation-${K.dpp.id}`,timestamp:K.dpp.created_at,description:"DPP Created",source:"creation"}),(await ee.getAnchoringEventsByDID(t)).forEach(Ce=>{he.push({id:`anchor-${Ce.id}`,timestamp:Ce.timestamp,description:`Anchored to DLT (${Ce.anchor_type})`,source:"anchoring"})}),(await ee.getAttestationsByDID(t)).forEach(Ce=>{const Ut=["did_creation","key_rotation","ownership_change","did_update","did_lifecycle_update"];if(Ut.includes(Ce.attestation_type)&&(Ce.approval_status==="pending"||Ce.approval_status==="rejected"))return;const fr=Ce.attestation_data&&Ce.attestation_data.timestamp||Ce.timestamp,aa=Ut.includes(Ce.attestation_type)?{did_creation:"DID Created & Registered",key_rotation:"Cryptographic Key Rotated",ownership_change:"Ownership Transferred",did_update:"DID Document Updated",did_lifecycle_update:"DID Lifecycle Stage Change"}[Ce.attestation_type]||Ce.attestation_type:["assembly","installation","maintenance","disposal","manufacturing"].includes(Ce.attestation_type)?`Product Lifecycle: ${Ce.attestation_type}`:Ce.attestation_type.replace(/_/g," ");he.push({id:`attestation-${Ce.id}`,timestamp:fr,description:aa,source:"attestation"})});const Le=await ee.getDIDDocumentByDID(t);Le&&he.push({id:`verification-${Le.id}`,timestamp:Le.created_at,description:"DID Document Verified",source:"verification"});const yt=he.slice().sort((Ce,Ut)=>{const fr=Ce!=null&&Ce.timestamp?new Date(Ce.timestamp).getTime():0;return(Ut!=null&&Ut.timestamp?new Date(Ut.timestamp).getTime():0)-fr}).slice(0,3);Y(yt)}catch(ee){console.error("Error building recentEvents:",ee)}if(K!=null&&K.dpp){const ee=await uN(K.dpp.id);c(ee);const he=await XS(K.dpp.id);h(he),await I(t)}}catch(K){console.error("Error loading main DPP data:",K)}finally{f(!1)}}async function I(K){try{const{hybridDataStore:ee}=await Bi(async()=>{const{hybridDataStore:Se}=await Promise.resolve().then(()=>dy);return{hybridDataStore:Se}},void 0),he=await ee.getAttestationsByDID(K);console.log("MainDPPView: All attestations for DID:",he);const je=he.filter(Se=>{const yt=["key_rotation","ownership_change","did_update"].includes(Se.attestation_type)&&Se.approval_status==="pending";return console.log("MainDPPView: Checking attestation",Se.id,"type:",Se.attestation_type,"status:",Se.approval_status,"isPending:",yt),yt});console.log("MainDPPView: Pending approvals found:",je.length,je),ie(je)}catch(ee){console.error("Error loading pending approvals:",ee)}}function W(){console.log("MainDPPView: handleEventCreated called, incrementing refresh key"),v(K=>{const ee=K+1;return console.log("MainDPPView: eventRefreshKey updated from",K,"to",ee),ee}),$()}async function q(K){if(!(i!=null&&i.dpp))return;const{updateDPP:ee}=await Bi(async()=>{const{updateDPP:je}=await Promise.resolve().then(()=>qS);return{updateDPP:je}},void 0),he=await ee(i.dpp.id,{metadata:{...i.dpp.metadata,declarationOfPerformance:K}});console.log("DoP saved successfully:",he),A(!1),await $()}if(u)return s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"}),s.jsx("p",{className:"text-gray-500 mt-4",children:"Loading DPP..."})]})});if(!i||!i.dpp)return s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-red-600",children:"DPP not found"}),s.jsx("button",{onClick:e,className:"mt-4 text-blue-600 hover:underline",children:"Go back"})]})});const ae=()=>a.includes("Manufacturer")||a==="Supervisor",Q=i.dpp;return s.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 transition-colors",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-4",children:[s.jsxs("button",{onClick:e,className:"flex items-center gap-2 text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white mb-4 transition-colors",children:[s.jsx(Yo,{className:"w-5 h-5"}),n||"Back to Dashboard"]}),s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[s.jsx("div",{className:`p-4 bg-gradient-to-br ${R(((ue=Q.metadata)==null?void 0:ue.productType)||Q.type).from} ${R(((oe=Q.metadata)==null?void 0:oe.productType)||Q.type).to} rounded-lg shadow-lg`,children:s.jsx(Re,{className:"w-8 h-8 text-white"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-3",children:Q.model}),s.jsxs("div",{className:"bg-gradient-to-r from-blue-50 via-purple-50 to-blue-50 dark:from-blue-900/30 dark:via-purple-900/30 dark:to-blue-900/30 border-2 border-blue-500 dark:border-blue-600 rounded-lg p-4 mb-3 shadow-sm transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Jm,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),s.jsx("span",{className:"text-sm font-bold text-blue-900 dark:text-blue-300 uppercase tracking-wide",children:"DID:webvh Identifier"})]}),s.jsx("p",{className:"text-base text-gray-900 dark:text-gray-100 font-mono break-all leading-relaxed",children:Q.did})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:`px-4 py-1.5 bg-gradient-to-r text-sm font-semibold rounded-full border ${Q.type==="main"?"from-blue-100 to-blue-200 text-blue-800 border-blue-300":"from-purple-100 to-purple-200 text-purple-800 border-purple-300"}`,children:Q.type==="main"?"Main Product":"Component"}),s.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300 font-medium capitalize px-3 py-1 bg-gray-100 dark:bg-gray-700 rounded-full transition-colors",children:Q.lifecycle_status}),s.jsxs("span",{className:"text-sm text-gray-700 dark:text-gray-300 font-medium px-3 py-1 bg-gray-100 dark:bg-gray-700 rounded-full transition-colors",children:["Version ",Q.version]})]})]})]}),s.jsxs("div",{className:"flex gap-2",children:[ae()&&s.jsxs("button",{onClick:()=>k(!0),className:"px-4 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-600 flex items-center gap-2 text-gray-900 dark:text-white transition-colors",children:[s.jsx(u0,{className:"w-4 h-4"}),"View Raw Data"]}),s.jsxs("button",{onClick:()=>b(!0),className:"px-4 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-600 flex items-center gap-2 text-gray-900 dark:text-white transition-colors",children:[s.jsx(Fb,{className:"w-4 h-4"}),"QR Code"]})]})]}),s.jsx("div",{className:"flex gap-2 mt-6 border-b border-gray-200 dark:border-gray-700",children:[{id:"overview",label:"Overview",showFor:["main","component"]},{id:"specifications",label:"Specifications",showFor:["main","component"]},{id:"components",label:"Components",showFor:["main"]},{id:"lifecycle",label:"Lifecycle",showFor:["main","component"]},{id:"did-operations",label:"DID Operations",showFor:["main","component"]},{id:"trust-validation",label:"Trust & Validation",showFor:["main","component"]},{id:"events",label:"Events",showFor:["main","component"]}].filter(K=>K.showFor.includes(Q.type)).map(K=>s.jsxs("button",{onClick:()=>x(K.id),className:`px-4 py-2 border-b-2 transition-colors relative ${m===K.id?"border-blue-600 text-blue-600 dark:text-blue-400 font-medium":"border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"}`,children:[K.label,K.id==="events"&&M.length>0&&s.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-yellow-500 text-white text-xs font-bold rounded-full flex items-center justify-center animate-pulse",children:M.length})]},K.id))})]})}),s.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[m==="specifications"&&(()=>{var he,je,Se;const K=fy(Q),ee=a==="Manufacturer";return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border-2 border-blue-200 dark:border-blue-700 shadow-sm p-6 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[s.jsx(Re,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Product Overview"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6 p-4 bg-blue-50 dark:bg-blue-900/30 rounded-lg transition-colors",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Type"}),s.jsx("div",{className:"font-semibold text-gray-900 dark:text-white",children:((he=Q.metadata)==null?void 0:he.productType)||Q.type})]}),((je=Q.metadata)==null?void 0:je.dimensions)&&s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Dimensions"}),s.jsxs("div",{className:"font-semibold text-gray-900 dark:text-white",children:[Q.metadata.dimensions.width,"mm  ",Q.metadata.dimensions.height,"mm (W  H)"]})]}),((Se=Q.metadata)==null?void 0:Se.weight)&&s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Weight"}),s.jsxs("div",{className:"font-semibold text-gray-900 dark:text-white",children:[Q.metadata.weight," kg"]})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Suitable for"}),s.jsx("div",{className:"font-semibold text-gray-900 dark:text-white",children:"Residential & Commercial Buildings"})]})]}),K&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4 mt-6",children:[s.jsx(Pl,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"}),s.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Performance"})]}),s.jsx("div",{className:"space-y-4",children:K.declaredPerformance&&K.declaredPerformance.length>0&&s.jsx("div",{className:"space-y-3",children:K.declaredPerformance.map((Le,yt)=>{const Ce=aa=>{const Nn=aa.toLowerCase();return Nn.includes("thermal")||Nn.includes("u-value")?{icon:Aj,color:"blue"}:Nn.includes("sound")||Nn.includes("acoustic")?{icon:Pj,color:"purple"}:Nn.includes("fire")?{icon:uj,color:"orange"}:Nn.includes("water")?{icon:cj,color:"cyan"}:{icon:Mt,color:"green"}},{icon:Ut,color:fr}=Ce(Le.characteristic);return s.jsx("div",{className:`border-l-4 border-${fr}-500 pl-4 py-2`,children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Ut,{className:`w-5 h-5 text-${fr}-600 dark:text-${fr}-400 flex-shrink-0 mt-0.5`}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-semibold text-gray-900 dark:text-white mb-1",children:Le.characteristic}),s.jsxs("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:[Le.performance," ",Le.unit&&`(${Le.unit})`]}),Le.classification&&s.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:["Classification: ",Le.classification]})]})]})},yt)})})}),s.jsxs("div",{className:"mt-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx(Bo,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"}),s.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Certifications"})]}),s.jsxs("div",{className:"space-y-2 bg-green-50 dark:bg-green-900/30 p-4 rounded-lg transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-2 text-green-700 dark:text-green-300",children:[s.jsx(fe,{className:"w-5 h-5"}),s.jsxs("span",{className:"font-medium",children:["CE Marking ",new Date(K.ceMarking.year).getFullYear()]})]}),s.jsxs("div",{className:"flex items-center gap-2 text-green-700 dark:text-green-300",children:[s.jsx(fe,{className:"w-5 h-5"}),s.jsx("span",{className:"font-medium",children:"EU Construction Products Regulation (CPR 305/2011)"})]}),K.notifiedBody&&s.jsxs("div",{className:"flex items-center gap-2 text-green-700 dark:text-green-300",children:[s.jsx(fe,{className:"w-5 h-5"}),s.jsxs("span",{className:"font-medium",children:["Tested by: ",K.notifiedBody.name]})]})]})]})]})]}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 transition-colors",children:[s.jsxs("button",{onClick:()=>V(!O),className:"w-full px-6 py-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Bo,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"}),s.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:"Technical Specifications"})]}),O?s.jsx(Pt,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"}):s.jsx(lt,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})]}),O&&s.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 p-6",children:K?s.jsx(y5,{dop:K,onEdit:ee?()=>A(!0):void 0}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"No Declaration of Performance available for this product."}),ee&&s.jsx("button",{onClick:()=>A(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Create DoP"})]})})]})]})})(),m==="overview"&&s.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[s.jsx("div",{className:"col-span-3 mb-4",children:s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl border-2 border-gray-200 dark:border-gray-700 shadow-sm overflow-hidden transition-colors",children:s.jsxs("div",{className:"flex items-start gap-0",children:[s.jsx("div",{className:"flex-shrink-0 relative group",children:s.jsx("div",{className:"w-96 h-96 bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 dark:from-blue-900/30 dark:via-indigo-900/30 dark:to-purple-900/30 flex items-center justify-center overflow-hidden",children:(ve=Q.metadata)!=null&&ve.image_url?s.jsx("img",{src:Q.metadata.image_url,alt:Q.model,className:"w-full h-full object-cover"}):s.jsxs("div",{className:"text-center p-8",children:[s.jsxs("div",{className:"relative inline-block",children:[s.jsx(gj,{className:"w-32 h-32 text-blue-300 dark:text-blue-600 mx-auto mb-4"}),s.jsx("div",{className:"absolute inset-0 bg-blue-400 dark:bg-blue-600 opacity-20 blur-2xl"})]}),s.jsx("p",{className:"text-lg font-semibold text-gray-600 dark:text-gray-300 mb-2",children:"Product Visual"}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:Q.type})]})})}),s.jsxs("div",{className:"flex-1 p-8",children:[s.jsx("div",{className:"flex items-start justify-between mb-4",children:s.jsxs("div",{children:[s.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:Q.model}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"px-3 py-1 bg-blue-100 dark:bg-blue-900/50 text-blue-700 dark:text-blue-300 text-sm font-semibold rounded-full",children:Q.type}),s.jsx("span",{className:"px-3 py-1 bg-green-100 dark:bg-green-900/50 text-green-700 dark:text-green-300 text-sm font-semibold rounded-full capitalize",children:Q.lifecycle_status})]})]})}),s.jsxs("div",{className:"mb-6",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wide mb-3",children:"Key Features"}),s.jsx("div",{className:"space-y-2.5",children:F(Q).map((K,ee)=>s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(fe,{className:"w-5 h-5 text-green-600 dark:text-green-400 flex-shrink-0 mt-0.5"}),s.jsx("span",{className:"text-gray-700 dark:text-gray-300 leading-relaxed",children:K})]},ee))})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[((X=Q.metadata)==null?void 0:X.dimensions)&&s.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3",children:[s.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium mb-1",children:"Dimensions"}),s.jsxs("div",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:[Q.metadata.dimensions.width,"  ",Q.metadata.dimensions.height," mm"]})]}),((ge=Q.metadata)==null?void 0:ge.weight)&&s.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3",children:[s.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium mb-1",children:"Weight"}),s.jsxs("div",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:[Q.metadata.weight," kg"]})]}),((Ee=Q.metadata)==null?void 0:Ee.batch)&&s.jsx(oi,{field:"operations",label:"Batch Number",value:Q.metadata.batch,children:s.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/30 rounded-lg p-3",children:[s.jsx("div",{className:"text-xs text-purple-600 dark:text-purple-400 font-medium mb-1",children:"Batch Number"}),s.jsx("div",{className:"text-sm font-semibold text-purple-900 dark:text-purple-300",children:Q.metadata.batch})]})}),Q.created_at&&s.jsx(oi,{field:"operations",label:"Production Date",value:new Date(Q.created_at).toLocaleDateString(),children:s.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3",children:[s.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium mb-1",children:"Production Date"}),s.jsx("div",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:new Date(Q.created_at).toLocaleDateString()})]})})]})]})]})})}),s.jsxs("div",{className:"col-span-2 space-y-6",children:[s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6 transition-colors",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[s.jsx(Mt,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),"Verification Status"]}),s.jsxs("div",{className:"relative",children:[s.jsx("button",{onMouseEnter:()=>C(!0),onMouseLeave:()=>C(!1),className:"p-1.5 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition-colors",children:s.jsx(Ro,{className:"w-5 h-5 text-gray-400"})}),L&&s.jsxs("div",{className:"absolute right-0 top-full mt-2 w-80 bg-gray-900 text-white text-sm rounded-lg shadow-xl p-4 z-10",children:[s.jsx("p",{className:"font-semibold mb-2",children:"What does this score mean?"}),s.jsx("p",{className:"text-xs leading-relaxed",children:"This score shows how complete and verifiable the product information is. A higher score means more transparency and reliability."})]})]})]}),d&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/30 dark:to-indigo-900/30 border-2 border-blue-200 dark:border-blue-700 rounded-lg p-4 mb-4",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[s.jsx(fe,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"}),s.jsx("span",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:d.score>=80?"Fully Verified Product":d.score>=60?"Verified Product":"Partially Verified"})]}),s.jsxs("div",{className:"mb-3",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Verification Completeness"}),s.jsxs("span",{className:"text-sm font-bold text-gray-900 dark:text-white",children:[d.score,"%"]})]}),s.jsx("div",{className:"h-3 bg-gray-200 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-blue-600 transition-all",style:{width:`${d.score}%`}})})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(fe,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:"Production Verified"}),s.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"DID document validated and registered"})]})]}),s.jsxs("div",{className:"flex items-start gap-3",children:[d.breakdown.credentials>=20?s.jsx(fe,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}):s.jsx(Gr,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:"Quality Controlled"}),s.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:[Math.round(d.breakdown.credentials/25*100),"% of certificates available"]})]})]}),s.jsxs("div",{className:"flex items-start gap-3",children:[d.breakdown.credentials>=15?s.jsx(fe,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}):s.jsx(Gr,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),s.jsxs("div",{children:[s.jsxs("div",{className:"font-medium text-gray-900 dark:text-white",children:[i.credentials?i.credentials.length:0," of ",i.credentials?Math.ceil(i.credentials.length/.68):25," Certificates Uploaded"]}),s.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Verifiable documents available"})]})]}),s.jsxs("div",{className:"flex items-start gap-3",children:[d.breakdown.anchoring>=20?s.jsx(fe,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}):s.jsx(Gr,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:"Blockchain Registered"}),s.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Data immutably recorded on blockchain"})]})]})]})]})]}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6 transition-colors",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Product Information"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(oi,{field:"basic",label:"Owner",value:Q.owner,children:s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Owner"}),s.jsx("div",{className:"text-sm font-mono text-gray-900 dark:text-white break-all",children:Q.owner})]})}),Q.custodian&&s.jsx(oi,{field:"operations",label:"Custodian",value:Q.custodian,children:s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Custodian"}),s.jsx("div",{className:"text-sm font-mono text-gray-900 dark:text-white break-all",children:Q.custodian})]})}),s.jsx(oi,{field:"operations",label:"Created",value:new Date(Q.created_at).toLocaleString(),children:s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Created"}),s.jsx("div",{className:"text-sm text-gray-900 dark:text-white",children:new Date(Q.created_at).toLocaleString()})]})}),s.jsx(oi,{field:"operations",label:"Updated",value:new Date(Q.updated_at).toLocaleString(),children:s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Updated"}),s.jsx("div",{className:"text-sm text-gray-900 dark:text-white",children:new Date(Q.updated_at).toLocaleString()})]})})]}),Q.metadata&&Object.keys(Q.metadata).length>0&&s.jsx(K6,{metadata:Q.metadata})]}),l&&l.aggregatedSustainability&&(l.aggregatedSustainability.totalCO2Footprint>0||l.aggregatedSustainability.avgRecycledContent>0||l.aggregatedSustainability.avgRecyclability>0)&&s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6 transition-colors",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Aggregated Sustainability"}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total CO Footprint"}),s.jsxs("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[l.aggregatedSustainability.totalCO2Footprint.toFixed(1),s.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400 ml-1",children:"kg"})]})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Avg Recycled Content"}),s.jsxs("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[l.aggregatedSustainability.avgRecycledContent.toFixed(0),s.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400 ml-1",children:"%"})]})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Avg Recyclability"}),s.jsxs("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[l.aggregatedSustainability.avgRecyclability.toFixed(0),s.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400 ml-1",children:"%"})]})]})]})]})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6 transition-colors",children:Q.type==="main"?s.jsxs(s.Fragment,{children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Components"}),s.jsx("div",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400 mb-2",children:i.children.length}),s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Total components"}),s.jsx("div",{className:"space-y-2",children:i.children.map(K=>{var Le;const ee=K.dpp||K,he=((Le=ee.metadata)==null?void 0:Le.productType)||"unknown",je=f0(he),Se=(je==null?void 0:je.color)||"#10B981";return console.log("Rendering child button:",ee.did,ee.model),s.jsxs("button",{onClick:()=>{console.log("Child component clicked:",ee.did),r(ee.did)},className:"w-full p-3 rounded-lg transition-colors text-left border",style:{backgroundColor:`${Se}10`,borderColor:`${Se}40`},onMouseEnter:yt=>{yt.currentTarget.style.backgroundColor=`${Se}20`},onMouseLeave:yt=>{yt.currentTarget.style.backgroundColor=`${Se}10`},children:[s.jsx("div",{className:"font-medium text-gray-900 dark:text-white text-sm mb-1",children:ee.model}),s.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400 font-mono truncate",children:ee.did})]},ee.id)})})]}):i.parent?s.jsxs(s.Fragment,{children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Parent Product"}),s.jsxs("button",{onClick:()=>r(i.parent.did),className:"w-full p-4 rounded-lg transition-colors text-left border-2 border-blue-200 dark:border-blue-700 bg-blue-50 dark:bg-blue-900/30 hover:bg-blue-100 dark:hover:bg-blue-900/50 hover:border-blue-300 dark:hover:border-blue-600",children:[s.jsx("div",{className:"font-semibold text-gray-900 dark:text-white text-base mb-2",children:i.parent.model}),s.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400 font-mono truncate mb-2",children:i.parent.did}),s.jsxs("div",{className:"flex items-center gap-1 text-sm text-blue-700 dark:text-blue-400 font-medium",children:[s.jsx("span",{children:"View parent product"}),s.jsx(_o,{className:"w-4 h-4"})]})]})]}):null}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6 transition-colors",children:[s.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[s.jsx(To,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),"Recent Events"]}),s.jsx("div",{className:"space-y-2",children:z&&z.length>0?z.map(K=>s.jsx("button",{onClick:()=>{x("events"),B(K.id)},className:"w-full text-left text-sm border-l-2 border-blue-500 dark:border-blue-400 pl-3 py-2 hover:bg-blue-50 dark:hover:bg-blue-900/30 transition-colors rounded-r",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"font-medium text-blue-600 dark:text-blue-400 capitalize hover:underline",children:K.description?String(K.description):K.attestation_type?K.attestation_type.replace(/_/g," "):"Unknown Event"}),s.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:K.timestamp?new Date(K.timestamp).toLocaleString("en-US",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):""})]})},K.id)):s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 text-center py-2",children:"No recent events"})})]})]})]}),m==="components"&&s.jsx("div",{className:"space-y-6",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6 transition-colors",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-6",children:"Component Details"}),s.jsx("div",{className:"grid grid-cols-2 gap-6",children:i.children.map(K=>{var Ce;const ee=K.dpp||K,he=((Ce=ee.metadata)==null?void 0:Ce.productType)||"unknown",je=f0(he),Se=(je==null?void 0:je.color)||"#10B981",Le=G(he),yt=H(ee);return s.jsxs("div",{className:"group border-2 rounded-xl overflow-hidden transition-all hover:shadow-lg bg-white dark:bg-gray-800",style:{borderColor:`${Se}40`},children:[s.jsxs("div",{className:"h-32 flex items-center justify-center relative overflow-hidden",style:{background:`linear-gradient(135deg, ${Se}15 0%, ${Se}05 100%)`},children:[s.jsx(Le,{className:"w-16 h-16 transition-transform group-hover:scale-110",style:{color:Se,opacity:.6}}),s.jsx("div",{className:"absolute top-3 right-3 px-2 py-1 rounded-full text-xs font-semibold",style:{backgroundColor:`${Se}20`,color:Se},children:(je==null?void 0:je.name)||"Component"})]}),s.jsxs("div",{className:"p-4",children:[s.jsx("h3",{className:"font-bold text-gray-900 dark:text-white text-lg mb-2",children:ee.model}),yt.length>0&&s.jsx("div",{className:"mb-3 space-y-1.5",children:yt.map((Ut,fr)=>s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx("div",{className:"w-1.5 h-1.5 rounded-full",style:{backgroundColor:Se}}),s.jsx("span",{className:"text-gray-700 dark:text-gray-300 font-medium",children:Ut})]},fr))}),s.jsxs("div",{className:"mb-3 p-2 bg-gray-50 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600",children:[s.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mb-0.5",children:"DID"}),s.jsx("p",{className:"text-xs text-gray-700 dark:text-gray-300 font-mono truncate",children:ee.did})]}),s.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400 mb-3",children:[s.jsx("span",{className:"capitalize",children:ee.lifecycle_status}),s.jsxs("span",{children:["v",ee.version||"1.0"]})]}),s.jsx("button",{onClick:()=>r(ee.did),className:"w-full py-2.5 rounded-lg text-sm font-semibold transition-all hover:shadow-md",style:{backgroundColor:Se,color:"white"},children:"View Full Details "})]})]},ee.id)})})]})}),m==="lifecycle"&&s.jsx("div",{className:"space-y-6",children:s.jsx(J6,{dpp:Q,events:i.events||[]})}),m==="did-operations"&&s.jsxs(s.Fragment,{children:[ae()&&s.jsx(k5,{did:t}),s.jsx(e5,{dpp:Q,onUpdate:$})]}),m==="trust-validation"&&s.jsx(x5,{did:t}),m==="events"&&s.jsxs(s.Fragment,{children:[M.length>0&&s.jsx("div",{className:"mb-4 p-4 bg-yellow-50 dark:bg-yellow-900/30 border border-yellow-200 dark:border-yellow-700 rounded-lg transition-colors",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Wr,{className:"w-5 h-5 text-yellow-600 dark:text-yellow-400 mt-0.5 flex-shrink-0"}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("h3",{className:"font-semibold text-yellow-900 dark:text-yellow-300 mb-1",children:[M.length," DID Event",M.length>1?"s":""," Awaiting Witness Approval"]}),s.jsx("p",{className:"text-sm text-yellow-700 dark:text-yellow-400 mb-2",children:"The following DID operations are pending validation by a witness node before they will appear in the event history:"}),s.jsx("div",{className:"space-y-2",children:M.map(K=>s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx("div",{className:"w-2 h-2 bg-yellow-400 dark:bg-yellow-500 rounded-full"}),s.jsxs("span",{className:"font-medium text-yellow-900 dark:text-yellow-300",children:[K.attestation_type==="key_rotation"&&"Key Rotation",K.attestation_type==="ownership_change"&&"Ownership Transfer",K.attestation_type==="did_update"&&"DID Document Update"]}),s.jsxs("span",{className:"text-yellow-600 dark:text-yellow-400",children:[" Submitted ",new Date(K.timestamp).toLocaleString()]})]},K.id))})]})]})}),s.jsx(Y6,{dppId:Q.id,did:t,onEventCreated:W}),s.jsx(W6,{did:t,openEventId:T},`events-${p}`)]})]}),g&&s.jsx(Q6,{did:t,onClose:()=>b(!1)}),N&&(i==null?void 0:i.dpp)&&s.jsx(w5,{initialData:fy(i.dpp),productType:i.dpp.type,onSave:q,onCancel:()=>A(!1)}),D&&s.jsx(v5,{attestation:D,onClose:()=>E(null)}),y&&s.jsx(N5,{data:i,onClose:()=>k(!1)})]})}function j5({onClose:t,onComplete:e}){const[r,n]=_.useState("window"),[a,i]=_.useState({model:"",description:"",dimensions:{width:1200,height:1500},weight:45}),[o,l]=_.useState({type:"glass",model:"",description:"",material:"Glass",metadata:{thickness:24,uValue:1.1}}),[c,d]=_.useState({type:"frame",model:"",description:"",material:"Aluminum",metadata:{finish:"Powder coated"}}),h=async()=>{n("creating");try{const f=`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,g=`did:webvh:example.com:products:window-${f}`,b=`did:webvh:example.com:products:glass-${f}`,y=`did:webvh:example.com:products:frame-${f}`,k=await _e.insertDPP({did:b,type:"component",model:o.model,parent_did:g,lifecycle_status:"active",owner:"did:webvh:example.com:organizations:glass-supplier",custodian:"did:webvh:example.com:organizations:window-manufacturer",metadata:{description:o.description,material:o.material,...o.metadata,productionDate:new Date().toISOString()},version:1,previous_version_id:null}),m=await _e.insertDPP({did:y,type:"component",model:c.model,parent_did:g,lifecycle_status:"active",owner:"did:webvh:example.com:organizations:frame-supplier",custodian:"did:webvh:example.com:organizations:window-manufacturer",metadata:{description:c.description,material:c.material,...c.metadata,productionDate:new Date().toISOString()},version:1,previous_version_id:null}),x=await _e.insertDPP({did:g,type:"main",model:a.model,parent_did:null,lifecycle_status:"active",owner:"did:webvh:example.com:organizations:window-manufacturer",custodian:null,metadata:{description:a.description,dimensions:{...a.dimensions,unit:"mm"},weight:a.weight,productionDate:new Date().toISOString()},version:1,previous_version_id:null});await _e.insertRelationship({parent_did:g,child_did:b,relationship_type:"component",position:1,metadata:{role:"glazing",quantity:1}}),await _e.insertRelationship({parent_did:g,child_did:y,relationship_type:"component",position:2,metadata:{role:"frame",quantity:1}}),await _e.insertDIDDocument({dpp_id:x.id,did:g,controller:x.owner,verification_method:[],service_endpoints:[],proof:{type:"Ed25519Signature2020"},document_metadata:{created:!0}}),await _e.insertDIDDocument({dpp_id:k.id,did:b,controller:k.owner,verification_method:[],service_endpoints:[],proof:{type:"Ed25519Signature2020"},document_metadata:{created:!0}}),await _e.insertDIDDocument({dpp_id:m.id,did:y,controller:m.owner,verification_method:[],service_endpoints:[],proof:{type:"Ed25519Signature2020"},document_metadata:{created:!0}}),await Js(x.id,g,"main"),await Js(k.id,b,"component"),await Js(m.id,y,"component"),setTimeout(()=>{e()},1500)}catch(u){console.error("Error creating DPP:",u),alert("Failed to create DPP. Please try again."),n("review")}};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-lg max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Create New Window DPP"}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Add a new window product with components"})]}),s.jsx("button",{onClick:t,disabled:r==="creating",className:"p-2 hover:bg-gray-100 rounded disabled:opacity-50",children:s.jsx(Pr,{size:24})})]}),s.jsx("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200",children:s.jsx("div",{className:"flex items-center justify-between max-w-2xl mx-auto",children:[{id:"window",label:"Window"},{id:"glass",label:"Glass"},{id:"frame",label:"Frame"},{id:"review",label:"Review"}].map((u,f)=>s.jsxs("div",{className:"flex items-center",children:[s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center font-semibold ${r===u.id?"bg-blue-600 text-white":["window","glass","frame","review"].indexOf(r)>["window","glass","frame","review"].indexOf(u.id)?"bg-green-600 text-white":"bg-gray-200 text-gray-600"}`,children:["window","glass","frame","review"].indexOf(r)>["window","glass","frame","review"].indexOf(u.id)?s.jsx(fe,{size:20}):f+1}),s.jsx("span",{className:"text-xs mt-1 font-medium",children:u.label})]}),f<3&&s.jsx("div",{className:`w-20 h-0.5 mx-2 ${["window","glass","frame","review"].indexOf(r)>["window","glass","frame","review"].indexOf(u.id)?"bg-green-600":"bg-gray-200"}`})]},u.id))})}),s.jsxs("div",{className:"p-6",children:[r==="window"&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Window Information"}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Model Name *"}),s.jsx("input",{type:"text",value:a.model,onChange:u=>i({...a,model:u.target.value}),placeholder:"e.g., Window-Premium-2025",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description *"}),s.jsx("textarea",{value:a.description,onChange:u=>i({...a,description:u.target.value}),placeholder:"e.g., Premium double-glazed window",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Width (mm) *"}),s.jsx("input",{type:"number",value:a.dimensions.width,onChange:u=>i({...a,dimensions:{...a.dimensions,width:Number(u.target.value)}}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Height (mm) *"}),s.jsx("input",{type:"number",value:a.dimensions.height,onChange:u=>i({...a,dimensions:{...a.dimensions,height:Number(u.target.value)}}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Weight (kg) *"}),s.jsx("input",{type:"number",step:"0.1",value:a.weight,onChange:u=>i({...a,weight:Number(u.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]})]}),r==="glass"&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Glass Component"}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Model Name *"}),s.jsx("input",{type:"text",value:o.model,onChange:u=>l({...o,model:u.target.value}),placeholder:"e.g., Glass-DoubleGlazed-Low-E",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description *"}),s.jsx("textarea",{value:o.description,onChange:u=>l({...o,description:u.target.value}),placeholder:"e.g., Low-E double-glazed glass panel",rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Material *"}),s.jsx("input",{type:"text",value:o.material,onChange:u=>l({...o,material:u.target.value}),placeholder:"e.g., Glass",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Thickness (mm)"}),s.jsx("input",{type:"number",value:o.metadata.thickness,onChange:u=>l({...o,metadata:{...o.metadata,thickness:Number(u.target.value)}}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"U-Value"}),s.jsx("input",{type:"number",step:"0.1",value:o.metadata.uValue,onChange:u=>l({...o,metadata:{...o.metadata,uValue:Number(u.target.value)}}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]}),r==="frame"&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Frame Component"}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Model Name *"}),s.jsx("input",{type:"text",value:c.model,onChange:u=>d({...c,model:u.target.value}),placeholder:"e.g., Frame-Aluminum-Thermal-Break",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description *"}),s.jsx("textarea",{value:c.description,onChange:u=>d({...c,description:u.target.value}),placeholder:"e.g., Aluminum frame with thermal break technology",rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Material *"}),s.jsx("input",{type:"text",value:c.material,onChange:u=>d({...c,material:u.target.value}),placeholder:"e.g., Aluminum",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Finish"}),s.jsx("input",{type:"text",value:c.metadata.finish,onChange:u=>d({...c,metadata:{...c.metadata,finish:u.target.value}}),placeholder:"e.g., Powder coated",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),r==="review"&&s.jsxs("div",{className:"space-y-6",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Review & Confirm"}),s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Re,{className:"w-5 h-5 text-blue-600 mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-semibold text-gray-900",children:a.model}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:a.description}),s.jsxs("div",{className:"mt-2 grid grid-cols-3 gap-2 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Width:"})," ",s.jsxs("span",{className:"font-medium",children:[a.dimensions.width,"mm"]})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Height:"})," ",s.jsxs("span",{className:"font-medium",children:[a.dimensions.height,"mm"]})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Weight:"})," ",s.jsxs("span",{className:"font-medium",children:[a.weight,"kg"]})]})]})]})]})}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Glass Component"}),s.jsx("p",{className:"text-sm font-medium text-gray-900",children:o.model}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:o.description}),s.jsx("div",{className:"mt-2 text-sm",children:s.jsxs("div",{className:"text-gray-600",children:["Material: ",s.jsx("span",{className:"font-medium",children:o.material})]})})]}),s.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Frame Component"}),s.jsx("p",{className:"text-sm font-medium text-gray-900",children:c.model}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:c.description}),s.jsx("div",{className:"mt-2 text-sm",children:s.jsxs("div",{className:"text-gray-600",children:["Material: ",s.jsx("span",{className:"font-medium",children:c.material})]})})]})]}),s.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:s.jsxs("p",{className:"text-sm text-yellow-800",children:[s.jsx("strong",{children:"Note:"})," This will create a new window DPP with DIDs for the window and both components, establish relationships, and register all DID documents."]})})]}),r==="creating"&&s.jsxs("div",{className:"py-12 text-center",children:[s.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mb-4"}),s.jsx("p",{className:"text-gray-600 font-medium",children:"Creating DPP and registering DIDs..."}),s.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"This may take a few moments"})]})]}),r!=="creating"&&s.jsxs("div",{className:"sticky bottom-0 bg-gray-50 border-t border-gray-200 p-6 flex justify-between",children:[s.jsxs("button",{onClick:()=>{r==="window"?t():r==="glass"?n("window"):r==="frame"?n("glass"):r==="review"&&n("frame")},className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-100 flex items-center gap-2",children:[s.jsx(Yo,{size:18}),r==="window"?"Cancel":"Back"]}),s.jsx("button",{onClick:()=>{r==="window"?n("glass"):r==="glass"?n("frame"):r==="frame"?n("review"):r==="review"&&h()},disabled:r==="window"&&(!a.model||!a.description)||r==="glass"&&(!o.model||!o.description)||r==="frame"&&(!c.model||!c.description),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:r==="review"?s.jsxs(s.Fragment,{children:[s.jsx(Ym,{size:18}),"Create DPP"]}):s.jsxs(s.Fragment,{children:["Next",s.jsx(Zn,{size:18})]})})]})]})})}function A5(){const{currentRoleDID:t}=Xt(),[e,r]=_.useState([]),[n,a]=_.useState([]),[i,o]=_.useState([]),[l,c]=_.useState("pending"),[d,h]=_.useState(null),[u,f]=_.useState(null),[g,b]=_.useState(new Set),[y,k]=_.useState(!1),[m,x]=_.useState(null),[p,v]=_.useState(null),[N,A]=_.useState(""),[D,E]=_.useState("all"),[L,C]=_.useState(!1),[O,V]=_.useState("all");_.useEffect(()=>{M();const F=setInterval(M,5e3);return()=>clearInterval(F)},[]);async function M(){var oe,ve;const F=await te.getAllDPPs(),H=new Map(F.map(X=>[X.id,X])),$=new Map(F.map(X=>[X.did,X])),I=new Map;for(const X of F)if(X.type==="component")if(X.parent_did){const ge=$.get(X.parent_did);ge&&(I.set(X.id,ge.id),console.log("Component found:",X.model,"Parent:",ge.model,"Parent ID:",ge.id))}else(oe=X.metadata)!=null&&oe.parent_dpp_id&&(I.set(X.id,String(X.metadata.parent_dpp_id)),console.log("Component found (metadata):",X.model,"Parent ID:",X.metadata.parent_dpp_id));console.log("Parent Map:",Array.from(I.entries()));const W=["did_creation","key_rotation","ownership_change","did_update","did_lifecycle_update"],q=[],ae=[],Q=[],ue=new Map;for(const X of F){const ge=await te.getAttestationsByDID(X.did);for(const Ee of ge){if(!W.includes(Ee.attestation_type))continue;let K="pending";Ee.approval_status==="approved"?K="approved":Ee.approval_status==="rejected"?K="rejected":Ee.approval_status==="pending"?K="pending":Ee.witness_did===t&&(Ee.signature.startsWith("witness-reject-")?K="rejected":Ee.signature.startsWith("witness-sig-")&&(K="approved"));let ee=X.id,he=X.model;if(X.type==="component"&&I.has(X.id)){const Se=I.get(X.id),Le=H.get(Se);Le&&(ee=Le.id,he=Le.model,console.log("Grouping component",X.model,"under parent",Le.model,"Parent ID:",ee))}console.log("Event for",X.model,"- Type:",X.type,"- GroupDppId:",ee,"- isComponent:",X.type==="component");const je={id:Ee.id,did:Ee.did,eventType:Ee.attestation_type,timestamp:Ee.timestamp,description:Ee.attestation_type.replace(/_/g," ").toUpperCase(),data:Ee.attestation_data,status:K,productModel:X.model,productType:X.type,dppId:ee,dppMetadata:{...X.metadata,groupModel:he,isComponent:X.type==="component",groupDppDid:X.type==="component"&&I.has(X.id)?(ve=H.get(I.get(X.id)))==null?void 0:ve.did:X.did}};ue.set(Ee.id,je)}}for(const X of ue.values())X.status==="approved"?ae.push(X):X.status==="rejected"?Q.push(X):q.push(X);r(q),a(ae),o(Q)}async function ie(F){var $,I,W,q;const H={witness_did:t,timestamp:new Date().toISOString(),event_id:F.id,did:F.did,verification:{previous_state_resolved:!0,version_valid:!0,hash_chain_valid:!0,method_rules_compliant:!0},signature:`witness-proof-${Date.now()}-${t.slice(-8)}`};if(await te.updateAttestation(F.id,{approval_status:"approved",signature:JSON.stringify(H),witness_did:t}),F.eventType==="ownership_change"){const ae=(($=F.data)==null?void 0:$.newOwner)||((I=F.data)==null?void 0:I.new_owner),Q=((W=F.data)==null?void 0:W.previousOwner)||((q=F.data)==null?void 0:q.old_owner);ae&&F.dppId&&await te.updateDPP(F.dppId,{owner:ae,metadata:{...F.dppMetadata,previousOwner:Q,ownershipTransferredAt:new Date().toISOString(),pendingOwnershipTransfer:void 0}})}await M(),k(!1),v(null),x(null)}async function z(F){var H;if(await te.updateAttestation(F.id,{approval_status:"rejected",signature:`witness-reject-${Date.now()}`,witness_did:t}),F.eventType==="ownership_change"&&F.dppId){const $=await te.getDPPById(F.dppId);$&&((H=$.metadata)!=null&&H.pendingOwnershipTransfer)&&await te.updateDPP(F.dppId,{metadata:{...$.metadata,pendingOwnershipTransfer:void 0}})}await M(),k(!1),v(null),x(null)}function Y(F,H){v(F),x(H),k(!0)}function T(){!p||!m||(m==="approve"?ie(p):z(p))}const R=(()=>{switch(l){case"pending":return e;case"approved":return n;case"rejected":return i;default:return[...e,...n,...i]}})(),G=()=>{const F=new Map;console.log("=== GROUPING EVENTS ==="),console.log("Total filtered events:",R.length),R.forEach($=>{var ae,Q,ue,oe,ve,X,ge,Ee,K,ee;const I=$.dppId;if(console.log("Processing event:",$.productModel,"- GroupKey:",I,"- isComponent:",(ae=$.dppMetadata)==null?void 0:ae.isComponent),l==="all"&&O!=="all"){const he=$.status==="approved"||$.status==="rejected";if(O==="processed"&&!he||O==="unprocessed"&&he)return}if(N){const he=N.toLowerCase();if(!(((Q=$.productModel)==null?void 0:Q.toLowerCase().includes(he))||$.did.toLowerCase().includes(he)||$.description.toLowerCase().includes(he)||((oe=(ue=$.dppMetadata)==null?void 0:ue.groupModel)==null?void 0:oe.toLowerCase().includes(he))))return}let W="window";if((ve=$.dppMetadata)!=null&&ve.isComponent){const he=$.dppMetadata;he.componentType==="glass"||(X=$.productModel)!=null&&X.toLowerCase().includes("glass")?W="glass":(he.componentType==="frame"||(ge=$.productModel)!=null&&ge.toLowerCase().includes("frame"))&&(W="frame")}if(D!=="all"&&D!==W)return;if(!F.has(I)){const he=((Ee=$.dppMetadata)==null?void 0:Ee.groupModel)||$.productModel||"Unknown Product",je=((K=$.dppMetadata)==null?void 0:K.groupDppDid)||$.did;F.set(I,{dppId:I,dppName:he,dppType:"main",did:je,componentType:"window",events:[],components:[]})}const q=F.get(I);if((ee=$.dppMetadata)!=null&&ee.isComponent){const he=$.productModel||"Unknown Component";let je=q.components.find(Se=>Se.name===he);je||(je={name:he,events:[]},q.components.push(je)),je.events.push($),console.log("   Added to components array of group:",q.dppName)}else q.events.push($),console.log("   Added as main product event to group:",q.dppName)}),console.log("=== FINAL GROUPS ==="),console.log("Total groups:",F.size),Array.from(F.values()).forEach($=>{var I,W;console.log("Group:",$.dppName,"(ID: "+$.dppId+") - Main events:",$.events.length,"- Components:",((I=$.components)==null?void 0:I.length)||0),(W=$.components)==null||W.forEach(q=>console.log("  Component:",q.name,"- Events:",q.events.length))});const H=Array.from(F.values()).filter($=>{const I=$.dppName.toLowerCase().startsWith("window")&&!$.dppName.toLowerCase().includes("frame")&&!$.dppName.toLowerCase().includes("panel");return console.log("Filtering group:",$.dppName,"- isWindow:",I,"- Keep?",I),I});return console.log("Valid groups after filtering:",H.length),H};return s.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 p-6 pt-20 transition-colors",children:[s.jsxs("div",{className:"max-w-[1920px] mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6 mb-6 transition-colors",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{children:s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("div",{className:"p-3 bg-emerald-100 dark:bg-emerald-900/50 rounded-lg",children:s.jsx(Bo,{className:"w-8 h-8 text-emerald-600 dark:text-emerald-400"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Witness Node Dashboard"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Validate and sign DID events"})]})]})}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Your Witness DID"}),s.jsx("div",{className:"text-xs font-mono text-gray-900 dark:text-gray-200 mt-1",children:t})]})]})}),s.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 transition-colors",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Wr,{className:"w-8 h-8 text-yellow-600 dark:text-yellow-400"}),s.jsxs("div",{children:[s.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:e.length}),s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Pending Events"})]})]})}),s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 transition-colors",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(fe,{className:"w-8 h-8 text-green-600 dark:text-green-400"}),s.jsxs("div",{children:[s.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:n.length}),s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Approved"})]})]})}),s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 transition-colors",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Ge,{className:"w-8 h-8 text-red-600 dark:text-red-400"}),s.jsxs("div",{children:[s.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:i.length}),s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Rejected"})]})]})}),s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 transition-colors",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(To,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"}),s.jsxs("div",{children:[s.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:e.length+n.length}),s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Validated"})]})]})})]}),s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 mb-6 transition-colors",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"flex-1 relative",children:[s.jsx(Sr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Search by product name, DID, or event type...",value:N,onChange:F=>A(F.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}),N&&s.jsx("button",{onClick:()=>A(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300",children:s.jsx(Pr,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"relative",children:[s.jsxs("button",{onClick:()=>C(!L),className:"flex items-center gap-2 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors text-gray-700 dark:text-gray-300",children:[s.jsx(Bc,{className:"w-5 h-5 text-white"}),s.jsx("span",{className:"text-sm font-medium text-white",children:D==="all"?"All Products":D==="window"?"Windows":D==="glass"?"Glass":"Frame"}),s.jsx(lt,{className:"w-4 h-4 text-gray-500"})]}),L&&s.jsxs("div",{className:"absolute top-full left-0 mt-2 w-56 bg-white border border-gray-200 rounded-lg shadow-lg overflow-hidden z-10",children:[s.jsxs("button",{onClick:()=>{E("all"),C(!1)},className:`w-full flex items-center gap-3 px-4 py-3 hover:bg-gray-50 transition-colors ${D==="all"?"bg-blue-50 text-blue-700":"text-gray-700"}`,children:[s.jsx(Re,{className:"w-5 h-5"}),s.jsx("span",{className:"font-medium",children:"All Products"})]}),s.jsxs("button",{onClick:()=>{E("window"),C(!1)},className:`w-full flex items-center gap-3 px-4 py-3 hover:bg-gray-50 transition-colors ${D==="window"?"bg-blue-50 text-blue-700":"text-gray-700"}`,children:[s.jsx(Lb,{className:"w-5 h-5"}),s.jsx("span",{className:"font-medium",children:"Windows Only"})]}),s.jsxs("button",{onClick:()=>{E("glass"),C(!1)},className:`w-full flex items-center gap-3 px-4 py-3 hover:bg-gray-50 transition-colors ${D==="glass"?"bg-blue-50 text-blue-700":"text-gray-700"}`,children:[s.jsx(Rc,{className:"w-5 h-5"}),s.jsx("span",{className:"font-medium",children:"Glass Only"})]}),s.jsxs("button",{onClick:()=>{E("frame"),C(!1)},className:`w-full flex items-center gap-3 px-4 py-3 hover:bg-gray-50 transition-colors ${D==="frame"?"bg-blue-50 text-blue-700":"text-gray-700"}`,children:[s.jsx(Re,{className:"w-5 h-5"}),s.jsx("span",{className:"font-medium",children:"Frame Only"})]})]})]}),l==="all"&&s.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-gray-100 rounded-lg",children:[s.jsx("button",{onClick:()=>V("all"),className:`px-3 py-1 rounded text-sm font-medium transition-colors ${O==="all"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"All"}),s.jsx("button",{onClick:()=>V("processed"),className:`px-3 py-1 rounded text-sm font-medium transition-colors ${O==="processed"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Processed"}),s.jsx("button",{onClick:()=>V("unprocessed"),className:`px-3 py-1 rounded text-sm font-medium transition-colors ${O==="unprocessed"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Unprocessed"})]}),(N||D!=="all"||l==="all"&&O!=="all")&&s.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-blue-50 text-blue-700 rounded-lg text-sm",children:[s.jsxs("span",{className:"font-medium",children:[[N,D!=="all",l==="all"&&O!=="all"].filter(Boolean).length," filter",[N,D!=="all",l==="all"&&O!=="all"].filter(Boolean).length!==1?"s":""," active"]}),s.jsx("button",{onClick:()=>{A(""),E("all"),V("all")},className:"hover:text-blue-900",children:s.jsx(Pr,{className:"w-4 h-4"})})]})]})}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 mb-6 transition-colors",children:[s.jsx("div",{className:"flex border-b border-gray-200 dark:border-gray-700",children:[{id:"pending",label:"Pending",count:e.length,color:"yellow"},{id:"approved",label:"Approved",count:n.length,color:"green"},{id:"rejected",label:"Rejected",count:i.length,color:"red"},{id:"all",label:"All Events",count:e.length+n.length+i.length,color:"blue"}].map(F=>s.jsxs("button",{onClick:()=>c(F.id),className:`flex-1 px-6 py-4 font-medium transition-colors ${l===F.id?"bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white border-b-2 border-blue-600":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:[F.label," ",s.jsx("span",{className:`ml-2 px-2 py-0.5 text-xs rounded-full bg-${F.color}-100 dark:bg-${F.color}-900/50 text-${F.color}-700 dark:text-${F.color}-300`,children:F.count})]},F.id))}),s.jsx("div",{className:"p-6",children:G().length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Mt,{className:"w-16 h-16 text-gray-300 dark:text-gray-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No events to display"})]}):s.jsx("div",{className:"space-y-4",children:G().map(F=>{var I;const H=F.events.length+(((I=F.components)==null?void 0:I.reduce((W,q)=>W+q.events.length,0))||0),$=u===F.dppId;return s.jsxs("div",{className:"border border-gray-300 rounded-lg overflow-hidden",children:[s.jsx("div",{className:"bg-gradient-to-r from-blue-100 to-blue-50 dark:from-gray-800 dark:to-gray-700 px-4 py-3 cursor-pointer hover:from-blue-200 hover:to-blue-100 dark:hover:from-gray-700 dark:hover:to-gray-600 transition-colors",onClick:()=>f($?null:F.dppId),children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Re,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:F.dppName}),s.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Main Product  ",H," event",H!==1?"s":"",F.components&&F.components.length>0&&`  ${F.components.length} component${F.components.length!==1?"s":""}`]})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("p",{className:"font-semibold text-xs text-gray-500 dark:text-white font-mono",children:["DID: ",F.did]}),$?s.jsx(Pt,{className:"w-5 h-5 text-gray-600"}):s.jsx(lt,{className:"w-5 h-5 text-gray-600"})]})]})}),$&&s.jsxs(s.Fragment,{children:[F.events.length>0&&s.jsx("div",{className:"bg-white",children:F.events.map(W=>s.jsx("div",{className:`border-b border-gray-200 p-4 transition-all ${W.status==="pending"?"bg-yellow-50":W.status==="approved"?"bg-green-50":"bg-red-50"}`,children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[W.status==="pending"&&s.jsx(Wr,{className:"w-5 h-5 text-yellow-600"}),W.status==="approved"&&s.jsx(fe,{className:"w-5 h-5 text-green-600"}),W.status==="rejected"&&s.jsx(Ge,{className:"w-5 h-5 text-red-600"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-gray-900",children:W.description}),s.jsx("p",{className:"text-xs text-gray-500",children:new Date(W.timestamp).toLocaleString()})]})]}),(d==null?void 0:d.id)===W.id&&s.jsxs("div",{className:"mt-3 p-3 bg-white rounded border border-gray-200",children:[s.jsx("div",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Event Data:"}),s.jsx("pre",{className:"text-xs text-gray-900 overflow-x-auto",children:JSON.stringify(W.data,null,2)})]})]}),s.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[s.jsx("button",{onClick:()=>h((d==null?void 0:d.id)===W.id?null:W),className:"px-3 py-1.5 text-sm text-gray-600 hover:text-gray-900 border border-gray-300 rounded hover:bg-gray-50",children:(d==null?void 0:d.id)===W.id?"Hide":"Details"}),W.status==="pending"&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>Y(W,"approve"),className:"px-3 py-1.5 text-sm text-white bg-green-600 rounded hover:bg-green-700",children:"Approve"}),s.jsx("button",{onClick:()=>Y(W,"reject"),className:"px-3 py-1.5 text-sm text-white bg-red-600 rounded hover:bg-red-700",children:"Reject"})]})]})]})},W.id))}),F.components&&F.components.map(W=>{var Q;const q=`${F.dppId}-${W.name}`,ae=g.has(q);return s.jsxs("div",{className:"border-t border-gray-300",children:[s.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-purple-100 px-4 py-3 cursor-pointer hover:from-purple-100 hover:to-purple-200 transition-colors",onClick:()=>{const ue=new Set(g);ae?ue.delete(q):ue.add(q),b(ue)},children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Mt,{className:"w-5 h-5 text-purple-600"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-purple-900",children:W.name}),s.jsxs("p",{className:"text-xs text-purple-600",children:["Component  ",W.events.length," event",W.events.length!==1?"s":""]})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("p",{className:"text-xs text-purple-500 font-mono",children:["DID: ",((Q=W.events[0])==null?void 0:Q.did)||"N/A"]}),ae?s.jsx(Pt,{className:"w-5 h-5 text-purple-600"}):s.jsx(lt,{className:"w-5 h-5 text-purple-600"})]})]})}),ae&&s.jsx("div",{className:"bg-white",children:W.events.map(ue=>s.jsx("div",{className:`border-t border-gray-200 p-4 transition-all ${ue.status==="pending"?"bg-yellow-50":ue.status==="approved"?"bg-green-50":"bg-red-50"}`,children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[ue.status==="pending"&&s.jsx(Wr,{className:"w-5 h-5 text-yellow-600"}),ue.status==="approved"&&s.jsx(fe,{className:"w-5 h-5 text-green-600"}),ue.status==="rejected"&&s.jsx(Ge,{className:"w-5 h-5 text-red-600"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-gray-900",children:ue.description}),s.jsx("p",{className:"text-xs text-gray-500",children:new Date(ue.timestamp).toLocaleString()})]})]}),(d==null?void 0:d.id)===ue.id&&s.jsxs("div",{className:"mt-3 p-3 bg-white rounded border border-gray-200",children:[s.jsx("div",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Event Data:"}),s.jsx("pre",{className:"text-xs text-gray-900 overflow-x-auto",children:JSON.stringify(ue.data,null,2)})]})]}),s.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[s.jsx("button",{onClick:()=>h((d==null?void 0:d.id)===ue.id?null:ue),className:"px-3 py-1.5 text-sm text-gray-600 hover:text-gray-900 border border-gray-300 rounded hover:bg-gray-50",children:(d==null?void 0:d.id)===ue.id?"Hide":"Details"}),ue.status==="pending"&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>Y(ue,"approve"),className:"px-3 py-1.5 text-sm text-white bg-green-600 rounded hover:bg-green-700",children:"Approve"}),s.jsx("button",{onClick:()=>Y(ue,"reject"),className:"px-3 py-1.5 text-sm text-white bg-red-600 rounded hover:bg-red-700",children:"Reject"})]})]})]})},ue.id))})]},W.name)})]})]},F.dppId)})})})]})]}),y&&p&&(()=>{const F=p.eventType,H=p.data,$=W=>W?{short:W.split(":").pop()||W,full:W}:{short:"Unknown",full:"Unknown"};let I=null;if(F==="ownership_change"){const W=(H==null?void 0:H.previousOwner)||(H==null?void 0:H.old_owner)||"Unknown",q=(H==null?void 0:H.newOwner)||(H==null?void 0:H.new_owner)||"Unknown",ae=$(W),Q=$(q);I=s.jsxs("div",{className:"py-8",children:[s.jsxs("div",{className:"flex items-center justify-center gap-8",children:[s.jsxs("div",{className:"text-center flex-1",children:[s.jsx("div",{className:"w-24 h-24 bg-blue-500 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg",children:s.jsx(_l,{className:"w-12 h-12 text-white"})}),s.jsxs("div",{className:"bg-white rounded-lg p-4 border-2 border-blue-200",children:[s.jsx("p",{className:"text-xs font-semibold text-blue-600 mb-2",children:"CURRENT OWNER"}),s.jsx("p",{className:"text-sm font-bold text-gray-800 mb-2",children:ae.short}),s.jsx("p",{className:"text-xs font-mono text-gray-500 break-all",title:ae.full,children:ae.full})]})]}),s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx(Zn,{className:"w-12 h-12 text-green-500 animate-pulse"}),s.jsx("p",{className:"text-xs font-semibold text-gray-600 mt-2",children:"TRANSFER"})]}),s.jsxs("div",{className:"text-center flex-1",children:[s.jsx("div",{className:"w-24 h-24 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg",children:s.jsx(_l,{className:"w-12 h-12 text-white"})}),s.jsxs("div",{className:"bg-white rounded-lg p-4 border-2 border-green-200",children:[s.jsx("p",{className:"text-xs font-semibold text-green-600 mb-2",children:"NEW OWNER"}),s.jsx("p",{className:"text-sm font-bold text-gray-800 mb-2",children:Q.short}),s.jsx("p",{className:"text-xs font-mono text-gray-500 break-all",title:Q.full,children:Q.full})]})]})]}),(H==null?void 0:H.transferMethod)&&s.jsxs("div",{className:"mt-6 text-center",children:[s.jsxs("p",{className:"text-sm text-gray-600",children:["Transfer Method: ",s.jsx("span",{className:"font-semibold text-gray-800",children:H.transferMethod})]}),(H==null?void 0:H.blockchainTxHash)&&s.jsxs("p",{className:"text-xs text-gray-500 font-mono mt-1",children:["TX: ",H.blockchainTxHash.substring(0,20),"..."]})]})]})}else if(F==="key_rotation"){const W=(H==null?void 0:H.old_key)||(H==null?void 0:H.previousKey)||"Unknown",q=(H==null?void 0:H.new_key)||(H==null?void 0:H.newKey)||"Unknown";I=s.jsxs("div",{className:"py-8",children:[s.jsxs("div",{className:"flex items-center justify-center gap-8",children:[s.jsxs("div",{className:"text-center flex-1",children:[s.jsx("div",{className:"w-24 h-24 bg-orange-500 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg",children:s.jsx(h0,{className:"w-12 h-12 text-white"})}),s.jsxs("div",{className:"bg-white rounded-lg p-4 border-2 border-orange-200",children:[s.jsx("p",{className:"text-xs font-semibold text-orange-600 mb-2",children:"OLD KEY"}),s.jsxs("p",{className:"text-xs font-mono text-gray-600 break-all",children:[W.substring(0,40),"..."]})]})]}),s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx(uu,{className:"w-12 h-12 text-green-500 animate-spin",style:{animationDuration:"3s"}}),s.jsx("p",{className:"text-xs font-semibold text-gray-600 mt-2",children:"ROTATION"})]}),s.jsxs("div",{className:"text-center flex-1",children:[s.jsx("div",{className:"w-24 h-24 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg",children:s.jsx(h0,{className:"w-12 h-12 text-white"})}),s.jsxs("div",{className:"bg-white rounded-lg p-4 border-2 border-green-200",children:[s.jsx("p",{className:"text-xs font-semibold text-green-600 mb-2",children:"NEW KEY"}),s.jsxs("p",{className:"text-xs font-mono text-gray-600 break-all",children:[q.substring(0,40),"..."]})]})]})]}),(H==null?void 0:H.reason)&&s.jsx("div",{className:"mt-6 text-center",children:s.jsxs("p",{className:"text-sm text-gray-600",children:["Reason: ",s.jsx("span",{className:"font-semibold text-gray-800",children:H.reason})]})})]})}else if(F==="did_creation"){const W=$(p.did),q=(H==null?void 0:H.controller)||(H==null?void 0:H.owner)||"Unknown",ae=$(q);I=s.jsx("div",{className:"py-8",children:s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("div",{className:"w-28 h-28 bg-gradient-to-br from-green-400 to-emerald-600 rounded-full flex items-center justify-center mb-4 shadow-xl",children:s.jsx(qo,{className:"w-14 h-14 text-white"})}),s.jsx("p",{className:"text-lg font-bold text-gray-800 mb-2",children:"New DID Created"}),s.jsxs("div",{className:"bg-white rounded-lg p-4 border-2 border-green-200 max-w-xl w-full",children:[s.jsx("p",{className:"text-xs font-semibold text-green-600 mb-2",children:"DID IDENTIFIER"}),s.jsx("p",{className:"text-sm font-mono text-gray-800 break-all",children:W.full})]}),s.jsx("div",{className:"mt-6 bg-blue-50 rounded-lg p-4 border border-blue-200 max-w-xl w-full",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(_l,{className:"w-8 h-8 text-blue-600"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-xs font-semibold text-blue-600 mb-1",children:"CONTROLLER"}),s.jsx("p",{className:"text-sm font-mono text-gray-800 break-all",children:ae.full})]})]})}),(H==null?void 0:H.publicKey)&&s.jsxs("div",{className:"mt-4 bg-gray-50 rounded-lg p-4 border border-gray-200 max-w-xl w-full",children:[s.jsx("p",{className:"text-xs font-semibold text-gray-600 mb-2",children:"PUBLIC KEY"}),s.jsxs("p",{className:"text-xs font-mono text-gray-600 break-all",children:[H.publicKey.substring(0,60),"..."]})]})]})})}else if(F==="did_update"||F==="did_lifecycle_update"){const W=(H==null?void 0:H.changes)||(H==null?void 0:H.updates)||{},q=(H==null?void 0:H.status)||(H==null?void 0:H.lifecycle_status);I=s.jsx("div",{className:"py-8",children:s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("div",{className:"w-28 h-28 bg-gradient-to-br from-blue-400 to-cyan-600 rounded-full flex items-center justify-center mb-4 shadow-xl",children:s.jsx(uu,{className:"w-14 h-14 text-white"})}),s.jsx("p",{className:"text-lg font-bold text-gray-800 mb-2",children:"DID Document Update"}),q&&s.jsxs("div",{className:"mt-4 bg-blue-50 rounded-lg p-4 border-2 border-blue-200 max-w-xl w-full",children:[s.jsx("p",{className:"text-xs font-semibold text-blue-600 mb-2",children:"LIFECYCLE STATUS"}),s.jsx("p",{className:"text-2xl font-bold text-blue-700",children:q})]}),Object.keys(W).length>0&&s.jsxs("div",{className:"mt-4 bg-white rounded-lg p-4 border border-gray-200 max-w-xl w-full",children:[s.jsx("p",{className:"text-xs font-semibold text-gray-600 mb-3",children:"CHANGES"}),s.jsx("div",{className:"space-y-2",children:Object.entries(W).map(([ae,Q])=>s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Zn,{className:"w-4 h-4 text-gray-400"}),s.jsxs("span",{className:"text-sm font-semibold text-gray-700",children:[ae,":"]}),s.jsx("span",{className:"text-sm text-gray-600",children:String(Q)})]},ae))})]})]})})}else I=s.jsx("div",{className:"py-8",children:s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("div",{className:"w-28 h-28 bg-gradient-to-br from-gray-400 to-slate-600 rounded-full flex items-center justify-center mb-4 shadow-xl",children:s.jsx(Ub,{className:"w-14 h-14 text-white"})}),s.jsx("p",{className:"text-lg font-bold text-gray-800 mb-2",children:p.description}),s.jsx("p",{className:"text-sm text-gray-600",children:"DID Event"})]})});return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-6xl w-full max-h-[95vh] overflow-y-auto",children:[s.jsxs("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-gray-50 to-white",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900 flex items-center gap-3",children:m==="approve"?s.jsxs(s.Fragment,{children:[s.jsx(fe,{className:"w-7 h-7 text-green-600"}),"Confirm Approval"]}):s.jsxs(s.Fragment,{children:[s.jsx(Ge,{className:"w-7 h-7 text-red-600"}),"Confirm Rejection"]})}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Review the DID event details before confirming"})]}),s.jsxs("div",{className:"p-6",children:[s.jsx("div",{className:"mb-6 bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 rounded-xl border border-gray-200",children:I}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-5 border border-gray-200",children:[s.jsxs("h3",{className:"text-sm font-bold text-gray-700 mb-4 flex items-center gap-2",children:[s.jsx(Mt,{className:"w-4 h-4"}),"Event Information"]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase",children:"Event Type"}),s.jsx("p",{className:"text-sm font-semibold text-gray-900 mt-1",children:p.description})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase",children:"Product"}),s.jsx("p",{className:"text-sm font-semibold text-gray-900 mt-1",children:p.productModel})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase",children:"DID"}),s.jsx("p",{className:"text-xs font-mono text-gray-800 break-all mt-1 bg-white p-2 rounded border border-gray-200",children:p.did})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase",children:"Timestamp"}),s.jsx("p",{className:"text-sm text-gray-900 mt-1",children:new Date(p.timestamp).toLocaleString()})]})]}),s.jsx("div",{className:`mt-6 p-4 rounded-lg border-2 ${m==="approve"?"bg-green-50 border-green-300":"bg-red-50 border-red-300"}`,children:s.jsxs("div",{className:"flex items-start gap-3",children:[m==="approve"?s.jsx(fe,{className:"w-5 h-5 text-green-600 flex-shrink-0 mt-0.5"}):s.jsx(Ge,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:`text-sm font-bold ${m==="approve"?"text-green-800":"text-red-800"} mb-1`,children:m==="approve"?"Approval Action":"Rejection Action"}),s.jsx("p",{className:`text-sm ${m==="approve"?"text-green-700":"text-red-700"}`,children:m==="approve"?"By confirming, you validate this event as legitimate and sign it with your witness DID. This action cannot be undone.":"By confirming, you mark this event as invalid and it will not be accepted in the DID log. This action cannot be undone."})]})]})})]}),s.jsxs("div",{className:"p-6 bg-gray-100 rounded-b-lg flex justify-end gap-3 border-t border-gray-200",children:[s.jsx("button",{onClick:()=>{k(!1),v(null),x(null)},className:"px-6 py-2.5 text-gray-700 bg-white border-2 border-gray-300 rounded-lg hover:bg-gray-50 font-medium transition-colors",children:"Cancel"}),s.jsx("button",{onClick:T,className:`px-6 py-2.5 text-white rounded-lg font-medium transition-colors shadow-lg ${m==="approve"?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700"}`,children:m==="approve"?" Confirm Approval":" Confirm Rejection"})]})]})})})()]})}function E5(){const{currentRoleDID:t}=Xt(),[e,r]=_.useState([]),[n,a]=_.useState([]),[i,o]=_.useState("all"),[l,c]=_.useState(null),[d,h]=_.useState(new Set),[u,f]=_.useState(null),[g,b]=_.useState([]),[y,k]=_.useState([]),[m,x]=_.useState(!1),[p,v]=_.useState(null),[N,A]=_.useState({severity:"warning",type:"signature_mismatch",description:""}),[D,E]=_.useState({monitored:0,criticalAlerts:0,warningAlerts:0,averageIntegrity:0});_.useEffect(()=>{L();const I=setInterval(L,1e4);return()=>clearInterval(I)},[]);async function L(){const I=await te.getAllDPPs(),q=(await Pe.getAlerts()).filter(X=>X.watcher_did===t),ae=await Promise.all(I.map(async X=>{const ge=q.filter(K=>K.dpp_id===X.id);await C(X,ge);const Ee=z(X,ge);return{...X,integrityScore:Ee,lastVerified:new Date().toISOString(),alertCount:ge.filter(K=>K.severity==="critical"||K.severity==="warning").length}}));r(ae),a(await Pe.getAlerts().then(X=>X.filter(ge=>ge.watcher_did===t)));const Q=await Pe.getAlerts().then(X=>X.filter(ge=>ge.watcher_did===t)),ue=Q.filter(X=>X.severity==="critical"&&X.status==="active").length,oe=Q.filter(X=>X.severity==="warning"&&X.status==="active").length,ve=ae.length>0?ae.reduce((X,ge)=>X+ge.integrityScore,0)/ae.length:100;E({monitored:ae.length,criticalAlerts:ue,warningAlerts:oe,averageIntegrity:ve})}async function C(I,W){const q=await pc(I.id);if(!q.success)return;const ae=await te.getAttestationsByDID(I.did),Q=O(q.operations,W,I),ue=V(ae,W,I),oe=M(ae,W,I),ve=ie(I,q.operations,W);(!Q||!ue||!oe||!ve)&&console.log(`Watcher detected inconsistencies in ${I.did}`)}function O(I,W,q){if(I.length===0)return!0;for(let ae=1;ae<I.length;ae++){const Q=I[ae],ue=I[ae-1];if(new Date(Q.timestamp)<new Date(ue.timestamp))return W.some(ve=>ve.alert_type==="hash_chain_broken"&&ve.status==="active")||Pe.insertAlert({watcher_id:t,watcher_did:t,dpp_id:q.id,did:q.did,alert_type:"hash_chain_broken",severity:"critical",description:"Hash chain integrity compromised: timestamps out of order",message:"Hash chain integrity compromised",details:{operation_index:ae},status:"active",resolved:!1,detected_at:new Date().toISOString()}),!1}return!0}function V(I,W,q){const ae=I.filter(Q=>Q.attestation_type==="ownership_change"||Q.attestation_type==="key_rotation"||Q.attestation_type==="did_creation");for(const Q of ae)if(!Q.signature||Q.signature.startsWith("pending-"))return!W.some(oe=>oe.alert_type==="missing_controller_signature"&&oe.status==="active")&&Q.approval_status==="approved"&&Pe.insertAlert({watcher_id:t,watcher_did:t,dpp_id:q.id,did:q.did,alert_type:"missing_controller_signature",severity:"critical",description:`Missing or invalid controller signature on ${Q.attestation_type}`,message:"Missing controller signature",details:{attestation_id:Q.id},status:"active",resolved:!1,detected_at:new Date().toISOString()}),!1;return!0}function M(I,W,q){const ae=I.filter(Q=>Q.attestation_type==="ownership_change"||Q.attestation_type==="key_rotation");for(const Q of ae)if(Q.approval_status==="rejected"&&(W.some(oe=>oe.alert_type==="rejected_by_witness"&&oe.status==="active")||Pe.insertAlert({watcher_id:t,watcher_did:t,dpp_id:q.id,did:q.did,alert_type:"rejected_by_witness",severity:"warning",description:`Operation ${Q.attestation_type} was rejected by witness`,message:"Operation rejected by witness",details:{attestation_id:Q.id},status:"active",resolved:!1,detected_at:new Date().toISOString()})),!Q.witness_did&&Q.approval_status==="approved")return W.some(oe=>oe.alert_type==="missing_witness_proof"&&oe.status==="active")||Pe.insertAlert({watcher_id:t,watcher_did:t,dpp_id:q.id,did:q.did,alert_type:"missing_witness_proof",severity:"critical",description:`Missing witness proof for ${Q.attestation_type}`,message:"Missing witness proof",details:{attestation_id:Q.id},status:"active",resolved:!1,detected_at:new Date().toISOString()}),!1;return!0}function ie(I,W,q){var Q;const ae=W.filter(ue=>ue.attestation_type==="ownership_change"&&ue.approval_status==="approved");if(ae.length>0){const oe=(Q=ae[ae.length-1].attestation_data)==null?void 0:Q.newOwner;if(oe&&I.owner!==oe)return q.some(X=>X.alert_type==="state_mismatch"&&X.status==="active")||Pe.insertAlert({watcher_id:t,watcher_did:t,dpp_id:I.id,did:I.did,alert_type:"state_mismatch",severity:"critical",description:`Owner mismatch: DID document shows ${I.owner} but history indicates ${oe}`,message:"State inconsistency detected",details:{expected_owner:oe,actual_owner:I.owner},status:"active",resolved:!1,detected_at:new Date().toISOString()}),!1}return!0}function z(I,W){let q=100;return W.filter(Q=>Q.status==="active").forEach(Q=>{Q.severity==="critical"?q-=20:Q.severity==="warning"?q-=10:Q.severity==="info"&&(q-=2)}),(I.lifecycle_status==="disposed"||I.lifecycle_status==="recycled"||I.lifecycle_status==="end_of_life")&&(q-=5),Math.max(0,Math.min(100,q))}async function Y(){if(!p||!N.description.trim())return;if(n.find(W=>W.dpp_id===p.id&&W.alert_type===N.type&&W.status==="active")){alert("An active alert of this type already exists for this product.");return}await Pe.insertAlert({watcher_id:t,watcher_did:t,dpp_id:p.id,did:p.did,alert_type:N.type,severity:N.severity,description:N.description,message:N.description,details:{},status:"active",resolved:!1,detected_at:new Date().toISOString()}),x(!1),v(null),A({severity:"warning",type:"signature_mismatch",description:""}),await L()}async function T(I){await Pe.updateAlert(I,{status:"resolved",resolved:!0}),await L()}const R=i==="selected"&&u?n.filter(I=>I.dpp_id===u.id&&I.status==="active"):i==="all"?n.filter(I=>I.status==="active"):i==="resolved"?n.filter(I=>I.status==="resolved"):n.filter(I=>I.severity===i&&I.status==="active"),G=I=>{switch(I){case"critical":return s.jsx(Gr,{className:"w-5 h-5 text-red-600"});case"warning":return s.jsx(Hn,{className:"w-5 h-5 text-yellow-600"});case"info":return s.jsx(Ro,{className:"w-5 h-5 text-blue-600"});default:return s.jsx(fe,{className:"w-5 h-5 text-green-600"})}},F=I=>I>=90?"text-green-600":I>=70?"text-yellow-600":"text-red-600",H=()=>{var ue;const I=new Map,W=new Map(e.map(oe=>[oe.id,oe])),q=new Map(e.map(oe=>[oe.did,oe])),ae=new Map;for(const oe of e)if(oe.type==="component")if(oe.parent_did){const ve=q.get(oe.parent_did);ve&&ae.set(oe.id,ve.id)}else(ue=oe.metadata)!=null&&ue.parent_dpp_id&&ae.set(oe.id,String(oe.metadata.parent_dpp_id));return e.forEach(oe=>{let ve=oe.id,X=oe.model,ge=!1;if(oe.type==="component"&&ae.has(oe.id)){const K=ae.get(oe.id),ee=W.get(K);ee&&(ve=ee.id,X=ee.model,ge=!0)}if(!I.has(ve)){const K=W.get(ve);I.set(ve,{dppId:ve,dppName:X,dppType:"main",dpp:K||oe,components:[]})}const Ee=I.get(ve);ge?Ee.components.push({name:oe.model,dpp:oe}):oe.id===ve&&(Ee.dpp=oe)}),Array.from(I.values()).filter(oe=>oe.dppName.toLowerCase().startsWith("window")&&!oe.dppName.toLowerCase().includes("frame")&&!oe.dppName.toLowerCase().includes("panel"))};async function $(I){f(I),o("selected");const W=await pc(I.id);b(W.success?W.operations:[]);const q=await te.getAttestationsByDID(I.did);k(q)}return s.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 p-6 pt-20 transition-colors",children:[s.jsxs("div",{className:"max-w-[1920px] mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6 mb-6 transition-colors",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{children:s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("div",{className:"p-3 bg-rose-100 dark:bg-rose-900/50 rounded-lg",children:s.jsx(To,{className:"w-8 h-8 text-rose-600 dark:text-rose-400"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Watcher Node Dashboard"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Monitor integrity and detect anomalies"})]})]})}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Your Watcher DID"}),s.jsx("div",{className:"text-xs font-mono text-gray-900 dark:text-gray-200 mt-1",children:t})]})]})}),s.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 transition-colors",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Ha,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"}),s.jsxs("div",{children:[s.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:D.monitored}),s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Monitored DPPs"})]})]})}),s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 transition-colors",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Gr,{className:"w-8 h-8 text-red-600 dark:text-red-400"}),s.jsxs("div",{children:[s.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:D.criticalAlerts}),s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Critical Alerts"})]})]})}),s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 transition-colors",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Hn,{className:"w-8 h-8 text-yellow-600 dark:text-yellow-400"}),s.jsxs("div",{children:[s.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:D.warningAlerts}),s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Warnings"})]})]})}),s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 transition-colors",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Zm,{className:"w-8 h-8 text-green-600 dark:text-green-400"}),s.jsxs("div",{children:[s.jsxs("div",{className:`text-2xl font-bold ${F(D.averageIntegrity)}`,children:[D.averageIntegrity.toFixed(1),"%"]}),s.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Avg. Integrity"})]})]})})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 transition-colors",children:[s.jsxs("div",{className:"border-b border-gray-200 dark:border-gray-700 p-4",children:[s.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[s.jsx(Mt,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),"Monitored Products"]}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Click a product to view DID details"})]}),s.jsx("div",{className:"p-4 max-h-[800px] overflow-y-auto",children:e.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Ha,{className:"w-12 h-12 text-gray-300 dark:text-gray-600 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No products monitored yet"})]}):s.jsx("div",{className:"space-y-3",children:H().map(I=>{var ae,Q;const W=l===I.dppId,q=I.dpp;return s.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[s.jsx("div",{className:`bg-blue-100 dark:bg-gray-800 p-3 cursor-pointer hover:bg-blue-200 dark:hover:bg-gray-700 transition-colors ${(u==null?void 0:u.id)===q.id?"ring-2 ring-blue-500 dark:ring-blue-400":""}`,onClick:()=>{c(W?null:I.dppId),$(q)},children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[s.jsx(Re,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-semibold text-blue-900 dark:text-white",children:q.model}),s.jsxs("p",{className:"text-xs text-blue-600 dark:text-blue-400",children:[q.type,"  ",((ae=I.components)==null?void 0:ae.length)||0," component",(((Q=I.components)==null?void 0:Q.length)||0)!==1?"s":""]})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{className:`text-xl font-bold ${F(q.integrityScore)}`,children:[q.integrityScore,"%"]}),s.jsx("div",{className:"text-xs text-gray-500",children:"Integrity"})]}),W?s.jsx(Pt,{className:"w-5 h-5 text-blue-600"}):s.jsx(lt,{className:"w-5 h-5 text-blue-600"})]})]})}),W&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-white p-3 border-b border-gray-200",children:[q.alertCount>0&&s.jsxs("div",{className:"flex items-center gap-2 text-sm text-red-600 mb-3",children:[s.jsx(Gr,{className:"w-4 h-4"}),q.alertCount," active alert",q.alertCount!==1?"s":""]}),s.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm mb-3",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Status:"}),s.jsx("span",{className:"ml-2 text-gray-900",children:q.lifecycle_status})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Last Verified:"}),s.jsx("span",{className:"ml-2 text-gray-900",children:new Date(q.lastVerified).toLocaleTimeString()})]})]}),s.jsx("div",{className:"flex gap-2",children:s.jsx("button",{onClick:ue=>{ue.stopPropagation(),v(q),A({severity:"warning",type:"did_history_anomaly",description:""}),x(!0)},className:"px-3 py-1.5 text-sm bg-yellow-100 text-yellow-700 rounded hover:bg-yellow-200",children:"Report Issue"})})]}),I.components&&I.components.map(ue=>{const oe=`${I.dppId}-${ue.name}`,ve=d.has(oe),X=ue.dpp;return s.jsxs("div",{className:"border-t border-gray-300",children:[s.jsx("div",{className:`bg-purple-100 px-4 py-2 cursor-pointer hover:bg-purple-200 transition-colors ${(u==null?void 0:u.id)===X.id?"ring-2 ring-purple-500":""}`,onClick:()=>{const ge=new Set(d);ve?ge.delete(oe):ge.add(oe),h(ge),$(X)},children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[s.jsx(Mt,{className:"w-4 h-4 text-purple-600"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-semibold text-purple-900 text-sm",children:ue.name}),s.jsx("p",{className:"text-xs text-purple-600",children:"component"})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"text-right",children:s.jsxs("div",{className:`text-lg font-bold ${F(X.integrityScore)}`,children:[X.integrityScore,"%"]})}),ve?s.jsx(Pt,{className:"w-4 h-4 text-purple-600"}):s.jsx(lt,{className:"w-4 h-4 text-purple-600"})]})]})}),ve&&s.jsxs("div",{className:"bg-white p-3",children:[X.alertCount>0&&s.jsxs("div",{className:"flex items-center gap-2 text-sm text-red-600 mb-3",children:[s.jsx(Gr,{className:"w-4 h-4"}),X.alertCount," active alert",X.alertCount!==1?"s":""]}),s.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm mb-3",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Status:"}),s.jsx("span",{className:"ml-2 text-gray-900",children:X.lifecycle_status})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Last Verified:"}),s.jsx("span",{className:"ml-2 text-gray-900",children:new Date(X.lastVerified).toLocaleTimeString()})]})]}),s.jsx("div",{className:"flex gap-2",children:s.jsx("button",{onClick:ge=>{ge.stopPropagation(),v(X),A({severity:"warning",type:"did_history_anomaly",description:""}),x(!0)},className:"px-3 py-1.5 text-xs bg-yellow-100 text-yellow-700 rounded hover:bg-yellow-200",children:"Report Issue"})})]})]},ue.name)})]})]},I.dppId)})})})]}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 transition-colors",children:[s.jsxs("div",{className:"border-b border-gray-200 dark:border-gray-700 p-4",children:[s.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[s.jsx(qo,{className:"w-5 h-5 text-green-600 dark:text-green-400"}),"DID Verification Details"]}),u&&s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:u.model})]}),s.jsx("div",{className:"p-4 max-h-[800px] overflow-y-auto",children:u?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3",children:[s.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-2 text-sm",children:"DID Information"}),s.jsxs("div",{className:"space-y-2 text-xs",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"DID:"}),s.jsx("p",{className:"font-mono text-gray-900 dark:text-gray-200 break-all mt-1",children:u.did})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Owner:"}),s.jsx("p",{className:"font-mono text-gray-900 dark:text-gray-200 break-all mt-1",children:u.owner})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Status:"}),s.jsx("span",{className:"ml-2 px-2 py-0.5 bg-green-100 dark:bg-green-900/50 text-green-700 dark:text-green-300 rounded",children:u.lifecycle_status})]})]})]}),s.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/30 rounded-lg p-3",children:[s.jsxs("h3",{className:"font-semibold text-gray-900 dark:text-white mb-2 text-sm flex items-center gap-2",children:[s.jsx(To,{className:"w-4 h-4"}),"DID Operations History (",g.length,")"]}),g.length===0?s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"No DID operations recorded"}):s.jsx("div",{className:"space-y-2",children:g.map((I,W)=>s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded p-2 text-xs",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("span",{className:"font-semibold text-blue-900 dark:text-blue-300",children:I.attestation_type.replace(/_/g," ").toUpperCase()}),s.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:new Date(I.timestamp).toLocaleString()})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Witness:"}),s.jsx("p",{className:"font-mono text-gray-900 dark:text-gray-200 break-all",children:I.witness_did})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Signature:"}),s.jsx("p",{className:"font-mono text-gray-900 dark:text-gray-200 break-all",children:I.signature})]}),I.approval_status&&s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Status:"}),s.jsx("span",{className:`ml-2 px-2 py-0.5 rounded ${I.approval_status==="approved"?"bg-green-100 dark:bg-green-900/50 text-green-700 dark:text-green-300":I.approval_status==="pending"?"bg-yellow-100 dark:bg-yellow-900/50 text-yellow-700 dark:text-yellow-300":"bg-red-100 dark:bg-red-900/50 text-red-700 dark:text-red-300"}`,children:I.approval_status})]})]})]},W))})]}),s.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/30 rounded-lg p-3",children:[s.jsxs("h3",{className:"font-semibold text-gray-900 dark:text-white mb-2 text-sm flex items-center gap-2",children:[s.jsx(Tl,{className:"w-4 h-4"}),"All Attestations (",y.length,")"]}),y.length===0?s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"No attestations found"}):s.jsx("div",{className:"space-y-2",children:y.map((I,W)=>s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded p-2 text-xs",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("span",{className:"font-semibold text-purple-900 dark:text-purple-300",children:I.attestation_type.replace(/_/g," ").toUpperCase()}),s.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:new Date(I.timestamp).toLocaleString()})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Witness DID:"}),s.jsx("p",{className:"font-mono text-gray-900 dark:text-gray-200 break-all",children:I.witness_did})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Signature:"}),s.jsx("p",{className:"font-mono text-gray-900 dark:text-gray-200 break-all bg-gray-50 dark:bg-gray-700 p-1 rounded",children:I.signature})]}),I.attestation_data&&Object.keys(I.attestation_data).length>0&&s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Data Hash:"}),s.jsxs("p",{className:"font-mono text-gray-900 dark:text-gray-200 break-all bg-gray-50 dark:bg-gray-700 p-1 rounded",children:[JSON.stringify(I.attestation_data).substring(0,64),"..."]})]})]})]},W))})]})]}):s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Ha,{className:"w-12 h-12 text-gray-300 dark:text-gray-600 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Select a product to view DID details"}),s.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-2",children:"Click on any product to inspect signatures and hashes"})]})})]}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 transition-colors",children:[s.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700",children:s.jsx("div",{className:"flex",children:[{id:"all",label:"All Alerts",count:n.filter(I=>I.status==="active").length},...u?[{id:"selected",label:u.model||"Selected",count:n.filter(I=>I.dpp_id===u.id&&I.status==="active").length}]:[],{id:"critical",label:"Critical",count:n.filter(I=>I.severity==="critical"&&I.status==="active").length},{id:"warning",label:"Warning",count:n.filter(I=>I.severity==="warning").length},{id:"resolved",label:"Resolved",count:n.filter(I=>I.status==="resolved").length}].map(I=>s.jsxs("button",{onClick:()=>o(I.id),className:`flex-1 px-4 py-3 text-sm font-medium transition-colors ${i===I.id?"bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white border-b-2 border-blue-600":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:[I.label," (",I.count,")"]},I.id))})}),s.jsx("div",{className:"p-4 min-h-[800px] max-h-[800px] overflow-y-auto",children:R.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(fe,{className:"w-12 h-12 text-gray-300 dark:text-gray-600 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No alerts to display"})]}):s.jsx("div",{className:"space-y-3",children:R.map(I=>{const W=e.find(q=>q.id===I.dpp_id);return s.jsx("div",{className:`border rounded-lg p-4 ${I.severity==="critical"?"border-red-200 dark:border-red-800 bg-red-50 dark:bg-red-900/30":I.severity==="warning"?"border-yellow-200 dark:border-yellow-800 bg-yellow-50 dark:bg-yellow-900/30":"border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/30"}`,children:s.jsxs("div",{className:"flex items-start gap-3",children:[G(I.severity),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-start justify-between mb-1",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:I.alert_type.replace(/_/g," ").toUpperCase()}),s.jsx("p",{className:"font-semibold text-sm text-white",children:(W==null?void 0:W.model)||"Unknown Product"})]}),s.jsx("span",{className:`px-2 py-1 text-xs rounded ${I.status==="active"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:I.status})]}),s.jsx("p",{className:"text-sm text-gray-700 dark:text-white mb-2",children:I.description}),s.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Detected: ",new Date(I.detected_at).toLocaleString()]}),I.status==="active"&&s.jsx("button",{onClick:()=>T(I.id),className:"mt-2 px-3 py-1 text-sm bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-50 dark:hover:bg-gray-600",children:"Mark Resolved"})]})]})},I.id)})})})]})]})]}),m&&p&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full mx-4 p-6",children:[s.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:["Report Issue for ",p.model]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Severity"}),s.jsxs("select",{value:N.severity,onChange:I=>A({...N,severity:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"info",children:"Info"}),s.jsx("option",{value:"warning",children:"Warning"}),s.jsx("option",{value:"critical",children:"Critical"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Issue Type"}),s.jsxs("select",{value:N.type,onChange:I=>A({...N,type:I.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"signature_mismatch",children:"Signature Mismatch"}),s.jsx("option",{value:"hash_mismatch",children:"Hash Mismatch"}),s.jsx("option",{value:"did_history_anomaly",children:"DID History Anomaly"}),s.jsx("option",{value:"missing_attestation",children:"Missing Attestation"}),s.jsx("option",{value:"integrity_failure",children:"Integrity Failure"}),s.jsx("option",{value:"unauthorized_change",children:"Unauthorized Change"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description *"}),s.jsx("textarea",{value:N.description,onChange:I=>A({...N,description:I.target.value}),placeholder:"Describe what you detected in the DID log, signatures, or hashes...",rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]})]}),s.jsxs("div",{className:"flex gap-3 mt-6",children:[s.jsx("button",{onClick:()=>{x(!1),v(null),A({severity:"warning",type:"signature_mismatch",description:""})},className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:Y,disabled:!N.description.trim(),className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Create Alert"})]})]})})]})}function S5(){const{currentRoleDID:t}=Xt(),[e,r]=_.useState([]),[n,a]=_.useState(null),[i,o]=_.useState(""),[l,c]=_.useState(!1),[d,h]=_.useState(null),[u,f]=_.useState(new Set),[g,b]=_.useState("all"),[y,k]=_.useState({totalVerifications:0,validDIDs:0,invalidDIDs:0,warningDIDs:0}),[m,x]=_.useState(!1),[p,v]=_.useState(null);_.useEffect(()=>{N()},[]);async function N(){const T=await te.getAllDPPs(),B=[];for(const R of T){const G=await A(R.did,R);B.push(G)}r(B),O(B)}async function A(T,B){if(B||(B=(await te.getAllDPPs()).find(Q=>Q.did===T)),!B)return{did:T,dppName:"Unknown",timestamp:new Date().toISOString(),status:"invalid",checks:{hashChain:{valid:!1,message:"DPP not found"},controllerSignatures:{valid:!1,message:"DPP not found"},witnessProofs:{valid:!1,message:"DPP not found"},documentConsistency:{valid:!1,message:"DPP not found"}},history:[],attestations:[]};const R=await pc(B.id),G=R.success?R.operations:[],F=await te.getAttestationsByDID(T),H=D(G),$=E(G,F),I=L(F),W=C(B,G);let q="valid";return!H.valid||!$.valid||!I.valid||!W.valid?q="invalid":(H.message.includes("warning")||$.message.includes("warning")||I.message.includes("warning")||W.message.includes("warning"))&&(q="warning"),{did:T,dppName:B.model||"Unknown Product",dppType:B.type,timestamp:new Date().toISOString(),status:q,checks:{hashChain:H,controllerSignatures:$,witnessProofs:I,documentConsistency:W},history:G,attestations:F,parentDid:B.parent_did||void 0,dpp:B}}function D(T,B){if(T.length===0)return{valid:!0,message:"No history to verify (new DID)",details:{totalEntries:0}};const R=[];for(let G=0;G<T.length;G++){const F=T[G];R.push({index:G,type:F.attestation_type,timestamp:F.timestamp,hash:F.operationHash||"N/A"})}return{valid:!0,message:`Hash chain verified: ${T.length} entries`,details:{totalEntries:T.length,entries:R}}}function E(T,B,R){const G=B.filter($=>$.attestation_type==="ownership_change"||$.attestation_type==="key_rotation"||$.attestation_type==="did_creation");if(G.length===0)return{valid:!0,message:"No operations requiring controller signatures",details:{totalOperations:0,signatures:[]}};const F=G.every($=>$.signature),H=G.map($=>({type:$.attestation_type,timestamp:$.timestamp,signature:$.signature?$.signature.substring(0,40)+"...":"Missing",status:$.signature?"Valid":"Invalid"}));return F?{valid:!0,message:`${G.length} controller signatures verified`,details:{totalOperations:G.length,signatures:H}}:{valid:!1,message:"Missing controller signatures on some operations",details:{totalOperations:G.length,signatures:H}}}function L(T){const B=T.filter($=>$.attestation_type==="ownership_change"||$.attestation_type==="key_rotation");if(B.length===0)return{valid:!0,message:"No operations requiring witness proofs",details:{totalOperations:0,proofs:[]}};const R=B.filter($=>$.approval_status==="approved"),G=B.filter($=>$.approval_status==="pending"),F=B.filter($=>$.approval_status==="rejected"),H=B.map($=>({type:$.attestation_type,timestamp:$.timestamp,witness:$.witness_did||"Unknown",status:$.approval_status||"Unknown",eventData:$.attestation_data||{},signature:$.signature}));return F.length>0?{valid:!1,message:`${F.length} operations rejected by witness`,details:{totalOperations:B.length,approved:R.length,pending:G.length,rejected:F.length,proofs:H}}:G.length>0?{valid:!0,message:`${R.length} proofs verified, ${G.length} pending (warning)`,details:{totalOperations:B.length,approved:R.length,pending:G.length,rejected:F.length,proofs:H}}:{valid:!0,message:`${R.length} witness proofs verified`,details:{totalOperations:B.length,approved:R.length,pending:G.length,rejected:F.length,proofs:H}}}function C(T,B){var G,F,H;const R=B.filter($=>$.attestation_type==="ownership_change"&&$.approval_status==="approved");if(R.length>0){const $=R[R.length-1],I=(G=$.attestation_data)==null?void 0:G.newOwner;if(I&&T.owner!==I)return{valid:!1,message:"Owner mismatch: DID document does not match history",details:{currentOwner:T.owner,expectedOwner:I,lastTransferTimestamp:$.timestamp,transferFrom:(F=$.attestation_data)==null?void 0:F.previousOwner}}}return(H=T.metadata)!=null&&H.pendingOwnershipTransfer?{valid:!0,message:"Document consistent (pending transfer exists - warning)"}:{valid:!0,message:"DID document consistent with history"}}function O(T){const B=T.filter(F=>F.status==="valid").length,R=T.filter(F=>F.status==="invalid").length,G=T.filter(F=>F.status==="warning").length;k({totalVerifications:T.length,validDIDs:B,invalidDIDs:R,warningDIDs:G})}function V(T,B,R){v({title:T,check:B,verification:R}),x(!0)}async function M(){if(i.trim()){c(!0);try{const T=await A(i.trim());r([T,...e]),O([T,...e]),a(T),o("")}catch(T){console.error("Error verifying DID:",T)}finally{c(!1)}}}function ie(){const T=[];return e.filter(R=>R.dppType==="main"||!R.parentDid&&R.dppType!=="component").forEach(R=>{const G=e.filter($=>$.parentDid===R.did).map($=>({name:$.dppName,verification:$}));let F=R.status;if(G.length>0){const $=G.some(W=>W.verification.status==="invalid"),I=G.some(W=>W.verification.status==="warning");$||R.status==="invalid"?F="invalid":I||R.status==="warning"?F="warning":F="valid"}const H={...R,status:F};T.push({dppId:R.did,dppName:R.dppName,dppType:"main",verification:H,components:G.length>0?G:void 0})}),T}const z=ie();_.useEffect(()=>{const T=z.filter(G=>G.verification.status==="valid").length,B=z.filter(G=>G.verification.status==="invalid").length,R=z.filter(G=>G.verification.status==="warning").length;k({totalVerifications:z.length,validDIDs:T,invalidDIDs:B,warningDIDs:R})},[z]);const Y=g==="all"?z:z.filter(T=>T.verification.status===g);return s.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 p-6 pt-20 transition-colors",children:[s.jsxs("div",{className:"max-w-[1920px] mx-auto",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6 mb-6 transition-colors",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{children:s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("div",{className:"p-3 bg-purple-100 dark:bg-purple-900/50 rounded-lg",children:s.jsx(Sr,{className:"w-8 h-8 text-purple-600 dark:text-purple-400"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Resolver Dashboard"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Reconstruct and verify DID history integrity"})]})]})}),s.jsx("div",{className:"flex items-center gap-4",children:s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Resolver Node"}),s.jsx("p",{className:"text-xs font-mono text-gray-500 dark:text-gray-400",children:t})]})})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 transition-colors",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Verifications"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:y.totalVerifications})]}),s.jsx(qo,{className:"w-8 h-8 text-blue-500 dark:text-blue-400"})]})}),s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 transition-colors",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Valid DIDs"}),s.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:y.validDIDs})]}),s.jsx(fe,{className:"w-8 h-8 text-green-500 dark:text-green-400"})]})}),s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 transition-colors",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Invalid DIDs"}),s.jsx("p",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:y.invalidDIDs})]}),s.jsx(Ge,{className:"w-8 h-8 text-red-500 dark:text-red-400"})]})}),s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 transition-colors",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Warnings"}),s.jsx("p",{className:"text-2xl font-bold text-yellow-600 dark:text-yellow-400",children:y.warningDIDs})]}),s.jsx(Hn,{className:"w-8 h-8 text-yellow-500 dark:text-yellow-400"})]})})]}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 mb-6 transition-colors",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Verify DID"}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("input",{type:"text",value:i,onChange:T=>o(T.target.value),onKeyPress:T=>T.key==="Enter"&&M(),placeholder:"Enter DID to verify (e.g., did:webvh:example.com:products:window-123)",className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 transition-colors"}),s.jsxs("button",{onClick:M,disabled:l||!i.trim(),className:"px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:bg-gray-400 dark:disabled:bg-gray-600 disabled:cursor-not-allowed flex items-center gap-2 transition-colors",children:[s.jsx(Sr,{className:"w-4 h-4"}),l?"Verifying...":"Verify"]})]})]}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 mb-6 transition-colors",children:[s.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Verification History"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{onClick:()=>b("all"),className:`px-3 py-1.5 text-sm rounded-lg transition-colors ${g==="all"?"bg-purple-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:["All (",y.totalVerifications,")"]}),s.jsxs("button",{onClick:()=>b("valid"),className:`px-3 py-1.5 text-sm rounded-lg transition-colors flex items-center gap-1 ${g==="valid"?"bg-green-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[s.jsx(fe,{className:"w-3 h-3"}),"Valid (",y.validDIDs,")"]}),s.jsxs("button",{onClick:()=>b("invalid"),className:`px-3 py-1.5 text-sm rounded-lg transition-colors flex items-center gap-1 ${g==="invalid"?"bg-red-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[s.jsx(Ge,{className:"w-3 h-3"}),"Invalid (",y.invalidDIDs,")"]}),s.jsxs("button",{onClick:()=>b("warning"),className:`px-3 py-1.5 text-sm rounded-lg transition-colors flex items-center gap-1 ${g==="warning"?"bg-yellow-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[s.jsx(Hn,{className:"w-3 h-3"}),"Warning (",y.warningDIDs,")"]})]})]})}),s.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:Y.length===0?s.jsxs("div",{className:"p-8 text-center text-gray-500 dark:text-gray-400",children:[s.jsx(Sr,{className:"w-12 h-12 mx-auto mb-3 text-gray-400 dark:text-gray-500"}),s.jsx("p",{children:"No verifications yet. Enter a DID above to verify."})]}):Y.map(T=>s.jsxs("div",{className:"p-4",children:[s.jsxs("div",{className:"flex items-center justify-between cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 p-3 rounded-lg transition-colors",onClick:()=>h(d===T.dppId?null:T.dppId),children:[s.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[s.jsx(Re,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:T.dppName}),T.verification.status==="valid"&&s.jsxs("span",{className:"flex items-center gap-1 px-2 py-1 text-xs rounded-full bg-green-100 dark:bg-green-900/50 text-green-700 dark:text-green-300",children:[s.jsx(fe,{className:"w-3 h-3"}),"Valid"]}),T.verification.status==="invalid"&&s.jsxs("span",{className:"flex items-center gap-1 px-2 py-1 text-xs rounded-full bg-red-100 dark:bg-red-900/50 text-red-700 dark:text-red-300",children:[s.jsx(Ge,{className:"w-3 h-3"}),"Invalid"]}),T.verification.status==="warning"&&s.jsxs("span",{className:"flex items-center gap-1 px-2 py-1 text-xs rounded-full bg-yellow-100 dark:bg-yellow-900/50 text-yellow-700 dark:text-yellow-300",children:[s.jsx(Hn,{className:"w-3 h-3"}),"Warning"]})]}),s.jsx("p",{className:"text-sm font-mono text-gray-500 dark:text-gray-400",children:T.verification.did}),s.jsxs("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:["Verified: ",new Date(T.verification.timestamp).toLocaleString()]})]})]}),s.jsx("button",{className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-600 rounded transition-colors",children:d===T.dppId?s.jsx(Pt,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"}):s.jsx(lt,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})})]}),d===T.dppId&&s.jsxs("div",{className:"ml-8 mt-4 space-y-3",children:[s.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 space-y-2 transition-colors",children:[s.jsx("h4",{className:"font-semibold text-sm text-gray-900 dark:text-white mb-3",children:"Verification Checks"}),s.jsxs("div",{className:"flex items-start gap-2",children:[T.verification.checks.hashChain.valid?s.jsx(fe,{className:"w-4 h-4 text-green-600 dark:text-green-400 mt-0.5"}):s.jsx(Ge,{className:"w-4 h-4 text-red-600 dark:text-red-400 mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Hash Chain"}),s.jsx("button",{onClick:()=>V("Hash Chain Verification",T.verification.checks.hashChain,T.verification),className:"text-xs text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 hover:underline text-left",children:T.verification.checks.hashChain.message})]})]}),s.jsxs("div",{className:"flex items-start gap-2",children:[T.verification.checks.controllerSignatures.valid?s.jsx(fe,{className:"w-4 h-4 text-green-600 mt-0.5"}):s.jsx(Ge,{className:"w-4 h-4 text-red-600 mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Controller Signatures"}),s.jsx("button",{onClick:()=>V("Controller Signatures Verification",T.verification.checks.controllerSignatures,T.verification),className:"text-xs text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 hover:underline text-left",children:T.verification.checks.controllerSignatures.message})]})]}),s.jsxs("div",{className:"flex items-start gap-2",children:[T.verification.checks.witnessProofs.valid?s.jsx(fe,{className:"w-4 h-4 text-green-600 mt-0.5"}):s.jsx(Ge,{className:"w-4 h-4 text-red-600 mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Witness Proofs"}),s.jsx("button",{onClick:()=>V("Witness Proofs Verification",T.verification.checks.witnessProofs,T.verification),className:"text-xs text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 hover:underline text-left",children:T.verification.checks.witnessProofs.message})]})]}),s.jsxs("div",{className:"flex items-start gap-2",children:[T.verification.checks.documentConsistency.valid?s.jsx(fe,{className:"w-4 h-4 text-green-600 mt-0.5"}):s.jsx(Ge,{className:"w-4 h-4 text-red-600 mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Document Consistency"}),s.jsx("button",{onClick:()=>V("Document Consistency Verification",T.verification.checks.documentConsistency,T.verification),className:"text-xs text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 hover:underline text-left",children:T.verification.checks.documentConsistency.message})]})]})]}),s.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[s.jsx("h4",{className:"font-semibold text-sm text-gray-900 dark:text-white mb-2",children:"History Summary"}),s.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:[T.verification.history.length," operations in history"]}),s.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:[T.verification.attestations.length," attestations recorded"]})]}),T.components&&T.components.length>0&&s.jsxs("div",{className:"mt-4",children:[s.jsxs("h4",{className:"font-semibold text-sm text-gray-900 dark:text-white mb-3",children:["Components (",T.components.length,")"]}),s.jsx("div",{className:"space-y-2",children:T.components.map(B=>s.jsxs("div",{className:"bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg p-3",children:[s.jsxs("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>{const R=new Set(u);R.has(B.verification.did)?R.delete(B.verification.did):R.add(B.verification.did),f(R)},children:[s.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[s.jsx(Re,{className:"w-4 h-4 text-gray-500"}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-medium text-sm text-gray-900 dark:text-white",children:B.name}),B.verification.status==="valid"&&s.jsx(fe,{className:"w-3 h-3 text-green-600"}),B.verification.status==="invalid"&&s.jsx(Ge,{className:"w-3 h-3 text-red-600"}),B.verification.status==="warning"&&s.jsx(Hn,{className:"w-3 h-3 text-yellow-600"})]}),s.jsx("p",{className:"text-xs font-mono text-gray-500",children:B.verification.did})]})]}),u.has(B.verification.did)?s.jsx(Pt,{className:"w-4 h-4 text-gray-600"}):s.jsx(lt,{className:"w-4 h-4 text-gray-600"})]}),u.has(B.verification.did)&&s.jsxs("div",{className:"mt-3 space-y-2 pl-6 border-l-2 border-gray-200",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-start gap-2",children:[B.verification.checks.hashChain.valid?s.jsx(fe,{className:"w-3 h-3 text-green-600 mt-0.5"}):s.jsx(Ge,{className:"w-3 h-3 text-red-600 mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-xs font-medium text-gray-900 dark:text-white",children:"Hash Chain"}),s.jsx("button",{onClick:()=>V("Hash Chain Verification",B.verification.checks.hashChain,B.verification),className:"text-xs text-blue-600 hover:text-blue-800 hover:underline text-left",children:B.verification.checks.hashChain.message})]})]}),s.jsxs("div",{className:"flex items-start gap-2",children:[B.verification.checks.controllerSignatures.valid?s.jsx(fe,{className:"w-3 h-3 text-green-600 mt-0.5"}):s.jsx(Ge,{className:"w-3 h-3 text-red-600 mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-xs font-medium text-gray-900 dark:text-white",children:"Controller Signatures"}),s.jsx("button",{onClick:()=>V("Controller Signatures Verification",B.verification.checks.controllerSignatures,B.verification),className:"text-xs text-blue-600 hover:text-blue-800 hover:underline text-left",children:B.verification.checks.controllerSignatures.message})]})]}),s.jsxs("div",{className:"flex items-start gap-2",children:[B.verification.checks.witnessProofs.valid?s.jsx(fe,{className:"w-3 h-3 text-green-600 mt-0.5"}):s.jsx(Ge,{className:"w-3 h-3 text-red-600 mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-xs font-medium text-gray-900 dark:text-white",children:"Witness Proofs"}),s.jsx("button",{onClick:()=>V("Witness Proofs Verification",B.verification.checks.witnessProofs,B.verification),className:"text-xs text-blue-600 hover:text-blue-800 hover:underline text-left",children:B.verification.checks.witnessProofs.message})]})]}),s.jsxs("div",{className:"flex items-start gap-2",children:[B.verification.checks.documentConsistency.valid?s.jsx(fe,{className:"w-3 h-3 text-green-600 mt-0.5"}):s.jsx(Ge,{className:"w-3 h-3 text-red-600 mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-xs font-medium text-gray-900 dark:text-white",children:"Document Consistency"}),s.jsx("button",{onClick:()=>V("Document Consistency Verification",B.verification.checks.documentConsistency,B.verification),className:"text-xs text-blue-600 hover:text-blue-800 hover:underline text-left",children:B.verification.checks.documentConsistency.message})]})]})]}),s.jsx("div",{className:"bg-gray-50 rounded p-2 mt-2",children:s.jsxs("p",{className:"text-xs text-gray-600",children:[B.verification.history.length," operations, ",B.verification.attestations.length," attestations"]})})]})]},B.verification.did))})]})]})]},T.dppId))})]})]}),m&&p&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold text-gray-900",children:p.title}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:p.verification.dppName})]}),s.jsx("button",{onClick:()=>x(!1),className:"text-gray-400 hover:text-gray-600",children:s.jsx(Pr,{className:"w-6 h-6"})})]})}),s.jsxs("div",{className:"p-6 overflow-y-auto flex-1",children:[s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[p.check.valid?s.jsx(fe,{className:"w-6 h-6 text-green-600"}):s.jsx(Ge,{className:"w-6 h-6 text-red-600"}),s.jsx("span",{className:"text-lg font-semibold text-gray-900",children:p.check.valid?"Valid":"Invalid"})]}),s.jsx("p",{className:"text-gray-700",children:p.check.message})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[s.jsx("h4",{className:"font-semibold text-sm text-gray-900 mb-2",children:"DID Information"}),s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-xs text-gray-500 min-w-[60px]",children:"DID:"}),s.jsx("span",{className:"text-xs font-mono text-gray-900 break-all",children:p.verification.did})]}),s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-xs text-gray-500 min-w-[60px]",children:"Type:"}),s.jsx("span",{className:"text-xs text-gray-900",children:p.verification.dppType||"N/A"})]}),s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-xs text-gray-500 min-w-[60px]",children:"Verified:"}),s.jsx("span",{className:"text-xs text-gray-900",children:new Date(p.verification.timestamp).toLocaleString()})]})]})]}),p.title==="Document Consistency Verification"&&!p.check.valid&&s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:[s.jsx("h4",{className:"font-semibold text-sm text-red-900 mb-2",children:"Owner Mismatch Details"}),s.jsx("p",{className:"text-sm text-red-800 mb-3",children:"The current owner in the DID document does not match the expected owner from the most recent approved ownership transfer in the history."}),p.check.details&&s.jsx("div",{className:"bg-white rounded p-3 mb-3",children:s.jsxs("div",{className:"space-y-2 text-xs",children:[s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-semibold text-red-900 min-w-[120px]",children:"Current Owner:"}),s.jsx("span",{className:"font-mono text-red-800 break-all",children:p.check.details.currentOwner})]}),s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-semibold text-green-900 min-w-[120px]",children:"Expected Owner:"}),s.jsx("span",{className:"font-mono text-green-800 break-all",children:p.check.details.expectedOwner})]}),p.check.details.transferFrom&&s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-semibold text-gray-700 min-w-[120px]",children:"Transferred From:"}),s.jsx("span",{className:"font-mono text-gray-600 break-all",children:p.check.details.transferFrom})]}),p.check.details.lastTransferTimestamp&&s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"font-semibold text-gray-700 min-w-[120px]",children:"Transfer Time:"}),s.jsx("span",{className:"text-gray-600",children:new Date(p.check.details.lastTransferTimestamp).toLocaleString()})]})]})}),s.jsx("div",{className:"space-y-2",children:s.jsxs("div",{children:[s.jsx("span",{className:"text-xs font-semibold text-red-900",children:"Possible causes:"}),s.jsxs("ul",{className:"list-disc list-inside text-xs text-red-800 mt-1 space-y-1",children:[s.jsx("li",{children:"Ownership transfer was not properly recorded in DID document"}),s.jsx("li",{children:"DID document was manually modified outside of proper procedures"}),s.jsx("li",{children:"History tampering or incomplete synchronization"})]})]})})]}),p.title==="Witness Proofs Verification"&&p.check.details&&s.jsxs("div",{className:`border rounded-lg p-4 mb-6 ${p.check.valid?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[s.jsx("h4",{className:`font-semibold text-sm mb-2 ${p.check.valid?"text-green-900":"text-red-900"}`,children:"Witness Proofs Details"}),s.jsxs("div",{className:"bg-white rounded p-3 mb-3",children:[s.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs mb-2",children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold text-gray-700",children:"Total:"})," ",p.check.details.totalOperations]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold text-green-700",children:"Approved:"})," ",p.check.details.approved]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold text-yellow-700",children:"Pending:"})," ",p.check.details.pending]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold text-red-700",children:"Rejected:"})," ",p.check.details.rejected]})]}),p.check.details.proofs&&p.check.details.proofs.length>0&&s.jsxs("div",{className:"mt-3 space-y-2",children:[s.jsx("p",{className:"text-xs font-semibold text-gray-700",children:"Proof Details:"}),p.check.details.proofs.map((T,B)=>s.jsxs("div",{className:"bg-gray-50 rounded p-3 text-xs space-y-2",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"font-medium",children:T.type}),s.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${T.status==="approved"?"bg-green-100 text-green-800":T.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:T.status})]}),s.jsxs("div",{className:"text-gray-600",children:[s.jsx("span",{className:"font-semibold",children:"Witness:"})," ",s.jsx("span",{className:"font-mono text-xs",children:T.witness})]}),s.jsxs("div",{className:"text-gray-600",children:[s.jsx("span",{className:"font-semibold",children:"Time:"})," ",new Date(T.timestamp).toLocaleString()]}),T.eventData&&Object.keys(T.eventData).length>0&&s.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-200",children:[s.jsx("p",{className:"font-semibold text-gray-700 mb-1",children:"Event Data:"}),s.jsxs("div",{className:"space-y-1",children:[T.eventData.previousOwner&&s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold text-gray-600",children:"Previous Owner:"}),s.jsx("div",{className:"font-mono text-xs text-gray-700 break-all ml-2",children:T.eventData.previousOwner})]}),T.eventData.newOwner&&s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold text-gray-600",children:"New Owner:"}),s.jsx("div",{className:"font-mono text-xs text-gray-700 break-all ml-2",children:T.eventData.newOwner})]}),T.eventData.oldKeyId&&s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold text-gray-600",children:"Old Key:"}),s.jsx("span",{className:"font-mono text-xs text-gray-700 ml-2",children:T.eventData.oldKeyId})]}),T.eventData.newKeyId&&s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold text-gray-600",children:"New Key:"}),s.jsx("span",{className:"font-mono text-xs text-gray-700 ml-2",children:T.eventData.newKeyId})]}),T.eventData.transferMethod&&s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold text-gray-600",children:"Transfer Method:"}),s.jsx("span",{className:"text-gray-700 ml-2",children:T.eventData.transferMethod})]}),T.eventData.organization&&s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold text-gray-600",children:"Organization:"}),s.jsx("span",{className:"text-gray-700 ml-2",children:T.eventData.organization})]})]})]}),T.signature&&s.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-200",children:[s.jsx("span",{className:"font-semibold text-gray-600",children:"Signature:"}),s.jsx("div",{className:"font-mono text-xs text-gray-700 break-all mt-1",children:T.signature})]})]},B))]})]}),!p.check.valid&&s.jsx("div",{className:"space-y-2",children:s.jsxs("div",{children:[s.jsx("span",{className:"text-xs font-semibold text-red-900",children:"Possible causes:"}),s.jsxs("ul",{className:"list-disc list-inside text-xs text-red-800 mt-1 space-y-1",children:[s.jsx("li",{children:"Operations are pending witness approval"}),s.jsx("li",{children:"Witness rejected the operation"}),s.jsx("li",{children:"Witness proofs were not properly recorded"})]})]})})]}),p.title==="Hash Chain Verification"&&p.check.details&&s.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-6",children:[s.jsx("h4",{className:"font-semibold text-sm text-green-900 mb-2",children:"Hash Chain Details"}),s.jsxs("div",{className:"bg-white rounded p-3",children:[s.jsxs("p",{className:"text-xs text-gray-700 mb-2",children:[s.jsx("span",{className:"font-semibold",children:"Total Entries:"})," ",p.check.details.totalEntries]}),p.check.details.entries&&p.check.details.entries.length>0&&s.jsxs("div",{className:"mt-3 space-y-2 max-h-60 overflow-y-auto",children:[s.jsx("p",{className:"text-xs font-semibold text-gray-700",children:"Chain Entries:"}),p.check.details.entries.map((T,B)=>s.jsxs("div",{className:"bg-gray-50 rounded p-2 text-xs",children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("span",{className:"font-medium",children:["Entry ",T.index]}),s.jsx("span",{className:"text-gray-600",children:T.type})]}),s.jsxs("div",{className:"text-gray-600 mt-1",children:["Hash: ",s.jsx("span",{className:"font-mono text-xs",children:T.hash})]}),s.jsxs("div",{className:"text-gray-600",children:["Time: ",new Date(T.timestamp).toLocaleString()]})]},B))]})]})]}),p.title==="Controller Signatures Verification"&&p.check.details&&s.jsxs("div",{className:`border rounded-lg p-4 mb-6 ${p.check.valid?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[s.jsx("h4",{className:`font-semibold text-sm mb-2 ${p.check.valid?"text-green-900":"text-red-900"}`,children:"Controller Signatures Details"}),s.jsxs("div",{className:"bg-white rounded p-3",children:[s.jsxs("p",{className:"text-xs text-gray-700 mb-2",children:[s.jsx("span",{className:"font-semibold",children:"Total Operations:"})," ",p.check.details.totalOperations]}),p.check.details.signatures&&p.check.details.signatures.length>0&&s.jsxs("div",{className:"mt-3 space-y-2 max-h-60 overflow-y-auto",children:[s.jsx("p",{className:"text-xs font-semibold text-gray-700",children:"Signatures:"}),p.check.details.signatures.map((T,B)=>s.jsxs("div",{className:"bg-gray-50 rounded p-2 text-xs",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"font-medium",children:T.type}),s.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${T.status==="Valid"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:T.status})]}),s.jsxs("div",{className:"text-gray-600 mt-1",children:["Signature: ",s.jsx("span",{className:"font-mono text-xs",children:T.signature})]}),s.jsxs("div",{className:"text-gray-600",children:["Time: ",new Date(T.timestamp).toLocaleString()]})]},B))]})]})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsx("h4",{className:"font-semibold text-sm text-gray-900 mb-2",children:"History Summary"}),s.jsxs("div",{className:"space-y-1",children:[s.jsxs("p",{className:"text-xs text-gray-600",children:["Total operations: ",p.verification.history.length]}),s.jsxs("p",{className:"text-xs text-gray-600",children:["Total attestations: ",p.verification.attestations.length]})]})]})]}),s.jsx("div",{className:"p-6 border-t border-gray-200",children:s.jsx("button",{onClick:()=>x(!1),className:"w-full px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 transition-colors",children:"Close"})})]})})]})}function C5({onNavigate:t,onBack:e,onCreateDPP:r,onClose:n}){const{currentRoleDID:a}=Xt(),[i,o]=_.useState([]),[l,c]=_.useState(!0),[d,h]=_.useState(""),[u,f]=_.useState(1),g=20,[b,y]=_.useState({total:0,active:0,recycled:0}),[k,m]=_.useState([]),[x,p]=_.useState([]),v=_.useCallback(async()=>{c(!0);const ie=(await te.getAllDPPs()).filter(T=>T.owner===a||T.custodian===a),z=ie.filter(T=>T.lifecycle_status==="active").length,Y=ie.filter(T=>T.lifecycle_status==="recycled").length;o(ie),y({total:ie.length,active:z,recycled:Y}),c(!1)},[a]);_.useEffect(()=>{v()},[v]);const N=async()=>{if(window.confirm("Are you sure you want to reset all data? This will delete all existing products and generate new test data with updated DIDs.")){c(!0);try{const M=indexedDB.deleteDatabase("dpp-enhanced-db");M.onsuccess=async()=>{console.log("Database deleted successfully"),window.location.reload()},M.onerror=()=>{console.error("Error deleting database"),c(!1)}}catch(M){console.error("Error resetting data:",M),c(!1)}}},A=Array.from(new Set(i.map(M=>M.metadata.productType||"Other"))).sort((M,ie)=>M.toLowerCase()==="window"?-1:ie.toLowerCase()==="window"?1:M.localeCompare(ie)),D=Array.from(new Set(i.map(M=>M.lifecycle_status))).sort(),E=i.filter(M=>{const ie=M.model.toLowerCase().includes(d.toLowerCase())||M.did.toLowerCase().includes(d.toLowerCase()),z=M.metadata.productType||"Other",Y=k.length===0||k.includes(z),T=x.length===0||x.includes(M.lifecycle_status);return ie&&Y&&T}),L=M=>{m(ie=>ie.includes(M)?ie.filter(z=>z!==M):[...ie,M]),f(1)},C=M=>{p(ie=>ie.includes(M)?ie.filter(z=>z!==M):[...ie,M]),f(1)},O=Math.ceil(E.length/g),V=E.slice((u-1)*g,u*g);return s.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 pb-12 transition-colors",children:[s.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 sticky top-0 z-30 transition-colors",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"flex justify-between items-center h-16",children:[s.jsxs("div",{className:"flex items-center gap-3 ml-72",children:[s.jsx("button",{onClick:n||e,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors mr-2",title:"Back to Dashboard",children:s.jsx(Yo,{className:"w-5 h-5 text-gray-600 dark:text-gray-300"})}),s.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900 rounded-lg",children:s.jsx(zb,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),s.jsx("div",{children:s.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Manufacturer Wallet"})})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("button",{onClick:N,className:"flex items-center gap-2 px-3 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/30 rounded-lg transition-colors border border-red-200 dark:border-red-700",title:"Reset all data and regenerate with new DIDs",children:[s.jsx(qm,{className:"w-4 h-4"}),s.jsx("span",{className:"hidden sm:inline",children:"Reset Data"})]}),r&&s.jsxs("button",{onClick:r,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-sm",children:[s.jsx(Re,{className:"w-4 h-4"}),s.jsx("span",{children:"New Product"})]})]})]})})}),s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700 shadow-sm transition-colors",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/50 rounded-lg",children:s.jsx(Re,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),s.jsx("span",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded-full",children:"Total Assets"})]}),s.jsx("div",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:b.total}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Registered products"})]}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700 shadow-sm transition-colors",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("div",{className:"p-3 bg-green-50 dark:bg-green-900/50 rounded-lg",children:s.jsx(Zm,{className:"w-6 h-6 text-green-600 dark:text-green-400"})}),s.jsx("span",{className:"text-xs font-medium text-green-600 dark:text-green-400 bg-green-50 dark:bg-green-900/50 px-2 py-1 rounded-full",children:"Active"})]}),s.jsx("div",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:b.active}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Currently in circulation"})]}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700 shadow-sm transition-colors",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("div",{className:"p-3 bg-purple-50 dark:bg-purple-900/50 rounded-lg",children:s.jsx(uu,{className:"w-6 h-6 text-purple-600 dark:text-purple-400"})}),s.jsx("span",{className:"text-xs font-medium text-purple-600 dark:text-purple-400 bg-purple-50 dark:bg-purple-900/50 px-2 py-1 rounded-full",children:"Recycled"})]}),s.jsx("div",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:b.recycled}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Processed end-of-life"})]})]}),s.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[s.jsx("div",{className:"w-full lg:w-64 flex-shrink-0 space-y-8",children:s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6 shadow-sm transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4 text-gray-900 dark:text-white font-semibold",children:[s.jsx(Bc,{className:"w-4 h-4"}),"Filters"]}),s.jsxs("div",{className:"mb-6",children:[s.jsx("h3",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-3",children:"Product Type"}),s.jsx("div",{className:"space-y-2",children:A.map(M=>s.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group",children:[s.jsx("div",{className:`w-5 h-5 rounded border flex items-center justify-center transition-colors ${k.includes(M)?"bg-blue-600 border-blue-600 text-white":"border-gray-300 dark:border-gray-600 group-hover:border-blue-400 bg-white dark:bg-gray-700"}`,children:k.includes(M)&&s.jsx($p,{className:"w-3 h-3"})}),s.jsx("input",{type:"checkbox",className:"hidden",checked:k.includes(M),onChange:()=>L(M)}),s.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300 group-hover:text-gray-900 dark:group-hover:text-white capitalize",children:M}),s.jsx("span",{className:"ml-auto text-xs text-gray-400 dark:text-gray-500",children:i.filter(ie=>(ie.metadata.productType||"Other")===M).length})]},M))})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-3",children:"Status"}),s.jsx("div",{className:"space-y-2",children:D.map(M=>s.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group",children:[s.jsx("div",{className:`w-5 h-5 rounded border flex items-center justify-center transition-colors ${x.includes(M)?"bg-blue-600 border-blue-600 text-white":"border-gray-300 dark:border-gray-600 group-hover:border-blue-400 bg-white dark:bg-gray-700"}`,children:x.includes(M)&&s.jsx($p,{className:"w-3 h-3"})}),s.jsx("input",{type:"checkbox",className:"hidden",checked:x.includes(M),onChange:()=>C(M)}),s.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300 group-hover:text-gray-900 dark:group-hover:text-white capitalize",children:M}),s.jsx("span",{className:"ml-auto text-xs text-gray-400 dark:text-gray-500",children:i.filter(ie=>ie.lifecycle_status===M).length})]},M))})]})]})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"relative mb-6",children:[s.jsx(Sr,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 dark:text-gray-500"}),s.jsx("input",{type:"text",placeholder:"Search by Model or DID...",value:d,onChange:M=>h(M.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all shadow-sm text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500"})]}),l?s.jsx("div",{className:"flex justify-center py-12",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):E.length===0?s.jsxs("div",{className:"text-center py-16 bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 border-dashed transition-colors",children:[s.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gray-50 dark:bg-gray-700 rounded-full mb-4",children:s.jsx(Bb,{className:"w-8 h-8 text-gray-400 dark:text-gray-500"})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-1",children:"No products found"}),s.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-6",children:"Try adjusting your filters or search terms."}),s.jsx("button",{onClick:()=>{h(""),m([]),p([])},className:"text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 font-medium",children:"Clear all filters"})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"flex flex-col gap-3",children:V.map(M=>s.jsx("div",{className:"group relative",children:s.jsx(Gb,{dpp:M,onClick:()=>t(M.did,"manufacturer-wallet"),viewMode:"list"})},M.id))}),O>1&&s.jsxs("div",{className:"flex items-center justify-between border-t border-gray-200 dark:border-gray-700 mt-6 pt-6",children:[s.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Showing ",s.jsx("span",{className:"font-medium",children:(u-1)*g+1})," to"," ",s.jsx("span",{className:"font-medium",children:Math.min(u*g,E.length)})," ","of ",s.jsx("span",{className:"font-medium",children:E.length})," results"]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{onClick:()=>f(M=>Math.max(1,M-1)),disabled:u===1,className:"flex items-center gap-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[s.jsx(oj,{className:"w-4 h-4"}),"Previous"]}),s.jsxs("button",{onClick:()=>f(M=>Math.min(O,M+1)),disabled:u===O,className:"flex items-center gap-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:["Next",s.jsx(qu,{className:"w-4 h-4"})]})]})]})]})]})]})]})]})}function D5({onRegisterWindow:t,onNavigate:e}){const{currentRoleDID:r}=Xt(),[n,a]=_.useState([]),[i,o]=_.useState(!0),[l,c]=_.useState(0);_.useEffect(()=>{d()},[r]);async function d(){o(!0);try{const f=(await te.getAllDPPs()).filter(k=>k.owner===r||k.custodian===r),g=new Date;g.setHours(0,0,0,0);const b=f.filter(k=>new Date(k.created_at)>=g);c(b.length);const y=f.filter(k=>k.type==="main").sort((k,m)=>new Date(m.created_at).getTime()-new Date(k.created_at).getTime()).slice(0,5);a(y)}catch(u){console.error("Error loading recent items:",u)}finally{o(!1)}}const h=(u,f)=>{u.stopPropagation(),navigator.clipboard.writeText(f)};return s.jsxs("div",{className:"min-h-screen bg-white dark:bg-gray-900 transition-colors",children:[s.jsx("div",{className:"border-b border-gray-100 dark:border-gray-800 px-6 py-6",children:s.jsxs("div",{className:"max-w-2xl mx-auto",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Welcome, Manufacturer"}),s.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"What would you like to do today?"})]})}),s.jsxs("div",{className:"max-w-2xl mx-auto px-6 py-8",children:[s.jsx("div",{className:"mb-8",children:s.jsx("button",{onClick:t,className:"w-full bg-gray-900 dark:bg-blue-600 hover:bg-gray-800 dark:hover:bg-blue-700 text-white rounded-2xl p-8 shadow-lg hover:shadow-xl transition-all transform hover:scale-[1.02] active:scale-[0.98] border-2 border-gray-900 dark:border-blue-600",children:s.jsxs("div",{className:"flex flex-col items-center gap-4",children:[s.jsx("div",{className:"w-20 h-20 bg-white/10 rounded-full flex items-center justify-center",children:s.jsx(Ym,{className:"w-10 h-10"})}),s.jsxs("div",{className:"text-center",children:[s.jsx("span",{className:"text-2xl font-bold block",children:"Register New Window"}),s.jsx("span",{className:"text-gray-300 dark:text-blue-200 text-sm mt-1 block",children:"Click here to add a new product"})]})]})})}),s.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl border-2 border-gray-100 dark:border-gray-700 p-6 mb-8 shadow-sm transition-colors",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-14 h-14 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center",children:s.jsx(fe,{className:"w-7 h-7 text-gray-700 dark:text-gray-300"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 font-medium",children:"Registered Today"}),s.jsx("p",{className:"text-4xl font-bold text-gray-900 dark:text-white",children:l})]})]}),s.jsx("div",{className:"text-right",children:s.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500",children:"Keep up the good work! "})})]})}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border-2 border-gray-100 dark:border-gray-700 shadow-sm overflow-hidden transition-colors",children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-100 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50",children:s.jsxs("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[s.jsx(Wr,{className:"w-5 h-5 text-gray-400 dark:text-gray-500"}),"Recently Added"]})}),i?s.jsx("div",{className:"p-8 text-center",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 dark:border-white mx-auto"})}):n.length===0?s.jsxs("div",{className:"p-8 text-center text-gray-500 dark:text-gray-400",children:[s.jsx(Re,{className:"w-12 h-12 mx-auto mb-3 text-gray-300 dark:text-gray-600"}),s.jsx("p",{className:"font-medium",children:"No products registered yet."}),s.jsx("p",{className:"text-sm",children:"Click the button above to get started!"})]}):s.jsx("div",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:n.map(u=>s.jsxs("button",{onClick:()=>e(u.did),className:"w-full px-6 py-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors text-left",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-12 h-12 bg-gray-100 dark:bg-gray-700 rounded-lg flex items-center justify-center",children:s.jsx(Re,{className:"w-6 h-6 text-gray-600 dark:text-gray-400"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:u.model}),s.jsxs("div",{className:"flex items-center gap-2 mt-1 mb-1",children:[s.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 font-mono bg-gray-50 dark:bg-gray-700 px-1.5 py-0.5 rounded border border-gray-100 dark:border-gray-600 flex items-center",children:u.did.length>20?`...${u.did.slice(-8)}`:u.did}),s.jsx("button",{onClick:f=>h(f,u.did),className:"p-1 text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/30 rounded-full transition-colors",title:"Copy DID",children:s.jsx(Rb,{className:"w-3 h-3"})})]}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:new Date(u.created_at).toLocaleString("en-US",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})})]})]}),s.jsx(qu,{className:"w-5 h-5 text-gray-400 dark:text-gray-500"})]},u.id))})]}),s.jsx("p",{className:"text-center text-gray-400 dark:text-gray-500 text-sm mt-8",children:"Need help? Contact your supervisor."})]})]})}function P5({onNavigate:t}){const[e,r]=_.useState([]),[n,a]=_.useState(!0),[i,o]=_.useState(""),[l,c]=_.useState("all"),[d,h]=_.useState({total:0,today:0,thisWeek:0,activeOperators:0,pendingValidation:0,yesterdayCount:0});_.useEffect(()=>{u()},[]);async function u(){a(!0);try{const g=await te.getAllDPPs();r(g);const b=new Date,y=new Date(b.getFullYear(),b.getMonth(),b.getDate()),k=new Date(y.getTime()-7*24*60*60*1e3),m=g.filter(N=>new Date(N.created_at)>=y).length,x=g.filter(N=>new Date(N.created_at)>=k).length,p=new Date(y.getTime()-24*60*60*1e3),v=g.filter(N=>{const A=new Date(N.created_at);return A>=p&&A<y}).length;h({total:g.length,today:m,thisWeek:x,activeOperators:3,pendingValidation:Math.floor(g.length*.05),yesterdayCount:v})}catch(g){console.error("Error loading data:",g)}finally{a(!1)}}const f=e.filter(g=>{const b=g.model.toLowerCase().includes(i.toLowerCase())||g.did.toLowerCase().includes(i.toLowerCase()),y=l==="all"||g.lifecycle_status===l;return b&&y}).slice(0,20);return s.jsxs("div",{className:"min-h-screen bg-red-50 dark:bg-gray-900",children:[s.jsx("div",{className:"bg-gradient-to-r from-red-700 to-red-800 text-white",children:s.jsx("div",{className:"max-w-7xl mx-auto px-6 py-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold",children:"Production Control Center"}),s.jsx("p",{className:"text-red-100",children:"Production overview and quality control"})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-red-100",children:[s.jsx(Km,{className:"w-4 h-4"}),new Date().toLocaleDateString("en-US",{weekday:"long",day:"numeric",month:"long"})]})]})})}),s.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-8",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-8",children:[s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-5 border border-red-200 dark:border-red-800 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx(Re,{className:"w-8 h-8 text-red-600"}),s.jsx("span",{className:"text-xs font-medium text-gray-400",children:"TOTAL"})]}),s.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:d.total}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Products"})]}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-5 border border-red-200 dark:border-red-800 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx(Zm,{className:"w-8 h-8 text-green-600"}),s.jsxs("span",{className:"flex items-center gap-1 text-xs font-medium text-green-600 bg-green-50 px-2 py-0.5 rounded-full",children:[d.today>=d.yesterdayCount?s.jsx(ij,{className:"w-3 h-3"}):s.jsx(aj,{className:"w-3 h-3"}),d.today>=d.yesterdayCount?"+":"",d.today-d.yesterdayCount]})]}),s.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:d.today}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Today"})]}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-5 border border-red-200 dark:border-red-800 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx(Gp,{className:"w-8 h-8 text-red-600"}),s.jsx("span",{className:"text-xs font-medium text-gray-400",children:"7 DAYS"})]}),s.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:d.thisWeek}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"This Week"})]}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-5 border border-red-200 dark:border-red-800 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx(Dj,{className:"w-8 h-8 text-red-600"}),s.jsx("span",{className:"text-xs font-medium text-green-600",children:""})]}),s.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:d.activeOperators}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Active Workers"})]}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-5 border border-red-200 dark:border-red-800 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx(Hn,{className:"w-8 h-8 text-yellow-600"}),d.pendingValidation>0&&s.jsx("span",{className:"text-xs font-medium text-yellow-600 bg-yellow-50 px-2 py-0.5 rounded-full",children:"Action"})]}),s.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:d.pendingValidation}),s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Pending Validation"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[s.jsxs("button",{onClick:()=>{const g=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),b=URL.createObjectURL(g),y=document.createElement("a");y.href=b,y.download=`production-report-${new Date().toISOString().split("T")[0]}.json`,y.click(),URL.revokeObjectURL(b)},className:"flex items-center justify-center gap-2 bg-red-600 hover:bg-red-700 text-white py-3 px-4 rounded-xl transition-colors font-medium",children:[s.jsx(Ob,{className:"w-5 h-5"}),"Export Report"]}),s.jsxs("button",{onClick:()=>alert("Quality audit scheduled!"),className:"flex items-center justify-center gap-2 bg-white border border-red-200 hover:bg-red-50 text-red-700 py-3 px-4 rounded-xl transition-colors font-medium",children:[s.jsx(fe,{className:"w-5 h-5"}),"Schedule Audit"]}),s.jsxs("button",{onClick:()=>alert("Opening compliance dashboard..."),className:"flex items-center justify-center gap-2 bg-white border border-red-200 hover:bg-red-50 text-red-700 py-3 px-4 rounded-xl transition-colors font-medium",children:[s.jsx(qo,{className:"w-5 h-5"}),"Compliance"]}),s.jsxs("button",{onClick:()=>window.print(),className:"flex items-center justify-center gap-2 bg-white border border-red-200 hover:bg-red-50 text-red-700 py-3 px-4 rounded-xl transition-colors font-medium",children:[s.jsx(Gp,{className:"w-5 h-5"}),"Print Summary"]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"lg:col-span-2 bg-white dark:bg-gray-800 rounded-xl border border-red-200 dark:border-red-800 shadow-sm overflow-hidden",children:[s.jsx("div",{className:"p-4 border-b border-red-100",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx(Sr,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Search by model or DID...",value:i,onChange:g=>o(g.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-200 dark:border-gray-700 rounded-lg text-sm focus:ring-2 focus:ring-red-500 focus:border-red-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Bc,{className:"w-4 h-4 text-gray-400"}),s.jsxs("select",{value:l,onChange:g=>c(g.target.value),className:"text-sm border border-gray-200 rounded-lg px-3 py-2 focus:ring-2 focus:ring-red-500",children:[s.jsx("option",{value:"all",children:"All"}),s.jsx("option",{value:"active",children:"Active"}),s.jsx("option",{value:"pending",children:"Pending"})]})]})]})}),n?s.jsx("div",{className:"p-8 text-center",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-red-600 mx-auto"})}):s.jsx("div",{className:"divide-y divide-gray-100 max-h-[500px] overflow-y-auto",children:f.map(g=>s.jsxs("button",{onClick:()=>t(g.did),className:"w-full px-4 py-3 flex items-center justify-between hover:bg-red-50 transition-colors text-left",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`w-2 h-2 rounded-full ${g.lifecycle_status==="active"?"bg-green-500":"bg-yellow-500"}`}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:g.model}),s.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 font-mono",children:[g.did.slice(0,40),"..."]})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${g.type==="main"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-600"}`,children:g.type==="main"?"Main Product":"Component"}),s.jsx(Ha,{className:"w-4 h-4 text-gray-400"})]})]},g.id))})]}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-red-200 dark:border-red-800 shadow-sm overflow-hidden",children:[s.jsx("div",{className:"p-4 border-b border-red-100",children:s.jsxs("h3",{className:"font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[s.jsx(Wr,{className:"w-4 h-4 text-red-500"}),"Recent Activity"]})}),s.jsx("div",{className:"divide-y divide-gray-100 max-h-[500px] overflow-y-auto",children:e.slice(0,10).map((g,b)=>s.jsx("div",{className:"px-4 py-3",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${b===0?"bg-green-100":"bg-gray-100"}`,children:s.jsx(fe,{className:`w-4 h-4 ${b===0?"text-green-600":"text-gray-400"}`})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("p",{className:"text-sm text-gray-900 dark:text-white truncate",children:[g.model," registered"]}),s.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:new Date(g.created_at).toLocaleString("en-US",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})})]})]})},g.id))})]})]})]})]})}function I5({onNavigate:t}){const[e,r]=_.useState(""),[n,a]=_.useState(null),[i,o]=_.useState([]),[l,c]=_.useState(!1),[d,h]=_.useState(!1),[u,f]=_.useState([]),[g,b]=_.useState(!1);_.useEffect(()=>{y()},[]);async function y(){try{const A=(await te.getAllDPPs()).filter(D=>D.type==="main").sort((D,E)=>{var O,V;const L=parseInt(((O=D.model.match(/\d+/))==null?void 0:O[0])||"0"),C=parseInt(((V=E.model.match(/\d+/))==null?void 0:V[0])||"0");return L-C});f(A)}catch(N){console.error("Error loading windows:",N)}}async function k(){if(e.trim()){c(!0),h(!1),a(null),o([]);try{const N=await te.getAllDPPs(),A=N.find(D=>D.did.toLowerCase().includes(e.toLowerCase())||D.model.toLowerCase().includes(e.toLowerCase()));if(A){if(a(A),A.type==="main"){const E=(await te.getRelationshipsByParent(A.did)).map(C=>C.child_did),L=N.filter(C=>E.includes(C.did));o(L)}}else h(!0)}catch(N){console.error("Error searching:",N),h(!0)}finally{c(!1)}}}function m(N){var D,E,L;const A=(((D=N.metadata)==null?void 0:D.productType)||"").toLowerCase();if(A.includes("glass")){const C=((E=N.metadata)==null?void 0:E.thickness)||"4mm";return{icon:tc,material:"Glass",recyclable:!0,instructions:`Glass container - Thickness: ${C}. Ensure no frame residue attached`,color:"sky",thickness:C}}if(A.includes("frame")){const C=((L=N.metadata)==null?void 0:L.material)||"Aluminium";return{icon:Rc,material:C,recyclable:!0,instructions:C.toLowerCase().includes("aluminium")?"Metal container - Keep aluminium separate from steel":"Wood waste - Check for paint/coating",color:"purple",thickness:null}}return{icon:Re,material:"Mixed",recyclable:!0,instructions:"Disassemble components and sort separately",color:"blue",thickness:null}}function x(N){r(N.did),a(N),h(!1),N.type==="main"&&te.getRelationshipsByParent(N.did).then(async A=>{const D=await te.getAllDPPs(),E=A.map(C=>C.child_did),L=D.filter(C=>E.includes(C.did));o(L)})}function p(){a(null),o([]),r(""),h(!1)}async function v(){if(n){b(!0);try{await te.updateDPP(n.id,{lifecycle_status:"end_of_life"}),await te.insertAttestation({dpp_id:n.id,did:n.did,attestation_type:"recycling_completed",witness_did:"did:webvh:recycler.local:operator-1",signature:`recycling-sig-${Date.now()}`,attestation_data:{description:"Product marked as recycled - End of Life",recycled_by:"Recycler Operator",recycling_facility:"Local Recycling Center",lifecycle_change:"active -> end_of_life"}});for(const N of i)await te.updateDPP(N.id,{lifecycle_status:"end_of_life"}),await te.insertAttestation({dpp_id:N.id,did:N.did,attestation_type:"recycling_completed",witness_did:"did:webvh:recycler.local:operator-1",signature:`recycling-sig-comp-${Date.now()}-${N.id}`,attestation_data:{description:`Component recycled as part of ${n.model}`,parent_product:n.did,recycled_by:"Recycler Operator",recycling_facility:"Local Recycling Center",lifecycle_change:"active -> end_of_life"}});a({...n,lifecycle_status:"end_of_life"}),o(i.map(N=>({...N,lifecycle_status:"end_of_life"}))),await y(),alert(` ${n.model} and ${i.length} component(s) have been marked as recycled (End of Life)!

Recycling events have been logged.`)}catch(N){console.error("Error marking as recycled:",N),alert("Error updating lifecycle status")}finally{b(!1)}}}return s.jsxs("div",{className:"min-h-screen bg-green-50 dark:bg-gray-900",children:[s.jsx("div",{className:"bg-gradient-to-r from-green-700 to-green-800 text-white",children:s.jsxs("div",{className:"max-w-3xl mx-auto px-6 py-8",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx(rc,{className:"w-8 h-8"}),s.jsx("h1",{className:"text-2xl font-bold",children:"Recycler Portal"})]}),s.jsx("p",{className:"text-green-100",children:"Search a product to view material information"})]})}),s.jsxs("div",{className:"max-w-3xl mx-auto px-6 -mt-6",children:[s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-4 mb-6",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx(Sr,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Enter DID or product name...",value:e,onChange:N=>r(N.target.value),onKeyPress:N=>N.key==="Enter"&&k(),className:"w-full pl-12 pr-4 py-4 text-lg border border-gray-200 dark:border-gray-700 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),s.jsx("button",{onClick:k,disabled:l||!e.trim(),className:"px-6 bg-green-600 hover:bg-green-700 disabled:bg-gray-400 dark:disabled:bg-gray-600 text-white rounded-xl font-medium transition-colors flex items-center gap-2",children:l?s.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):s.jsxs(s.Fragment,{children:[s.jsx(Sr,{className:"w-5 h-5"}),"Search"]})})]}),s.jsx("div",{className:"flex items-center gap-4 mt-3 text-sm text-gray-500",children:s.jsxs("button",{onClick:()=>alert("QR Scanner would open here"),className:"flex items-center gap-1 hover:text-green-600 transition-colors",children:[s.jsx(Fb,{className:"w-4 h-4"}),"Scan QR code"]})})]}),d&&s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-8 text-center mb-6 border border-green-200 dark:border-green-700",children:[s.jsx(Hn,{className:"w-12 h-12 text-yellow-500 mx-auto mb-3"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Product not found"}),s.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Check the DID or product name and try again"})]}),n&&s.jsxs("div",{className:"space-y-4 mb-6",children:[s.jsxs("button",{onClick:p,className:"flex items-center gap-2 text-green-700 hover:text-green-800 font-medium transition-colors",children:[s.jsx(Yo,{className:"w-5 h-5"}),"Back to Quick Access"]}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-green-200 dark:border-green-700 overflow-hidden",children:[s.jsx("div",{className:"bg-gradient-to-r from-green-600 to-green-700 px-6 py-4 text-white",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-green-100 text-sm",children:"Product found"}),s.jsx("h2",{className:"text-xl font-bold",children:n.model})]}),s.jsx(fe,{className:"w-8 h-8"})]})}),s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Type"}),s.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:n.type==="main"?"Main Product (Window)":"Component"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Lifecycle Status"}),s.jsx("p",{className:`font-medium capitalize ${n.lifecycle_status==="end_of_life"?"text-red-600":"text-green-600"}`,children:n.lifecycle_status==="end_of_life"?" End of Life":n.lifecycle_status})]})]}),n.metadata&&s.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 mb-4 space-y-3",children:[s.jsxs("h4",{className:"font-medium text-gray-900 dark:text-white flex items-center gap-2",children:[s.jsx(Ro,{className:"w-4 h-4 text-green-600 dark:text-green-400"}),"Product Specifications"]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[n.metadata.dimensions?s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Dimensions"}),s.jsxs("p",{className:"font-medium text-gray-900 dark:text-white",children:[n.metadata.dimensions.width," x ",n.metadata.dimensions.height," ",n.metadata.dimensions.unit||"mm"]})]}):null,n.metadata.glazing_type?s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Glass Type"}),s.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:String(n.metadata.glazing_type)})]}):null,n.metadata.frame_material?s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Frame Material"}),s.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:String(n.metadata.frame_material)})]}):null,n.metadata.productType?s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Product Type"}),s.jsx("p",{className:"font-medium text-gray-900 dark:text-white capitalize",children:String(n.metadata.productType)})]}):null]}),n.metadata.description?s.jsxs("div",{className:"pt-2 border-t border-gray-200 dark:border-gray-600",children:[s.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"Description"}),s.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:String(n.metadata.description)})]}):null]}),s.jsxs("button",{onClick:()=>t(n.did),className:"w-full py-3 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg text-gray-700 dark:text-gray-200 font-medium transition-colors flex items-center justify-center gap-2",children:["View full DPP",s.jsx(Zn,{className:"w-4 h-4"})]})]})]}),i.length>0&&s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-green-200 dark:border-green-700 overflow-hidden",children:[s.jsxs("div",{className:"px-6 py-4 border-b border-green-100 dark:border-green-800 flex items-center gap-2",children:[s.jsx(tc,{className:"w-5 h-5 text-green-500"}),s.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Materials & Components"})]}),s.jsx("div",{className:"divide-y divide-gray-100",children:i.map(N=>{const A=m(N),D=A.icon;return s.jsx("div",{className:"p-4",children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center bg-${A.color}-100`,children:s.jsx(D,{className:`w-6 h-6 text-${A.color}-600`})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:N.model}),A.recyclable&&s.jsxs("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded-full flex items-center gap-1",children:[s.jsx(rc,{className:"w-3 h-3"}),"Recyclable"]})]}),s.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:["Material: ",A.material]}),s.jsxs("div",{className:"flex items-start gap-2 p-3 bg-green-50 dark:bg-green-900/30 rounded-lg",children:[s.jsx(Ro,{className:"w-4 h-4 text-green-600 dark:text-green-400 mt-0.5 flex-shrink-0"}),s.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:A.instructions})]})]})]})},N.id)})})]}),n.lifecycle_status!=="end_of_life"?s.jsx("button",{onClick:v,disabled:g,className:"w-full py-4 bg-green-600 hover:bg-green-700 disabled:bg-green-400 text-white rounded-xl font-medium transition-colors flex items-center justify-center gap-2",children:g?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Processing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(qm,{className:"w-5 h-5"}),"Mark as Recycled (End of Life)"]})}):s.jsxs("div",{className:"w-full py-4 bg-gray-100 text-gray-600 rounded-xl font-medium flex items-center justify-center gap-2",children:[s.jsx(fe,{className:"w-5 h-5 text-green-600"}),"Already Recycled"]})]}),!n&&!d&&s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-green-200 dark:border-green-700 overflow-hidden",children:[s.jsxs("div",{className:"px-6 py-4 border-b border-green-100 dark:border-green-800 flex items-center justify-between",children:[s.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Quick Access - All Windows"}),s.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[u.length," products"]})]}),s.jsx("div",{className:"divide-y divide-gray-100 max-h-[500px] overflow-y-auto",children:u.length===0?s.jsxs("div",{className:"px-6 py-8 text-center text-gray-500",children:[s.jsx(Re,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),s.jsx("p",{children:"No products found"})]}):u.map(N=>s.jsxs("button",{onClick:()=>x(N),className:"w-full px-6 py-4 flex items-center justify-between hover:bg-green-50 transition-colors text-left",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Re,{className:`w-8 h-8 ${N.lifecycle_status==="end_of_life"?"text-gray-400":"text-green-500"}`}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:N.model}),s.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 font-mono",children:[N.did.slice(0,35),"..."]})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[N.lifecycle_status==="end_of_life"&&s.jsx("span",{className:"text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded-full",children:" Recycled"}),s.jsx(Zn,{className:"w-5 h-5 text-green-500"})]})]},N.id))})]})]})]})}function T5({did:t,onNavigate:e}){var h;const[r,n]=_.useState(null),[a,i]=_.useState(!0),[o,l]=_.useState("story");_.useEffect(()=>{t?c(t):d()},[t]);async function c(u){i(!0);try{const f=await te.getDPPByDID(u);n(f)}catch(f){console.error("Error loading product:",f)}finally{i(!1)}}async function d(){i(!0);try{const f=(await te.getAllDPPs()).filter(g=>g.type==="main");if(f.length>0){const g=f[Math.floor(Math.random()*f.length)];n(g)}}catch(u){console.error("Error loading product:",u)}finally{i(!1)}}return a?s.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):r?s.jsxs("div",{className:"min-h-screen bg-blue-50 dark:bg-gray-900",children:[s.jsx("div",{className:"bg-gradient-to-br from-blue-600 via-blue-700 to-indigo-800 text-white",children:s.jsxs("div",{className:"max-w-lg mx-auto px-6 py-8",children:[s.jsx("div",{className:"flex items-center gap-2 mb-4",children:s.jsxs("div",{className:"flex items-center gap-1.5 bg-white/20 backdrop-blur-sm rounded-full px-3 py-1.5",children:[s.jsx(Mt,{className:"w-4 h-4 text-green-300"}),s.jsx("span",{className:"text-sm font-medium",children:"Verified Product"})]})}),s.jsx("h1",{className:"text-3xl font-bold mb-2",children:r.model}),s.jsx("p",{className:"text-blue-200 mb-6",children:((h=r.metadata)==null?void 0:h.productType)||"Premium Window"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(Wp,{className:"w-4 h-4 text-green-300"}),s.jsx("span",{className:"text-sm text-blue-200",children:"Sustainability"})]}),s.jsx("p",{className:"text-xl font-bold",children:"A+"})]}),s.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(Km,{className:"w-4 h-4 text-blue-300"}),s.jsx("span",{className:"text-sm text-blue-200",children:"Produced"})]}),s.jsx("p",{className:"text-xl font-bold",children:new Date(r.created_at).toLocaleDateString("en-US",{month:"short",year:"numeric"})})]})]})]})}),s.jsxs("div",{className:"max-w-lg mx-auto px-6 -mt-4",children:[s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg mb-6 overflow-hidden border border-blue-200 dark:border-gray-700",children:[s.jsx("div",{className:"flex border-b border-blue-100",children:[{id:"story",label:"Story",icon:wj},{id:"maintenance",label:"Maintenance",icon:hu},{id:"warranty",label:"Warranty",icon:Pl}].map(u=>s.jsxs("button",{onClick:()=>l(u.id),className:`flex-1 py-4 flex flex-col items-center gap-1 text-sm font-medium transition-colors ${o===u.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50/50 dark:bg-blue-900/30":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"}`,children:[s.jsx(u.icon,{className:"w-5 h-5"}),u.label]},u.id))}),s.jsxs("div",{className:"p-6",children:[o==="story"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-3",children:"The journey of your window"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 flex items-center justify-center",children:s.jsx(fe,{className:"w-4 h-4 text-green-600"})}),s.jsx("div",{className:"w-0.5 h-full bg-blue-200 my-2"})]}),s.jsxs("div",{className:"pb-4",children:[s.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Manufactured"}),s.jsx("p",{className:"text-sm text-gray-500",children:new Date(r.created_at).toLocaleDateString("en-US",{day:"numeric",month:"long",year:"numeric"})}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Expertly crafted in the Netherlands"})]})]}),s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center",children:s.jsx(Mt,{className:"w-4 h-4 text-blue-600"})}),s.jsx("div",{className:"w-0.5 h-full bg-blue-200 my-2"})]}),s.jsxs("div",{className:"pb-4",children:[s.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Quality Control"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Tested and approved according to EN 14351-1"})]})]}),s.jsxs("div",{className:"flex gap-4",children:[s.jsx("div",{className:"flex flex-col items-center",children:s.jsx("div",{className:"w-8 h-8 rounded-full bg-purple-100 flex items-center justify-center",children:s.jsx(Pl,{className:"w-4 h-4 text-purple-600"})})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Certified"}),s.jsx("p",{className:"text-sm text-gray-600",children:"CE marking and KOMO quality mark"})]})]})]})]}),s.jsx("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-4 border border-green-200",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-green-100 flex items-center justify-center",children:s.jsx(Wp,{className:"w-5 h-5 text-green-600"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-green-900",children:"Sustainably produced"}),s.jsx("p",{className:"text-sm text-green-700",children:"100% recyclable materials"})]})]})})]}),o==="maintenance"&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Maintenance Tips"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex gap-3 p-3 bg-blue-50 dark:bg-blue-900/30 rounded-lg",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-100 dark:bg-blue-800 flex items-center justify-center flex-shrink-0",children:s.jsx("span",{className:"text-sm font-bold text-blue-600 dark:text-blue-300",children:"1"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Regular Cleaning"}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Clean the frame monthly with a damp cloth and mild soap."})]})]}),s.jsxs("div",{className:"flex gap-3 p-3 bg-blue-50 dark:bg-blue-900/30 rounded-lg",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-100 dark:bg-blue-800 flex items-center justify-center flex-shrink-0",children:s.jsx("span",{className:"text-sm font-bold text-blue-600 dark:text-blue-300",children:"2"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Lubricate Hinges"}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Apply silicone spray to hinges annually."})]})]}),s.jsxs("div",{className:"flex gap-3 p-3 bg-blue-50 dark:bg-blue-900/30 rounded-lg",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-100 dark:bg-blue-800 flex items-center justify-center flex-shrink-0",children:s.jsx("span",{className:"text-sm font-bold text-blue-600 dark:text-blue-300",children:"3"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:"Check Seals"}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Inspect rubber seals for wear and replace if needed."})]})]})]}),s.jsxs("button",{onClick:()=>{const u=`
# Maintenance Manual - ${r.model}

## Regular Cleaning
Clean the frame monthly with a damp cloth and mild soap.

## Lubricate Hinges  
Apply silicone spray to hinges annually.

## Check Seals
Inspect rubber seals for wear and replace if needed.

## Annual Inspection
Have a professional inspect the window annually.

Product DID: ${r.did}
                    `,f=new Blob([u],{type:"text/plain"}),g=URL.createObjectURL(f),b=document.createElement("a");b.href=g,b.download=`maintenance-manual-${r.model.replace(/\s+/g,"-")}.txt`,b.click(),URL.revokeObjectURL(g)},className:"w-full py-3 bg-blue-50 text-blue-600 rounded-lg font-medium flex items-center justify-center gap-2 hover:bg-blue-100 transition-colors",children:[s.jsx(Ob,{className:"w-4 h-4"}),"Download Full Manual"]})]}),o==="warranty"&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"text-center py-4",children:[s.jsx("div",{className:"w-16 h-16 rounded-full bg-green-100 flex items-center justify-center mx-auto mb-3",children:s.jsx(Pl,{className:"w-8 h-8 text-green-600"})}),s.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"10 Year Warranty"}),s.jsxs("p",{className:"text-gray-500",children:["Valid until ",new Date(new Date(r.created_at).getTime()+10*365*24*60*60*1e3).toLocaleDateString("en-US",{month:"long",year:"numeric"})]})]}),s.jsxs("div",{className:"bg-blue-50 rounded-xl p-4 space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(fe,{className:"w-5 h-5 text-green-600"}),s.jsx("span",{className:"text-gray-700",children:"Manufacturing defects covered"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(fe,{className:"w-5 h-5 text-green-600"}),s.jsx("span",{className:"text-gray-700",children:"Material warranty"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(fe,{className:"w-5 h-5 text-green-600"}),s.jsx("span",{className:"text-gray-700",children:"Free replacement parts"})]})]}),s.jsxs("button",{onClick:()=>{const u=encodeURIComponent(`Warranty Claim - ${r.model}`),f=encodeURIComponent(`
Product: ${r.model}
DID: ${r.did}
Warranty valid until: ${new Date(new Date(r.created_at).getTime()+10*365*24*60*60*1e3).toLocaleDateString("en-US",{month:"long",year:"numeric"})}

Please describe your issue:

                    `);window.open(`mailto:warranty@manufacturer.com?subject=${u}&body=${f}`),alert("Opening email client to submit warranty claim...")},className:"w-full py-3 bg-blue-600 text-white rounded-lg font-medium flex items-center justify-center gap-2 hover:bg-blue-700 transition-colors",children:["Submit Warranty Claim",s.jsx(qu,{className:"w-4 h-4"})]})]})]})]}),s.jsxs("div",{className:"flex gap-3 mb-8",children:[s.jsxs("button",{onClick:()=>{const u=`${window.location.origin}/product/${r.did}`;navigator.share?navigator.share({title:r.model,text:`Check out this verified product: ${r.model}`,url:u}):(navigator.clipboard.writeText(u),alert("Product link copied to clipboard!"))},className:"flex-1 py-3 bg-white border border-blue-200 rounded-xl font-medium text-gray-700 flex items-center justify-center gap-2 shadow-sm hover:bg-blue-50 transition-colors",children:[s.jsx(kj,{className:"w-4 h-4"}),"Share"]}),s.jsxs("button",{onClick:()=>e==null?void 0:e(r.did),className:"flex-1 py-3 bg-white border border-blue-200 rounded-xl font-medium text-gray-700 flex items-center justify-center gap-2 shadow-sm hover:bg-blue-50 transition-colors",children:[s.jsx(_o,{className:"w-4 h-4"}),"Technical Details"]})]}),s.jsxs("div",{className:"text-center pb-8",children:[s.jsx("p",{className:"text-xs text-gray-400",children:"Verified by Digital Product Passport"}),s.jsxs("p",{className:"text-xs text-gray-400 font-mono mt-1",children:[r.did.slice(0,30),"..."]})]})]})]}):s.jsx("div",{className:"min-h-screen bg-blue-50 dark:bg-gray-900 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Re,{className:"w-16 h-16 text-gray-300 dark:text-gray-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Product not found"})]})})}function _5({onClose:t,onComplete:e}){const{currentRoleDID:r}=Xt(),[n,a]=_.useState("intro"),[i,o]=_.useState(""),[l,c]=_.useState(1200),[d,h]=_.useState(1500),[u,f]=_.useState("Double glazing"),[g,b]=_.useState("Aluminium"),y=[{id:"window",label:"Window"},{id:"glass",label:"Glass"},{id:"frame",label:"Frame"},{id:"review",label:"Review"}];async function k(){a("creating");try{const p=`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,v=r.includes("glass-solutions")?"glass-solutions.com":r.includes("frame-masters")?"frame-masters.com":"example.com",N=`did:webvh:${v}:products:window-${p}`,A=`did:webvh:${v}:products:glass-${p}`,D=`did:webvh:${v}:products:frame-${p}`,E=await te.insertDPP({did:A,type:"component",model:`${u} Panel`,parent_did:N,lifecycle_status:"active",owner:r,custodian:r,metadata:{productType:"glass",glazing_type:u,thickness:u.includes("Triple")?36:24,description:`${u} for ${i}`},version:1,previous_version_id:null}),L=await te.insertDPP({did:D,type:"component",model:`${g} Frame`,parent_did:N,lifecycle_status:"active",owner:r,custodian:r,metadata:{productType:"frame",material:g,thermal_break:g==="Aluminium",description:`${g} frame for ${i}`},version:1,previous_version_id:null}),C=await te.insertDPP({did:N,type:"main",model:i||`Window-${p.slice(0,8)}`,parent_did:null,lifecycle_status:"active",owner:r,custodian:null,metadata:{productType:"window",dimensions:{width:l,height:d,unit:"mm"},glazing_type:u,frame_material:g,description:`${i} - ${l}x${d}mm`},version:1,previous_version_id:null});await te.insertRelationship({parent_did:N,child_did:A,relationship_type:"component",position:1,metadata:{role:"glazing",quantity:1}}),await te.insertRelationship({parent_did:N,child_did:D,relationship_type:"component",position:2,metadata:{role:"frame",quantity:1}}),await te.insertDIDDocument({dpp_id:C.id,did:N,controller:r,verification_method:[{id:`${N}#key-1`,type:"Ed25519VerificationKey2020",controller:r,publicKeyMultibase:`z6Mk${Math.random().toString(36).substring(2,15)}`}],service_endpoints:[{id:`${N}#dpp-service`,type:"DPPService",serviceEndpoint:`https://${v}/dpp/${N.split(":").pop()}`}],proof:{type:"Ed25519Signature2020",created:new Date().toISOString()},document_metadata:{created:!0,productType:"window"}}),await te.insertDIDDocument({dpp_id:E.id,did:A,controller:r,verification_method:[],service_endpoints:[],proof:{type:"Ed25519Signature2020"},document_metadata:{created:!0,productType:"glass"}}),await te.insertDIDDocument({dpp_id:L.id,did:D,controller:r,verification_method:[],service_endpoints:[],proof:{type:"Ed25519Signature2020"},document_metadata:{created:!0,productType:"frame"}}),await Js(C.id,N,"main"),await Js(E.id,A,"component"),await Js(L.id,D,"component"),await K0(C.id,N,[A,D]),a("success"),setTimeout(()=>{e()},2e3)}catch(x){console.error("Error creating DPP:",x),alert("Something went wrong. Please try again."),a("review")}}const m=y.findIndex(x=>x.id===n);return s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-2xl max-w-lg w-full max-h-[90vh] overflow-hidden shadow-2xl",children:[s.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"text-xl font-bold",children:"Register New Window"}),s.jsx("button",{onClick:t,disabled:n==="creating",className:"p-1 hover:bg-white/20 rounded-lg transition-colors disabled:opacity-50",children:s.jsx(Pr,{className:"w-5 h-5"})})]}),n!=="intro"&&n!=="creating"&&n!=="success"&&s.jsx("div",{className:"flex items-center justify-between",children:y.map((x,p)=>s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${m>p?"bg-green-500 text-white":m===p?"bg-white text-blue-600":"bg-blue-500/50 text-blue-200"}`,children:m>p?s.jsx(fe,{className:"w-5 h-5"}):p+1}),p<y.length-1&&s.jsx("div",{className:`w-12 h-0.5 mx-1 ${m>p?"bg-green-500":"bg-blue-500/50"}`})]},x.id))})]}),s.jsxs("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:[n==="intro"&&s.jsxs("div",{className:"text-center py-8",children:[s.jsx("div",{className:"w-20 h-20 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-6",children:s.jsx(Re,{className:"w-10 h-10 text-blue-600"})}),s.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-3",children:"Add a new window"}),s.jsx("p",{className:"text-gray-600 mb-8",children:"In a few simple steps, register a new window with glass and frame."}),s.jsxs("button",{onClick:()=>a("window"),className:"w-full py-4 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-medium transition-colors flex items-center justify-center gap-2",children:["Start Registration",s.jsx(Zn,{className:"w-5 h-5"})]})]}),n==="window"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-3 p-4 bg-blue-50 rounded-xl",children:[s.jsx(Re,{className:"w-8 h-8 text-blue-600"}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:"Step 1: Window Details"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Enter the basic information"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Window Name *"}),s.jsx("input",{type:"text",value:i,onChange:x=>o(x.target.value),placeholder:"e.g. Living Room Window Left",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-lg"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Width (mm)"}),s.jsx("input",{type:"number",value:l,onChange:x=>c(Number(x.target.value)),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-lg"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Height (mm)"}),s.jsx("input",{type:"number",value:d,onChange:x=>h(Number(x.target.value)),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-lg"})]})]})]}),n==="glass"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-3 p-4 bg-sky-50 rounded-xl",children:[s.jsx(tc,{className:"w-8 h-8 text-sky-600"}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:"Step 2: Glass Type"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Select the glass type"})]})]}),s.jsx("div",{className:"space-y-3",children:["Single glazing","Double glazing","Triple glazing","HR++ glazing"].map(x=>s.jsx("button",{onClick:()=>f(x),className:`w-full p-4 rounded-xl border-2 text-left transition-all ${u===x?"border-sky-500 bg-sky-50":"border-gray-200 hover:border-gray-300"}`,children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"font-medium text-gray-900",children:x}),u===x&&s.jsx(fe,{className:"w-5 h-5 text-sky-600"})]})},x))})]}),n==="frame"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-3 p-4 bg-purple-50 rounded-xl",children:[s.jsx(Rc,{className:"w-8 h-8 text-purple-600"}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:"Step 3: Frame Type"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Select the frame material"})]})]}),s.jsx("div",{className:"space-y-3",children:["Aluminium","Plastic (PVC)","Wood","Steel"].map(x=>s.jsx("button",{onClick:()=>b(x),className:`w-full p-4 rounded-xl border-2 text-left transition-all ${g===x?"border-purple-500 bg-purple-50":"border-gray-200 hover:border-gray-300"}`,children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"font-medium text-gray-900",children:x}),g===x&&s.jsx(fe,{className:"w-5 h-5 text-purple-600"})]})},x))})]}),n==="review"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-3 p-4 bg-green-50 rounded-xl",children:[s.jsx(Ro,{className:"w-8 h-8 text-green-600"}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:"Review the details"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Is everything correct?"})]})]}),s.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 space-y-4",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Name"}),s.jsx("span",{className:"font-medium text-gray-900",children:i||"(not entered)"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Dimensions"}),s.jsxs("span",{className:"font-medium text-gray-900",children:[l," x ",d," mm"]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Glass"}),s.jsx("span",{className:"font-medium text-gray-900",children:u})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Frame"}),s.jsx("span",{className:"font-medium text-gray-900",children:g})]})]})]}),n==="creating"&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto mb-6"}),s.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Registering..."}),s.jsx("p",{className:"text-gray-600",children:"Please wait"})]}),n==="success"&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6",children:s.jsx(fe,{className:"w-12 h-12 text-green-600"})}),s.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Success! "}),s.jsx("p",{className:"text-gray-600",children:"The window has been successfully registered."})]})]}),n!=="intro"&&n!=="creating"&&n!=="success"&&s.jsxs("div",{className:"border-t border-gray-100 p-4 flex justify-between",children:[s.jsxs("button",{onClick:()=>{const x=m-1;x>=0&&a(y[x].id)},disabled:m===0,className:"flex items-center gap-2 px-4 py-2 text-gray-600 hover:text-gray-900 disabled:opacity-50 disabled:cursor-not-allowed",children:[s.jsx(Yo,{className:"w-4 h-4"}),"Previous"]}),n==="review"?s.jsxs("button",{onClick:k,className:"flex items-center gap-2 px-6 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium transition-colors",children:["Register",s.jsx(fe,{className:"w-4 h-4"})]}):s.jsxs("button",{onClick:()=>{const x=m+1;x<y.length&&a(y[x].id)},className:"flex items-center gap-2 px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors",children:["Next",s.jsx(Zn,{className:"w-4 h-4"})]})]})]})})}function B5({onContinue:t}){const[e,r]=_.useState(0),n=[{component:s.jsx(R5,{})},{component:s.jsx(O5,{})},{component:s.jsx(M5,{})},{component:s.jsx(L5,{})}],a=()=>{e<n.length-1?r(o=>o+1):t()},i=()=>{e>0&&r(o=>o-1)};return s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 dark:from-gray-900 dark:via-gray-900 dark:to-gray-800 flex flex-col transition-colors",children:[s.jsxs("div",{className:"px-6 py-8 flex justify-between items-center max-w-6xl mx-auto w-full",children:[s.jsx("div",{className:"flex gap-2",children:n.map((o,l)=>s.jsx("div",{className:`h-2 w-12 rounded-full transition-all duration-300 ${l<=e?"bg-blue-600":"bg-gray-200"}`},l))}),s.jsxs("button",{onClick:t,className:"text-gray-500 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 font-medium flex items-center gap-2 px-4 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:["Skip Intro ",s.jsx(Pr,{className:"w-4 h-4"})]})]}),s.jsx("div",{className:"flex-1 flex flex-col items-center justify-center px-6 pb-6",children:s.jsx("div",{className:"max-w-5xl w-full animate-in fade-in slide-in-from-bottom-4 duration-500",children:n[e].component})}),s.jsx("div",{className:"p-6 border-t border-gray-100 dark:border-gray-700 bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm sticky bottom-0 transition-colors",children:s.jsxs("div",{className:"max-w-5xl mx-auto flex justify-between items-center",children:[s.jsxs("button",{onClick:i,disabled:e===0,className:`flex items-center gap-2 px-6 py-3 rounded-xl font-medium transition-colors ${e===0?"text-gray-300 dark:text-gray-600 cursor-not-allowed":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-white"}`,children:[s.jsx(Yo,{className:"w-5 h-5"})," Back"]}),s.jsxs("button",{onClick:a,className:"flex items-center gap-2 px-8 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-xl shadow-lg hover:shadow-xl transition-all transform hover:scale-105",children:[e===n.length-1?"Get Started":"Next Step",s.jsx(Zn,{className:"w-5 h-5"})]})]})})]})}function R5(){return s.jsxs("div",{className:"text-center max-w-3xl mx-auto",children:[s.jsx("div",{className:"inline-flex items-center justify-center w-24 h-24 bg-blue-600 rounded-3xl mb-8 shadow-xl shadow-blue-200",children:s.jsx(Bo,{className:"w-12 h-12 text-white"})}),s.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-gray-900 dark:text-white mb-6",children:"Digital Product Passport"}),s.jsx("p",{className:"text-xl text-gray-600 dark:text-gray-300 mb-12 leading-relaxed",children:"Building trust in the circular economy through transparent, verifiable product data."}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl border border-gray-200 dark:border-gray-700 shadow-sm p-8 text-left transition-colors",children:[s.jsxs("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4 flex items-center gap-3",children:[s.jsx("span",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-300 text-sm",children:"1"}),"Why Does This System Exist?"]}),s.jsxs("p",{className:"text-gray-700 dark:text-gray-300 leading-relaxed mb-4 text-lg",children:["In a circular economy, products like windows move through many handsfrom manufacturers to installers to recyclers. The challenge is: ",s.jsx("strong",{children:"How do you trust the data?"})]}),s.jsxs("p",{className:"text-gray-700 leading-relaxed text-lg",children:["This system gives every product a ",s.jsx("strong",{children:"Digital Product Passport"})," (technically known as a ",s.jsx("strong",{children:"DID"}),"). Think of it as an unforgeable birth certificate that travels with the product forever, recording every significant event along the way."]})]})]})}function O5(){return s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsxs("div",{className:"text-center mb-10",children:[s.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-4",children:"Stakeholders"}),s.jsx("p",{className:"text-xl text-gray-600 dark:text-gray-300",children:"Who is involved in the product lifecycle?"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-8 hover:shadow-lg transition-all duration-300 hover:-translate-y-1",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[s.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:s.jsx(dj,{className:"w-8 h-8 text-blue-600"})}),s.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Manufacturer"})]}),s.jsx("p",{className:"text-gray-600 dark:text-gray-300 leading-relaxed",children:"Creates the product and issues its first digital passport. They are the starting point of the journey and define the initial specifications."})]}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-8 hover:shadow-lg transition-all duration-300 hover:-translate-y-1",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[s.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:s.jsx(hu,{className:"w-8 h-8 text-green-600"})}),s.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Operator"})]}),s.jsx("p",{className:"text-gray-600 dark:text-gray-300 leading-relaxed",children:"Works with the materials day-to-day. They handle assembly, installation, and maintenance, updating the passport with new events."})]}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-8 hover:shadow-lg transition-all duration-300 hover:-translate-y-1",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[s.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:s.jsx(Cj,{className:"w-8 h-8 text-purple-600"})}),s.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Supervisor"})]}),s.jsx("p",{className:"text-gray-600 dark:text-gray-300 leading-relaxed",children:"Oversees the entire process. They ensure compliance with regulations and quality standards, acting as an auditor."})]}),s.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-8 hover:shadow-lg transition-all duration-300 hover:-translate-y-1",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[s.jsx("div",{className:"p-3 bg-teal-100 rounded-lg",children:s.jsx(rc,{className:"w-8 h-8 text-teal-600"})}),s.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Recycler"})]}),s.jsx("p",{className:"text-gray-600 dark:text-gray-300 leading-relaxed",children:"Handles end-of-life processing. They use the passport to identify materials for efficient recycling, closing the loop."})]})]})]})}function M5(){return s.jsxs("div",{className:"max-w-5xl mx-auto",children:[s.jsxs("div",{className:"text-center mb-10",children:[s.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-4",children:"Under the Hood"}),s.jsx("p",{className:"text-xl text-gray-600 dark:text-gray-300",children:"Three digital guardians work together to ensure trust."})]}),s.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 shadow-sm overflow-hidden flex flex-col",children:[s.jsxs("div",{className:"bg-gradient-to-br from-emerald-500 to-emerald-600 p-6 text-center",children:[s.jsx(Mt,{className:"w-12 h-12 text-white mx-auto mb-3"}),s.jsx("h3",{className:"text-xl font-bold text-white",children:"Witnesses"}),s.jsx("p",{className:"text-emerald-100 text-sm",children:"The Digital Notaries"})]}),s.jsxs("div",{className:"p-6 flex-1 flex flex-col",children:[s.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-4 flex-1",children:"When an event happens (like production), a Witness reviews and digitally signs it."}),s.jsxs("div",{className:"bg-emerald-50 rounded-lg p-3 text-sm text-emerald-800 border border-emerald-100",children:[s.jsx("strong",{children:"Analogy:"})," Like a notary public stamping a document to prove it's official."]})]})]}),s.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 shadow-sm overflow-hidden flex flex-col",children:[s.jsxs("div",{className:"bg-gradient-to-br from-amber-500 to-amber-600 p-6 text-center",children:[s.jsx(Ha,{className:"w-12 h-12 text-white mx-auto mb-3"}),s.jsx("h3",{className:"text-xl font-bold text-white",children:"Watchers"}),s.jsx("p",{className:"text-amber-100 text-sm",children:"The Security Guards"})]}),s.jsxs("div",{className:"p-6 flex-1 flex flex-col",children:[s.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-4 flex-1",children:"They continuously monitor data for tampering and verify that components belong to the right products."}),s.jsxs("div",{className:"bg-amber-50 rounded-lg p-3 text-sm text-amber-800 border border-amber-100",children:[s.jsx("strong",{children:"Analogy:"})," Security cameras and inspectors that raise an alarm if something looks wrong."]})]})]}),s.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 shadow-sm overflow-hidden flex flex-col",children:[s.jsxs("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 p-6 text-center",children:[s.jsx(Sr,{className:"w-12 h-12 text-white mx-auto mb-3"}),s.jsx("h3",{className:"text-xl font-bold text-white",children:"Resolvers"}),s.jsx("p",{className:"text-blue-100 text-sm",children:"The Digital Phonebook"})]}),s.jsxs("div",{className:"p-6 flex-1 flex flex-col",children:[s.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-4 flex-1",children:"Looks up the unique ID (DID) and retrieves the full, verified history of the product."}),s.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 text-sm text-blue-800 border border-blue-100",children:[s.jsx("strong",{children:"Analogy:"})," A search engine that finds the right file instantly when you scan a code."]})]})]})]})]})}function L5(){return s.jsxs("div",{className:"max-w-3xl mx-auto text-center",children:[s.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-8",children:"Why Does This Matter?"}),s.jsx("div",{className:"bg-gradient-to-br from-blue-600 to-purple-700 rounded-3xl p-10 text-white shadow-xl mb-10",children:s.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[s.jsxs("div",{children:[s.jsx("div",{className:"bg-white/20 w-12 h-12 rounded-xl flex items-center justify-center mx-auto mb-4 backdrop-blur-sm",children:s.jsx(Sr,{className:"w-6 h-6 text-white"})}),s.jsx("h3",{className:"text-xl font-bold mb-2",children:"Transparency"}),s.jsx("p",{className:"text-blue-100 text-sm leading-relaxed",children:"No hidden surprises. Every step is recorded."})]}),s.jsxs("div",{children:[s.jsx("div",{className:"bg-white/20 w-12 h-12 rounded-xl flex items-center justify-center mx-auto mb-4 backdrop-blur-sm",children:s.jsx(Mt,{className:"w-6 h-6 text-white"})}),s.jsx("h3",{className:"text-xl font-bold mb-2",children:"Trust"}),s.jsx("p",{className:"text-blue-100 text-sm leading-relaxed",children:"Independent guardians ensure data is authentic."})]}),s.jsxs("div",{children:[s.jsx("div",{className:"bg-white/20 w-12 h-12 rounded-xl flex items-center justify-center mx-auto mb-4 backdrop-blur-sm",children:s.jsx(rc,{className:"w-6 h-6 text-white"})}),s.jsx("h3",{className:"text-xl font-bold mb-2",children:"Circularity"}),s.jsx("p",{className:"text-blue-100 text-sm leading-relaxed",children:"Smarter reuse through better data."})]})]})}),s.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-lg mb-8",children:"You are now ready to explore the dashboard. Remember, you can always revisit this guide by clicking the help icon."})]})}const CN=_.createContext(void 0);function F5({children:t}){const[e,r]=_.useState(()=>localStorage.getItem("theme")||"light");_.useEffect(()=>{console.log("Theme changed to:",e);const a=document.documentElement;e==="dark"?(a.classList.add("dark"),console.log("Added dark class to HTML element")):(a.classList.remove("dark"),console.log("Removed dark class from HTML element")),localStorage.setItem("theme",e),console.log("Saved theme to localStorage:",e)},[e]);const n=()=>{console.log("Toggle theme called, current theme:",e),r(a=>a==="light"?"dark":"light")};return s.jsx(CN.Provider,{value:{theme:e,toggleTheme:n},children:t})}function U5(){const t=_.useContext(CN);if(t===void 0)throw new Error("useTheme must be used within a ThemeProvider");return t}function z5(){var E;const{currentRole:t,setRole:e}=Xt(),{theme:r,toggleTheme:n}=U5(),[a,i]=_.useState("dashboard"),[o,l]=_.useState(""),[c,d]=_.useState(!0),[h,u]=_.useState(!1),[f,g]=_.useState(!0),[b,y]=_.useState("dashboard"),[k,m]=_.useState("role"),x=()=>{g(!1)};_.useEffect(()=>{let L=!1;return(async()=>{d(!0);const O=await te.getAllDPPs();if(!L){if(O.length===0){console.log("No data found, generating test data...");try{await cN(),console.log("Test data generated successfully");const V=await te.getAllDPPs();console.log("Total DPPs after generation:",V.length)}catch(V){console.error("Error initializing data:",V)}}else console.log("Existing data found:",O.length,"DPPs");d(!1)}})(),()=>{L=!0}},[]),_.useEffect(()=>{a==="manufacturer-wallet"&&!(t==="Manufacturer"||t==="Manufacturer A"||t==="Manufacturer B")&&(console.log("Role switched to non-manufacturer, resetting view to dashboard"),i("dashboard"),y("dashboard"))},[t,a]);function p(L,C){console.log("handleSelectDPP called with DID:",L,"from view:",C),l(L),C&&y(C),te.getDPPByDID(L).then(O=>{if(console.log("DPP found:",O),O){const V=O.type==="main"?"dpp-main":"dpp-component";console.log("Setting view to:",V),i(V)}else console.error("DPP not found for DID:",L)}).catch(O=>{console.error("Error loading DPP:",O)})}function v(){console.log("handleBack called, returning to:",b),i(b),l("")}function N(){i("create-dpp")}function A(){i("dashboard")}const D=[{value:"Manufacturer A",label:"Manufacturer A"},{value:"Manufacturer B",label:"Manufacturer B"},{value:"Supervisor",label:"Supervisor"},{value:"Recycler",label:"Recycler"},{value:"Consumer",label:"Consumer"},{value:"Witness",label:"Witness"},{value:"Watcher",label:"Watcher"},{value:"Resolver",label:"Resolver"}];return s.jsxs("div",{className:"relative bg-gray-50 dark:bg-gray-900 min-h-screen transition-colors",children:[s.jsxs("div",{className:"fixed top-4 left-4 z-50 flex items-center gap-2",children:[s.jsxs("div",{className:"relative",children:[s.jsxs("button",{onClick:()=>u(!h),className:"flex items-center gap-2 px-4 py-2 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm transition-colors",children:[s.jsx(_l,{className:"w-4 h-4 text-gray-700 dark:text-gray-300"}),s.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:(E=D.find(L=>L.value===t))==null?void 0:E.label}),s.jsx(lt,{className:"w-4 h-4 text-gray-700 dark:text-gray-300"})]}),h&&s.jsx("div",{className:"absolute top-full left-0 mt-2 w-48 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg overflow-hidden",children:D.map(L=>s.jsx("button",{onClick:()=>{e(L.value),u(!1)},className:`w-full text-left px-4 py-2 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors ${t===L.value?"bg-blue-50 dark:bg-blue-900 text-blue-600 dark:text-blue-400 font-medium":"text-gray-700 dark:text-gray-300"}`,children:L.label},L.value))})]}),s.jsx("button",{onClick:()=>g(!0),className:"flex items-center justify-center w-10 h-10 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm transition-colors",title:"Show introduction",children:s.jsx(fj,{className:"w-5 h-5 text-gray-600 dark:text-gray-300"})}),s.jsxs("button",{onClick:()=>m(k==="role"?"classic":"role"),className:`flex items-center gap-2 px-3 py-2 border rounded-lg shadow-sm transition-colors ${k==="classic"?"bg-purple-50 dark:bg-purple-900/50 border-purple-200 dark:border-purple-700 text-purple-700 dark:text-purple-300":"bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"}`,title:k==="role"?"Switch to Classic View":"Switch to Role View",children:[k==="role"?s.jsx(Ej,{className:"w-5 h-5"}):s.jsx(Sj,{className:"w-5 h-5"}),s.jsx("span",{className:"text-xs font-medium",children:k==="role"?"Role":"Classic"})]}),s.jsx("button",{onClick:n,className:"flex items-center justify-center w-10 h-10 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm transition-colors",title:r==="light"?"Switch to dark mode":"Switch to light mode",children:r==="light"?s.jsx(bj,{className:"w-5 h-5 text-gray-600"}):s.jsx(jj,{className:"w-5 h-5 text-yellow-400"})}),(t==="Manufacturer"||t==="Manufacturer A"||t==="Manufacturer B")&&s.jsx("button",{onClick:()=>i("manufacturer-wallet"),className:`flex items-center justify-center w-10 h-10 border rounded-lg shadow-sm transition-colors ${a==="manufacturer-wallet"?"bg-blue-50 dark:bg-blue-900/50 border-blue-200 dark:border-blue-700 text-blue-600 dark:text-blue-400":"bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-300"}`,title:"Open Manufacturer Wallet",children:s.jsx(zb,{className:"w-5 h-5"})})]}),f&&s.jsx(B5,{onContinue:x}),!f&&c&&s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Loading data..."})]})}),!f&&!c&&s.jsxs(s.Fragment,{children:[a==="register-wizard"&&s.jsx(_5,{onClose:()=>i("dashboard"),onComplete:()=>i("dashboard")}),a==="dashboard"&&t==="Witness"&&s.jsx(A5,{}),a==="dashboard"&&t==="Watcher"&&s.jsx(E5,{}),a==="dashboard"&&t==="Resolver"&&s.jsx(S5,{}),a==="manufacturer-wallet"&&(t==="Manufacturer"||t==="Manufacturer A"||t==="Manufacturer B")&&s.jsx(C5,{onNavigate:p,onCreateDPP:N,onBack:v,onClose:()=>{i("dashboard"),y("dashboard"),l("")}}),a==="dashboard"&&k==="role"&&(t==="Manufacturer"||t==="Manufacturer A"||t==="Manufacturer B")&&s.jsx(D5,{onRegisterWindow:()=>i("register-wizard"),onNavigate:p}),a==="dashboard"&&k==="role"&&t==="Supervisor"&&s.jsx(P5,{onNavigate:p}),a==="dashboard"&&k==="role"&&t==="Recycler"&&s.jsx(I5,{onNavigate:p}),a==="dashboard"&&k==="role"&&t==="Consumer"&&s.jsx(T5,{onNavigate:p}),a==="dashboard"&&k==="classic"&&t!=="Witness"&&t!=="Watcher"&&t!=="Resolver"&&s.jsx(hy,{onNavigate:p,onCreateDPP:t==="Manufacturer"||t==="Manufacturer A"||t==="Manufacturer B"?N:void 0}),a==="create-dpp"&&s.jsxs(s.Fragment,{children:[s.jsx(hy,{onNavigate:p,onCreateDPP:t==="Manufacturer"||t==="Manufacturer A"||t==="Manufacturer B"?N:void 0}),s.jsx(j5,{onClose:v,onComplete:A})]}),a==="dpp-main"&&s.jsx(yy,{did:o,onBack:v,onNavigate:L=>p(L,b),backLabel:b==="manufacturer-wallet"?"Back to Wallet":"Back to Dashboard"}),a==="dpp-component"&&s.jsx(yy,{did:o,onBack:v,onNavigate:L=>p(L,b),backLabel:b==="manufacturer-wallet"?"Back to Wallet":"Back to Dashboard"})]})]})}function H5(){return s.jsx(F5,{children:s.jsx(Bj,{children:s.jsx(z5,{})})})}Tb(document.getElementById("root")).render(s.jsx(_.StrictMode,{children:s.jsx(H5,{})}));
